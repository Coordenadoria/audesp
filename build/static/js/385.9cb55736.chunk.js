"use strict";(self.webpackChunkaudesp_connect_phase_v=self.webpackChunkaudesp_connect_phase_v||[]).push([[385],{2750(e,s,a){a.d(s,{D0:()=>i,MG:()=>c,T6:()=>d,VR:()=>l,X3:()=>n});var t=a(9379),r=(a(5043),a(4516)),o=a(579);const l={INPUT:"w-full h-10 px-3 rounded-md border border-slate-300 text-sm text-slate-700 shadow-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none transition-all placeholder:text-slate-400 disabled:bg-slate-50 disabled:text-slate-500",CHECKBOX:"w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer transition-colors",LABEL:"block text-xs font-bold text-slate-500 uppercase mb-1.5 tracking-wider",SECTION:"bg-white p-6 rounded-lg shadow-sm border border-slate-200 mb-6 animate-in fade-in slide-in-from-bottom-2 duration-500",BTN_ADD:"h-9 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium shadow-sm transition-colors flex items-center gap-2 cursor-pointer",BTN_REMOVE:"text-red-500 hover:text-red-700 text-xs font-bold uppercase tracking-wide transition-colors px-2 py-1 rounded hover:bg-red-50 cursor-pointer",BTN_SUB:"h-7 px-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded text-xs font-bold",HEADER_TITLE:"text-xl font-bold text-slate-800",HEADER_DIVIDER:"flex justify-between items-center mb-6 pb-4 border-b border-slate-100",GRID_CONTAINER:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",FLEX_ROW_CENTER:"flex items-center gap-3"},n=e=>{let{title:s,children:a}=e;return(0,o.jsxs)("div",{className:l.HEADER_DIVIDER,children:[(0,o.jsx)("h2",{className:l.HEADER_TITLE,children:s}),(0,o.jsx)("div",{className:"flex gap-2",children:a})]})},c=e=>{let{label:s,error:a,children:t}=e;return(0,o.jsxs)("div",{className:"mb-1",children:[(0,o.jsx)("label",{className:l.LABEL,children:s}),t,a&&(0,o.jsx)("div",{className:"text-red-600 text-[10px] font-bold uppercase mt-1 animate-pulse",children:a})]})};function d(e){let{title:s,items:a,newItemTemplate:c,onAdd:d,onRemove:i,onUpdate:p,renderItem:u,ocrSection:m,onOcrData:x}=e;return(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsx)(n,{title:s,children:(0,o.jsx)("button",{onClick:()=>d(c),className:l.BTN_ADD,children:"+ Adicionar Item"})}),m&&(0,o.jsx)(r.O,{section:m,onDataExtracted:e=>{e&&("relacao_empregados"===m&&e.empregados&&Array.isArray(e.empregados)?e.empregados.forEach(e=>d(e)):x?x(e):d((0,t.A)((0,t.A)({},c),e)))}}),a&&a.length>0?a.map((e,s)=>(0,o.jsxs)("div",{className:l.SECTION+" relative border-l-4 border-l-slate-400",children:[(0,o.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,o.jsx)("button",{onClick:()=>i(s),className:l.BTN_REMOVE,children:"\ud83d\uddd1 Remover"})}),(0,o.jsx)("div",{className:"pt-2",children:u(e,s,(e,a)=>p(s,e,a))})]},s)):(0,o.jsx)("div",{className:"text-center p-8 border-2 border-dashed border-slate-200 rounded-lg bg-slate-50",children:(0,o.jsx)("p",{className:"text-slate-400 text-sm font-medium",children:"Nenhum registro adicionado."})})]})}const i=e=>{let{label:s,value:a,onChange:t,type:r="text",error:n,options:d}=e;return(0,o.jsx)(c,{label:s,error:n,children:d?(0,o.jsx)("select",{className:l.INPUT,value:a,onChange:e=>t(e.target.value),children:d.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,o.jsx)("input",{type:r,className:l.INPUT,value:a,onChange:e=>t("number"===r?Number(e.target.value):e.target.value),step:"number"===r?"0.01":void 0})})}},4516(e,s,a){a.d(s,{O:()=>l});var t=a(5043);const r="http://localhost:8000";var o=a(579);const l=e=>{let{section:s,onDataExtracted:a}=e;const[l,n]=(0,t.useState)(!1),[c,d]=(0,t.useState)(null),[i,p]=(0,t.useState)(!0);t.useEffect(()=>{(async function(){try{return(await fetch("".concat(r,"/health"))).ok}catch(c){return console.warn("[OCRService] Backend n\xe3o dispon\xedvel:",c),!1}})().then(p)},[]);return(0,o.jsxs)("div",{className:"mb-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg shadow-sm",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("h3",{className:"text-sm font-bold text-indigo-800 flex items-center gap-2",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),"OCR Inteligente (Gemini 2.0)"]}),(0,o.jsxs)("p",{className:"text-xs text-indigo-600 mt-1",children:["Extra\xe7\xe3o autom\xe1tica para se\xe7\xe3o: ",(0,o.jsx)("strong",{children:s})]})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{type:"file",accept:"application/pdf",onChange:async e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0];if(!t.type.includes("pdf"))return void d("\u274c Apenas PDF \xe9 suportado. Recebido: ".concat(t.type||"tipo desconhecido"));n(!0),d(null);try{console.log("[GeminiUploader] Enviando PDF para backend: ".concat(t.name));const e=await async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";if(!e.type.includes("pdf"))throw new Error("\u274c Apenas PDF \xe9 suportado");const a=new FormData;a.append("file",e);try{console.log("[OCRService] Extraindo dados de bloco:",s);const e=await fetch("".concat(r,"/api/ocr/extract-block?block_type=").concat(s),{method:"POST",body:a});if(!e.ok){const s=await e.json();throw new Error(s.detail||"HTTP ".concat(e.status))}return function(e,s){const a={};switch(s){case"general":e.cnpj&&e.cnpj.length>0&&(a.cnpj=e.cnpj[0]),e.cpf&&e.cpf.length>0&&(a.cpf=e.cpf[0]),e.dates&&e.dates.length>0&&(a.dates=e.dates),e.phones&&e.phones.length>0&&(a.phone=e.phones[0]),e.emails&&e.emails.length>0&&(a.email=e.emails[0]);break;case"finance":if(e.currency&&e.currency.length>0){a.values=e.currency;const s=e.currency[0].match(/[\d.,]+/);s&&(a.primary_value=s[0])}e.percentages&&e.percentages.length>0&&(a.percentages=e.percentages);break;default:a.patterns=e}return a}((await e.json()).patterns,s)}catch(c){const s=c.message||"Erro ao extrair dados de bloco";throw console.error("[OCRService] Erro ao extrair bloco:",s),new Error("\u274c Erro na extra\xe7\xe3o: ".concat(s))}}(t,"general");console.log("[GeminiUploader] Dados extra\xeddos com sucesso:",e),a(e)}catch(s){console.error("[GeminiUploader] Erro ao processar arquivo:",s);const e=(null===s||void 0===s?void 0:s.message)||"Erro ao processar PDF";d(e)}finally{n(!1)}}},disabled:l,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:"Selecione um arquivo PDF"}),(0,o.jsx)("button",{disabled:l,className:"px-4 py-2 rounded text-sm font-medium shadow transition-colors ".concat(l?"bg-indigo-300":"bg-indigo-600 hover:bg-indigo-700"," text-white"),children:l?"Lendo Documento...":"Upload PDF/Imagem"})]})]}),c&&(0,o.jsx)("p",{className:"text-red-600 text-xs mt-2 font-medium",children:c})]})}},5385(e,s,a){a.d(s,{Dashboard:()=>o});a(5043);var t=a(2750),r=a(579);const o=e=>{var s,a,o,l,n,c,d,i,p;let{data:u,sectionStatus:m,onNavigate:x}=e;const h=((null===(s=u.receitas)||void 0===s||null===(a=s.repasses_recebidos)||void 0===a?void 0:a.reduce((e,s)=>e+(s.valor||0),0))||0)+(((null===(o=u.receitas)||void 0===o||null===(l=o.outras_receitas)||void 0===l?void 0:l.reduce((e,s)=>e+(s.valor||0),0))||0)+((null===(n=u.receitas)||void 0===n?void 0:n.receitas_aplic_financ_repasses_publicos_municipais)||0)+((null===(c=u.receitas)||void 0===c?void 0:c.receitas_aplic_financ_repasses_publicos_estaduais)||0)+((null===(d=u.receitas)||void 0===d?void 0:d.receitas_aplic_financ_repasses_publicos_federais)||0)),g=((null===(i=u.pagamentos)||void 0===i?void 0:i.reduce((e,s)=>e+(s.pagamento_valor||0),0))||0)+((null===(p=u.devolucoes)||void 0===p?void 0:p.reduce((e,s)=>e+(s.valor||0),0))||0),b=h-g,v=["descritor","codigo_ajuste","dados_gerais","responsaveis","empenhos","contratos","documentos_fiscais","pagamentos","repasses","receitas","glosas","ajustes_saldo","descontos","devolucoes","disponibilidades","relatorio_atividades","relatorio_gov","relacao_empregados","servidores_cedidos","relacao_bens","demonstracoes","publicacoes","declaracoes","transparencia","parecer"],f=v.length,j=Object.values(m).filter(e=>"valid"===e.status).length,N=Math.round(j/f*100);return(0,r.jsxs)("div",{className:"space-y-8 animate-in fade-in duration-500",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[(0,r.jsx)("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Progresso do Preenchimento"}),(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[(0,r.jsxs)("span",{className:"text-3xl font-bold text-slate-800",children:[N,"%"]}),(0,r.jsxs)("span",{className:"text-sm text-slate-500 mb-1",children:[j,"/",f," Blocos"]})]}),(0,r.jsx)("div",{className:"w-full bg-slate-100 h-2 mt-3 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"bg-blue-600 h-full transition-all duration-1000",style:{width:"".concat(N,"%")}})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[(0,r.jsx)("h3",{className:"text-xs font-bold text-emerald-600 uppercase tracking-wider mb-2",children:"Total Receitas"}),(0,r.jsx)("span",{className:"text-2xl font-bold text-slate-800",children:h.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(0,r.jsx)("p",{className:"text-[10px] text-slate-400 mt-1",children:"Repasses + Rendimentos"})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[(0,r.jsx)("h3",{className:"text-xs font-bold text-red-500 uppercase tracking-wider mb-2",children:"Total Despesas"}),(0,r.jsx)("span",{className:"text-2xl font-bold text-slate-800",children:g.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(0,r.jsx)("p",{className:"text-[10px] text-slate-400 mt-1",children:"Pagamentos + Devolu\xe7\xf5es"})]}),(0,r.jsxs)("div",{className:"p-6 rounded-lg shadow-sm border ".concat(b>=0?"bg-blue-50 border-blue-200":"bg-red-50 border-red-200"),children:[(0,r.jsx)("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Saldo Final Estimado"}),(0,r.jsx)("span",{className:"text-2xl font-bold ".concat(b>=0?"text-blue-700":"text-red-700"),children:b.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(0,r.jsx)("p",{className:"text-[10px] text-slate-500 mt-1",children:"Calculado automaticamente"})]})]}),(0,r.jsxs)("div",{className:t.VR.SECTION,children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:t.VR.HEADER_TITLE,children:"Status dos Blocos"}),(0,r.jsxs)("div",{className:"flex gap-4 text-xs font-medium",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Completo"]}),(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-red-500"})," Inv\xe1lido/Pendente"]}),(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-slate-300"})," Vazio (Opcional)"]})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:v.map(e=>{const s=m[e];let a="bg-slate-50 border-slate-200 text-slate-400",t="\u26aa";"valid"===(null===s||void 0===s?void 0:s.status)?(a="bg-green-50 border-green-200 text-green-800 hover:bg-green-100",t="\u2705"):"invalid"===(null===s||void 0===s?void 0:s.status)&&(a="bg-red-50 border-red-200 text-red-800 hover:bg-red-100",t="\u26a0\ufe0f");return(0,r.jsxs)("button",{onClick:()=>x(e),className:"p-3 rounded border text-left transition-all ".concat(a," relative group"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)("span",{className:"font-bold text-xs uppercase tracking-wide opacity-70",children:"Se\xe7\xe3o"}),(0,r.jsx)("span",{children:t})]}),(0,r.jsx)("div",{className:"font-semibold text-sm mt-1 truncate",children:{descritor:"Descritor",codigo_ajuste:"C\xf3digo Ajuste",dados_gerais:"Dados Gerais",responsaveis:"Respons\xe1veis",empenhos:"Empenhos",contratos:"Contratos",documentos_fiscais:"Docs Fiscais",pagamentos:"Pagamentos",repasses:"Repasses",receitas:"Receitas",glosas:"Glosas",ajustes_saldo:"Ajustes Saldo",descontos:"Descontos",devolucoes:"Devolu\xe7\xf5es",disponibilidades:"Disponibilidades",relatorio_atividades:"Rel. Atividades",relatorio_gov:"Rel. Governo",relacao_empregados:"Empregados",servidores_cedidos:"Cedidos",relacao_bens:"Bens",demonstracoes:"Dem. Cont\xe1beis",publicacoes:"Publica\xe7\xf5es",declaracoes:"Declara\xe7\xf5es",transparencia:"Transpar\xeancia",parecer:"Parecer"}[e]||e}),(null===s||void 0===s?void 0:s.errors.length)>0&&(0,r.jsxs)("div",{className:"hidden group-hover:block absolute bottom-full left-0 w-full bg-slate-800 text-white text-[10px] p-2 rounded mb-2 z-10 shadow-lg",children:[s.errors[0]," ",s.errors.length>1&&"(+".concat(s.errors.length-1,")")]})]},e)})})]})]})}}}]);
//# sourceMappingURL=385.9cb55736.chunk.js.map