/*! For license information please see main.af82da80.js.LICENSE.txt */
(()=>{var e={122(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var s,i,r;if(Array.isArray(t)){if((s=t.length)!=n.length)return!1;for(i=s;0!==i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((s=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=s;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=s;0!==i--;){var o=r[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},138(e,t,n){"use strict";var s,i,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const l=n(8584),c=n(9207),d=n(1762),u=n(9550),h=n(8396),p={keyword:"discriminator",type:"object",schemaType:"object",error:{message:e=>{let{params:{discrError:t,tagName:n}}=e;return t===c.DiscrError.Tag?'tag "'.concat(n,'" must be string'):'value of tag "'.concat(n,'" must be in oneOf')},params:e=>{let{params:{discrError:t,tag:n,tagName:i}}=e;return(0,l._)(s||(s=a(["{error: ",", tag: ",", tagValue: ","}"])),t,i,n)}},code(e){const{gen:t,data:n,schema:s,parentSchema:p,it:f}=e,{oneOf:m}=p;if(!f.opts.discriminator)throw new Error("discriminator: requires discriminator option");const g=s.propertyName;if("string"!=typeof g)throw new Error("discriminator: requires propertyName");if(s.mapping)throw new Error("discriminator: mapping is not supported");if(!m)throw new Error("discriminator: requires oneOf keyword");const v=t.let("valid",!1),b=t.const("tag",(0,l._)(i||(i=a(["","",""])),n,(0,l.getProperty)(g)));function y(n){const s=t.name("valid"),i=e.subschema({keyword:"oneOf",schemaProp:n},s);return e.mergeEvaluated(i,l.Name),s}t.if((0,l._)(r||(r=a(["typeof ",' == "string"'])),b),()=>function(){const n=function(){var e;const t={},n=i(p);let s=!0;for(let a=0;a<m.length;a++){let t=m[a];if((null===t||void 0===t?void 0:t.$ref)&&!(0,h.schemaHasRulesButRef)(t,f.self.RULES)){const e=t.$ref;if(t=d.resolveRef.call(f.self,f.schemaEnv.root,f.baseId,e),t instanceof d.SchemaEnv&&(t=t.schema),void 0===t)throw new u.default(f.opts.uriResolver,f.baseId,e)}const o=null===(e=null===t||void 0===t?void 0:t.properties)||void 0===e?void 0:e[g];if("object"!=typeof o)throw new Error('discriminator: oneOf subschemas (or referenced schemas) must have "properties/'.concat(g,'"'));s=s&&(n||i(t)),r(o,a)}if(!s)throw new Error('discriminator: "'.concat(g,'" must be required'));return t;function i(e){let{required:t}=e;return Array.isArray(t)&&t.includes(g)}function r(e,t){if(e.const)o(e.const,t);else{if(!e.enum)throw new Error('discriminator: "properties/'.concat(g,'" must have "const" or "enum"'));for(const n of e.enum)o(n,t)}}function o(e,n){if("string"!=typeof e||e in t)throw new Error('discriminator: "'.concat(g,'" values must be unique strings'));t[e]=n}}();t.if(!1);for(const e in n)t.elseIf((0,l._)(o||(o=a([""," === ",""])),b,e)),t.assign(v,y(n[e]));t.else(),e.error(!1,{discrError:c.DiscrError.Mapping,tag:b,tagName:g}),t.endIf()}(),()=>e.error(!1,{discrError:c.DiscrError.Tag,tag:b,tagName:g})),e.ok(v)}};t.default=p},166(e){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.__esModule=!0,e.exports.default=e.exports},266(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(8584),i={data:new s.Name("data"),valCxt:new s.Name("valCxt"),instancePath:new s.Name("instancePath"),parentData:new s.Name("parentData"),parentDataProperty:new s.Name("parentDataProperty"),rootData:new s.Name("rootData"),dynamicAnchors:new s.Name("dynamicAnchors"),vErrors:new s.Name("vErrors"),errors:new s.Name("errors"),this:new s.Name("this"),self:new s.Name("self"),scope:new s.Name("scope"),json:new s.Name("json"),jsonPos:new s.Name("jsonPos"),jsonLen:new s.Name("jsonLen"),jsonPart:new s.Name("jsonPart")};t.default=i},463(e,t,n){"use strict";var s,i,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const l=n(8584),c=n(8396);function d(e,t,n){const{gen:d,compositeRule:u,data:h,opts:p}=e;if(void 0===n)return;const f=(0,l._)(s||(s=a(["","",""])),h,(0,l.getProperty)(t));if(u)return void(0,c.checkStrictMode)(e,"default is ignored for: ".concat(f));let m=(0,l._)(i||(i=a([""," === undefined"])),f);"empty"===p.useDefaults&&(m=(0,l._)(r||(r=a([""," || "," === null || ",' === ""'])),m,f,f)),d.if(m,(0,l._)(o||(o=a([""," = ",""])),f,(0,l.stringify)(n)))}t.assignDefaults=function(e,t){const{properties:n,items:s}=e.schema;if("object"===t&&n)for(const i in n)d(e,i,n[i].default);else"array"===t&&Array.isArray(s)&&s.forEach((t,n)=>d(e,n,t.default))}},483(e,t,n){"use strict";var s,i=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const r=n(2215),o=n(7864),a=n(8584),l=new a.Name("fullFormats"),c=new a.Name("fastFormats"),d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keywords:!0};if(Array.isArray(t))return u(e,t,r.fullFormats,l),e;const[n,s]="fast"===t.mode?[r.fastFormats,c]:[r.fullFormats,l];return u(e,t.formats||r.formatNames,n,s),t.keywords&&o.default(e),e};function u(e,t,n,r){var o,l;null!==(o=(l=e.opts.code).formats)&&void 0!==o||(l.formats=a._(s||(s=i(['require("ajv-formats/dist/formats").',""])),r));for(const s of t)e.addFormat(s,n[s])}d.get=function(e){const t=("fast"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full")?r.fastFormats:r.fullFormats)[e];if(!t)throw new Error('Unknown format "'.concat(e,'"'));return t},e.exports=t=d,Object.defineProperty(t,"__esModule",{value:!0}),t.default=d},579(e,t,n){"use strict";e.exports=n(1153)},656(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const y=n(8584),_=n(8396),w=n(266),x=n(8396);function E(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,y._)(r||(r=b(["Object.prototype.hasOwnProperty"])))})}function S(e,t,n){return(0,y._)(o||(o=b(["",".call(",", ",")"])),E(e),t,n)}function A(e,t,n,s){const i=(0,y._)(c||(c=b(["",""," === undefined"])),t,(0,y.getProperty)(n));return s?(0,y.or)(i,(0,y.not)(S(e,t,n))):i}function C(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}t.checkReportMissingProp=function(e,t){const{gen:n,data:i,it:r}=e;n.if(A(n,i,t,r.opts.ownProperties),()=>{e.setParams({missingProperty:(0,y._)(s||(s=b(["",""])),t)},!0),e.error()})},t.checkMissingProp=function(e,t,n){let{gen:s,data:r,it:{opts:o}}=e;return(0,y.or)(...t.map(e=>(0,y.and)(A(s,r,e,o.ownProperties),(0,y._)(i||(i=b([""," = ",""])),n,e))))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.hasPropFunc=E,t.isOwnProperty=S,t.propertyInData=function(e,t,n,s){const i=(0,y._)(a||(a=b(["",""," !== undefined"])),t,(0,y.getProperty)(n));return s?(0,y._)(l||(l=b([""," && ",""])),i,S(e,t,n)):i},t.noPropertyInData=A,t.allSchemaProperties=C,t.schemaProperties=function(e,t){return C(t).filter(n=>!(0,_.alwaysValidSchema)(e,t[n]))},t.callValidateCode=function(e,t,n,s){let{schemaCode:i,data:r,it:{gen:o,topSchemaRef:a,schemaPath:l,errorPath:c},it:f}=e;const m=s?(0,y._)(d||(d=b(["",", ",", ","",""])),i,r,a,l):r,g=[[w.default.instancePath,(0,y.strConcat)(w.default.instancePath,c)],[w.default.parentData,f.parentData],[w.default.parentDataProperty,f.parentDataProperty],[w.default.rootData,w.default.rootData]];f.opts.dynamicRef&&g.push([w.default.dynamicAnchors,w.default.dynamicAnchors]);const v=(0,y._)(u||(u=b(["",", ",""])),m,o.object(...g));return n!==y.nil?(0,y._)(h||(h=b(["",".call(",", ",")"])),t,n,v):(0,y._)(p||(p=b(["","(",")"])),t,v)};const k=(0,y._)(f||(f=b(["new RegExp"])));t.usePattern=function(e,t){let{gen:n,it:{opts:s}}=e;const i=s.unicodeRegExp?"u":"",{regExp:r}=s.code,o=r(t,i);return n.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,y._)(m||(m=b(["","(",", ",")"])),"new RegExp"===r.code?k:(0,x.useFunc)(n,r),t,i)})},t.validateArray=function(e){const{gen:t,data:n,keyword:s,it:i}=e,r=t.name("valid");if(i.allErrors){const e=t.let("valid",!0);return o(()=>t.assign(e,!1)),e}return t.var(r,!0),o(()=>t.break()),r;function o(i){const o=t.const("len",(0,y._)(g||(g=b(["",".length"])),n));t.forRange("i",0,o,n=>{e.subschema({keyword:s,dataProp:n,dataPropType:_.Type.Num},r),t.if((0,y.not)(r),i)})}},t.validateUnion=function(e){const{gen:t,schema:n,keyword:s,it:i}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(e=>(0,_.alwaysValidSchema)(i,e))&&!i.opts.unevaluated)return;const r=t.let("valid",!1),o=t.name("_valid");t.block(()=>n.forEach((n,i)=>{const a=e.subschema({keyword:s,schemaProp:i,compositeRule:!0},o);t.assign(r,(0,y._)(v||(v=b([""," || ",""])),r,o));e.mergeValidEvaluated(a,o)||t.if((0,y.not)(r))})),e.result(r,()=>e.reset(),()=>e.error(!0))}},667(e){"use strict";var t=e.exports=function(e,t,s){"function"==typeof t&&(s=t,t={}),n(t,"function"==typeof(s=t.cb||s)?s:s.pre||function(){},s.post||function(){},e,"",e)};function n(e,i,r,o,a,l,c,d,u,h){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var p in i(o,a,l,c,d,u,h),o){var f=o[p];if(Array.isArray(f)){if(p in t.arrayKeywords)for(var m=0;m<f.length;m++)n(e,i,r,f[m],a+"/"+p+"/"+m,l,a,p,o,m)}else if(p in t.propsKeywords){if(f&&"object"==typeof f)for(var g in f)n(e,i,r,f[g],a+"/"+p+"/"+s(g),l,a,p,o,g)}else(p in t.keywords||e.allKeys&&!(p in t.skipKeywords))&&n(e,i,r,f,a+"/"+p,l,a,p,o)}r(o,a,l,c,d,u,h)}}function s(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},1011(e,t,n){"use strict";var s,i,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const l=n(656),c=n(8584),d={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:e=>{let{schemaCode:t}=e;return(0,c.str)(s||(s=a(['must match pattern "','"'])),t)},params:e=>{let{schemaCode:t}=e;return(0,c._)(i||(i=a(["{pattern: ","}"])),t)}},code(e){const{data:t,$data:n,schema:s,schemaCode:i,it:d}=e,u=d.opts.unicodeRegExp?"u":"",h=n?(0,c._)(r||(r=a(["(new RegExp(",", ","))"])),i,u):(0,l.usePattern)(e,s);e.fail$data((0,c._)(o||(o=a(["!",".test(",")"])),h,t))}};t.default=d},1153(e,t,n){"use strict";var s=n(5043),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var s,r={},c=null,d=null;for(s in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,s)&&!l.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:i,type:e,key:c,ref:d,props:r,_owner:a.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},1156(e,t,n){"use strict";var s,i,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;const c=n(8584),d=n(8396),u={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:e=>{let{params:{len:t}}=e;return(0,c.str)(s||(s=l(["must NOT have more than "," items"])),t)},params:e=>{let{params:{len:t}}=e;return(0,c._)(i||(i=l(["{limit: ","}"])),t)}},code(e){const{parentSchema:t,it:n}=e,{items:s}=t;Array.isArray(s)?h(e,s):(0,d.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas')}};function h(e,t){const{gen:n,schema:s,data:i,keyword:u,it:h}=e;h.items=!0;const p=n.const("len",(0,c._)(r||(r=l(["",".length"])),i));if(!1===s)e.setParams({len:t.length}),e.pass((0,c._)(o||(o=l([""," <= ",""])),p,t.length));else if("object"==typeof s&&!(0,d.alwaysValidSchema)(h,s)){const s=n.var("valid",(0,c._)(a||(a=l([""," <= ",""])),p,t.length));n.if((0,c.not)(s),()=>function(s){n.forRange("i",t.length,p,t=>{e.subschema({keyword:u,dataProp:t,dataPropType:d.Type.Num},s),h.allErrors||n.if((0,c.not)(s),()=>n.break())})}(s)),e.ok(s)}}t.validateAdditionalItems=h,t.default=u},1246(e){"use strict";const t=e=>new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{t(s.result)},s.onerror=e=>{let{target:{error:{code:t}}}=e;n(Error("File could not be read! Code=".concat(t)))},s.readAsArrayBuffer(e)}),n=async e=>{let s=e;if("undefined"===typeof e)return"undefined";if("string"===typeof e)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e))s=atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const t=await fetch(e);s=await t.arrayBuffer()}else if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement)"IMG"===e.tagName&&(s=await n(e.src)),"VIDEO"===e.tagName&&(s=await n(e.poster)),"CANVAS"===e.tagName&&await new Promise(n=>{e.toBlob(async e=>{s=await t(e),n()})});else if("undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas){const n=await e.convertToBlob();s=await t(n)}else(e instanceof File||e instanceof Blob)&&(s=await t(e));return new Uint8Array(s)};e.exports=n},1257(e,t,n){"use strict";var s=n(2897).default;const i=n(1432),r=n(9343),o=n(2163),a=n(7092),l=n(1600),c=n(5783),{setLogging:d}=n(5597);e.exports=s({languages:a,OEM:l,PSM:c,createScheduler:i,createWorker:r,setLogging:d},o)},1289(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=n(8396),c={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:e=>{let{params:t}=e;return(0,a._)(s||(s=o(["{passingSchemas: ","}"])),t.passing)}},code(e){const{gen:t,schema:n,parentSchema:s,it:c}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(c.opts.discriminator&&s.discriminator)return;const d=n,u=t.let("valid",!1),h=t.let("passing",null),p=t.name("_valid");e.setParams({passing:h}),t.block(function(){d.forEach((n,s)=>{let d;(0,l.alwaysValidSchema)(c,n)?t.var(p,!0):d=e.subschema({keyword:"oneOf",schemaProp:s,compositeRule:!0},p),s>0&&t.if((0,a._)(i||(i=o([""," && ",""])),p,u)).assign(u,!1).assign(h,(0,a._)(r||(r=o(["[",", ","]"])),h,s)).else(),t.if(p,()=>{t.assign(u,!0),t.assign(h,s),d&&e.mergeEvaluated(d,a.Name)})})}),e.result(u,()=>e.reset(),()=>e.error(!0))}};t.default=c},1432(e,t,n){"use strict";const s=n(5362),{log:i}=n(5597),r=n(1674);let o=0;e.exports=()=>{const e=r("Scheduler",o),t={},n={};let a=[];o+=1;const l=()=>Object.keys(t).length,c=()=>{if(0!==a.length){const e=Object.keys(t);for(let s=0;s<e.length;s+=1)if("undefined"===typeof n[e[s]]){a[0](t[e[s]]);break}}},d=(t,r)=>new Promise((o,l)=>{const d=s({action:t,payload:r});a.push(async e=>{a.shift(),n[e.id]=d;try{o(await e[t].apply(this,[...r,d.id]))}catch(s){l(s)}finally{delete n[e.id],c()}}),i("[".concat(e,"]: Add ").concat(d.id," to JobQueue")),i("[".concat(e,"]: JobQueue length=").concat(a.length)),c()});return{addWorker:n=>(t[n.id]=n,i("[".concat(e,"]: Add ").concat(n.id)),i("[".concat(e,"]: Number of workers=").concat(l())),c(),n.id),addJob:async function(t){if(0===l())throw Error("[".concat(e,"]: You need to have at least one worker before adding jobs"));for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return d(t,s)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),a=[]},getQueueLen:()=>a.length,getNumWorkers:l}}},1518(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=n(8396),c=n(2979),d={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:e=>{let{schemaCode:t}=e;return(0,a._)(s||(s=o(["{allowedValue: ","}"])),t)}},code(e){const{gen:t,data:n,$data:s,schemaCode:d,schema:u}=e;s||u&&"object"==typeof u?e.fail$data((0,a._)(i||(i=o(["!","(",", ",")"])),(0,l.useFunc)(t,c.default),n,d)):e.fail((0,a._)(r||(r=o([""," !== ",""])),u,n))}};t.default=d},1578(e,t,n){"use strict";const{isUUID:s}=n(6099),i=/([0-9a-z\u017F\u212A][\x2D0-9a-z\u017F\u212A]{0,31}):((?:[!\$'-\.0-;=@-Z_a-z\u017F\u212A]|%[0-9a-f]{2})+)/i,r=["http","https","ws","wss","urn","urn:uuid"];function o(e){return!0===e.secure||!1!==e.secure&&(!!e.scheme&&(3===e.scheme.length&&("w"===e.scheme[0]||"W"===e.scheme[0])&&("s"===e.scheme[1]||"S"===e.scheme[1])&&("s"===e.scheme[2]||"S"===e.scheme[2])))}function a(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function l(e){const t="https"===String(e.scheme).toLowerCase();return e.port!==(t?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}const c={scheme:"http",domainHost:!0,parse:a,serialize:l},d={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=o(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if(e.port!==(o(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"===typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){const[t,n]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=n,e.resourceName=void 0}return e.fragment=void 0,e}},u={http:c,https:{scheme:"https",domainHost:c.domainHost,parse:a,serialize:l},ws:d,wss:{scheme:"wss",domainHost:d.domainHost,parse:d.parse,serialize:d.serialize},urn:{scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;const n=e.path.match(i);if(n){const s=t.scheme||e.scheme||"urn";e.nid=n[1].toLowerCase(),e.nss=n[2];const i=h("".concat(s,":").concat(t.nid||e.nid));e.path=void 0,i&&(e=i.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){if(void 0===e.nid)throw new Error("URN without nid cannot be serialized");const n=t.scheme||e.scheme||"urn",s=e.nid.toLowerCase(),i=h("".concat(n,":").concat(t.nid||s));i&&(e=i.serialize(e,t));const r=e,o=e.nss;return r.path="".concat(s||t.nid,":").concat(o),t.skipEscape=!0,r},skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:function(e,t){const n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&s(n.uuid)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e){const t=e;return t.nss=(e.uuid||"").toLowerCase(),t},skipNormalize:!0}};function h(e){return e&&(u[e]||u[e.toLowerCase()])||void 0}Object.setPrototypeOf(u,null),e.exports={wsIsSecure:o,SCHEMES:u,isValidSchemeName:function(e){return-1!==r.indexOf(e)},getSchemeHandler:h}},1598(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const a=n(8584),l=n(8396),c=n(656);t.error={message:e=>{let{params:{property:t,depsCount:n,deps:i}}=e;const r=1===n?"property":"properties";return(0,a.str)(s||(s=o(["must have "," "," when property "," is present"])),r,i,t)},params:e=>{let{params:{property:t,depsCount:n,deps:s,missingProperty:r}}=e;return(0,a._)(i||(i=o(["{property: ",",\n    missingProperty: ",",\n    depsCount: ",",\n    deps: ","}"])),t,r,n,s)}};const d={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(e){const[t,n]=function(e){let{schema:t}=e;const n={},s={};for(const i in t){if("__proto__"===i)continue;(Array.isArray(t[i])?n:s)[i]=t[i]}return[n,s]}(e);u(e,t),h(e,n)}};function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema;const{gen:n,data:s,it:i}=e;if(0===Object.keys(t).length)return;const l=n.let("missing");for(const d in t){const u=t[d];if(0===u.length)continue;const h=(0,c.propertyInData)(n,s,d,i.opts.ownProperties);e.setParams({property:d,depsCount:u.length,deps:u.join(", ")}),i.allErrors?n.if(h,()=>{for(const t of u)(0,c.checkReportMissingProp)(e,t)}):(n.if((0,a._)(r||(r=o([""," && (",")"])),h,(0,c.checkMissingProp)(e,u,l))),(0,c.reportMissingProp)(e,l),n.else())}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema;const{gen:n,data:s,keyword:i,it:r}=e,o=n.name("valid");for(const a in t)(0,l.alwaysValidSchema)(r,t[a])||(n.if((0,c.propertyInData)(n,s,a,r.opts.ownProperties),()=>{const t=e.subschema({keyword:i,schemaProp:a},o);e.mergeValidEvaluated(t,o)},()=>n.var(o,!0)),e.ok(o))}t.validatePropertyDeps=u,t.validateSchemaDeps=h,t.default=d},1600(e){"use strict";e.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},1674(e){"use strict";e.exports=(e,t)=>"".concat(e,"-").concat(t,"-").concat(Math.random().toString(16).slice(3,8))},1734(e){"use strict";e.exports=e=>{const t={};return"undefined"!==typeof WorkerGlobalScope?t.type="webworker":"object"===typeof document?t.type="browser":"object"===typeof process&&(t.type="node"),"undefined"===typeof e?t:t[e]}},1762(e,t,n){"use strict";var s,i,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;const o=n(8584),a=n(6817),l=n(266),c=n(2302),d=n(8396),u=n(5413);class h{constructor(e){var t;let n;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,c.normalizeId)(null===n||void 0===n?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null===n||void 0===n?void 0:n.$async,this.refs={}}}function p(e){const t=m.call(this,e);if(t)return t;const n=(0,c.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:d,lines:h}=this.opts.code,{ownProperties:p}=this.opts,f=new o.CodeGen(this.scope,{es5:d,lines:h,ownProperties:p});let g;e.$async&&(g=f.scopeValue("Error",{ref:a.default,code:(0,o._)(s||(s=r(['require("ajv/dist/runtime/validation_error").default'])))}));const v=f.scopeName("validate");e.validateName=v;const b={gen:f,allErrors:this.opts.allErrors,data:l.default.data,parentData:l.default.parentData,parentDataProperty:l.default.parentDataProperty,dataNames:[l.default.data],dataPathArr:[o.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:f.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,o.stringify)(e.schema)}:{ref:e.schema}),validateName:v,ValidationError:g,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:o.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,o._)(i||(i=r(['""']))),opts:this.opts,self:this};let y;try{this._compilations.add(e),(0,u.validateFunctionCode)(b),f.optimize(this.opts.code.optimize);const t=f.toString();y="".concat(f.scopeRefs(l.default.scope),"return ").concat(t),this.opts.code.process&&(y=this.opts.code.process(y,e));const n=new Function("".concat(l.default.self),"".concat(l.default.scope),y)(this,this.scope.get());if(this.scope.value(v,{ref:n}),n.errors=null,n.schema=e.schema,n.schemaEnv=e,e.$async&&(n.$async=!0),!0===this.opts.code.source&&(n.source={validateName:v,validateCode:t,scopeValues:f._values}),this.opts.unevaluated){const{props:e,items:t}=b;n.evaluated={props:e instanceof o.Name?void 0:e,items:t instanceof o.Name?void 0:t,dynamicProps:e instanceof o.Name,dynamicItems:t instanceof o.Name},n.source&&(n.source.evaluated=(0,o.stringify)(n.evaluated))}return e.validate=n,e}catch(_){throw delete e.validate,delete e.validateName,y&&this.logger.error("Error compiling schema, function code:",y),_}finally{this._compilations.delete(e)}}function f(e){return(0,c.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:p.call(this,e)}function m(e){for(const t of this._compilations)if(g(t,e))return t}function g(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function v(e,t){let n;for(;"string"==typeof(n=this.refs[t]);)t=n;return n||this.schemas[t]||b.call(this,e,t)}function b(e,t){const n=this.opts.uriResolver.parse(t),s=(0,c._getFullPath)(this.opts.uriResolver,n);let i=(0,c.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&s===i)return _.call(this,n,e);const r=(0,c.normalizeId)(s),o=this.refs[r]||this.schemas[r];if("string"==typeof o){const t=b.call(this,e,o);if("object"!==typeof(null===t||void 0===t?void 0:t.schema))return;return _.call(this,n,t)}if("object"===typeof(null===o||void 0===o?void 0:o.schema)){if(o.validate||p.call(this,o),r===(0,c.normalizeId)(t)){const{schema:t}=o,{schemaId:n}=this.opts,s=t[n];return s&&(i=(0,c.resolveUrl)(this.opts.uriResolver,i,s)),new h({schema:t,schemaId:n,root:e,baseId:i})}return _.call(this,n,o)}}t.SchemaEnv=h,t.compileSchema=p,t.resolveRef=function(e,t,n){var s;n=(0,c.resolveUrl)(this.opts.uriResolver,t,n);const i=e.refs[n];if(i)return i;let r=v.call(this,e,n);if(void 0===r){const i=null===(s=e.localRefs)||void 0===s?void 0:s[n],{schemaId:o}=this.opts;i&&(r=new h({schema:i,schemaId:o,root:e,baseId:t}))}return void 0!==r?e.refs[n]=f.call(this,r):void 0},t.getCompilingSchema=m,t.resolveSchema=b;const y=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function _(e,t){let{baseId:n,schema:s,root:i}=t;var r;if("/"!==(null===(r=e.fragment)||void 0===r?void 0:r[0]))return;for(const l of e.fragment.slice(1).split("/")){if("boolean"===typeof s)return;const e=s[(0,d.unescapeFragment)(l)];if(void 0===e)return;s=e;const t="object"===typeof s&&s[this.opts.schemaId];!y.has(l)&&t&&(n=(0,c.resolveUrl)(this.opts.uriResolver,n,t))}let o;if("boolean"!=typeof s&&s.$ref&&!(0,d.schemaHasRulesButRef)(s,this.RULES)){const e=(0,c.resolveUrl)(this.opts.uriResolver,n,s.$ref);o=b.call(this,i,e)}const{schemaId:a}=this.opts;return o=o||new h({schema:s,schemaId:a,root:i,baseId:n}),o.schema!==o.root.schema?o:void 0}},1847(e,t,n){var s=n(4893);e.exports=function(e,t){if(null==e)return{};var n,i,r=s(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r},e.exports.__esModule=!0,e.exports.default=e.exports},2075(e,t,n){"use strict";var s,i,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const c=n(656),d=n(8584),u=n(266),h=n(8396),p={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:e=>{let{params:t}=e;return(0,d._)(s||(s=l(["{additionalProperty: ","}"])),t.additionalProperty)}},code(e){const{gen:t,schema:n,parentSchema:s,data:p,errsCount:f,it:m}=e;if(!f)throw new Error("ajv implementation error");const{allErrors:g,opts:v}=m;if(m.props=!0,"all"!==v.removeAdditional&&(0,h.alwaysValidSchema)(m,n))return;const b=(0,c.allSchemaProperties)(s.properties),y=(0,c.allSchemaProperties)(s.patternProperties);function _(e){t.code((0,d._)(a||(a=l(["delete ","[","]"])),p,e))}function w(s){if("all"===v.removeAdditional||v.removeAdditional&&!1===n)_(s);else{if(!1===n)return e.setParams({additionalProperty:s}),e.error(),void(g||t.break());if("object"==typeof n&&!(0,h.alwaysValidSchema)(m,n)){const n=t.name("valid");"failing"===v.removeAdditional?(x(s,n,!1),t.if((0,d.not)(n),()=>{e.reset(),_(s)})):(x(s,n),g||t.if((0,d.not)(n),()=>t.break()))}}}function x(t,n,s){const i={keyword:"additionalProperties",dataProp:t,dataPropType:h.Type.Str};!1===s&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,n)}t.forIn("key",p,n=>{b.length||y.length?t.if(function(n){let i;if(b.length>8){const e=(0,h.schemaRefOrVal)(m,s.properties,"properties");i=(0,c.isOwnProperty)(t,e,n)}else i=b.length?(0,d.or)(...b.map(e=>(0,d._)(r||(r=l([""," === ",""])),n,e))):d.nil;return y.length&&(i=(0,d.or)(i,...y.map(t=>(0,d._)(o||(o=l(["",".test(",")"])),(0,c.usePattern)(e,t),n)))),(0,d.not)(i)}(n),()=>w(n)):w(n)}),e.ok((0,d._)(i||(i=l([""," === ",""])),f,u.default.errors))}};t.default=p},2079(e){"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},2141(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(6623),i=n(7352),r=n(9294),o=n(1011),a=n(8211),l=n(4796),c=n(4700),d=n(6480),u=n(1518),h=n(6740),p=[s.default,i.default,r.default,o.default,a.default,l.default,c.default,d.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},u.default,h.default];t.default=p},2163(e,t,n){"use strict";const s=n(9343);e.exports={recognize:async(e,t,n)=>{const i=await s(t,1,n);return i.recognize(e).finally(async()=>{await i.terminate()})},detect:async(e,t)=>{const n=await s("osd",0,t);return n.detect(e).finally(async()=>{await n.terminate()})}}},2215(e,t,n){"use strict";var s=n(2897).default;function i(e,t){return{validate:e,compare:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0,t.fullFormats={date:i(a,l),time:i(d,u),"date-time":i(function(e){const t=e.split(h);return 2===t.length&&a(t[0])&&d(t[1],!0)},p),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return f.test(e)&&m.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:http[s\u017F]?|ftp):\/\/(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!(?:10|127)(?:\.[0-9]{1,3}){3})(?!(?:169\.254|192\.168)(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:[0-9KSa-z\xA1-\uFFFF]+-)*[0-9KSa-z\xA1-\uFFFF]+)(?:\.(?:[0-9KSa-z\xA1-\uFFFF]+-)*[0-9KSa-z\xA1-\uFFFF]+)*(?:\.(?:[KSa-z\xA1-\uFFFF]{2,})))(?::[0-9]{2,5})?(?:\/(?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*)?$/i,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(b.test(e))return!1;try{return new RegExp(e),!0}catch(t){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return g.lastIndex=0,g.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=2147483647&&e>=-2147483648}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:v},double:{type:"number",validate:v},password:!0,binary:!0},t.fastFormats=s(s({},t.fullFormats),{},{date:i(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,l),time:i(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,u),"date-time":i(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,p),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i}),t.formatNames=Object.keys(t.fullFormats);const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a(e){const t=r.exec(e);if(!t)return!1;const n=+t[1],s=+t[2],i=+t[3];return s>=1&&s<=12&&i>=1&&i<=(2===s&&function(e){return e%4===0&&(e%100!==0||e%400===0)}(n)?29:o[s])}function l(e,t){if(e&&t)return e>t?1:e<t?-1:0}const c=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function d(e,t){const n=c.exec(e);if(!n)return!1;const s=+n[1],i=+n[2],r=+n[3],o=n[5];return(s<=23&&i<=59&&r<=59||23===s&&59===i&&60===r)&&(!t||""!==o)}function u(e,t){if(!e||!t)return;const n=c.exec(e),s=c.exec(t);return n&&s?(e=n[1]+n[2]+n[3]+(n[4]||""))>(t=s[1]+s[2]+s[3]+(s[4]||""))?1:e<t?-1:0:void 0}const h=/t|\s/i;function p(e,t){if(!e||!t)return;const[n,s]=e.split(h),[i,r]=t.split(h),o=l(n,i);return void 0!==o?o||u(s,r):void 0}const f=/\/|:/,m=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;const g=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function v(){return!0}const b=/[^\\]\\Z/},2262(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b,y,_=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const w=n(8584),x={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:e=>{let{schemaCode:t}=e;return(0,w.str)(s||(s=_(['must match format "','"'])),t)},params:e=>{let{schemaCode:t}=e;return(0,w._)(i||(i=_(["{format: ","}"])),t)}},code(e,t){const{gen:n,data:s,$data:i,schema:x,schemaCode:E,it:S}=e,{opts:A,errSchemaPath:C,schemaEnv:k,self:T}=S;A.validateFormats&&(i?function(){const i=n.scopeValue("formats",{ref:T.formats,code:A.code.formats}),m=n.const("fDef",(0,w._)(r||(r=_(["","[","]"])),i,E)),g=n.let("fType"),v=n.let("format");n.if((0,w._)(o||(o=_(["typeof ",' == "object" && !('," instanceof RegExp)"])),m,m),()=>n.assign(g,(0,w._)(a||(a=_(["",'.type || "string"'])),m)).assign(v,(0,w._)(l||(l=_(["",".validate"])),m)),()=>n.assign(g,(0,w._)(c||(c=_(['"string"'])))).assign(v,m)),e.fail$data((0,w.or)(!1===A.strictSchema?w.nil:(0,w._)(d||(d=_([""," && !",""])),E,v),function(){const e=k.$async?(0,w._)(u||(u=_(["(",".async ? await ","(",") : ","(","))"])),m,v,s,v,s):(0,w._)(h||(h=_(["","(",")"])),v,s),n=(0,w._)(p||(p=_(["(typeof ",' == "function" ? '," : ",".test(","))"])),v,e,v,s);return(0,w._)(f||(f=_([""," && "," !== true && "," === "," && !",""])),v,v,g,t,n)}()))}():function(){const i=T.formats[x];if(!i)return void function(){if(!1===A.strictSchema)return void T.logger.warn(e());throw new Error(e());function e(){return'unknown format "'.concat(x,'" ignored in schema at path "').concat(C,'"')}}();if(!0===i)return;const[r,o,a]=function(e){const t=e instanceof RegExp?(0,w.regexpCode)(e):A.code.formats?(0,w._)(m||(m=_(["","",""])),A.code.formats,(0,w.getProperty)(x)):void 0,s=n.scopeValue("formats",{key:x,ref:e,code:t});if("object"==typeof e&&!(e instanceof RegExp))return[e.type||"string",e.validate,(0,w._)(g||(g=_(["",".validate"])),s)];return["string",e,s]}(i);r===t&&e.pass(function(){if("object"==typeof i&&!(i instanceof RegExp)&&i.async){if(!k.$async)throw new Error("async format in sync schema");return(0,w._)(v||(v=_(["await ","(",")"])),a,s)}return"function"==typeof o?(0,w._)(b||(b=_(["","(",")"])),a,s):(0,w._)(y||(y=_(["",".test(",")"])),a,s)}())}())}};t.default=x},2302(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const s=n(8396),i=n(122),r=n(667),o=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return"boolean"==typeof e||(!0===t?!l(e):!!t&&c(e)<=t)};const a=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(e){for(const t in e){if(a.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(l))return!0;if("object"==typeof n&&l(n))return!0}return!1}function c(e){let t=0;for(const n in e){if("$ref"===n)return 1/0;if(t++,!o.has(n)&&("object"==typeof e[n]&&(0,s.eachItem)(e[n],e=>t+=c(e)),t===1/0))return 1/0}return t}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!1!==(arguments.length>2?arguments[2]:void 0)&&(t=p(t));const n=e.parse(t);return u(e,n)}function u(e,t){return e.serialize(t).split("#")[0]+"#"}t.getFullPath=d,t._getFullPath=u;const h=/#\/?$/;function p(e){return e?e.replace(h,""):""}t.normalizeId=p,t.resolveUrl=function(e,t,n){return n=p(n),e.resolve(t,n)};const f=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:n,uriResolver:s}=this.opts,o=p(e[n]||t),a={"":o},l=d(s,o,!1),c={},u=new Set;return r(e,{allKeys:!0},(e,t,s,i)=>{if(void 0===i)return;const r=l+t;let o=a[i];function d(t){const n=this.opts.uriResolver.resolve;if(t=p(o?n(o,t):t),u.has(t))throw m(t);u.add(t);let s=this.refs[t];return"string"==typeof s&&(s=this.refs[s]),"object"==typeof s?h(e,s.schema,t):t!==p(r)&&("#"===t[0]?(h(e,c[t],t),c[t]=e):this.refs[t]=r),t}function g(e){if("string"==typeof e){if(!f.test(e))throw new Error('invalid anchor "'.concat(e,'"'));d.call(this,"#".concat(e))}}"string"==typeof e[n]&&(o=d.call(this,e[n])),g.call(this,e.$anchor),g.call(this,e.$dynamicAnchor),a[t]=o}),c;function h(e,t,n){if(void 0!==t&&!i(e,t))throw m(n)}function m(e){return new Error('reference "'.concat(e,'" resolves to more than one schema'))}}},2392(e,t){"use strict";function n(e,t){return t.rules.some(t=>s(e,t))}function s(e,t){var n;return void 0!==e[t.keyword]||(null===(n=t.definition.implements)||void 0===n?void 0:n.some(t=>void 0!==e[t]))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=function(e,t){let{schema:s,self:i}=e;const r=i.RULES.types[t];return r&&!0!==r&&n(s,r)},t.shouldUseGroup=n,t.shouldUseRule=s},2730(e,t,n){"use strict";var s=n(5043),i=n(8853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,s,i,r,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,n,s){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:s||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,s){if(null===t||"undefined"===typeof t||function(e,t,n,s){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!s&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,s))return!0;if(s)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,s)&&(n=null),s||null===i?function(e){return!!u.call(f,e)||!u.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,s=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,b);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var _=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),k=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var j,F=Object.assign;function L(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var s=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){s=c}e.call(t.prototype)}else{try{throw Error()}catch(c){s=c}e()}}catch(c){if(c&&s&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),r=s.stack.split("\n"),o=i.length-1,a=r.length-1;1<=o&&0<=a&&i[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==r[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==r[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function V(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case x:return"Portal";case A:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function z(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=z(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){s=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(e){s=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=z(e)?e.checked?"true":"false":e.value),(e=s)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,s=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){X(e,t);var n=q(t.value),s=t.type;if(null!=n)"number"===s?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===s||"reset"===s)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!("submit"!==s&&"reset"!==s||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,s){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&s&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(s&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function re(e,t){var n=q(t.value),s=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=s&&(e.defaultValue=""+s)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,s){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var s=0===n.indexOf("--"),i=me(n,t[n],s);"float"===n&&(n="cssFloat"),s?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Ee=null,Se=null;function Ae(e){if(e=yi(e)){if("function"!==typeof xe)throw Error(r(280));var t=e.stateNode;t&&(t=wi(t),xe(e.stateNode,e.type,t))}}function Ce(e){Ee?Se?Se.push(e):Se=[e]:Ee=e}function ke(){if(Ee){var e=Ee,t=Se;if(Se=Ee=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function Te(e,t){return e(t)}function Ne(){}var Ie=!1;function Pe(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Te(e,t,n)}finally{Ie=!1,(null!==Ee||null!==Se)&&(Ne(),ke())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var s=wi(n);if(null===s)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(r(231,t,typeof n));return n}var Me=!1;if(d)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(de){Me=!1}function De(e,t,n,s,i,r,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var je=!1,Fe=null,Le=!1,Ue=null,Be={onError:function(e){je=!0,Fe=e}};function Ve(e,t,n,s,i,r,o,a,l){je=!1,Fe=null,De.apply(Be,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(We(e)!==e)throw Error(r(188))}function ze(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,s=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(s=i.return)){n=s;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qe(i),e;if(o===s)return qe(i),t;o=o.sibling}throw Error(r(188))}if(n.return!==s.return)n=i,s=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,s=o;break}if(l===s){a=!0,s=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,s=i;break}if(l===s){a=!0,s=o,n=i;break}l=l.sibling}if(!a)throw Error(r(189))}}if(n.alternate!==s)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Je=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,$e=i.unstable_requestPaint,Xe=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,st=i.unstable_IdlePriority,it=null,rt=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var s=0,i=e.suspendedLanes,r=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?s=ut(a):0!==(r&=o)&&(s=ut(r))}else 0!==(o=n&~i)?s=ut(o):0!==r&&(s=ut(r));if(0===s)return 0;if(0!==t&&t!==s&&0===(t&i)&&((i=s&-s)>=(r=t&-t)||16===i&&0!==(4194240&r)))return t;if(0!==(4&s)&&(s|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=s;0<t;)i=1<<(n=31-ot(t)),s|=e[n],t&=~i;return s}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-ot(n),i=1<<s;i&t|e[s]&t&&(e[s]|=t),n&=~i}}var yt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,xt,Et,St,At,Ct=!1,kt=[],Tt=null,Nt=null,It=null,Pt=new Map,Rt=new Map,Mt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function jt(e,t,n,s,i,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&xt(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=bi(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void At(e.priority,function(){Et(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&xt(t),e.blockedOn=n,!1;var s=new(n=e.nativeEvent).constructor(n.type,n);_e=s,n.target.dispatchEvent(s),_e=null,t.shift()}return!0}function Ut(e,t,n){Lt(e)&&n.delete(t)}function Bt(){Ct=!1,null!==Tt&&Lt(Tt)&&(Tt=null),null!==Nt&&Lt(Nt)&&(Nt=null),null!==It&&Lt(It)&&(It=null),Pt.forEach(Ut),Rt.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function Wt(e){function t(t){return Vt(t,e)}if(0<kt.length){Vt(kt[0],e);for(var n=1;n<kt.length;n++){var s=kt[n];s.blockedOn===e&&(s.blockedOn=null)}}for(null!==Tt&&Vt(Tt,e),null!==Nt&&Vt(Nt,e),null!==It&&Vt(It,e),Pt.forEach(t),Rt.forEach(t),n=0;n<Mt.length;n++)(s=Mt[n]).blockedOn===e&&(s.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Mt.shift()}var Ht=_.ReactCurrentBatchConfig,qt=!0;function zt(e,t,n,s){var i=yt,r=Ht.transition;Ht.transition=null;try{yt=1,Kt(e,t,n,s)}finally{yt=i,Ht.transition=r}}function Gt(e,t,n,s){var i=yt,r=Ht.transition;Ht.transition=null;try{yt=4,Kt(e,t,n,s)}finally{yt=i,Ht.transition=r}}function Kt(e,t,n,s){if(qt){var i=Yt(e,t,n,s);if(null===i)qs(e,t,s,Jt,n),Dt(e,s);else if(function(e,t,n,s,i){switch(t){case"focusin":return Tt=jt(Tt,e,t,n,s,i),!0;case"dragenter":return Nt=jt(Nt,e,t,n,s,i),!0;case"mouseover":return It=jt(It,e,t,n,s,i),!0;case"pointerover":var r=i.pointerId;return Pt.set(r,jt(Pt.get(r)||null,e,t,n,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Rt.set(r,jt(Rt.get(r)||null,e,t,n,s,i)),!0}return!1}(i,e,t,n,s))s.stopPropagation();else if(Dt(e,s),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var r=yi(i);if(null!==r&&wt(r),null===(r=Yt(e,t,n,s))&&qs(e,t,s,Jt,n),r===i)break;i=r}null!==i&&s.stopPropagation()}else qs(e,t,s,null,n)}}var Jt=null;function Yt(e,t,n,s){if(Jt=null,null!==(e=bi(e=we(s))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case st:return 536870912;default:return 16}default:return 16}}var Xt=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,s=n.length,i="value"in Xt?Xt.value:Xt.textContent,r=i.length;for(e=0;e<s&&n[e]===i[e];e++);var o=s-e;for(t=1;t<=o&&n[s-t]===i[r-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function sn(){return!1}function rn(e){function t(t,n,s,i,r){for(var o in this._reactName=t,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:sn,this.isPropagationStopped=sn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=F({},cn,{view:0,detail:0}),hn=rn(un),pn=F({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=rn(pn),mn=rn(F({},pn,{dataTransfer:0})),gn=rn(F({},un,{relatedTarget:0})),vn=rn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=rn(bn),_n=rn(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function An(){return Sn}var Cn=F({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=rn(Cn),Tn=rn(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=rn(F({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),In=rn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=F({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=rn(Pn),Mn=[9,13,27,32],On=d&&"CompositionEvent"in window,Dn=null;d&&"documentMode"in document&&(Dn=document.documentMode);var jn=d&&"TextEvent"in window&&!Dn,Fn=d&&(!On||Dn&&8<Dn&&11>=Dn),Ln=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function zn(e,t,n,s){Ce(s),0<(t=Gs(t,"onChange")).length&&(n=new dn("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Jn(e){Ls(e,0)}function Yn(e){if(K(_i(e)))return e}function $n(e,t){if("change"===e)return t}var Xn=!1;if(d){var Qn;if(d){var Zn="oninput"in document;if(!Zn){var es=document.createElement("div");es.setAttribute("oninput","return;"),Zn="function"===typeof es.oninput}Qn=Zn}else Qn=!1;Xn=Qn&&(!document.documentMode||9<document.documentMode)}function ts(){Gn&&(Gn.detachEvent("onpropertychange",ns),Kn=Gn=null)}function ns(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];zn(t,Kn,e,we(e)),Pe(Jn,t)}}function ss(e,t,n){"focusin"===e?(ts(),Kn=n,(Gn=t).attachEvent("onpropertychange",ns)):"focusout"===e&&ts()}function is(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function rs(e,t){if("click"===e)return Yn(t)}function os(e,t){if("input"===e||"change"===e)return Yn(t)}var as="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ls(e,t){if(as(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!u.call(t,i)||!as(e[i],t[i]))return!1}return!0}function cs(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ds(e,t){var n,s=cs(e);for(e=0;s;){if(3===s.nodeType){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=cs(s)}}function us(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?us(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hs(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(s){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function ps(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fs(e){var t=hs(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&us(n.ownerDocument.documentElement,n)){if(null!==s&&ps(n))if(t=s.start,void 0===(e=s.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,r=Math.min(s.start,i);s=void 0===s.end?r:Math.min(s.end,i),!e.extend&&r>s&&(i=s,s=r,r=i),i=ds(n,r);var o=ds(n,s);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),r>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ms=d&&"documentMode"in document&&11>=document.documentMode,gs=null,vs=null,bs=null,ys=!1;function _s(e,t,n){var s=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ys||null==gs||gs!==J(s)||("selectionStart"in(s=gs)&&ps(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},bs&&ls(bs,s)||(bs=s,0<(s=Gs(vs,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=gs)))}function ws(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xs={animationend:ws("Animation","AnimationEnd"),animationiteration:ws("Animation","AnimationIteration"),animationstart:ws("Animation","AnimationStart"),transitionend:ws("Transition","TransitionEnd")},Es={},Ss={};function As(e){if(Es[e])return Es[e];if(!xs[e])return e;var t,n=xs[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ss)return Es[e]=n[t];return e}d&&(Ss=document.createElement("div").style,"AnimationEvent"in window||(delete xs.animationend.animation,delete xs.animationiteration.animation,delete xs.animationstart.animation),"TransitionEvent"in window||delete xs.transitionend.transition);var Cs=As("animationend"),ks=As("animationiteration"),Ts=As("animationstart"),Ns=As("transitionend"),Is=new Map,Ps="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rs(e,t){Is.set(e,t),l(t,[e])}for(var Ms=0;Ms<Ps.length;Ms++){var Os=Ps[Ms];Rs(Os.toLowerCase(),"on"+(Os[0].toUpperCase()+Os.slice(1)))}Rs(Cs,"onAnimationEnd"),Rs(ks,"onAnimationIteration"),Rs(Ts,"onAnimationStart"),Rs("dblclick","onDoubleClick"),Rs("focusin","onFocus"),Rs("focusout","onBlur"),Rs(Ns,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ds="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),js=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ds));function Fs(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,s,i,o,a,l,c){if(Ve.apply(this,arguments),je){if(!je)throw Error(r(198));var d=Fe;je=!1,Fe=null,Le||(Le=!0,Ue=d)}}(s,t,void 0,e),e.currentTarget=null}function Ls(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var s=e[n],i=s.event;s=s.listeners;e:{var r=void 0;if(t)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&i.isPropagationStopped())break e;Fs(i,a,c),r=l}else for(o=0;o<s.length;o++){if(l=(a=s[o]).instance,c=a.currentTarget,a=a.listener,l!==r&&i.isPropagationStopped())break e;Fs(i,a,c),r=l}}}if(Le)throw e=Ue,Le=!1,Ue=null,e}function Us(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var s=e+"__bubble";n.has(s)||(Hs(t,e,2,!1),n.add(s))}function Bs(e,t,n){var s=0;t&&(s|=4),Hs(n,e,s,t)}var Vs="_reactListening"+Math.random().toString(36).slice(2);function Ws(e){if(!e[Vs]){e[Vs]=!0,o.forEach(function(t){"selectionchange"!==t&&(js.has(t)||Bs(t,!1,e),Bs(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vs]||(t[Vs]=!0,Bs("selectionchange",!1,t))}}function Hs(e,t,n,s){switch($t(t)){case 1:var i=zt;break;case 4:i=Gt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),s?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qs(e,t,n,s,i){var r=s;if(0===(1&t)&&0===(2&t)&&null!==s)e:for(;;){if(null===s)return;var o=s.tag;if(3===o||4===o){var a=s.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=s.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=bi(a)))return;if(5===(l=o.tag)||6===l){s=r=o;continue e}a=a.parentNode}}s=s.return}Pe(function(){var s=r,i=we(n),o=[];e:{var a=Is.get(e);if(void 0!==a){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case Cs:case ks:case Ts:l=vn;break;case Ns:l=In;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==a?a+"Capture":null:a;d=[];for(var p,f=s;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Re(f,h))&&d.push(zs(f,m,p)))),u)break;f=f.return}0<d.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!bi(c)&&!c[fi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=s,null!==(c=(c=n.relatedTarget||n.toElement)?bi(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=s),l!==c)){if(d=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Tn,m="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==l?a:_i(l),p=null==c?a:_i(c),(a=new d(m,f+"leave",l,n,i)).target=u,a.relatedTarget=p,m=null,bi(i)===s&&((d=new d(h,f+"enter",c,n,i)).target=p,d.relatedTarget=u,m=d),u=m,l&&c)e:{for(h=c,f=0,p=d=l;p;p=Ks(p))f++;for(p=0,m=h;m;m=Ks(m))p++;for(;0<f-p;)d=Ks(d),f--;for(;0<p-f;)h=Ks(h),p--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=Ks(d),h=Ks(h)}d=null}else d=null;null!==l&&Js(o,a,l,d,!1),null!==c&&null!==u&&Js(o,u,c,d,!0)}if("select"===(l=(a=s?_i(s):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=$n;else if(qn(a))if(Xn)g=os;else{g=is;var v=ss}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=rs);switch(g&&(g=g(e,s))?zn(o,g,n,i):(v&&v(e,a,s),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=s?_i(s):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gs=v,vs=s,bs=null);break;case"focusout":bs=vs=gs=null;break;case"mousedown":ys=!0;break;case"contextmenu":case"mouseup":case"dragend":ys=!1,_s(o,n,i);break;case"selectionchange":if(ms)break;case"keydown":case"keyup":_s(o,n,i)}var b;if(On)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Wn?Bn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Fn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Wn&&(b=en()):(Qt="value"in(Xt=i)?Xt.value:Xt.textContent,Wn=!0)),0<(v=Gs(s,y)).length&&(y=new _n(y,e,null,n,i),o.push({event:y,listeners:v}),b?y.data=b:null!==(b=Vn(n))&&(y.data=b))),(b=jn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Un=!0,Ln);case"textInput":return(e=t.data)===Ln&&Un?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!On&&Bn(e,t)?(e=en(),Zt=Qt=Xt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(s=Gs(s,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:s}),i.data=b))}Ls(o,t)})}function zs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gs(e,t){for(var n=t+"Capture",s=[];null!==e;){var i=e,r=i.stateNode;5===i.tag&&null!==r&&(i=r,null!=(r=Re(e,n))&&s.unshift(zs(e,r,i)),null!=(r=Re(e,t))&&s.push(zs(e,r,i))),e=e.return}return s}function Ks(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Js(e,t,n,s,i){for(var r=t._reactName,o=[];null!==n&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===s)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Re(n,r))&&o.unshift(zs(n,l,a)):i||null!=(l=Re(n,r))&&o.push(zs(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Ys=/\r\n?/g,$s=/\u0000|\uFFFD/g;function Xs(e){return("string"===typeof e?e:""+e).replace(Ys,"\n").replace($s,"")}function Qs(e,t,n){if(t=Xs(t),Xs(e)!==t&&n)throw Error(r(425))}function Zs(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var si="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ri="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ri?function(e){return ri.resolve(null).then(e).catch(ai)}:si;function ai(e){setTimeout(function(){throw e})}function li(e,t){var n=t,s=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===s)return e.removeChild(i),void Wt(t);s--}else"$"!==n&&"$?"!==n&&"$!"!==n||s++;n=i}while(n);Wt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),hi="__reactFiber$"+ui,pi="__reactProps$"+ui,fi="__reactContainer$"+ui,mi="__reactEvents$"+ui,gi="__reactListeners$"+ui,vi="__reactHandles$"+ui;function bi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=di(e);null!==e;){if(n=e[hi])return n;e=di(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[hi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function wi(e){return e[pi]||null}var xi=[],Ei=-1;function Si(e){return{current:e}}function Ai(e){0>Ei||(e.current=xi[Ei],xi[Ei]=null,Ei--)}function Ci(e,t){Ei++,xi[Ei]=e.current,e.current=t}var ki={},Ti=Si(ki),Ni=Si(!1),Ii=ki;function Pi(e,t){var n=e.type.contextTypes;if(!n)return ki;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var i,r={};for(i in n)r[i]=t[i];return s&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mi(){Ai(Ni),Ai(Ti)}function Oi(e,t,n){if(Ti.current!==ki)throw Error(r(168));Ci(Ti,t),Ci(Ni,n)}function Di(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,"function"!==typeof s.getChildContext)return n;for(var i in s=s.getChildContext())if(!(i in t))throw Error(r(108,H(e)||"Unknown",i));return F({},n,s)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Ii=Ti.current,Ci(Ti,e),Ci(Ni,Ni.current),!0}function Fi(e,t,n){var s=e.stateNode;if(!s)throw Error(r(169));n?(e=Di(e,t,Ii),s.__reactInternalMemoizedMergedChildContext=e,Ai(Ni),Ai(Ti),Ci(Ti,e)):Ai(Ni),Ci(Ni,n)}var Li=null,Ui=!1,Bi=!1;function Vi(e){null===Li?Li=[e]:Li.push(e)}function Wi(){if(!Bi&&null!==Li){Bi=!0;var e=0,t=yt;try{var n=Li;for(yt=1;e<n.length;e++){var s=n[e];do{s=s(!0)}while(null!==s)}Li=null,Ui=!1}catch(i){throw null!==Li&&(Li=Li.slice(e+1)),Ke(Ze,Wi),i}finally{yt=t,Bi=!1}}return null}var Hi=[],qi=0,zi=null,Gi=0,Ki=[],Ji=0,Yi=null,$i=1,Xi="";function Qi(e,t){Hi[qi++]=Gi,Hi[qi++]=zi,zi=e,Gi=t}function Zi(e,t,n){Ki[Ji++]=$i,Ki[Ji++]=Xi,Ki[Ji++]=Yi,Yi=e;var s=$i;e=Xi;var i=32-ot(s)-1;s&=~(1<<i),n+=1;var r=32-ot(t)+i;if(30<r){var o=i-i%5;r=(s&(1<<o)-1).toString(32),s>>=o,i-=o,$i=1<<32-ot(t)+i|n<<i|s,Xi=r+e}else $i=1<<r|n<<i|s,Xi=e}function er(e){null!==e.return&&(Qi(e,1),Zi(e,1,0))}function tr(e){for(;e===zi;)zi=Hi[--qi],Hi[qi]=null,Gi=Hi[--qi],Hi[qi]=null;for(;e===Yi;)Yi=Ki[--Ji],Ki[Ji]=null,Xi=Ki[--Ji],Ki[Ji]=null,$i=Ki[--Ji],Ki[Ji]=null}var nr=null,sr=null,ir=!1,rr=null;function or(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ar(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,sr=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,sr=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:$i,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,nr=e,sr=null,!0);default:return!1}}function lr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(ir){var t=sr;if(t){var n=t;if(!ar(e,t)){if(lr(e))throw Error(r(418));t=ci(n.nextSibling);var s=nr;t&&ar(e,t)?or(s,n):(e.flags=-4097&e.flags|2,ir=!1,nr=e)}}else{if(lr(e))throw Error(r(418));e.flags=-4097&e.flags|2,ir=!1,nr=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function ur(e){if(e!==nr)return!1;if(!ir)return dr(e),ir=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=sr)){if(lr(e))throw hr(),Error(r(418));for(;t;)or(e,t),t=ci(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){sr=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}sr=null}}else sr=nr?ci(e.stateNode.nextSibling):null;return!0}function hr(){for(var e=sr;e;)e=ci(e.nextSibling)}function pr(){sr=nr=null,ir=!1}function fr(e){null===rr?rr=[e]:rr.push(e)}var mr=_.ReactCurrentBatchConfig;function gr(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var s=n.stateNode}if(!s)throw Error(r(147,e));var i=s,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function br(e){return(0,e._init)(e._payload)}function yr(e){function t(t,n){if(e){var s=t.deletions;null===s?(t.deletions=[n],t.flags|=16):s.push(n)}}function n(n,s){if(!e)return null;for(;null!==s;)t(n,s),s=s.sibling;return null}function s(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function o(t,n,s){return t.index=s,e?null!==(s=t.alternate)?(s=s.index)<n?(t.flags|=2,n):s:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,s){return null===t||6!==t.tag?((t=jc(n,e.mode,s)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,s){var r=n.type;return r===E?u(e,t,n.props.children,s,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===R&&br(r)===t.type)?((s=i(t,n.props)).ref=gr(e,t,n),s.return=e,s):((s=Mc(n.type,n.key,n.props,null,e.mode,s)).ref=gr(e,t,n),s.return=e,s)}function d(e,t,n,s){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,s)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function u(e,t,n,s,r){return null===t||7!==t.tag?((t=Oc(n,e.mode,s,r)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=gr(e,null,t),n.return=e,n;case x:return(t=Fc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Oc(t,e.mode,n,null)).return=e,t;vr(e,t)}return null}function p(e,t,n,s){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,s):null;case x:return n.key===i?d(e,t,n,s):null;case R:return p(e,t,(i=n._init)(n._payload),s)}if(te(n)||D(n))return null!==i?null:u(e,t,n,s,null);vr(e,n)}return null}function f(e,t,n,s,i){if("string"===typeof s&&""!==s||"number"===typeof s)return l(t,e=e.get(n)||null,""+s,i);if("object"===typeof s&&null!==s){switch(s.$$typeof){case w:return c(t,e=e.get(null===s.key?n:s.key)||null,s,i);case x:return d(t,e=e.get(null===s.key?n:s.key)||null,s,i);case R:return f(e,t,n,(0,s._init)(s._payload),i)}if(te(s)||D(s))return u(t,e=e.get(n)||null,s,i,null);vr(t,s)}return null}function m(i,r,a,l){for(var c=null,d=null,u=r,m=r=0,g=null;null!==u&&m<a.length;m++){u.index>m?(g=u,u=null):g=u.sibling;var v=p(i,u,a[m],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(i,u),r=o(v,r,m),null===d?c=v:d.sibling=v,d=v,u=g}if(m===a.length)return n(i,u),ir&&Qi(i,m),c;if(null===u){for(;m<a.length;m++)null!==(u=h(i,a[m],l))&&(r=o(u,r,m),null===d?c=u:d.sibling=u,d=u);return ir&&Qi(i,m),c}for(u=s(i,u);m<a.length;m++)null!==(g=f(u,i,m,a[m],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?m:g.key),r=o(g,r,m),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(i,e)}),ir&&Qi(i,m),c}function g(i,a,l,c){var d=D(l);if("function"!==typeof d)throw Error(r(150));if(null==(l=d.call(l)))throw Error(r(151));for(var u=d=null,m=a,g=a=0,v=null,b=l.next();null!==m&&!b.done;g++,b=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var y=p(i,m,b.value,c);if(null===y){null===m&&(m=v);break}e&&m&&null===y.alternate&&t(i,m),a=o(y,a,g),null===u?d=y:u.sibling=y,u=y,m=v}if(b.done)return n(i,m),ir&&Qi(i,g),d;if(null===m){for(;!b.done;g++,b=l.next())null!==(b=h(i,b.value,c))&&(a=o(b,a,g),null===u?d=b:u.sibling=b,u=b);return ir&&Qi(i,g),d}for(m=s(i,m);!b.done;g++,b=l.next())null!==(b=f(m,i,g,b.value,c))&&(e&&null!==b.alternate&&m.delete(null===b.key?g:b.key),a=o(b,a,g),null===u?d=b:u.sibling=b,u=b);return e&&m.forEach(function(e){return t(i,e)}),ir&&Qi(i,g),d}return function e(s,r,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,d=r;null!==d;){if(d.key===c){if((c=o.type)===E){if(7===d.tag){n(s,d.sibling),(r=i(d,o.props.children)).return=s,s=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&br(c)===d.type){n(s,d.sibling),(r=i(d,o.props)).ref=gr(s,d,o),r.return=s,s=r;break e}n(s,d);break}t(s,d),d=d.sibling}o.type===E?((r=Oc(o.props.children,s.mode,l,o.key)).return=s,s=r):((l=Mc(o.type,o.key,o.props,null,s.mode,l)).ref=gr(s,r,o),l.return=s,s=l)}return a(s);case x:e:{for(d=o.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(s,r.sibling),(r=i(r,o.children||[])).return=s,s=r;break e}n(s,r);break}t(s,r),r=r.sibling}(r=Fc(o,s.mode,l)).return=s,s=r}return a(s);case R:return e(s,r,(d=o._init)(o._payload),l)}if(te(o))return m(s,r,o,l);if(D(o))return g(s,r,o,l);vr(s,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==r&&6===r.tag?(n(s,r.sibling),(r=i(r,o)).return=s,s=r):(n(s,r),(r=jc(o,s.mode,l)).return=s,s=r),a(s)):n(s,r)}}var _r=yr(!0),wr=yr(!1),xr=Si(null),Er=null,Sr=null,Ar=null;function Cr(){Ar=Sr=Er=null}function kr(e){var t=xr.current;Ai(xr),e._currentValue=t}function Tr(e,t,n){for(;null!==e;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==s&&(s.childLanes|=t)):null!==s&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Nr(e,t){Er=e,Ar=Sr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function Ir(e){var t=e._currentValue;if(Ar!==e)if(e={context:e,memoizedValue:t,next:null},null===Sr){if(null===Er)throw Error(r(308));Sr=e,Er.dependencies={lanes:0,firstContext:e}}else Sr=Sr.next=e;return t}var Pr=null;function Rr(e){null===Pr?Pr=[e]:Pr.push(e)}function Mr(e,t,n,s){var i=t.interleaved;return null===i?(n.next=n,Rr(t)):(n.next=i.next,i.next=n),t.interleaved=n,Or(e,s)}function Or(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Dr=!1;function jr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ur(e,t,n){var s=e.updateQueue;if(null===s)return null;if(s=s.shared,0!==(2&kl)){var i=s.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),s.pending=t,Or(e,n)}return null===(i=s.interleaved)?(t.next=t,Rr(s)):(t.next=i.next,i.next=t),s.interleaved=t,Or(e,n)}function Br(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Vr(e,t){var n=e.updateQueue,s=e.alternate;if(null!==s&&n===(s=s.updateQueue)){var i=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?i=r=o:r=r.next=o,n=n.next}while(null!==n);null===r?i=r=t:r=r.next=t}else i=r=t;return n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wr(e,t,n,s){var i=e.updateQueue;Dr=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?r=c:o.next=c,o=l;var d=e.alternate;null!==d&&((a=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===a?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(null!==r){var u=i.baseState;for(o=0,d=c=l=null,a=r;;){var h=a.lane,p=a.eventTime;if((s&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){u=f.call(p,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,u,h):f)||void 0===h)break e;u=F({},u,h);break e;case 2:Dr=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,o|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===d&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===r&&(i.shared.lanes=0);Dl|=o,e.lanes=o,e.memoizedState=u}}function Hr(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var s=e[t],i=s.callback;if(null!==i){if(s.callback=null,s=n,"function"!==typeof i)throw Error(r(191,i));i.call(s)}}}var qr={},zr=Si(qr),Gr=Si(qr),Kr=Si(qr);function Jr(e){if(e===qr)throw Error(r(174));return e}function Yr(e,t){switch(Ci(Kr,t),Ci(Gr,e),Ci(zr,qr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ai(zr),Ci(zr,t)}function $r(){Ai(zr),Ai(Gr),Ai(Kr)}function Xr(e){Jr(Kr.current);var t=Jr(zr.current),n=le(t,e.type);t!==n&&(Ci(Gr,e),Ci(zr,n))}function Qr(e){Gr.current===e&&(Ai(zr),Ai(Gr))}var Zr=Si(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var so=_.ReactCurrentDispatcher,io=_.ReactCurrentBatchConfig,ro=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,po=0;function fo(){throw Error(r(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!as(e[n],t[n]))return!1;return!0}function go(e,t,n,s,i,o){if(ro=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?Zo:ea,e=n(s,i),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(r(301));o+=1,lo=ao=null,t.updateQueue=null,so.current=ta,e=n(s,i)}while(uo)}if(so.current=Qo,t=null!==ao&&null!==ao.next,ro=0,lo=ao=oo=null,co=!1,t)throw Error(r(300));return e}function vo(){var e=0!==ho;return ho=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function yo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(r(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function _o(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=yo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var s=ao,i=s.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}s.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,s=s.baseState;var l=a=null,c=null,d=o;do{var u=d.lane;if((ro&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:e(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,a=s):c=c.next=h,oo.lanes|=u,Dl|=u}d=d.next}while(null!==d&&d!==o);null===c?a=s:c.next=l,as(s,t.memoizedState)||(ya=!0),t.memoizedState=s,t.baseState=a,t.baseQueue=c,n.lastRenderedState=s}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,Dl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xo(e){var t=yo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var s=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);as(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,s]}function Eo(){}function So(e,t){var n=oo,s=yo(),i=t(),o=!as(s.memoizedState,i);if(o&&(s.memoizedState=i,ya=!0),s=s.queue,jo(ko.bind(null,n,s,e),[e]),s.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Po(9,Co.bind(null,n,s,i,t),void 0,null),null===Tl)throw Error(r(349));0!==(30&ro)||Ao(n,t,i)}return i}function Ao(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Co(e,t,n,s){t.value=n,t.getSnapshot=s,To(t)&&No(e)}function ko(e,t,n){return n(function(){To(t)&&No(e)})}function To(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!as(e,n)}catch(s){return!0}}function No(e){var t=Or(e,1);null!==t&&tc(t,e,1,-1)}function Io(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_o,lastRenderedState:e},t.queue=e,e=e.dispatch=Jo.bind(null,oo,e),[t.memoizedState,e]}function Po(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function Ro(){return yo().memoizedState}function Mo(e,t,n,s){var i=bo();oo.flags|=e,i.memoizedState=Po(1|t,n,void 0,void 0===s?null:s)}function Oo(e,t,n,s){var i=yo();s=void 0===s?null:s;var r=void 0;if(null!==ao){var o=ao.memoizedState;if(r=o.destroy,null!==s&&mo(s,o.deps))return void(i.memoizedState=Po(t,n,r,s))}oo.flags|=e,i.memoizedState=Po(1|t,n,r,s)}function Do(e,t){return Mo(8390656,8,e,t)}function jo(e,t){return Oo(2048,8,e,t)}function Fo(e,t){return Oo(4,2,e,t)}function Lo(e,t){return Oo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Uo.bind(null,t,e),n)}function Vo(){}function Wo(e,t){var n=yo();t=void 0===t?null:t;var s=n.memoizedState;return null!==s&&null!==t&&mo(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Ho(e,t){var n=yo();t=void 0===t?null:t;var s=n.memoizedState;return null!==s&&null!==t&&mo(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&ro)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(as(n,t)||(n=mt(),oo.lanes|=n,Dl|=n,e.baseState=!0),t)}function zo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var s=io.transition;io.transition={};try{e(!1),t()}finally{yt=n,io.transition=s}}function Go(){return yo().memoizedState}function Ko(e,t,n){var s=ec(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(e))$o(t,n);else if(null!==(n=Mr(e,t,n,s))){tc(n,e,s,Zl()),Xo(n,t,s)}}function Jo(e,t,n){var s=ec(e),i={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))$o(t,i);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=r(o,n);if(i.hasEagerState=!0,i.eagerState=a,as(a,o)){var l=t.interleaved;return null===l?(i.next=i,Rr(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Mr(e,t,i,s))&&(tc(n,e,s,i=Zl()),Xo(n,t,s))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function $o(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xo(e,t,n){if(0!==(4194240&n)){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Qo={readContext:Ir,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Zo={readContext:Ir,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Ir,useEffect:Do,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Mo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mo(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=bo();return t=void 0!==n?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[s.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:Io,useDebugValue:Vo,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=Io(!1),t=e[0];return e=zo.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=oo,i=bo();if(ir){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===Tl)throw Error(r(349));0!==(30&ro)||Ao(s,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Do(ko.bind(null,s,o,e),[e]),s.flags|=2048,Po(9,Co.bind(null,s,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=Tl.identifierPrefix;if(ir){var n=Xi;t=":"+t+"R"+(n=($i&~(1<<32-ot($i)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Ir,useCallback:Wo,useContext:Ir,useEffect:jo,useImperativeHandle:Bo,useInsertionEffect:Fo,useLayoutEffect:Lo,useMemo:Ho,useReducer:wo,useRef:Ro,useState:function(){return wo(_o)},useDebugValue:Vo,useDeferredValue:function(e){return qo(yo(),ao.memoizedState,e)},useTransition:function(){return[wo(_o)[0],yo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:So,useId:Go,unstable_isNewReconciler:!1},ta={readContext:Ir,useCallback:Wo,useContext:Ir,useEffect:jo,useImperativeHandle:Bo,useInsertionEffect:Fo,useLayoutEffect:Lo,useMemo:Ho,useReducer:xo,useRef:Ro,useState:function(){return xo(_o)},useDebugValue:Vo,useDeferredValue:function(e){var t=yo();return null===ao?t.memoizedState=e:qo(t,ao.memoizedState,e)},useTransition:function(){return[xo(_o)[0],yo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:So,useId:Go,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function sa(e,t,n,s){n=null===(n=n(s,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Zl(),i=ec(e),r=Lr(s,i);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Ur(e,r,i))&&(tc(t,e,i,s),Br(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Zl(),i=ec(e),r=Lr(s,i);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Ur(e,r,i))&&(tc(t,e,i,s),Br(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zl(),s=ec(e),i=Lr(n,s);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ur(e,i,s))&&(tc(t,e,s,n),Br(t,e,s))}};function ra(e,t,n,s,i,r,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(s,r,o):!t.prototype||!t.prototype.isPureReactComponent||(!ls(n,s)||!ls(i,r))}function oa(e,t,n){var s=!1,i=ki,r=t.contextType;return"object"===typeof r&&null!==r?r=Ir(r):(i=Ri(t)?Ii:Ti.current,r=(s=null!==(s=t.contextTypes)&&void 0!==s)?Pi(e,i):ki),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,s&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=r),t}function aa(e,t,n,s){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,s),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,s){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},jr(e);var r=t.contextType;"object"===typeof r&&null!==r?i.context=Ir(r):(r=Ri(t)?Ii:Ti.current,i.context=Pi(e,r)),i.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(sa(e,t,r,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),Wr(e,n,i,s),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",s=t;do{n+=V(s),s=s.return}while(s);var i=n}catch(r){i="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:i,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ua(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ha="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Lr(-1,n)).tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Hl||(Hl=!0,ql=s),ua(0,t)},n}function fa(e,t,n){(n=Lr(-1,n)).tag=3;var s=e.type.getDerivedStateFromError;if("function"===typeof s){var i=t.value;n.payload=function(){return s(i)},n.callback=function(){ua(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){ua(0,t),"function"!==typeof s&&(null===zl?zl=new Set([this]):zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var s=e.pingCache;if(null===s){s=e.pingCache=new ha;var i=new Set;s.set(t,i)}else void 0===(i=s.get(t))&&(i=new Set,s.set(t,i));i.has(n)||(i.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,s,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Lr(-1,1)).tag=2,Ur(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ba=_.ReactCurrentOwner,ya=!1;function _a(e,t,n,s){t.child=null===e?wr(t,null,n,s):_r(t,e.child,n,s)}function wa(e,t,n,s,i){n=n.render;var r=t.ref;return Nr(t,i),s=go(e,t,n,s,r,i),n=vo(),null===e||ya?(ir&&n&&er(t),t.flags|=1,_a(e,t,s,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function xa(e,t,n,s,i){if(null===e){var r=n.type;return"function"!==typeof r||Pc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,s,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Ea(e,t,r,s,i))}if(r=e.child,0===(e.lanes&i)){var o=r.memoizedProps;if((n=null!==(n=n.compare)?n:ls)(o,s)&&e.ref===t.ref)return Ha(e,t,i)}return t.flags|=1,(e=Rc(r,s)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,s,i){if(null!==e){var r=e.memoizedProps;if(ls(r,s)&&e.ref===t.ref){if(ya=!1,t.pendingProps=s=r,0===(e.lanes&i))return t.lanes=e.lanes,Ha(e,t,i);0!==(131072&e.flags)&&(ya=!0)}}return Ca(e,t,n,s,i)}function Sa(e,t,n){var s=t.pendingProps,i=s.children,r=null!==e?e.memoizedState:null;if("hidden"===s.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Rl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Rl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=null!==r?r.baseLanes:n,Ci(Rl,Pl),Pl|=s}else null!==r?(s=r.baseLanes|n,t.memoizedState=null):s=n,Ci(Rl,Pl),Pl|=s;return _a(e,t,i,n),t.child}function Aa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ca(e,t,n,s,i){var r=Ri(n)?Ii:Ti.current;return r=Pi(t,r),Nr(t,i),n=go(e,t,n,s,r,i),s=vo(),null===e||ya?(ir&&s&&er(t),t.flags|=1,_a(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function ka(e,t,n,s,i){if(Ri(n)){var r=!0;ji(t)}else r=!1;if(Nr(t,i),null===t.stateNode)Wa(e,t),oa(t,n,s),la(t,n,s,i),s=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ir(c):c=Pi(t,c=Ri(n)?Ii:Ti.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==s||l!==c)&&aa(t,o,s,c),Dr=!1;var h=t.memoizedState;o.state=h,Wr(t,s,o,i),l=t.memoizedState,a!==s||h!==l||Ni.current||Dr?("function"===typeof d&&(sa(t,n,d,s),l=t.memoizedState),(a=Dr||ra(t,n,a,s,h,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,Fr(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,u=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ir(l):l=Pi(t,l=Ri(n)?Ii:Ti.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==u||h!==l)&&aa(t,o,s,l),Dr=!1,h=t.memoizedState,o.state=h,Wr(t,s,o,i);var f=t.memoizedState;a!==u||h!==f||Ni.current||Dr?("function"===typeof p&&(sa(t,n,p,s),f=t.memoizedState),(c=Dr||ra(t,n,c,s,h,f,l)||!1)?(d||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(s,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(s,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=f),o.props=s,o.state=f,o.context=l,s=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return Ta(e,t,n,s,r,i)}function Ta(e,t,n,s,i,r){Aa(e,t);var o=0!==(128&t.flags);if(!s&&!o)return i&&Fi(t,n,!1),Ha(e,t,r);s=t.stateNode,ba.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:s.render();return t.flags|=1,null!==e&&o?(t.child=_r(t,e.child,null,r),t.child=_r(t,null,a,r)):_a(e,t,a,r),t.memoizedState=s.state,i&&Fi(t,n,!0),t.child}function Na(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Yr(e,t.containerInfo)}function Ia(e,t,n,s,i){return pr(),fr(i),t.flags|=256,_a(e,t,n,s),t.child}var Pa,Ra,Ma,Oa={dehydrated:null,treeContext:null,retryLane:0};function Da(e){return{baseLanes:e,cachePool:null,transitions:null}}function ja(e,t,n){var s,i=t.pendingProps,o=Zr.current,a=!1,l=0!==(128&t.flags);if((s=l)||(s=(null===e||null!==e.memoizedState)&&0!==(2&o)),s?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ci(Zr,1&o),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Dc(l,i,0,null),e=Oc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Da(n),t.memoizedState=Oa,e):Fa(t,l));if(null!==(o=e.memoizedState)&&null!==(s=o.dehydrated))return function(e,t,n,s,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,La(e,t,a,s=da(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=s.fallback,i=t.mode,s=Dc({mode:"visible",children:s.children},i,0,null),(o=Oc(o,i,a,null)).flags|=2,s.return=t,o.return=t,s.sibling=o,t.child=s,0!==(1&t.mode)&&_r(t,e.child,null,a),t.child.memoizedState=Da(a),t.memoizedState=Oa,o);if(0===(1&t.mode))return La(e,t,a,null);if("$!"===i.data){if(s=i.nextSibling&&i.nextSibling.dataset)var l=s.dgst;return s=l,La(e,t,a,s=da(o=Error(r(419)),s,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(s=Tl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(s.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Or(e,i),tc(s,e,i,-1))}return fc(),La(e,t,a,s=da(Error(r(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,sr=ci(i.nextSibling),nr=t,ir=!0,rr=null,null!==e&&(Ki[Ji++]=$i,Ki[Ji++]=Xi,Ki[Ji++]=Yi,$i=e.id,Xi=e.overflow,Yi=t),t=Fa(t,s.children),t.flags|=4096,t)}(e,t,l,i,s,o,n);if(a){a=i.fallback,l=t.mode,s=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Rc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==s?a=Rc(s,a):(a=Oc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Da(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Oa,i}return e=(a=e.child).sibling,i=Rc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fa(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function La(e,t,n,s){return null!==s&&fr(s),_r(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var s=e.alternate;null!==s&&(s.lanes|=t),Tr(e.return,t,n)}function Ba(e,t,n,s,i){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=n,r.tailMode=i)}function Va(e,t,n){var s=t.pendingProps,i=s.revealOrder,r=s.tail;if(_a(e,t,s.children,n),0!==(2&(s=Zr.current)))s=1&s|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ci(Zr,s),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ba(t,!1,i,n,r);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ba(t,!0,n,null,r);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!ir)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;null!==n;)null!==n.alternate&&(s=n),n=n.sibling;null===s?t||null===e.tail?e.tail=null:e.tail.sibling=null:s.sibling=null}}function za(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,s=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,s|=14680064&i.subtreeFlags,s|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Ga(e,t,n){var s=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return za(t),null;case 1:case 17:return Ri(t.type)&&Mi(),za(t),null;case 3:return s=t.stateNode,$r(),Ai(Ni),Ai(Ti),no(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==e&&null!==e.child||(ur(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(rc(rr),rr=null))),za(t),null;case 5:Qr(t);var i=Jr(Kr.current);if(n=t.type,null!==e&&null!=t.stateNode)Ra(e,t,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(null===t.stateNode)throw Error(r(166));return za(t),null}if(e=Jr(zr.current),ur(t)){s=t.stateNode,n=t.type;var o=t.memoizedProps;switch(s[hi]=t,s[pi]=o,e=0!==(1&t.mode),n){case"dialog":Us("cancel",s),Us("close",s);break;case"iframe":case"object":case"embed":Us("load",s);break;case"video":case"audio":for(i=0;i<Ds.length;i++)Us(Ds[i],s);break;case"source":Us("error",s);break;case"img":case"image":case"link":Us("error",s),Us("load",s);break;case"details":Us("toggle",s);break;case"input":$(s,o),Us("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Us("invalid",s);break;case"textarea":ie(s,o),Us("invalid",s)}for(var l in be(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?s.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qs(s.textContent,c,e),i=["children",c]):"number"===typeof c&&s.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qs(s.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Us("scroll",s)}switch(n){case"input":G(s),Z(s,o,!0);break;case"textarea":G(s),oe(s);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(s.onclick=Zs)}s=i,t.updateQueue=s,null!==s&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof s.is?e=l.createElement(n,{is:s.is}):(e=l.createElement(n),"select"===n&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=s,Pa(e,t),t.stateNode=e;e:{switch(l=ye(n,s),n){case"dialog":Us("cancel",e),Us("close",e),i=s;break;case"iframe":case"object":case"embed":Us("load",e),i=s;break;case"video":case"audio":for(i=0;i<Ds.length;i++)Us(Ds[i],e);i=s;break;case"source":Us("error",e),i=s;break;case"img":case"image":case"link":Us("error",e),Us("load",e),i=s;break;case"details":Us("toggle",e),i=s;break;case"input":$(e,s),i=Y(e,s),Us("invalid",e);break;case"option":default:i=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},i=F({},s,{value:void 0}),Us("invalid",e);break;case"textarea":ie(e,s),i=se(e,s),Us("invalid",e)}for(o in be(n,i),c=i)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?ge(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===o?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Us("scroll",e):null!=d&&y(e,o,d,l))}switch(n){case"input":G(e),Z(e,s,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=s.value&&e.setAttribute("value",""+q(s.value));break;case"select":e.multiple=!!s.multiple,null!=(o=s.value)?ne(e,!!s.multiple,o,!1):null!=s.defaultValue&&ne(e,!!s.multiple,s.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zs)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return za(t),null;case 6:if(e&&null!=t.stateNode)Ma(0,t,e.memoizedProps,s);else{if("string"!==typeof s&&null===t.stateNode)throw Error(r(166));if(n=Jr(Kr.current),Jr(zr.current),ur(t)){if(s=t.stateNode,n=t.memoizedProps,s[hi]=t,(o=s.nodeValue!==n)&&null!==(e=nr))switch(e.tag){case 3:Qs(s.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qs(s.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(s=(9===n.nodeType?n:n.ownerDocument).createTextNode(s))[hi]=t,t.stateNode=s}return za(t),null;case 13:if(Ai(Zr),s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ir&&null!==sr&&0!==(1&t.mode)&&0===(128&t.flags))hr(),pr(),t.flags|=98560,o=!1;else if(o=ur(t),null!==s&&null!==s.dehydrated){if(null===e){if(!o)throw Error(r(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(r(317));o[hi]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;za(t),o=!1}else null!==rr&&(rc(rr),rr=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((s=null!==s)!==(null!==e&&null!==e.memoizedState)&&s&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zr.current)?0===Ml&&(Ml=3):fc())),null!==t.updateQueue&&(t.flags|=4),za(t),null);case 4:return $r(),null===e&&Ws(t.stateNode.containerInfo),za(t),null;case 10:return kr(t.type._context),za(t),null;case 19:if(Ai(Zr),null===(o=t.memoizedState))return za(t),null;if(s=0!==(128&t.flags),null===(l=o.rendering))if(s)qa(o,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,qa(o,!1),null!==(s=l.updateQueue)&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;null!==n;)e=s,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(Zr,1&Zr.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>Vl&&(t.flags|=128,s=!0,qa(o,!1),t.lanes=4194304)}else{if(!s)if(null!==(e=eo(l))){if(t.flags|=128,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ir)return za(t),null}else 2*Xe()-o.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,s=!0,qa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=Zr.current,Ci(Zr,s?1&n|2:1&n),t):(za(t),null);case 22:case 23:return dc(),s=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==s&&(t.flags|=8192),s&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(za(t),6&t.subtreeFlags&&(t.flags|=8192)):za(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Ka(e,t){switch(tr(t),t.tag){case 1:return Ri(t.type)&&Mi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $r(),Ai(Ni),Ai(Ti),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qr(t),null;case 13:if(Ai(Zr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ai(Zr),null;case 4:return $r(),null;case 10:return kr(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Pa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(e,t,n,s){var i=e.memoizedProps;if(i!==s){e=t.stateNode,Jr(zr.current);var r,o=null;switch(n){case"input":i=Y(e,i),s=Y(e,s),o=[];break;case"select":i=F({},i,{value:void 0}),s=F({},s,{value:void 0}),o=[];break;case"textarea":i=se(e,i),s=se(e,s),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof s.onClick&&(e.onclick=Zs)}for(d in be(n,s),n=null,i)if(!s.hasOwnProperty(d)&&i.hasOwnProperty(d)&&null!=i[d])if("style"===d){var l=i[d];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(a.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in s){var c=s[d];if(l=null!=i?i[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(a.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Us("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Ma=function(e,t,n,s){n!==s&&(t.flags|=4)};var Ja=!1,Ya=!1,$a="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Qa(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(s){Ec(e,t,s)}else n.current=null}function Za(e,t,n){try{n()}catch(s){Ec(e,t,s)}}var el=!1;function tl(e,t,n){var s=t.updateQueue;if(null!==(s=null!==s?s.lastEffect:null)){var i=s=s.next;do{if((i.tag&e)===e){var r=i.destroy;i.destroy=void 0,void 0!==r&&Za(t,n,r)}i=i.next}while(i!==s)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function al(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zs));else if(4!==s&&null!==(e=e.child))for(al(e,t,n),e=e.sibling;null!==e;)al(e,t,n),e=e.sibling}function ll(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==s&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,dl=!1;function ul(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ya||Qa(n,t);case 6:var s=cl,i=dl;cl=null,ul(e,t,n),dl=i,null!==(cl=s)&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Wt(e)):li(cl,n.stateNode));break;case 4:s=cl,i=dl,cl=n.stateNode.containerInfo,dl=!0,ul(e,t,n),cl=s,dl=i;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(s=n.updateQueue)&&null!==(s=s.lastEffect))){i=s=s.next;do{var r=i,o=r.destroy;r=r.tag,void 0!==o&&(0!==(2&r)||0!==(4&r))&&Za(n,t,o),i=i.next}while(i!==s)}ul(e,t,n);break;case 1:if(!Ya&&(Qa(n,t),"function"===typeof(s=n.stateNode).componentWillUnmount))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Ec(n,t,a)}ul(e,t,n);break;case 21:ul(e,t,n);break;case 22:1&n.mode?(Ya=(s=Ya)||null!==n.memoizedState,ul(e,t,n),Ya=s):ul(e,t,n);break;default:ul(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $a),t.forEach(function(t){var s=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(s,s))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var s=0;s<n.length;s++){var i=n[s];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===cl)throw Error(r(160));hl(o,a,i),cl=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(d){Ec(i,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),gl(e),4&s){try{tl(3,e,e.return),nl(3,e)}catch(g){Ec(e,e.return,g)}try{tl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:fl(t,e),gl(e),512&s&&null!==n&&Qa(n,n.return);break;case 5:if(fl(t,e),gl(e),512&s&&null!==n&&Qa(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Ec(e,e.return,g)}}if(4&s&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&X(i,o),ye(l,a);var d=ye(l,o);for(a=0;a<c.length;a+=2){var u=c[a],h=c[a+1];"style"===u?ge(i,h):"dangerouslySetInnerHTML"===u?ue(i,h):"children"===u?he(i,h):y(i,u,h,d)}switch(l){case"input":Q(i,o);break;case"textarea":re(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(i,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[pi]=o}catch(g){Ec(e,e.return,g)}}break;case 6:if(fl(t,e),gl(e),4&s){if(null===e.stateNode)throw Error(r(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Ec(e,e.return,g)}}break;case 3:if(fl(t,e),gl(e),4&s&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:fl(t,e),gl(e);break;case 13:fl(t,e),gl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Xe())),4&s&&pl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(d=Ya)||u,fl(t,e),Ya=d):fl(t,e),gl(e),8192&s){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xa=e,u=e.child;null!==u;){for(h=Xa=u;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Qa(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){s=p,n=p.return;try{t=s,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(s,n,g)}}break;case 5:Qa(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==f?(f.return=p,Xa=f):_l(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{i=h.stateNode,d?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Ec(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),gl(e),4&s&&pl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rl(n)){var s=n;break e}n=n.return}throw Error(r(160))}switch(s.tag){case 5:var i=s.stateNode;32&s.flags&&(he(i,""),s.flags&=-33),ll(e,ol(e),i);break;case 3:case 4:var o=s.stateNode.containerInfo;al(e,ol(e),o);break;default:throw Error(r(161))}}catch(a){Ec(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xa=e,bl(e,t,n)}function bl(e,t,n){for(var s=0!==(1&e.mode);null!==Xa;){var i=Xa,r=i.child;if(22===i.tag&&s){var o=null!==i.memoizedState||Ja;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Ja;var c=Ya;if(Ja=o,(Ya=l)&&!c)for(Xa=i;null!==Xa;)l=(o=Xa).child,22===o.tag&&null!==o.memoizedState?wl(i):null!==l?(l.return=o,Xa=l):wl(i);for(;null!==r;)Xa=r,bl(r,t,n),r=r.sibling;Xa=i,Ja=a,Ya=c}yl(e)}else 0!==(8772&i.subtreeFlags)&&null!==r?(r.return=i,Xa=r):yl(e)}}function yl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||nl(5,t);break;case 1:var s=t.stateNode;if(4&t.flags&&!Ya)if(null===n)s.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);s.componentDidUpdate(i,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Hr(t,o,s);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hr(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(r(163))}Ya||512&t.flags&&sl(t)}catch(p){Ec(t,t.return,p)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function _l(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function wl(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var s=t.stateNode;if("function"===typeof s.componentDidMount){var i=t.return;try{s.componentDidMount()}catch(l){Ec(t,i,l)}}var r=t.return;try{sl(t)}catch(l){Ec(t,r,l)}break;case 5:var o=t.return;try{sl(t)}catch(l){Ec(t,o,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var xl,El=Math.ceil,Sl=_.ReactCurrentDispatcher,Al=_.ReactCurrentOwner,Cl=_.ReactCurrentBatchConfig,kl=0,Tl=null,Nl=null,Il=0,Pl=0,Rl=Si(0),Ml=0,Ol=null,Dl=0,jl=0,Fl=0,Ll=null,Ul=null,Bl=0,Vl=1/0,Wl=null,Hl=!1,ql=null,zl=null,Gl=!1,Kl=null,Jl=0,Yl=0,$l=null,Xl=-1,Ql=0;function Zl(){return 0!==(6&kl)?Xe():-1!==Xl?Xl:Xl=Xe()}function ec(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Il?Il&-Il:null!==mr.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=yt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function tc(e,t,n,s){if(50<Yl)throw Yl=0,$l=null,Error(r(185));vt(e,n,s),0!==(2&kl)&&e===Tl||(e===Tl&&(0===(2&kl)&&(jl|=n),4===Ml&&oc(e,Il)),nc(e,s),1===n&&0===kl&&0===(1&t.mode)&&(Vl=Xe()+500,Ui&&Wi()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,i=e.expirationTimes,r=e.pendingLanes;0<r;){var o=31-ot(r),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&s)||(i[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}}(e,t);var s=ht(e,e===Tl?Il:0);if(0===s)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){Ui=!0,Vi(e)}(ac.bind(null,e)):Vi(ac.bind(null,e)),oi(function(){0===(6&kl)&&Wi()}),n=null;else{switch(_t(s)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=st}n=Tc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Xl=-1,Ql=0,0!==(6&kl))throw Error(r(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var s=ht(e,e===Tl?Il:0);if(0===s)return null;if(0!==(30&s)||0!==(s&e.expiredLanes)||t)t=mc(e,s);else{t=s;var i=kl;kl|=2;var o=pc();for(Tl===e&&Il===t||(Wl=null,Vl=Xe()+500,uc(e,t));;)try{vc();break}catch(l){hc(e,l)}Cr(),Sl.current=o,kl=i,null!==Nl?t=0:(Tl=null,Il=0,t=Ml)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(s=i,t=ic(e,i))),1===t)throw n=Ol,uc(e,0),oc(e,s),nc(e,Xe()),n;if(6===t)oc(e,s);else{if(i=e.current.alternate,0===(30&s)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var s=0;s<n.length;s++){var i=n[s],r=i.getSnapshot;i=i.value;try{if(!as(r(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mc(e,s))&&(0!==(o=ft(e))&&(s=o,t=ic(e,o))),1===t))throw n=Ol,uc(e,0),oc(e,s),nc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=s,t){case 0:case 1:throw Error(r(345));case 2:case 5:_c(e,Ul,Wl);break;case 3:if(oc(e,s),(130023424&s)===s&&10<(t=Bl+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&s)!==s){Zl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=si(_c.bind(null,e,Ul,Wl),t);break}_c(e,Ul,Wl);break;case 4:if(oc(e,s),(4194240&s)===s)break;for(t=e.eventTimes,i=-1;0<s;){var a=31-ot(s);o=1<<a,(a=t[a])>i&&(i=a),s&=~o}if(s=i,10<(s=(120>(s=Xe()-s)?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*El(s/1960))-s)){e.timeoutHandle=si(_c.bind(null,e,Ul,Wl),s);break}_c(e,Ul,Wl);break;default:throw Error(r(329))}}}return nc(e,Xe()),e.callbackNode===n?sc.bind(null,e):null}function ic(e,t){var n=Ll;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Ul,Ul=n,null!==t&&rc(t)),e}function rc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~Fl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),s=1<<n;e[n]=-1,t&=~s}}function ac(e){if(0!==(6&kl))throw Error(r(327));wc();var t=ht(e,0);if(0===(1&t))return nc(e,Xe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var s=ft(e);0!==s&&(t=s,n=ic(e,s))}if(1===n)throw n=Ol,uc(e,0),oc(e,t),nc(e,Xe()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Ul,Wl),nc(e,Xe()),null}function lc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Vl=Xe()+500,Ui&&Wi())}}function cc(e){null!==Kl&&0===Kl.tag&&0===(6&kl)&&wc();var t=kl;kl|=1;var n=Cl.transition,s=yt;try{if(Cl.transition=null,yt=1,e)return e()}finally{yt=s,Cl.transition=n,0===(6&(kl=t))&&Wi()}}function dc(){Pl=Rl.current,Ai(Rl)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Nl)for(n=Nl.return;null!==n;){var s=n;switch(tr(s),s.tag){case 1:null!==(s=s.type.childContextTypes)&&void 0!==s&&Mi();break;case 3:$r(),Ai(Ni),Ai(Ti),no();break;case 5:Qr(s);break;case 4:$r();break;case 13:case 19:Ai(Zr);break;case 10:kr(s.type._context);break;case 22:case 23:dc()}n=n.return}if(Tl=e,Nl=e=Rc(e.current,null),Il=Pl=t,Ml=0,Ol=null,Fl=jl=Dl=0,Ul=Ll=null,null!==Pr){for(t=0;t<Pr.length;t++)if(null!==(s=(n=Pr[t]).interleaved)){n.interleaved=null;var i=s.next,r=n.pending;if(null!==r){var o=r.next;r.next=i,s.next=o}n.pending=s}Pr=null}return e}function hc(e,t){for(;;){var n=Nl;try{if(Cr(),so.current=Qo,co){for(var s=oo.memoizedState;null!==s;){var i=s.queue;null!==i&&(i.pending=null),s=s.next}co=!1}if(ro=0,lo=ao=oo=null,uo=!1,ho=0,Al.current=null,null===n||null===n.return){Ml=1,Ol=t,Nl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,va(f,a,l,0,t),1&f.mode&&ma(o,d,t),c=d;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(o,d,t),fc();break e}c=Error(r(426))}else if(ir&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),fr(ca(c,l));break e}}o=c=ca(c,l),4!==Ml&&(Ml=2),null===Ll?Ll=[o]:Ll.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Vr(o,pa(0,c,t));break e;case 1:l=c;var b=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===zl||!zl.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,Vr(o,fa(o,l,t));break e}}o=o.return}while(null!==o)}yc(n)}catch(_){t=_,Nl===n&&null!==n&&(Nl=n=n.return);continue}break}}function pc(){var e=Sl.current;return Sl.current=Qo,null===e?Qo:e}function fc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Tl||0===(268435455&Dl)&&0===(268435455&jl)||oc(Tl,Il)}function mc(e,t){var n=kl;kl|=2;var s=pc();for(Tl===e&&Il===t||(Wl=null,uc(e,t));;)try{gc();break}catch(i){hc(e,i)}if(Cr(),kl=n,Sl.current=s,null!==Nl)throw Error(r(261));return Tl=null,Il=0,Ml}function gc(){for(;null!==Nl;)bc(Nl)}function vc(){for(;null!==Nl&&!Ye();)bc(Nl)}function bc(e){var t=xl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?yc(e):Nl=t,Al.current=null}function yc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ga(n,t,Pl)))return void(Nl=n)}else{if(null!==(n=Ka(n,t)))return n.flags&=32767,void(Nl=n);if(null===e)return Ml=6,void(Nl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Nl=t);Nl=t=e}while(null!==t);0===Ml&&(Ml=5)}function _c(e,t,n){var s=yt,i=Cl.transition;try{Cl.transition=null,yt=1,function(e,t,n,s){do{wc()}while(null!==Kl);if(0!==(6&kl))throw Error(r(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),r=1<<i;t[i]=0,s[i]=-1,e[i]=-1,n&=~r}}(e,o),e===Tl&&(Nl=Tl=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Tc(tt,function(){return wc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var a=yt;yt=1;var l=kl;kl|=4,Al.current=null,function(e,t){if(ei=qt,ps(e=hs())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(s&&0!==s.rangeCount){n=s.anchorNode;var i=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==s&&3!==h.nodeType||(c=a+s),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++d===i&&(l=a),p===o&&++u===s&&(c=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(r(163))}}catch(w){Ec(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=el,el=!1}(e,n),ml(n,e),fs(ti),qt=!!ei,ti=ei=null,e.current=n,vl(n,e,i),$e(),kl=l,yt=a,Cl.transition=o}else e.current=n;if(Gl&&(Gl=!1,Kl=e,Jl=i),o=e.pendingLanes,0===o&&(zl=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Xe()),null!==t)for(s=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],s(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=ql,ql=null,e;0!==(1&Jl)&&0!==e.tag&&wc(),o=e.pendingLanes,0!==(1&o)?e===$l?Yl++:(Yl=0,$l=e):Yl=0,Wi()}(e,t,n,s)}finally{Cl.transition=i,yt=s}return null}function wc(){if(null!==Kl){var e=_t(Jl),t=Cl.transition,n=yt;try{if(Cl.transition=null,yt=16>e?16:e,null===Kl)var s=!1;else{if(e=Kl,Kl=null,Jl=0,0!==(6&kl))throw Error(r(331));var i=kl;for(kl|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xa=d;null!==Xa;){var u=Xa;switch(u.tag){case 0:case 11:case 15:tl(8,u,o)}var h=u.child;if(null!==h)h.return=u,Xa=h;else for(;null!==Xa;){var p=(u=Xa).sibling,f=u.return;if(il(u),u===d){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:tl(9,o,o.return)}var b=o.sibling;if(null!==b){b.return=o.return,Xa=b;break e}Xa=o.return}}var y=e.current;for(Xa=y;null!==Xa;){var _=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==_)_.return=a,Xa=_;else e:for(a=y;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(x){Ec(l,l.return,x)}if(l===a){Xa=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Xa=w;break e}Xa=l.return}}if(kl=i,Wi(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(it,e)}catch(x){}s=!0}return s}finally{yt=n,Cl.transition=t}}return!1}function xc(e,t,n){e=Ur(e,t=pa(0,t=ca(n,t),1),1),t=Zl(),null!==e&&(vt(e,1,t),nc(e,t))}function Ec(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var s=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof s.componentDidCatch&&(null===zl||!zl.has(s))){t=Ur(t,e=fa(t,e=ca(n,e),1),1),e=Zl(),null!==t&&(vt(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,n){var s=e.pingCache;null!==s&&s.delete(t),t=Zl(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Il&n)===n&&(4===Ml||3===Ml&&(130023424&Il)===Il&&500>Xe()-Bl?uc(e,0):Fl|=n),nc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=Zl();null!==(e=Or(e,t))&&(vt(e,t,n),nc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(r(314))}null!==s&&s.delete(t),Ac(e,n)}function Tc(e,t){return Ke(e,t)}function Nc(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,s){return new Nc(e,t,n,s)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,s,i,o){var a=2;if(s=e,"function"===typeof e)Pc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Oc(n.children,i,o,t);case S:a=8,i|=8;break;case A:return(e=Ic(12,n,t,2|i)).elementType=A,e.lanes=o,e;case N:return(e=Ic(13,n,t,i)).elementType=N,e.lanes=o,e;case I:return(e=Ic(19,n,t,i)).elementType=I,e.lanes=o,e;case M:return Dc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case k:a=9;break e;case T:a=11;break e;case P:a=14;break e;case R:a=16,s=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Ic(a,n,t,i)).elementType=e,t.type=s,t.lanes=o,t}function Oc(e,t,n,s){return(e=Ic(7,e,s,t)).lanes=n,e}function Dc(e,t,n,s){return(e=Ic(22,e,s,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,s,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,s,i,r,o,a,l){return e=new Lc(e,t,n,a,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Ic(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jr(r),e}function Bc(e){if(!e)return ki;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Di(e,n,t)}return t}function Vc(e,t,n,s,i,r,o,a,l){return(e=Uc(n,s,!0,e,0,r,0,a,l)).context=Bc(null),n=e.current,(r=Lr(s=Zl(),i=ec(n))).callback=void 0!==t&&null!==t?t:null,Ur(n,r,i),e.current.lanes=i,vt(e,i,s),nc(e,s),e}function Wc(e,t,n,s){var i=t.current,r=Zl(),o=ec(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Lr(r,o)).payload={element:e},null!==(s=void 0===s?null:s)&&(t.callback=s),null!==(e=Ur(i,t,o))&&(tc(e,i,o,r),Br(e,i,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}xl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Na(t),pr();break;case 5:Xr(t);break;case 1:Ri(t.type)&&ji(t);break;case 4:Yr(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,i=t.memoizedProps.value;Ci(xr,s._currentValue),s._currentValue=i;break;case 13:if(null!==(s=t.memoizedState))return null!==s.dehydrated?(Ci(Zr,1&Zr.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ja(e,t,n):(Ci(Zr,1&Zr.current),null!==(e=Ha(e,t,n))?e.sibling:null);Ci(Zr,1&Zr.current);break;case 19:if(s=0!==(n&t.childLanes),0!==(128&e.flags)){if(s)return Va(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(Zr,Zr.current),s)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Ha(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,ir&&0!==(1048576&t.flags)&&Zi(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Wa(e,t),e=t.pendingProps;var i=Pi(t,Ti.current);Nr(t,n),i=go(null,t,s,e,i,n);var o=vo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(s)?(o=!0,ji(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,jr(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,s,e,n),t=Ta(null,t,s,!0,o,n)):(t.tag=0,ir&&o&&er(t),_a(null,t,i,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Wa(e,t),e=t.pendingProps,s=(i=s._init)(s._payload),t.type=s,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===P)return 14}return 2}(s),e=na(s,e),i){case 0:t=Ca(null,t,s,e,n);break e;case 1:t=ka(null,t,s,e,n);break e;case 11:t=wa(null,t,s,e,n);break e;case 14:t=xa(null,t,s,na(s.type,e),n);break e}throw Error(r(306,s,""))}return t;case 0:return s=t.type,i=t.pendingProps,Ca(e,t,s,i=t.elementType===s?i:na(s,i),n);case 1:return s=t.type,i=t.pendingProps,ka(e,t,s,i=t.elementType===s?i:na(s,i),n);case 3:e:{if(Na(t),null===e)throw Error(r(387));s=t.pendingProps,i=(o=t.memoizedState).element,Fr(e,t),Wr(t,s,null,n);var a=t.memoizedState;if(s=a.element,o.isDehydrated){if(o={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ia(e,t,s,n,i=ca(Error(r(423)),t));break e}if(s!==i){t=Ia(e,t,s,n,i=ca(Error(r(424)),t));break e}for(sr=ci(t.stateNode.containerInfo.firstChild),nr=t,ir=!0,rr=null,n=wr(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pr(),s===i){t=Ha(e,t,n);break e}_a(e,t,s,n)}t=t.child}return t;case 5:return Xr(t),null===e&&cr(t),s=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(s,i)?a=null:null!==o&&ni(s,o)&&(t.flags|=32),Aa(e,t),_a(e,t,a,n),t.child;case 6:return null===e&&cr(t),null;case 13:return ja(e,t,n);case 4:return Yr(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=_r(t,null,s,n):_a(e,t,s,n),t.child;case 11:return s=t.type,i=t.pendingProps,wa(e,t,s,i=t.elementType===s?i:na(s,i),n);case 7:return _a(e,t,t.pendingProps,n),t.child;case 8:case 12:return _a(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ci(xr,s._currentValue),s._currentValue=a,null!==o)if(as(o.value,a)){if(o.children===i.children&&!Ni.current){t=Ha(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===s){if(1===o.tag){(c=Lr(-1,n&-n)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Tr(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(r(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Tr(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}_a(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,s=t.pendingProps.children,Nr(t,n),s=s(i=Ir(i)),t.flags|=1,_a(e,t,s,n),t.child;case 14:return i=na(s=t.type,t.pendingProps),xa(e,t,s,i=na(s.type,i),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:na(s,i),Wa(e,t),t.tag=1,Ri(s)?(e=!0,ji(t)):e=!1,Nr(t,n),oa(t,s,i),la(t,s,i,n),Ta(null,t,s,!0,e,n);case 19:return Va(e,t,n);case 22:return Sa(e,t,n)}throw Error(r(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Qc(e,t,n,s,i){var r=n._reactRootContainer;if(r){var o=r;if("function"===typeof i){var a=i;i=function(){var e=Hc(o);a.call(e)}}Wc(t,o,e,i)}else o=function(e,t,n,s,i){if(i){if("function"===typeof s){var r=s;s=function(){var e=Hc(o);r.call(e)}}var o=Vc(t,s,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[fi]=o.current,Ws(8===e.nodeType?e.parentNode:e),cc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof s){var a=s;s=function(){var e=Hc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[fi]=l.current,Ws(8===e.nodeType?e.parentNode:e),cc(function(){Wc(t,l,n,s)}),l}(n,t,e,i,s);return Hc(o)}Jc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Wc(e,t,null,null)},Jc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc(function(){Wc(null,e,null,null)}),t[fi]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(bt(t,1|n),nc(t,Xe()),0===(6&kl)&&(Vl=Xe()+500,Wi()))}break;case 13:cc(function(){var t=Or(e,1);if(null!==t){var n=Zl();tc(t,e,1,n)}}),zc(e,1)}},xt=function(e){if(13===e.tag){var t=Or(e,134217728);if(null!==t)tc(t,e,134217728,Zl());zc(e,134217728)}},Et=function(e){if(13===e.tag){var t=ec(e),n=Or(e,t);if(null!==n)tc(n,e,t,Zl());zc(e,t)}},St=function(){return yt},At=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},xe=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var i=wi(s);if(!i)throw Error(r(90));K(s),Q(s,i)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=lc,Ne=cc;var Zc={usingClientEntryPoint:!1,Events:[yi,_i,wi,Ce,ke,lc]},ed={findFiberByHostInstance:bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},td={bundleType:ed.bundleType,version:ed.version,rendererPackageName:ed.rendererPackageName,rendererConfig:ed.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=ze(e))?null:e.stateNode},findFiberByHostInstance:ed.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{it=nd.inject(td),rt=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(r(200));return function(e,t,n){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==s?null:""+s,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(r(299));var n=!1,s="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(s=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,s,i),e[fi]=t.current,Ws(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=ze(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(r(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(r(405));var s=null!=n&&n.hydratedSources||null,i=!1,o="",a=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,i,0,o,a),e[fi]=t.current,Ws(e),s)for(e=0;e<s.length;e++)i=(i=(n=s[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Jc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(r(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(r(40));return!!e._reactRootContainer&&(cc(function(){Qc(null,null,e,!1,function(){e._reactRootContainer=null,e[fi]=null})}),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!$c(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Qc(e,t,n,!1,s)},t.version="18.3.1-next-f1338f8080-20240426"},2875(e,t,n){"use strict";var s,i,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;const o=n(8584),a=n(8396),l=n(656),c={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return d(e,"additionalItems",t);n.items=!0,(0,a.alwaysValidSchema)(n,t)||e.ok((0,l.validateArray)(e))}};function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.schema;const{gen:l,parentSchema:c,data:d,keyword:u,it:h}=e;!function(e){const{opts:s,errSchemaPath:i}=h,r=n.length,o=r===e.minItems&&(r===e.maxItems||!1===e[t]);if(s.strictTuples&&!o){const e='"'.concat(u,'" is ').concat(r,"-tuple, but minItems or maxItems/").concat(t,' are not specified or different at path "').concat(i,'"');(0,a.checkStrictMode)(h,e,s.strictTuples)}}(c),h.opts.unevaluated&&n.length&&!0!==h.items&&(h.items=a.mergeEvaluated.items(l,n.length,h.items));const p=l.name("valid"),f=l.const("len",(0,o._)(s||(s=r(["",".length"])),d));n.forEach((t,n)=>{(0,a.alwaysValidSchema)(h,t)||(l.if((0,o._)(i||(i=r([""," > ",""])),f,n),()=>e.subschema({keyword:u,schemaProp:n,dataProp:n},p)),e.ok(p))})}t.validateTuple=d,t.default=c},2897(e,t,n){var s=n(3693);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},2943(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(2875),i={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,s.validateTuple)(e,"items")};t.default=i},2979(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(122);s.code='require("ajv/dist/runtime/equal").default',t.default=s},2985(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(8396),i={keyword:["then","else"],schemaType:["object","boolean"],code(e){let{keyword:t,parentSchema:n,it:i}=e;void 0===n.if&&(0,s.checkStrictMode)(i,'"'.concat(t,'" without "if" is ignored'))}};t.default=i},2992(e,t,n){"use strict";var s,i=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const r=n(8584),o=n(8396),a={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:e=>{let{params:t}=e;return(0,r._)(s||(s=i(["{propertyName: ","}"])),t.propertyName)}},code(e){const{gen:t,schema:n,data:s,it:i}=e;if((0,o.alwaysValidSchema)(i,n))return;const a=t.name("valid");t.forIn("key",s,n=>{e.setParams({propertyName:n}),e.subschema({keyword:"propertyNames",data:n,dataTypes:["string"],propertyName:n,compositeRule:!0},a),t.if((0,r.not)(a),()=>{e.error(!0),i.allErrors||t.break()})}),e.ok(a)}};t.default=a},3146(e,t,n){"use strict";var s=n(2897).default;const i=n(6125).rE,r=n(6706);e.exports=s(s({},r),{},{workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@v".concat(i,"/dist/worker.min.js")})},3324(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=n(8396),c={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:e=>{let{params:t}=e;return(0,a.str)(s||(s=o(['must match "','" schema'])),t.ifClause)},params:e=>{let{params:t}=e;return(0,a._)(i||(i=o(["{failingKeyword: ","}"])),t.ifClause)}},code(e){const{gen:t,parentSchema:n,it:s}=e;void 0===n.then&&void 0===n.else&&(0,l.checkStrictMode)(s,'"if" without "then" and "else" is ignored');const i=d(s,"then"),c=d(s,"else");if(!i&&!c)return;const u=t.let("valid",!0),h=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},h);e.mergeEvaluated(t)}(),e.reset(),i&&c){const n=t.let("ifClause");e.setParams({ifClause:n}),t.if(h,p("then",n),p("else",n))}else i?t.if(h,p("then")):t.if((0,a.not)(h),p("else"));function p(n,s){return()=>{const i=e.subschema({keyword:n},h);t.assign(u,h),e.mergeValidEvaluated(i,u),s?t.assign(s,(0,a._)(r||(r=o(["",""])),n)):e.setParams({ifClause:n})}}e.pass(u,()=>e.error(!0))}};function d(e,t){const n=e.schema[t];return void 0!==n&&!(0,l.alwaysValidSchema)(e,n)}t.default=c},3670(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5413),i=n(656),r=n(8396),o=n(2075),a={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:a,data:l,it:c}=e;"all"===c.opts.removeAdditional&&void 0===a.additionalProperties&&o.default.code(new s.KeywordCxt(c,o.default,"additionalProperties"));const d=(0,i.allSchemaProperties)(n);for(const s of d)c.definedProperties.add(s);c.opts.unevaluated&&d.length&&!0!==c.props&&(c.props=r.mergeEvaluated.props(t,(0,r.toHash)(d),c.props));const u=d.filter(e=>!(0,r.alwaysValidSchema)(c,n[e]));if(0===u.length)return;const h=t.name("valid");for(const s of u)p(s)?f(s):(t.if((0,i.propertyInData)(t,l,s,c.opts.ownProperties)),f(s),c.allErrors||t.else().var(h,!0),t.endIf()),e.it.definedProperties.add(s),e.ok(h);function p(e){return c.opts.useDefaults&&!c.compositeRule&&void 0!==n[e].default}function f(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},h)}}};t.default=a},3693(e,t,n){var s=n(7736);e.exports=function(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3709(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=[n(2262).default];t.default=s},3738(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3740(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=n},3837(e){"use strict";e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},3919(e,t,n){"use strict";const s=n(3146),i=n(4282),r=n(4826),o=n(6171),a=n(6677),l=n(1246);e.exports={defaultOptions:s,spawnWorker:i,terminateWorker:r,onMessage:o,send:a,loadImage:l}},3939(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1156),i=n(2943),r=n(2875),o=n(4859),a=n(6386),l=n(1598),c=n(2992),d=n(2075),u=n(3670),h=n(5532),p=n(8218),f=n(3952),m=n(1289),g=n(5801),v=n(3324),b=n(2985);t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[p.default,f.default,m.default,g.default,v.default,b.default,c.default,d.default,l.default,u.default,h.default];return e?t.push(i.default,o.default):t.push(s.default,r.default),t.push(a.default),t}},3952(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:n(656).validateUnion,error:{message:"must match a schema in anyOf"}};t.default=s},4202(e,t){"use strict";var n=Symbol.for("react.element"),s=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function b(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var _=y.prototype=new b;_.constructor=y,m(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,s){var i,r={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)x.call(t,i)&&!S.hasOwnProperty(i)&&(r[i]=t[i]);var l=arguments.length-2;if(1===l)r.children=s;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===r[i]&&(r[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:r,_owner:E.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function N(e,t,i,r,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case s:l=!0}}if(l)return o=o(l=e),e=""===r?"."+T(l,0):r,w(o)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),N(o,t,i,"",function(e){return e})):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(l=0,r=""===r?".":r+":",w(e))for(var c=0;c<e.length;c++){var d=r+T(a=e[c],c);l+=N(a,t,i,d,o)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(a=e.next()).done;)l+=N(a=a.value,t,i,d=r+T(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var s=[],i=0;return N(e,s,"","",function(e){return t.call(n,e,i++)}),s}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},M={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:E};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=y,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=D,t.cloneElement=function(e,t,s){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),r=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!S.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=s;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:n,type:e.type,key:r,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},4282(e){"use strict";e.exports=e=>{let t,{workerPath:n,workerBlobURL:s}=e;if(Blob&&URL&&s){const e=new Blob(['importScripts("'.concat(n,'");')],{type:"application/javascript"});t=new Worker(URL.createObjectURL(e))}else t=new Worker(n);return t}},4366(e,t,n){"use strict";var s=n(2897).default;const{normalizeIPv6:i,removeDotSegments:r,recomposeAuthority:o,normalizeComponentEncoding:a,isIPv4:l,nonSimpleDomain:c}=n(6099),{SCHEMES:d,getSchemeHandler:u}=n(1578);function h(e,t,n,s){const i={};return s||(e=m(p(e,n),n),t=m(p(t,n),n)),!(n=n||{}).tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=r(t.path||""),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=r(t.path||""),i.query=t.query):(t.path?("/"===t.path[0]?i.path=r(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=r(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function p(e,t){const n={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},s=Object.assign({},t),i=[],a=u(s.scheme||n.scheme);a&&a.serialize&&a.serialize(n,s),void 0!==n.path&&(s.skipEscape?n.path=unescape(n.path):(n.path=escape(n.path),void 0!==n.scheme&&(n.path=n.path.split("%3A").join(":")))),"suffix"!==s.reference&&n.scheme&&i.push(n.scheme,":");const l=o(n);if(void 0!==l&&("suffix"!==s.reference&&i.push("//"),i.push(l),n.path&&"/"!==n.path[0]&&i.push("/")),void 0!==n.path){let e=n.path;s.absolutePath||a&&a.absolutePath||(e=r(e)),void 0===l&&"/"===e[0]&&"/"===e[1]&&(e="/%2F"+e.slice(2)),i.push(e)}return void 0!==n.query&&i.push("?",n.query),void 0!==n.fragment&&i.push("#",n.fragment),i.join("")}const f=/^(?:((?:[\0-"\$-\.0-9;->@-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+):)?(?:\/\/((?:((?:[\0-"\$-\.0->A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)@)?(\[(?:[\0-"\$-\.0->@-\\\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\]|(?:[\0-"\$-\.0-9;->@-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)(?::([0-9]*))?))?((?:[\0-"\$->@-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)(?:\?((?:[\0-"\$-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?(?:#((?:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|[\n\r])*))?/;function m(e,t){const n=Object.assign({},t),s={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let r=!1;"suffix"===n.reference&&(e=n.scheme?n.scheme+":"+e:"//"+e);const o=e.match(f);if(o){if(s.scheme=o[1],s.userinfo=o[3],s.host=o[4],s.port=parseInt(o[5],10),s.path=o[6]||"",s.query=o[7],s.fragment=o[8],isNaN(s.port)&&(s.port=o[5]),s.host){if(!1===l(s.host)){const e=i(s.host);s.host=e.host.toLowerCase(),r=e.isIPV6}else r=!0}void 0!==s.scheme||void 0!==s.userinfo||void 0!==s.host||void 0!==s.port||void 0!==s.query||s.path?void 0===s.scheme?s.reference="relative":void 0===s.fragment?s.reference="absolute":s.reference="uri":s.reference="same-document",n.reference&&"suffix"!==n.reference&&n.reference!==s.reference&&(s.error=s.error||"URI is not a "+n.reference+" reference.");const t=u(n.scheme||s.scheme);if(!n.unicodeSupport&&(!t||!t.unicodeSupport)&&s.host&&(n.domainHost||t&&t.domainHost)&&!1===r&&c(s.host))try{s.host=URL.domainToASCII(s.host.toLowerCase())}catch(a){s.error=s.error||"Host's domain name can not be converted to ASCII: "+a}(!t||t&&!t.skipNormalize)&&(-1!==e.indexOf("%")&&(void 0!==s.scheme&&(s.scheme=unescape(s.scheme)),void 0!==s.host&&(s.host=unescape(s.host))),s.path&&(s.path=escape(unescape(s.path))),s.fragment&&(s.fragment=encodeURI(decodeURIComponent(s.fragment)))),t&&t.parse&&t.parse(s,n)}else s.error=s.error||"URI can not be parsed.";return s}const g={SCHEMES:d,normalize:function(e,t){return"string"===typeof e?e=p(m(e,t),t):"object"===typeof e&&(e=m(p(e,t),t)),e},resolve:function(e,t,n){const s=n?Object.assign({scheme:"null"},n):{scheme:"null"},i=h(m(e,s),m(t,s),s,!0);return s.skipEscape=!0,p(i,s)},resolveComponent:h,equal:function(e,t,n){return"string"===typeof e?(e=unescape(e),e=p(a(m(e,n),!0),s(s({},n),{},{skipEscape:!0}))):"object"===typeof e&&(e=p(a(e,!0),s(s({},n),{},{skipEscape:!0}))),"string"===typeof t?(t=unescape(t),t=p(a(m(t,n),!0),s(s({},n),{},{skipEscape:!0}))):"object"===typeof t&&(t=p(a(t,!0),s(s({},n),{},{skipEscape:!0}))),e.toLowerCase()===t.toLowerCase()},serialize:p,parse:m};e.exports=g,e.exports.default=g,e.exports.fastUri=g},4391(e,t,n){"use strict";var s=n(7950);t.createRoot=s.createRoot,t.hydrateRoot=s.hydrateRoot},4445(e,t,n){"use strict";var s=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;const i=new Set(["string","number","integer","boolean","null","object","array"]);t.isJSONType=function(e){return"string"==typeof e&&i.has(e)},t.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:s(s({},e),{},{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}},4601(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(4366);s.code='require("ajv/dist/runtime/uri").default',t.default=s},4700(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message(e){let{keyword:t,schemaCode:n}=e;const i="maxItems"===t?"more":"fewer";return(0,a.str)(s||(s=o(["must NOT have "," than "," items"])),i,n)},params:e=>{let{schemaCode:t}=e;return(0,a._)(i||(i=o(["{limit: ","}"])),t)}},code(e){const{keyword:t,data:n,schemaCode:s}=e,i="maxItems"===t?a.operators.GT:a.operators.LT;e.fail$data((0,a._)(r||(r=o(["",".length "," ",""])),n,i,s))}};t.default=l},4796(e,t,n){"use strict";var s,i,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const o=n(656),a=n(8584),l=n(8396),c={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:e=>{let{params:{missingProperty:t}}=e;return(0,a.str)(s||(s=r(["must have required property '","'"])),t)},params:e=>{let{params:{missingProperty:t}}=e;return(0,a._)(i||(i=r(["{missingProperty: ","}"])),t)}},code(e){const{gen:t,schema:n,schemaCode:s,data:i,$data:r,it:c}=e,{opts:d}=c;if(!r&&0===n.length)return;const u=n.length>=d.loopRequired;if(c.allErrors?function(){if(u||r)e.block$data(a.nil,h);else for(const t of n)(0,o.checkReportMissingProp)(e,t)}():function(){const l=t.let("missing");if(u||r){const n=t.let("valid",!0);e.block$data(n,()=>function(n,r){e.setParams({missingProperty:n}),t.forOf(n,s,()=>{t.assign(r,(0,o.propertyInData)(t,i,n,d.ownProperties)),t.if((0,a.not)(r),()=>{e.error(),t.break()})},a.nil)}(l,n)),e.ok(n)}else t.if((0,o.checkMissingProp)(e,n,l)),(0,o.reportMissingProp)(e,l),t.else()}(),d.strictRequired){const t=e.parentSchema.properties,{definedProperties:s}=e.it;for(const e of n)if(void 0===(null===t||void 0===t?void 0:t[e])&&!s.has(e)){const t=c.schemaEnv.baseId+c.errSchemaPath,n='required property "'.concat(e,'" is not defined at "').concat(t,'" (strictRequired)');(0,l.checkStrictMode)(c,n,c.opts.strictRequired)}}function h(){t.forOf("prop",s,n=>{e.setParams({missingProperty:n}),t.if((0,o.noPropertyInData)(t,i,n,d.ownProperties),()=>e.error())})}}};t.default=c},4826(e){"use strict";e.exports=e=>{e.terminate()}},4859(e,t,n){"use strict";var s,i,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const o=n(8584),a=n(8396),l=n(656),c=n(1156),d={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:e=>{let{params:{len:t}}=e;return(0,o.str)(s||(s=r(["must NOT have more than "," items"])),t)},params:e=>{let{params:{len:t}}=e;return(0,o._)(i||(i=r(["{limit: ","}"])),t)}},code(e){const{schema:t,parentSchema:n,it:s}=e,{prefixItems:i}=n;s.items=!0,(0,a.alwaysValidSchema)(s,t)||(i?(0,c.validateAdditionalItems)(e,i):e.ok((0,l.validateArray)(e)))}};t.default=d},4893(e){e.exports=function(e,t){if(null==e)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;n[s]=e[s]}return n},e.exports.__esModule=!0,e.exports.default=e.exports},5043(e,t,n){"use strict";e.exports=n(4202)},5280(e,t,n){"use strict";var s,i,r,o,a,l=n(2897).default,c=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const d=n(5467);class u extends Error{constructor(e){super('CodeGen: "code" for '.concat(e," not defined")),this.value=e.value}}var h;!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"}(h||(t.UsedValueState=h={})),t.varKinds={const:new d.Name("const"),let:new d.Name("let"),var:new d.Name("var")};class p{constructor(){let{prefixes:e,parent:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof d.Name?e:this.name(e)}name(e){return new d.Name(this._newName(e))}_newName(e){const t=this._names[e]||this._nameGroup(e);return"".concat(e).concat(t.index++)}_nameGroup(e){var t,n;if((null===(n=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===n?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error('CodeGen: prefix "'.concat(e,'" is not allowed in this scope'));return this._names[e]={prefix:e,index:0}}}t.Scope=p;class f extends d.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,t){let{property:n,itemIndex:i}=t;this.value=e,this.scopePath=(0,d._)(s||(s=c([".","[","]"])),new d.Name(n),i)}}t.ValueScopeName=f;const m=(0,d._)(i||(i=c(["\n"],["\\n"])));t.ValueScope=class extends p{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts=l(l({},e),{},{_n:e.lines?m:d.nil})}get(){return this._scope}name(e){return new f(e,this._newName(e))}value(e,t){var n;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const s=this.toName(e),{prefix:i}=s,r=null!==(n=t.key)&&void 0!==n?n:t.ref;let o=this._values[i];if(o){const e=o.get(r);if(e)return e}else o=this._values[i]=new Map;o.set(r,s);const a=this._scope[i]||(this._scope[i]=[]),l=a.length;return a[l]=t.ref,s.setValue(t,{property:i,itemIndex:l}),s}getValue(e,t){const n=this._values[e];if(n)return n.get(t)}scopeRefs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._values;return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error('CodeGen: name "'.concat(t,'" has no value'));return(0,d._)(r||(r=c(["","",""])),e,t.scopePath)})}scopeCode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._values,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error('CodeGen: name "'.concat(e,'" has no value'));return e.value.code},t,n)}_reduceValues(e,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,r=d.nil;for(const l in e){const p=e[l];if(!p)continue;const f=s[l]=s[l]||new Map;p.forEach(e=>{if(f.has(e))return;f.set(e,h.Started);let s=n(e);if(s){const n=this.opts.es5?t.varKinds.var:t.varKinds.const;r=(0,d._)(o||(o=c(["",""," "," = ",";",""])),r,n,e,s,this.opts._n)}else{if(!(s=null===i||void 0===i?void 0:i(e)))throw new u(e);r=(0,d._)(a||(a=c(["","","",""])),r,s,this.opts._n)}f.set(e,h.Completed)})}return r}}},5362(e,t,n){"use strict";const s=n(1674);let i=0;e.exports=e=>{let{id:t,action:n,payload:r={}}=e,o=t;return"undefined"===typeof o&&(o=s("Job",i),i+=1),{id:o,action:n,payload:r}}},5413(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b,y,_,w,x,E,S,A,C,k,T,N,I,P,R,M,O,D,j,F,L,U,B,V,W=n(2897).default,H=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;const q=n(6470),z=n(9273),G=n(2392),K=n(9273),J=n(463),Y=n(9142),$=n(6340),X=n(8584),Q=n(266),Z=n(2302),ee=n(8396),te=n(6772);function ne(e,t){let{gen:n,validateName:v,schema:b,schemaEnv:y,opts:_}=e;_.code.es5?n.func(v,(0,X._)(s||(s=H(["",", ",""])),Q.default.data,Q.default.valCxt),y.$async,()=>{n.code((0,X._)(i||(i=H(['"use strict"; ',""])),se(b,_))),function(e,t){e.if(Q.default.valCxt,()=>{e.var(Q.default.instancePath,(0,X._)(l||(l=H(["",".",""])),Q.default.valCxt,Q.default.instancePath)),e.var(Q.default.parentData,(0,X._)(c||(c=H(["",".",""])),Q.default.valCxt,Q.default.parentData)),e.var(Q.default.parentDataProperty,(0,X._)(d||(d=H(["",".",""])),Q.default.valCxt,Q.default.parentDataProperty)),e.var(Q.default.rootData,(0,X._)(u||(u=H(["",".",""])),Q.default.valCxt,Q.default.rootData)),t.dynamicRef&&e.var(Q.default.dynamicAnchors,(0,X._)(h||(h=H(["",".",""])),Q.default.valCxt,Q.default.dynamicAnchors))},()=>{e.var(Q.default.instancePath,(0,X._)(p||(p=H(['""'])))),e.var(Q.default.parentData,(0,X._)(f||(f=H(["undefined"])))),e.var(Q.default.parentDataProperty,(0,X._)(m||(m=H(["undefined"])))),e.var(Q.default.rootData,Q.default.data),t.dynamicRef&&e.var(Q.default.dynamicAnchors,(0,X._)(g||(g=H(["{}"]))))})}(n,_),n.code(t)}):n.func(v,(0,X._)(r||(r=H(["",", ",""])),Q.default.data,function(e){return(0,X._)(o||(o=H(["{",'="", ',", ",", ","=","","}={}"])),Q.default.instancePath,Q.default.parentData,Q.default.parentDataProperty,Q.default.rootData,Q.default.data,e.dynamicRef?(0,X._)(a||(a=H([", ","={}"])),Q.default.dynamicAnchors):X.nil)}(_)),y.$async,()=>n.code(se(b,_)).code(t))}function se(e,t){const n="object"==typeof e&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,X._)(S||(S=H(["/*# sourceURL="," */"])),n):X.nil}function ie(e,t){oe(e)&&(ae(e),re(e))?function(e,t){const{schema:n,gen:s,opts:i}=e;i.$comment&&n.$comment&&ce(e);(function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,Z.resolveUrl)(e.opts.uriResolver,e.baseId,t))})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const r=s.const("_errs",Q.default.errors);le(e,r),s.var(t,(0,X._)(A||(A=H([""," === ",""])),r,Q.default.errors))}(e,t):(0,q.boolOrEmptySchema)(e,t)}function re(e){let{schema:t,self:n}=e;if("boolean"==typeof t)return!t;for(const s in t)if(n.RULES.all[s])return!0;return!1}function oe(e){return"boolean"!=typeof e.schema}function ae(e){(0,ee.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:n,opts:s,self:i}=e;t.$ref&&s.ignoreKeywordsWithRef&&(0,ee.schemaHasRulesButRef)(t,i.RULES)&&i.logger.warn('$ref: keywords ignored in schema at path "'.concat(n,'"'))}(e)}function le(e,t){if(e.opts.jtd)return de(e,[],!1,t);const n=(0,z.getSchemaTypes)(e.schema);de(e,n,!(0,z.coerceAndCheckDataType)(e,n),t)}function ce(e){let{gen:t,schemaEnv:n,schema:s,errSchemaPath:i,opts:r}=e;const o=s.$comment;if(!0===r.$comment)t.code((0,X._)(C||(C=H(["",".logger.log(",")"])),Q.default.self,o));else if("function"==typeof r.$comment){const e=(0,X.str)(k||(k=H(["","/$comment"])),i),s=t.scopeValue("root",{ref:n.root});t.code((0,X._)(T||(T=H(["",".opts.$comment(",", ",", ",".schema)"])),Q.default.self,o,e,s))}}function de(e,t,n,s){const{gen:i,schema:r,data:o,allErrors:a,opts:l,self:c}=e,{RULES:d}=c;function u(c){(0,G.shouldUseGroup)(r,c)&&(c.type?(i.if((0,K.checkDataType)(c.type,o,l.strictNumbers)),ue(e,c),1===t.length&&t[0]===c.type&&n&&(i.else(),(0,K.reportTypeError)(e)),i.endIf()):ue(e,c),a||i.if((0,X._)(D||(D=H([""," === ",""])),Q.default.errors,s||0)))}!r.$ref||!l.ignoreKeywordsWithRef&&(0,ee.schemaHasRulesButRef)(r,d)?(l.jtd||function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(t=>{pe(e.dataTypes,t)||fe(e,'type "'.concat(t,'" not allowed by context "').concat(e.dataTypes.join(","),'"'))}),function(e,t){const n=[];for(const s of e.dataTypes)pe(t,s)?n.push(s):t.includes("integer")&&"number"===s&&n.push("integer");e.dataTypes=n}(e,t)})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&fe(e,"use allowUnionTypes to allow union type keyword")}(e,t);!function(e,t){const n=e.self.RULES.all;for(const s in n){const i=n[s];if("object"==typeof i&&(0,G.shouldUseRule)(e.schema,i)){const{type:n}=i.definition;n.length&&!n.some(e=>he(t,e))&&fe(e,'missing type "'.concat(n.join(","),'" for keyword "').concat(s,'"'))}}}(e,e.dataTypes)}(e,t),i.block(()=>{for(const e of d.rules)u(e);u(d.post)})):i.block(()=>ge(e,"$ref",d.all.$ref.definition))}function ue(e,t){const{gen:n,schema:s,opts:{useDefaults:i}}=e;i&&(0,J.assignDefaults)(e,t.type),n.block(()=>{for(const n of t.rules)(0,G.shouldUseRule)(s,n)&&ge(e,n.keyword,n.definition,t.type)})}function he(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function pe(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function fe(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=' at "'.concat(n,'" (strictTypes)'),(0,ee.checkStrictMode)(e,t,e.opts.strictTypes)}t.validateFunctionCode=function(e){oe(e)&&(ae(e),re(e))?function(e){const{schema:t,opts:n,gen:s}=e;ne(e,()=>{n.$comment&&t.$comment&&ce(e),function(e){const{schema:t,opts:n}=e;void 0!==t.default&&n.useDefaults&&n.strictSchema&&(0,ee.checkStrictMode)(e,"default is ignored in the schema root")}(e),s.let(Q.default.vErrors,null),s.let(Q.default.errors,0),n.unevaluated&&function(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",(0,X._)(v||(v=H(["",".evaluated"])),n)),t.if((0,X._)(b||(b=H(["",".dynamicProps"])),e.evaluated),()=>t.assign((0,X._)(y||(y=H(["",".props"])),e.evaluated),(0,X._)(_||(_=H(["undefined"]))))),t.if((0,X._)(w||(w=H(["",".dynamicItems"])),e.evaluated),()=>t.assign((0,X._)(x||(x=H(["",".items"])),e.evaluated),(0,X._)(E||(E=H(["undefined"])))))}(e),le(e),function(e){const{gen:t,schemaEnv:n,validateName:s,ValidationError:i,opts:r}=e;n.$async?t.if((0,X._)(N||(N=H([""," === 0"])),Q.default.errors),()=>t.return(Q.default.data),()=>t.throw((0,X._)(I||(I=H(["new ","(",")"])),i,Q.default.vErrors))):(t.assign((0,X._)(P||(P=H(["",".errors"])),s),Q.default.vErrors),r.unevaluated&&function(e){let{gen:t,evaluated:n,props:s,items:i}=e;s instanceof X.Name&&t.assign((0,X._)(M||(M=H(["",".props"])),n),s);i instanceof X.Name&&t.assign((0,X._)(O||(O=H(["",".items"])),n),i)}(e),t.return((0,X._)(R||(R=H([""," === 0"])),Q.default.errors)))}(e)})}(e):ne(e,()=>(0,q.topBoolOrEmptySchema)(e))};class me{constructor(e,t,n){if((0,Y.validateKeywordUsage)(e,t,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,ee.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",ye(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Y.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error("".concat(n," value must be ").concat(JSON.stringify(t.schemaType)));("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",Q.default.errors))}result(e,t,n){this.failResult((0,X.not)(e),t,n)}failResult(e,t,n){this.gen.if(e),n?n():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,X.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail((0,X._)(j||(j=H([""," !== undefined && (",")"])),t,(0,X.or)(this.invalid$data(),e)))}error(e,t,n){if(t)return this.setParams(t),this._error(e,n),void this.setParams({});this._error(e,n)}_error(e,t){(e?te.reportExtraError:te.reportError)(this,this.def.error,t)}$dataError(){(0,te.reportError)(this,this.def.$dataError||te.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,te.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X.nil;this.gen.block(()=>{this.check$data(e,n),t()})}check$data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X.nil,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.nil;if(!this.$data)return;const{gen:n,schemaCode:s,schemaType:i,def:r}=this;n.if((0,X.or)((0,X._)(F||(F=H([""," === undefined"])),s),t)),e!==X.nil&&n.assign(e,!0),(i.length||r.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==X.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:n,def:s,it:i}=this;return(0,X.or)(function(){if(n.length){if(!(t instanceof X.Name))throw new Error("ajv implementation error");const e=Array.isArray(n)?n:[n];return(0,X._)(L||(L=H(["",""])),(0,K.checkDataTypes)(e,t,i.opts.strictNumbers,K.DataType.Wrong))}return X.nil}(),function(){if(s.validateSchema){const n=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,X._)(U||(U=H(["!","(",")"])),n,t)}return X.nil}())}subschema(e,t){const n=(0,$.getSubschema)(this.it,e);(0,$.extendSubschemaData)(n,this.it,e),(0,$.extendSubschemaMode)(n,e);const s=W(W(W({},this.it),n),{},{items:void 0,props:void 0});return ie(s,t),s}mergeEvaluated(e,t){const{it:n,gen:s}=this;n.opts.unevaluated&&(!0!==n.props&&void 0!==e.props&&(n.props=ee.mergeEvaluated.props(s,e.props,n.props,t)),!0!==n.items&&void 0!==e.items&&(n.items=ee.mergeEvaluated.items(s,e.items,n.items,t)))}mergeValidEvaluated(e,t){const{it:n,gen:s}=this;if(n.opts.unevaluated&&(!0!==n.props||!0!==n.items))return s.if(t,()=>this.mergeEvaluated(e,X.Name)),!0}}function ge(e,t,n,s){const i=new me(e,n,t);"code"in n?n.code(i,s):i.$data&&n.validate?(0,Y.funcKeywordCode)(i,n):"macro"in n?(0,Y.macroKeywordCode)(i,n):(n.compile||n.validate)&&(0,Y.funcKeywordCode)(i,n)}t.KeywordCxt=me;const ve=/^\/(?:[^~]|~0|~1)*$/,be=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ye(e,t){let n,s,{dataLevel:i,dataNames:r,dataPathArr:o}=t;if(""===e)return Q.default.rootData;if("/"===e[0]){if(!ve.test(e))throw new Error("Invalid JSON-pointer: ".concat(e));n=e,s=Q.default.rootData}else{const t=be.exec(e);if(!t)throw new Error("Invalid JSON-pointer: ".concat(e));const a=+t[1];if(n=t[2],"#"===n){if(a>=i)throw new Error(c("property/index",a));return o[i-a]}if(a>i)throw new Error(c("data",a));if(s=r[i-a],!n)return s}let a=s;const l=n.split("/");for(const d of l)d&&(s=(0,X._)(B||(B=H(["","",""])),s,(0,X.getProperty)((0,ee.unescapeJsonPointer)(d))),a=(0,X._)(V||(V=H([""," && ",""])),a,s));return a;function c(e,t){return"Cannot access ".concat(e," ").concat(t," levels up, current level is ").concat(i)}}t.getData=ye},5467(e,t,n){"use strict";var s,i,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class o{}t._CodeOrName=o,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class a extends o{constructor(e){if(super(),!t.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=a;class l extends o{constructor(e){super(),this._items="string"===typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>"".concat(e).concat(t),"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof a&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function c(e){const t=[e[0]];let n=0;for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];for(;n<i.length;)h(t,i[n]),t.push(e[++n]);return new l(t)}t._Code=l,t.nil=new l(""),t._=c;const d=new l("+");function u(e){const t=[f(e[0])];let n=0;for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];for(;n<i.length;)t.push(d),h(t,i[n]),t.push(d,f(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===d){const n=p(e[t-1],e[t+1]);if(void 0!==n){e.splice(t-1,3,n);continue}e[t++]="+"}t++}}(t),new l(t)}function h(e,t){var n;t instanceof l?e.push(...t._items):t instanceof a?e.push(t):e.push("number"==typeof(n=t)||"boolean"==typeof n||null===n?n:f(Array.isArray(n)?n.join(","):n))}function p(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof a||'"'!==e[e.length-1])return;return"string"!=typeof t?"".concat(e.slice(0,-1)).concat(t,'"'):'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof a?void 0:'"'.concat(e).concat(t.slice(1))}function f(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.str=u,t.addCodeArg=h,t.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:u(s||(s=r(["","",""])),e,t)},t.stringify=function(e){return new l(f(e))},t.safeStringify=f,t.getProperty=function(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new l(".".concat(e)):c(i||(i=r(["[","]"])),e)},t.getEsmExportName=function(e){if("string"==typeof e&&t.IDENTIFIER.test(e))return new l("".concat(e));throw new Error("CodeGen: invalid export name: ".concat(e,", use explicit $id name mapping"))},t.regexpCode=function(e){return new l(e.toString())}},5532(e,t,n){"use strict";var s,i,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const o=n(656),a=n(8584),l=n(8396),c=n(8396),d={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:d,parentSchema:u,it:h}=e,{opts:p}=h,f=(0,o.allSchemaProperties)(n),m=f.filter(e=>(0,l.alwaysValidSchema)(h,n[e]));if(0===f.length||m.length===f.length&&(!h.opts.unevaluated||!0===h.props))return;const g=p.strictSchema&&!p.allowMatchingProperties&&u.properties,v=t.name("valid");!0===h.props||h.props instanceof a.Name||(h.props=(0,c.evaluatedPropsToName)(t,h.props));const{props:b}=h;function y(e){for(const t in g)new RegExp(e).test(t)&&(0,l.checkStrictMode)(h,"property ".concat(t," matches pattern ").concat(e," (use allowMatchingProperties)"))}function _(n){t.forIn("key",d,l=>{t.if((0,a._)(s||(s=r(["",".test(",")"])),(0,o.usePattern)(e,n),l),()=>{const s=m.includes(n);s||e.subschema({keyword:"patternProperties",schemaProp:n,dataProp:l,dataPropType:c.Type.Str},v),h.opts.unevaluated&&!0!==b?t.assign((0,a._)(i||(i=r(["","[","]"])),b,l),!0):s||h.allErrors||t.if((0,a.not)(v),()=>t.break())})})}!function(){for(const e of f)g&&y(e),h.allErrors?_(e):(t.var(v,!0),_(e),t.if(v))}()}};t.default=d},5597(e,t){"use strict";var n=this;let s=!1;t.logging=s,t.setLogging=e=>{s=e},t.log=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return s?console.log.apply(n,t):null}},5783(e){"use strict";e.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}},5801(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(8396),i={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:i}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const r=t.name("valid");n.forEach((t,n)=>{if((0,s.alwaysValidSchema)(i,t))return;const o=e.subschema({keyword:"allOf",schemaProp:n},r);e.ok(r),e.mergeEvaluated(o)})}};t.default=i},6099(e){"use strict";const t=RegExp.prototype.test.bind(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),n=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])$/);function s(e){let t="",n=0,s=0;for(s=0;s<e.length;s++)if(n=e[s].charCodeAt(0),48!==n){if(!(n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102))return"";t+=e[s];break}for(s+=1;s<e.length;s++){if(n=e[s].charCodeAt(0),!(n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102))return"";t+=e[s]}return t}const i=RegExp.prototype.test.bind(/(?:[\0- #%\/-:<>-\^\|\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/);function r(e){return e.length=0,!0}function o(e,t,n){if(e.length){const i=s(e);if(""===i)return n.error=!0,!1;t.push(i),e.length=0}return!0}function a(e){if(function(e,t){let n=0;for(let s=0;s<e.length;s++)e[s]===t&&n++;return n}(e,":")<2)return{host:e,isIPV6:!1};const t=function(e){let t=0;const n={error:!1,address:"",zone:""},i=[],a=[];let l=!1,c=!1,d=o;for(let s=0;s<e.length;s++){const o=e[s];if("["!==o&&"]"!==o)if(":"!==o)if("%"===o){if(!d(a,i,n))break;d=r}else a.push(o);else{if(!0===l&&(c=!0),!d(a,i,n))break;if(++t>7){n.error=!0;break}s>0&&":"===e[s-1]&&(l=!0),i.push(":")}}return a.length&&(d===r?n.zone=a.join(""):c?i.push(a.join("")):i.push(s(a))),n.address=i.join(""),n}(e);if(t.error)return{host:e,isIPV6:!1};{let e=t.address,n=t.address;return t.zone&&(e+="%"+t.zone,n+="%25"+t.zone),{host:e,isIPV6:!0,escapedHost:n}}}e.exports={nonSimpleDomain:i,recomposeAuthority:function(e){const t=[];if(void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host){let s=unescape(e.host);if(!n(s)){const t=a(s);s=!0===t.isIPV6?"[".concat(t.escapedHost,"]"):e.host}t.push(s)}return"number"!==typeof e.port&&"string"!==typeof e.port||(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0},normalizeComponentEncoding:function(e,t){const n=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=n(e.scheme)),void 0!==e.userinfo&&(e.userinfo=n(e.userinfo)),void 0!==e.host&&(e.host=n(e.host)),void 0!==e.path&&(e.path=n(e.path)),void 0!==e.query&&(e.query=n(e.query)),void 0!==e.fragment&&(e.fragment=n(e.fragment)),e},removeDotSegments:function(e){let t=e;const n=[];let s=-1,i=0;for(;i=t.length;){if(1===i){if("."===t)break;if("/"===t){n.push("/");break}n.push(t);break}if(2===i){if("."===t[0]){if("."===t[1])break;if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&("."===t[1]||"/"===t[1])){n.push("/");break}}else if(3===i&&"/.."===t){0!==n.length&&n.pop(),n.push("/");break}if("."===t[0]){if("."===t[1]){if("/"===t[2]){t=t.slice(3);continue}}else if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&"."===t[1]){if("/"===t[2]){t=t.slice(2);continue}if("."===t[2]&&"/"===t[3]){t=t.slice(3),0!==n.length&&n.pop();continue}}if(-1===(s=t.indexOf("/",1))){n.push(t);break}n.push(t.slice(0,s)),t=t.slice(s)}return n.join("")},isIPv4:n,isUUID:t,normalizeIPv6:a,stringArrayToHexStripped:s}},6125(e){"use strict";e.exports={rE:"7.0.0"}},6171(e){"use strict";e.exports=(e,t)=>{e.onmessage=e=>{let{data:n}=e;t(n)}}},6280(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},6340(e,t,n){"use strict";var s,i,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;const c=n(8584),d=n(8396);t.getSubschema=function(e,t){let{keyword:n,schemaProp:r,schema:o,schemaPath:a,errSchemaPath:u,topSchemaRef:h}=t;if(void 0!==n&&void 0!==o)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==n){const t=e.schema[n];return void 0===r?{schema:t,schemaPath:(0,c._)(s||(s=l(["","",""])),e.schemaPath,(0,c.getProperty)(n)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(n)}:{schema:t[r],schemaPath:(0,c._)(i||(i=l(["","","",""])),e.schemaPath,(0,c.getProperty)(n),(0,c.getProperty)(r)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(n,"/").concat((0,d.escapeFragment)(r))}}if(void 0!==o){if(void 0===a||void 0===u||void 0===h)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:o,schemaPath:a,topSchemaRef:h,errSchemaPath:u}}throw new Error('either "keyword" or "schema" must be passed')},t.extendSubschemaData=function(e,t,n){let{dataProp:s,dataPropType:i,data:u,dataTypes:h,propertyName:p}=n;if(void 0!==u&&void 0!==s)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:f}=t;if(void 0!==s){const{errorPath:n,dataPathArr:u,opts:h}=t;m(f.let("data",(0,c._)(r||(r=l(["","",""])),t.data,(0,c.getProperty)(s)),!0)),e.errorPath=(0,c.str)(o||(o=l(["","",""])),n,(0,d.getErrorPath)(s,i,h.jsPropertySyntax)),e.parentDataProperty=(0,c._)(a||(a=l(["",""])),s),e.dataPathArr=[...u,e.parentDataProperty]}if(void 0!==u){m(u instanceof c.Name?u:f.let("data",u,!0)),void 0!==p&&(e.propertyName=p)}function m(n){e.data=n,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,n]}h&&(e.dataTypes=h)},t.extendSubschemaMode=function(e,t){let{jtdDiscriminator:n,jtdMetadata:s,compositeRule:i,createErrors:r,allErrors:o}=t;void 0!==i&&(e.compositeRule=i),void 0!==r&&(e.createErrors=r),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=n,e.jtdMetadata=s}},6386(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const g=n(8584),v=n(8396),b={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:e=>{let{params:{min:t,max:n}}=e;return void 0===n?(0,g.str)(s||(s=m(["must contain at least "," valid item(s)"])),t):(0,g.str)(i||(i=m(["must contain at least "," and no more than "," valid item(s)"])),t,n)},params:e=>{let{params:{min:t,max:n}}=e;return void 0===n?(0,g._)(r||(r=m(["{minContains: ","}"])),t):(0,g._)(o||(o=m(["{minContains: ",", maxContains: ","}"])),t,n)}},code(e){const{gen:t,schema:n,parentSchema:s,data:i,it:r}=e;let o,b;const{minContains:y,maxContains:_}=s;r.opts.next?(o=void 0===y?1:y,b=_):o=1;const w=t.const("len",(0,g._)(a||(a=m(["",".length"])),i));if(e.setParams({min:o,max:b}),void 0===b&&0===o)return void(0,v.checkStrictMode)(r,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==b&&o>b)return(0,v.checkStrictMode)(r,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,v.alwaysValidSchema)(r,n)){let t=(0,g._)(l||(l=m([""," >= ",""])),w,o);return void 0!==b&&(t=(0,g._)(c||(c=m([""," && "," <= ",""])),t,w,b)),void e.pass(t)}r.items=!0;const x=t.name("valid");function E(){const e=t.name("_valid"),n=t.let("count",0);S(e,()=>t.if(e,()=>function(e){t.code((0,g._)(u||(u=m(["","++"])),e)),void 0===b?t.if((0,g._)(h||(h=m([""," >= ",""])),e,o),()=>t.assign(x,!0).break()):(t.if((0,g._)(p||(p=m([""," > ",""])),e,b),()=>t.assign(x,!1).break()),1===o?t.assign(x,!0):t.if((0,g._)(f||(f=m([""," >= ",""])),e,o),()=>t.assign(x,!0)))}(n)))}function S(n,s){t.forRange("i",0,w,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:v.Type.Num,compositeRule:!0},n),s()})}void 0===b&&1===o?S(x,()=>t.if(x,()=>t.break())):0===o?(t.let(x,!0),void 0!==b&&t.if((0,g._)(d||(d=m(["",".length > 0"])),i),E)):(t.let(x,!1),E()),e.result(x,()=>e.reset())}};t.default=b},6470(e,t,n){"use strict";var s,i=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;const r=n(6772),o=n(8584),a=n(266),l={message:"boolean schema is false"};function c(e,t){const{gen:n,data:s}=e,i={gen:n,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,r.reportError)(i,l,void 0,t)}t.topBoolOrEmptySchema=function(e){const{gen:t,schema:n,validateName:r}=e;!1===n?c(e,!1):"object"==typeof n&&!0===n.$async?t.return(a.default.data):(t.assign((0,o._)(s||(s=i(["",".errors"])),r),null),t.return(!0))},t.boolOrEmptySchema=function(e,t){const{gen:n,schema:s}=e;!1===s?(n.var(t,!1),c(e)):n.var(t,!0)}},6480(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b,y,_=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const w=n(9273),x=n(8584),E=n(8396),S=n(2979),A={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:e=>{let{params:{i:t,j:n}}=e;return(0,x.str)(s||(s=_(["must NOT have duplicate items (items ## "," and "," are identical)"])),n,t)},params:e=>{let{params:{i:t,j:n}}=e;return(0,x._)(i||(i=_(["{i: ",", j: ","}"])),t,n)}},code(e){const{gen:t,data:n,$data:s,schema:i,parentSchema:A,schemaCode:C,it:k}=e;if(!s&&!i)return;const T=t.let("valid"),N=A.items?(0,w.getSchemaTypes)(A.items):[];function I(s,i){const r=t.name("item"),o=(0,w.checkDataTypes)(N,r,k.opts.strictNumbers,w.DataType.Wrong),a=t.const("indices",(0,x._)(l||(l=_(["{}"]))));t.for((0,x._)(c||(c=_([";","--;"])),s),()=>{t.let(r,(0,x._)(d||(d=_(["","[","]"])),n,s)),t.if(o,(0,x._)(u||(u=_(["continue"])))),N.length>1&&t.if((0,x._)(h||(h=_(["typeof ",' == "string"'])),r),(0,x._)(p||(p=_(["",' += "_"'])),r)),t.if((0,x._)(f||(f=_(["typeof ","[",'] == "number"'])),a,r),()=>{t.assign(i,(0,x._)(m||(m=_(["","[","]"])),a,r)),e.error(),t.assign(T,!1).break()}).code((0,x._)(g||(g=_(["","[","] = ",""])),a,r,s))})}function P(s,i){const r=(0,E.useFunc)(t,S.default),o=t.name("outer");t.label(o).for((0,x._)(v||(v=_([";","--;"])),s),()=>t.for((0,x._)(b||(b=_([""," = ","; ","--;"])),i,s,i),()=>t.if((0,x._)(y||(y=_(["","(","[","], ","[","])"])),r,n,s,n,i),()=>{e.error(),t.assign(T,!1).break(o)})))}e.block$data(T,function(){const s=t.let("i",(0,x._)(o||(o=_(["",".length"])),n)),i=t.let("j");e.setParams({i:s,j:i}),t.assign(T,!0),t.if((0,x._)(a||(a=_([""," > 1"])),s),()=>(N.length>0&&!N.some(e=>"object"===e||"array"===e)?I:P)(s,i))},(0,x._)(r||(r=_([""," === false"])),C)),e.ok(T)}};t.default=A},6623(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=a.operators,c={maximum:{okStr:"<=",ok:l.LTE,fail:l.GT},minimum:{okStr:">=",ok:l.GTE,fail:l.LT},exclusiveMaximum:{okStr:"<",ok:l.LT,fail:l.GTE},exclusiveMinimum:{okStr:">",ok:l.GT,fail:l.LTE}},d={message:e=>{let{keyword:t,schemaCode:n}=e;return(0,a.str)(s||(s=o(["must be "," ",""])),c[t].okStr,n)},params:e=>{let{keyword:t,schemaCode:n}=e;return(0,a._)(i||(i=o(["{comparison: ",", limit: ","}"])),c[t].okStr,n)}},u={keyword:Object.keys(c),type:"number",schemaType:"number",$data:!0,error:d,code(e){const{keyword:t,data:n,schemaCode:s}=e;e.fail$data((0,a._)(r||(r=o([""," "," "," || isNaN(",")"])),n,c[t].fail,s,n))}};t.default=u},6677(e){"use strict";e.exports=async(e,t)=>{e.postMessage(t)}},6706(e){"use strict";e.exports={workerBlobURL:!0,logger:()=>{}}},6740(e,t,n){"use strict";var s,i,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const l=n(8584),c=n(8396),d=n(2979),u={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:e=>{let{schemaCode:t}=e;return(0,l._)(s||(s=a(["{allowedValues: ","}"])),t)}},code(e){const{gen:t,data:n,$data:s,schema:u,schemaCode:h,it:p}=e;if(!s&&0===u.length)throw new Error("enum must have non-empty array");const f=u.length>=p.opts.loopEnum;let m;const g=()=>null!==m&&void 0!==m?m:m=(0,c.useFunc)(t,d.default);let v;if(f||s)v=t.let("valid"),e.block$data(v,function(){t.assign(v,!1),t.forOf("v",h,e=>t.if((0,l._)(i||(i=a(["","(",", ",")"])),g(),n,e),()=>t.assign(v,!0).break()))});else{if(!Array.isArray(u))throw new Error("ajv implementation error");const e=t.const("vSchema",h);v=(0,l.or)(...u.map((t,s)=>function(e,t){const s=u[t];return"object"===typeof s&&null!==s?(0,l._)(r||(r=a(["","(",", ","[","])"])),g(),n,e,t):(0,l._)(o||(o=a([""," === ",""])),n,s)}(e,s)))}e.pass(v)}};t.default=u},6754(e,t){"use strict";function n(e){const t=e.length;let n,s=0,i=0;for(;i<t;)s++,n=e.charCodeAt(i++),n>=55296&&n<=56319&&i<t&&(n=e.charCodeAt(i),56320===(64512&n)&&i++);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,n.code='require("ajv/dist/runtime/ucs2length").default'},6772(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b,y,_,w,x,E,S,A,C,k,T=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const N=n(8584),I=n(8396),P=n(266);function R(e,t){const n=e.const("err",t);e.if((0,N._)(g||(g=T([""," === null"])),P.default.vErrors),()=>e.assign(P.default.vErrors,(0,N._)(v||(v=T(["[","]"])),n)),(0,N._)(b||(b=T(["",".push(",")"])),P.default.vErrors,n)),e.code((0,N._)(y||(y=T(["","++"])),P.default.errors))}function M(e,t){const{gen:n,validateName:s,schemaEnv:i}=e;i.$async?n.throw((0,N._)(_||(_=T(["new ","(",")"])),e.ValidationError,t)):(n.assign((0,N._)(w||(w=T(["",".errors"])),s),t),n.return(!1))}t.keywordError={message:e=>{let{keyword:t}=e;return(0,N.str)(s||(s=T(['must pass "','" keyword validation'])),t)}},t.keyword$DataError={message:e=>{let{keyword:t,schemaType:n}=e;return n?(0,N.str)(i||(i=T(['"','" keyword must be '," ($data)"])),t,n):(0,N.str)(r||(r=T(['"','" keyword is invalid ($data)'])),t)}},t.reportError=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.keywordError,s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;const{it:r}=e,{gen:a,compositeRule:l,allErrors:c}=r,d=D(e,n,s);(null!==i&&void 0!==i?i:l||c)?R(a,d):M(r,(0,N._)(o||(o=T(["[","]"])),d))},t.reportExtraError=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.keywordError,s=arguments.length>2?arguments[2]:void 0;const{it:i}=e,{gen:r,compositeRule:o,allErrors:a}=i;R(r,D(e,n,s)),o||a||M(i,P.default.vErrors)},t.resetErrorsCount=function(e,t){e.assign(P.default.errors,t),e.if((0,N._)(a||(a=T([""," !== null"])),P.default.vErrors),()=>e.if(t,()=>e.assign((0,N._)(l||(l=T(["",".length"])),P.default.vErrors),t),()=>e.assign(P.default.vErrors,null)))},t.extendErrors=function(e){let{gen:t,keyword:n,schemaValue:s,data:i,errsCount:r,it:o}=e;if(void 0===r)throw new Error("ajv implementation error");const a=t.name("err");t.forRange("i",r,P.default.errors,e=>{t.const(a,(0,N._)(c||(c=T(["","[","]"])),P.default.vErrors,e)),t.if((0,N._)(d||(d=T(["",".instancePath === undefined"])),a),()=>t.assign((0,N._)(u||(u=T(["",".instancePath"])),a),(0,N.strConcat)(P.default.instancePath,o.errorPath))),t.assign((0,N._)(h||(h=T(["",".schemaPath"])),a),(0,N.str)(p||(p=T(["","/",""])),o.errSchemaPath,n)),o.opts.verbose&&(t.assign((0,N._)(f||(f=T(["",".schema"])),a),s),t.assign((0,N._)(m||(m=T(["",".data"])),a),i))})};const O={keyword:new N.Name("keyword"),schemaPath:new N.Name("schemaPath"),params:new N.Name("params"),propertyName:new N.Name("propertyName"),message:new N.Name("message"),schema:new N.Name("schema"),parentSchema:new N.Name("parentSchema")};function D(e,t,n){const{createErrors:s}=e.it;return!1===s?(0,N._)(x||(x=T(["{}"]))):function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{gen:s,it:i}=e,r=[j(i,n),F(e,n)];return function(e,t,n){let{params:s,message:i}=t;const{keyword:r,data:o,schemaValue:a,it:l}=e,{opts:c,propertyName:d,topSchemaRef:u,schemaPath:h}=l;n.push([O.keyword,r],[O.params,"function"==typeof s?s(e):s||(0,N._)(C||(C=T(["{}"])))]),c.messages&&n.push([O.message,"function"==typeof i?i(e):i]);c.verbose&&n.push([O.schema,a],[O.parentSchema,(0,N._)(k||(k=T(["","",""])),u,h)],[P.default.data,o]);d&&n.push([O.propertyName,d])}(e,t,r),s.object(...r)}(e,t,n)}function j(e,t){let{errorPath:n}=e,{instancePath:s}=t;const i=s?(0,N.str)(E||(E=T(["","",""])),n,(0,I.getErrorPath)(s,I.Type.Str)):n;return[P.default.instancePath,(0,N.strConcat)(P.default.instancePath,i)]}function F(e,t){let{keyword:n,it:{errSchemaPath:s}}=e,{schemaPath:i,parentSchema:r}=t,o=r?s:(0,N.str)(S||(S=T(["","/",""])),s,n);return i&&(o=(0,N.str)(A||(A=T(["","",""])),o,(0,I.getErrorPath)(i,I.Type.Str))),[O.schemaPath,o]}},6817(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}t.default=n},7003(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const s=n(9281),i=n(9497),r=n(138),o=n(2079),a=["/properties"],l="http://json-schema.org/draft-07/schema";class c extends s.default{_addVocabularies(){super._addVocabularies(),i.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(r.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,a):o;this.addMetaSchema(e,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var d=n(5413);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return d.KeywordCxt}});var u=n(8584);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var h=n(6817);Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return h.default}});var p=n(9550);Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return p.default}})},7092(e){"use strict";e.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}},7234(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var s=n-1>>>1,i=e[s];if(!(0<r(i,t)))break e;e[s]=t,e[n]=i,n=s}}function s(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var s=0,i=e.length,o=i>>>1;s<o;){var a=2*(s+1)-1,l=e[a],c=a+1,d=e[c];if(0>r(l,n))c<i&&0>r(d,l)?(e[s]=d,e[c]=n,s=c):(e[s]=l,e[a]=n,s=a);else{if(!(c<i&&0>r(d,n)))break e;e[s]=d,e[c]=n,s=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=s(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,n(c,t)}t=s(d)}}function w(e){if(g=!1,_(e),!m)if(null!==s(c))m=!0,M(x);else{var t=s(d);null!==t&&O(w,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,b(C),C=-1),f=!0;var r=p;try{for(_(n),h=s(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===s(c)&&i(c),_(n)}else i(c);h=s(c)}if(null!==h)var l=!0;else{var u=s(d);null!==u&&O(w,u.startTime-n),l=!1}return l}finally{h=null,p=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,A=null,C=-1,k=5,T=-1;function N(){return!(t.unstable_now()-T<k)}function I(){if(null!==A){var e=t.unstable_now();T=e;var n=!0;try{n=A(!0,e)}finally{n?E():(S=!1,A=null)}}else S=!1}if("function"===typeof y)E=function(){y(I)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,R=P.port2;P.port1.onmessage=I,E=function(){R.postMessage(null)}}else E=function(){v(I,0)};function M(e){A=e,S||(S=!0,E())}function O(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,M(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return s(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,r){var o=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?o+r:o:r=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>o?(e.sortIndex=r,n(d,e),null===s(c)&&e===s(d)&&(g?(b(C),C=-1):g=!0,O(w,r-o))):(e.sortIndex=a,n(c,e),m||f||(m=!0,M(x))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7352(e,t,n){"use strict";var s,i,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const c=n(8584),d={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:e=>{let{schemaCode:t}=e;return(0,c.str)(s||(s=l(["must be multiple of ",""])),t)},params:e=>{let{schemaCode:t}=e;return(0,c._)(i||(i=l(["{multipleOf: ","}"])),t)}},code(e){const{gen:t,data:n,schemaCode:s,it:i}=e,d=i.opts.multipleOfPrecision,u=t.let("res"),h=d?(0,c._)(r||(r=l(["Math.abs(Math.round(",") - ",") > 1e-",""])),u,u,d):(0,c._)(o||(o=l([""," !== parseInt(",")"])),u,u);e.fail$data((0,c._)(a||(a=l(["("," === 0 || ("," = ","/",", ","))"])),s,u,n,s,h))}};t.default=d},7599(e,t,n){"use strict";var s=n(2897).default;const i="browser"===n(1734)("type")?e=>new URL(e,window.location.href).href:e=>e;e.exports=e=>{const t=s({},e);return["corePath","workerPath","langPath"].forEach(n=>{e[n]&&(t[n]=i(t[n]))}),t}},7736(e,t,n){var s=n(3738).default,i=n(9045);e.exports=function(e){var t=i(e,"string");return"symbol"==s(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7864(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const h=n(7003),p=n(8584),f=p.operators,m={formatMaximum:{okStr:"<=",ok:f.LTE,fail:f.GT},formatMinimum:{okStr:">=",ok:f.GTE,fail:f.LT},formatExclusiveMaximum:{okStr:"<",ok:f.LT,fail:f.GTE},formatExclusiveMinimum:{okStr:">",ok:f.GT,fail:f.LTE}},g={message:e=>{let{keyword:t,schemaCode:n}=e;return p.str(s||(s=u(["should be "," ",""])),m[t].okStr,n)},params:e=>{let{keyword:t,schemaCode:n}=e;return p._(i||(i=u(["{comparison: ",", limit: ","}"])),m[t].okStr,n)}};t.formatLimitDefinition={keyword:Object.keys(m),type:"string",schemaType:"string",$data:!0,error:g,code(e){const{gen:t,data:n,schemaCode:s,keyword:i,it:f}=e,{opts:g,self:v}=f;if(!g.validateFormats)return;const b=new h.KeywordCxt(f,v.RULES.all.format.definition,"format");function y(e){return p._(d||(d=u(["",".compare(",", ",") "," 0"])),e,n,s,m[i].fail)}b.$data?function(){const n=t.scopeValue("formats",{ref:v.formats,code:g.code.formats}),s=t.const("fmt",p._(r||(r=u(["","[","]"])),n,b.schemaCode));e.fail$data(p.or(p._(o||(o=u(["typeof ",' != "object"'])),s),p._(a||(a=u([""," instanceof RegExp"])),s),p._(l||(l=u(["typeof ",'.compare != "function"'])),s),y(s)))}():function(){const n=b.schema,s=v.formats[n];if(!s||!0===s)return;if("object"!=typeof s||s instanceof RegExp||"function"!=typeof s.compare)throw new Error('"'.concat(i,'": format "').concat(n,'" does not define "compare" function'));const r=t.scopeValue("formats",{key:n,ref:s,code:g.code.formats?p._(c||(c=u(["","",""])),g.code.formats,p.getProperty(n)):void 0});e.fail$data(y(r))}()},dependencies:["format"]};t.default=e=>(e.addKeyword(t.formatLimitDefinition),e)},7950(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},7968(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;const p=n(9550),f=n(656),m=n(8584),g=n(266),v=n(1762),b=n(8396),y={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:i}=e,{baseId:r,schemaEnv:o,validateName:a,opts:l,self:c}=i,{root:d}=o;if(("#"===n||"#/"===n)&&r===d.baseId)return function(){if(o===d)return w(e,a,o,o.$async);const n=t.scopeValue("root",{ref:d});return w(e,(0,m._)(s||(s=h(["",".validate"])),n),d,d.$async)}();const u=v.resolveRef.call(c,d,r,n);if(void 0===u)throw new p.default(i.opts.uriResolver,r,n);return u instanceof v.SchemaEnv?function(t){const n=_(e,t);w(e,n,t,t.$async)}(u):function(s){const i=t.scopeValue("schema",!0===l.code.source?{ref:s,code:(0,m.stringify)(s)}:{ref:s}),r=t.name("valid"),o=e.subschema({schema:s,dataTypes:[],schemaPath:m.nil,topSchemaRef:i,errSchemaPath:n},r);e.mergeEvaluated(o),e.ok(r)}(u)}};function _(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0,m._)(i||(i=h(["",".validate"])),n.scopeValue("wrapper",{ref:t}))}function w(e,t,n,s){const{gen:i,it:p}=e,{allErrors:v,schemaEnv:y,opts:_}=p,w=_.passContext?g.default.this:m.nil;function x(e){const t=(0,m._)(a||(a=h(["",".errors"])),e);i.assign(g.default.vErrors,(0,m._)(l||(l=h([""," === null ? "," : ",".concat(",")"])),g.default.vErrors,t,g.default.vErrors,t)),i.assign(g.default.errors,(0,m._)(c||(c=h(["",".length"])),g.default.vErrors))}function E(e){var t;if(!p.opts.unevaluated)return;const s=null===(t=null===n||void 0===n?void 0:n.validate)||void 0===t?void 0:t.evaluated;if(!0!==p.props)if(s&&!s.dynamicProps)void 0!==s.props&&(p.props=b.mergeEvaluated.props(i,s.props,p.props));else{const t=i.var("props",(0,m._)(d||(d=h(["",".evaluated.props"])),e));p.props=b.mergeEvaluated.props(i,t,p.props,m.Name)}if(!0!==p.items)if(s&&!s.dynamicItems)void 0!==s.items&&(p.items=b.mergeEvaluated.items(i,s.items,p.items));else{const t=i.var("items",(0,m._)(u||(u=h(["",".evaluated.items"])),e));p.items=b.mergeEvaluated.items(i,t,p.items,m.Name)}}s?function(){if(!y.$async)throw new Error("async schema referenced by sync schema");const n=i.let("valid");i.try(()=>{i.code((0,m._)(r||(r=h(["await ",""])),(0,f.callValidateCode)(e,t,w))),E(t),v||i.assign(n,!0)},e=>{i.if((0,m._)(o||(o=h(["!("," instanceof ",")"])),e,p.ValidationError),()=>i.throw(e)),x(e),v||i.assign(n,!1)}),e.ok(n)}():e.result((0,f.callValidateCode)(e,t,w),()=>E(t),()=>x(t))}t.getValidate=_,t.callRef=w,t.default=y},8211(e,t,n){"use strict";var s,i,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message(e){let{keyword:t,schemaCode:n}=e;const i="maxProperties"===t?"more":"fewer";return(0,a.str)(s||(s=o(["must NOT have "," than "," properties"])),i,n)},params:e=>{let{schemaCode:t}=e;return(0,a._)(i||(i=o(["{limit: ","}"])),t)}},code(e){const{keyword:t,data:n,schemaCode:s}=e,i="maxProperties"===t?a.operators.GT:a.operators.LT;e.fail$data((0,a._)(r||(r=o(["Object.keys(",").length "," ",""])),n,i,s))}};t.default=l},8218(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(8396),i={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:i}=e;if((0,s.alwaysValidSchema)(i,n))return void e.fail();const r=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},r),e.failResult(r,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};t.default=i},8396(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b,y,_,w=n(2897).default,x=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const E=n(8584),S=n(5467);function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema;const{opts:n,self:s}=e;if(!n.strictSchema)return;if("boolean"===typeof t)return;const i=s.RULES.keywords;for(const r in t)i[r]||O(e,'unknown keyword: "'.concat(r,'"'))}function C(e,t){if("boolean"==typeof e)return!e;for(const n in e)if(t[n])return!0;return!1}function k(e){return"number"==typeof e?"".concat(e):e.replace(/~/g,"~0").replace(/\//g,"~1")}function T(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function N(e){let{mergeNames:t,mergeToName:n,mergeValues:s,resultToName:i}=e;return(e,r,o,a)=>{const l=void 0===o?r:o instanceof E.Name?(r instanceof E.Name?t(e,r,o):n(e,r,o),o):r instanceof E.Name?(n(e,o,r),r):s(r,o);return a!==E.Name||l instanceof E.Name?l:i(e,l)}}function I(e,t){if(!0===t)return e.var("props",!0);const n=e.var("props",(0,E._)(m||(m=x(["{}"]))));return void 0!==t&&P(e,n,t),n}function P(e,t,n){Object.keys(n).forEach(n=>e.assign((0,E._)(g||(g=x(["","",""])),t,(0,E.getProperty)(n)),!0))}t.toHash=function(e){const t={};for(const n of e)t[n]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(A(e,t),!C(t,e.self.RULES.all))},t.checkUnknownRules=A,t.schemaHasRules=C,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const n in e)if("$ref"!==n&&t.all[n])return!0;return!1},t.schemaRefOrVal=function(e,t,n,r){let{topSchemaRef:o,schemaPath:a}=e;if(!r){if("number"==typeof t||"boolean"==typeof t)return t;if("string"==typeof t)return(0,E._)(s||(s=x(["",""])),t)}return(0,E._)(i||(i=x(["","","",""])),o,a,(0,E.getProperty)(n))},t.unescapeFragment=function(e){return T(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(k(e))},t.escapeJsonPointer=k,t.unescapeJsonPointer=T,t.eachItem=function(e,t){if(Array.isArray(e))for(const n of e)t(n);else t(e)},t.mergeEvaluated={props:N({mergeNames:(e,t,n)=>e.if((0,E._)(r||(r=x([""," !== true && "," !== undefined"])),n,t),()=>{e.if((0,E._)(o||(o=x([""," === true"])),t),()=>e.assign(n,!0),()=>e.assign(n,(0,E._)(a||(a=x([""," || {}"])),n)).code((0,E._)(l||(l=x(["Object.assign(",", ",")"])),n,t)))}),mergeToName:(e,t,n)=>e.if((0,E._)(c||(c=x([""," !== true"])),n),()=>{!0===t?e.assign(n,!0):(e.assign(n,(0,E._)(d||(d=x([""," || {}"])),n)),P(e,n,t))}),mergeValues:(e,t)=>!0===e||w(w({},e),t),resultToName:I}),items:N({mergeNames:(e,t,n)=>e.if((0,E._)(u||(u=x([""," !== true && "," !== undefined"])),n,t),()=>e.assign(n,(0,E._)(h||(h=x([""," === true ? true : "," > "," ? "," : ",""])),t,n,t,n,t))),mergeToName:(e,t,n)=>e.if((0,E._)(p||(p=x([""," !== true"])),n),()=>e.assign(n,!0===t||(0,E._)(f||(f=x([""," > "," ? "," : ",""])),n,t,n,t))),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=I,t.setEvaluated=P;const R={};var M;function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.opts.strictSchema;if(n){if(t="strict mode: ".concat(t),!0===n)throw new Error(t);e.self.logger.warn(t)}}t.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:R[t.code]||(R[t.code]=new S._Code(t.code))})},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(M||(t.Type=M={})),t.getErrorPath=function(e,t,n){if(e instanceof E.Name){const s=t===M.Num;return n?s?(0,E._)(v||(v=x(['"[" + ',' + "]"'])),e):(0,E._)(b||(b=x(['"[\'" + ',' + "\']"'])),e):s?(0,E._)(y||(y=x(['"/" + ',""])),e):(0,E._)(_||(_=x(['"/" + ','.replace(/~/g, "~0").replace(/\\//g, "~1")'],['"/" + ','.replace(/~/g, "~0").replace(/\\\\//g, "~1")'])),e)}return n?(0,E.getProperty)(e).toString():"/"+k(e)},t.checkStrictMode=O},8584(e,t,n){"use strict";var s,i,r,o,a,l,c=n(166).default,d=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const u=n(5467),h=n(5280);var p=n(5467);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return p._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return p.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return p.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return p.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return p.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return p.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return p.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return p.Name}});var f=n(5280);Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return f.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return f.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return f.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return f.varKinds}}),t.operators={GT:new u._Code(">"),GTE:new u._Code(">="),LT:new u._Code("<"),LTE:new u._Code("<="),EQ:new u._Code("==="),NEQ:new u._Code("!=="),NOT:new u._Code("!"),OR:new u._Code("||"),AND:new u._Code("&&"),ADD:new u._Code("+")};class m{optimizeNodes(){return this}optimizeNames(e,t){return this}}class g extends m{constructor(e,t,n){super(),this.varKind=e,this.name=t,this.rhs=n}render(e){let{es5:t,_n:n}=e;const s=t?h.varKinds.var:this.varKind,i=void 0===this.rhs?"":" = ".concat(this.rhs);return"".concat(s," ").concat(this.name).concat(i,";")+n}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=U(this.rhs,e,t)),this}get names(){return this.rhs instanceof u._CodeOrName?this.rhs.names:{}}}class v extends m{constructor(e,t,n){super(),this.lhs=e,this.rhs=t,this.sideEffects=n}render(e){let{_n:t}=e;return"".concat(this.lhs," = ").concat(this.rhs,";")+t}optimizeNames(e,t){if(!(this.lhs instanceof u.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=U(this.rhs,e,t),this}get names(){return L(this.lhs instanceof u.Name?{}:d({},this.lhs.names),this.rhs)}}class b extends v{constructor(e,t,n,s){super(e,n,s),this.op=t}render(e){let{_n:t}=e;return"".concat(this.lhs," ").concat(this.op,"= ").concat(this.rhs,";")+t}}class y extends m{constructor(e){super(),this.label=e,this.names={}}render(e){let{_n:t}=e;return"".concat(this.label,":")+t}}class _ extends m{constructor(e){super(),this.label=e,this.names={}}render(e){let{_n:t}=e;const n=this.label?" ".concat(this.label):"";return"break".concat(n,";")+t}}class w extends m{constructor(e){super(),this.error=e}render(e){let{_n:t}=e;return"throw ".concat(this.error,";")+t}get names(){return this.error.names}}class x extends m{constructor(e){super(),this.code=e}render(e){let{_n:t}=e;return"".concat(this.code,";")+t}optimizeNodes(){return"".concat(this.code)?this:void 0}optimizeNames(e,t){return this.code=U(this.code,e,t),this}get names(){return this.code instanceof u._CodeOrName?this.code.names:{}}}class E extends m{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.nodes=e}render(e){return this.nodes.reduce((t,n)=>t+n.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const n=e[t].optimizeNodes();Array.isArray(n)?e.splice(t,1,...n):n?e[t]=n:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:n}=this;let s=n.length;for(;s--;){const i=n[s];i.optimizeNames(e,t)||(B(e,i.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>F(e,t.names),{})}}class S extends E{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class A extends E{}class C extends S{}C.kind="else";class k extends S{constructor(e,t){super(t),this.condition=e}render(e){let t="if(".concat(this.condition,")")+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new C(e):e}return t?!1===e?t instanceof k?t:t.nodes:this.nodes.length?this:new k(V(e),t instanceof k?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var n;if(this.else=null===(n=this.else)||void 0===n?void 0:n.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=U(this.condition,e,t),this}get names(){const e=super.names;return L(e,this.condition),this.else&&F(e,this.else.names),e}}k.kind="if";class T extends S{}T.kind="for";class N extends T{constructor(e){super(),this.iteration=e}render(e){return"for(".concat(this.iteration,")")+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=U(this.iteration,e,t),this}get names(){return F(super.names,this.iteration.names)}}class I extends T{constructor(e,t,n,s){super(),this.varKind=e,this.name=t,this.from=n,this.to=s}render(e){const t=e.es5?h.varKinds.var:this.varKind,{name:n,from:s,to:i}=this;return"for(".concat(t," ").concat(n,"=").concat(s,"; ").concat(n,"<").concat(i,"; ").concat(n,"++)")+super.render(e)}get names(){const e=L(super.names,this.from);return L(e,this.to)}}class P extends T{constructor(e,t,n,s){super(),this.loop=e,this.varKind=t,this.name=n,this.iterable=s}render(e){return"for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=U(this.iterable,e,t),this}get names(){return F(super.names,this.iterable.names)}}class R extends S{constructor(e,t,n){super(),this.name=e,this.args=t,this.async=n}render(e){const t=this.async?"async ":"";return"".concat(t,"function ").concat(this.name,"(").concat(this.args,")")+super.render(e)}}R.kind="func";class M extends E{render(e){return"return "+super.render(e)}}M.kind="return";class O extends S{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var n,s;return super.optimizeNames(e,t),null===(n=this.catch)||void 0===n||n.optimizeNames(e,t),null===(s=this.finally)||void 0===s||s.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&F(e,this.catch.names),this.finally&&F(e,this.finally.names),e}}class D extends S{constructor(e){super(),this.error=e}render(e){return"catch(".concat(this.error,")")+super.render(e)}}D.kind="catch";class j extends S{render(e){return"finally"+super.render(e)}}j.kind="finally";function F(e,t){for(const n in t)e[n]=(e[n]||0)+(t[n]||0);return e}function L(e,t){return t instanceof u._CodeOrName?F(e,t.names):e}function U(e,t,n){return e instanceof u.Name?i(e):(s=e)instanceof u._Code&&s._items.some(e=>e instanceof u.Name&&1===t[e.str]&&void 0!==n[e.str])?new u._Code(e._items.reduce((e,t)=>(t instanceof u.Name&&(t=i(t)),t instanceof u._Code?e.push(...t._items):e.push(t),e),[])):e;var s;function i(e){const s=n[e.str];return void 0===s||1!==t[e.str]?e:(delete t[e.str],s)}}function B(e,t){for(const n in t)e[n]=(e[n]||0)-(t[n]||0)}function V(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:(0,u._)(o||(o=c(["!",""])),z(e))}t.CodeGen=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._values={},this._blockStarts=[],this._constants={},this.opts=d(d({},t),{},{_n:t.lines?"\n":""}),this._extScope=e,this._scope=new h.Scope({parent:e}),this._nodes=[new A]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const n=this._extScope.value(e,t);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,n,s){const i=this._scope.toName(t);return void 0!==n&&s&&(this._constants[i.str]=n),this._leafNode(new g(e,i,n)),i}const(e,t,n){return this._def(h.varKinds.const,e,t,n)}let(e,t,n){return this._def(h.varKinds.let,e,t,n)}var(e,t,n){return this._def(h.varKinds.var,e,t,n)}assign(e,t,n){return this._leafNode(new v(e,t,n))}add(e,n){return this._leafNode(new b(e,t.operators.ADD,n))}code(e){return"function"==typeof e?e():e!==u.nil&&this._leafNode(new x(e)),this}object(){const e=["{"];for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];for(const[i,r]of n)e.length>1&&e.push(","),e.push(i),(i!==r||this.opts.es5)&&(e.push(":"),(0,u.addCodeArg)(e,r));return e.push("}"),new u._Code(e)}if(e,t,n){if(this._blockNode(new k(e)),t&&n)this.code(t).else().code(n).endIf();else if(t)this.code(t).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new k(e))}else(){return this._elseNode(new C)}endIf(){return this._endBlockNode(k,C)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new N(e),t)}forRange(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.es5?h.varKinds.var:h.varKinds.let;const r=this._scope.toName(e);return this._for(new I(i,r,t,n),()=>s(r))}forOf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.varKinds.const;const o=this._scope.toName(e);if(this.opts.es5){const e=t instanceof u.Name?t:this.var("_arr",t);return this.forRange("_i",0,(0,u._)(s||(s=c(["",".length"])),e),t=>{this.var(o,(0,u._)(i||(i=c(["","[","]"])),e,t)),n(o)})}return this._for(new P("of",r,o,t),()=>n(o))}forIn(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.es5?h.varKinds.var:h.varKinds.const;if(this.opts.ownProperties)return this.forOf(e,(0,u._)(r||(r=c(["Object.keys(",")"])),t),n);const i=this._scope.toName(e);return this._for(new P("in",s,i,t),()=>n(i))}endFor(){return this._endBlockNode(T)}label(e){return this._leafNode(new y(e))}break(e){return this._leafNode(new _(e))}return(e){const t=new M;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(M)}try(e,t,n){if(!t&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');const s=new O;if(this._blockNode(s),this.code(e),t){const e=this.name("e");this._currNode=s.catch=new D(e),t(e)}return n&&(this._currNode=s.finally=new j,this.code(n)),this._endBlockNode(D,j)}throw(e){return this._leafNode(new w(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const n=this._nodes.length-t;if(n<0||void 0!==e&&n!==e)throw new Error("CodeGen: wrong number of nodes: ".concat(n," vs ").concat(e," expected"));return this._nodes.length=t,this}func(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.nil,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return this._blockNode(new R(e,t,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(R)}optimize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const n=this._currNode;if(n instanceof e||t&&n instanceof t)return this._nodes.pop(),this;throw new Error('CodeGen: not in block "'.concat(t?"".concat(e.kind,"/").concat(t.kind):e.kind,'"'))}_elseNode(e){const t=this._currNode;if(!(t instanceof k))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},t.not=V;const W=q(t.operators.AND);t.and=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(W)};const H=q(t.operators.OR);function q(e){return(t,n)=>t===u.nil?n:n===u.nil?t:(0,u._)(a||(a=c([""," "," ",""])),z(t),e,z(n))}function z(e){return e instanceof u.Name?e:(0,u._)(l||(l=c(["(",")"])),e)}t.or=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(H)}},8617(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(3740),i=n(7968),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",s.default,i.default];t.default=r},8853(e,t,n){"use strict";e.exports=n(7234)},9045(e,t,n){var s=n(3738).default;e.exports=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9142(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;const f=n(8584),m=n(266),g=n(656),v=n(6772);function b(e){const{gen:t,data:n,it:s}=e;t.if(s.parentData,()=>t.assign(n,(0,f._)(c||(c=p(["","[","]"])),s.parentData,s.parentDataProperty)))}function y(e,t,n){if(void 0===n)throw new Error('keyword "'.concat(t,'" failed to compile'));return e.scopeValue("keyword","function"==typeof n?{ref:n}:{ref:n,code:(0,f.stringify)(n)})}t.macroKeywordCode=function(e,t){const{gen:n,keyword:s,schema:i,parentSchema:r,it:o}=e,a=t.macro.call(o.self,i,r,o),l=y(n,s,a);!1!==o.opts.validateSchema&&o.self.validateSchema(a,!0);const c=n.name("valid");e.subschema({schema:a,schemaPath:f.nil,errSchemaPath:"".concat(o.errSchemaPath,"/").concat(s),topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))},t.funcKeywordCode=function(e,t){var n;const{gen:c,keyword:_,schema:w,parentSchema:x,$data:E,it:S}=e;!function(e,t){let{schemaEnv:n}=e;if(t.async&&!n.$async)throw new Error("async keyword in sync schema")}(S,t);const A=!E&&t.compile?t.compile.call(S.self,w,x,S):t.validate,C=y(c,_,A),k=c.let("valid");function T(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.async?(0,f._)(a||(a=p(["await "]))):f.nil;const s=S.opts.passContext?m.default.this:m.default.self,i=!("compile"in t&&!E||!1===t.schema);c.assign(k,(0,f._)(l||(l=p(["","",""])),n,(0,g.callValidateCode)(e,C,s,i)),t.modifying)}function N(e){var n;c.if((0,f.not)(null!==(n=t.valid)&&void 0!==n?n:k),e)}e.block$data(k,function(){if(!1===t.errors)T(),t.modifying&&b(e),N(()=>e.error());else{const n=t.async?function(){const e=c.let("ruleErrs",null);return c.try(()=>T((0,f._)(s||(s=p(["await "])))),t=>c.assign(k,!1).if((0,f._)(i||(i=p([""," instanceof ",""])),t,S.ValidationError),()=>c.assign(e,(0,f._)(r||(r=p(["",".errors"])),t)),()=>c.throw(t))),e}():function(){const e=(0,f._)(o||(o=p(["",".errors"])),C);return c.assign(e,null),T(f.nil),e}();t.modifying&&b(e),N(()=>function(e,t){const{gen:n}=e;n.if((0,f._)(d||(d=p(["Array.isArray(",")"])),t),()=>{n.assign(m.default.vErrors,(0,f._)(u||(u=p([""," === null ? "," : ",".concat(",")"])),m.default.vErrors,t,m.default.vErrors,t)).assign(m.default.errors,(0,f._)(h||(h=p(["",".length"])),m.default.vErrors)),(0,v.extendErrors)(e)},()=>e.error())}(e,n))}}),e.ok(null!==(n=t.valid)&&void 0!==n?n:k)},t.validSchemaType=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||n&&"undefined"==typeof e)},t.validateKeywordUsage=function(e,t,n){let{schema:s,opts:i,self:r,errSchemaPath:o}=e;if(Array.isArray(t.keyword)?!t.keyword.includes(n):t.keyword!==n)throw new Error("ajv implementation error");const a=t.dependencies;if(null===a||void 0===a?void 0:a.some(e=>!Object.prototype.hasOwnProperty.call(s,e)))throw new Error("parent schema must have dependencies of ".concat(n,": ").concat(a.join(",")));if(t.validateSchema){if(!t.validateSchema(s[n])){const e='keyword "'.concat(n,'" value is invalid at path "').concat(o,'": ')+r.errorsText(t.validateSchema.errors);if("log"!==i.validateSchema)throw new Error(e);r.logger.error(e)}}}},9207(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(n||(t.DiscrError=n={}))},9273(e,t,n){"use strict";var s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b,y,_,w,x,E,S,A,C,k,T,N,I,P,R,M,O,D,j=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const F=n(4445),L=n(2392),U=n(6772),B=n(8584),V=n(8396);var W;function H(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(F.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(W||(t.DataType=W={})),t.getSchemaTypes=function(e){const t=H(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=H,t.coerceAndCheckDataType=function(e,t){const{gen:n,data:A,opts:C}=e,k=function(e,t){return t?e.filter(e=>q.has(e)||"array"===t&&"array"===e):[]}(t,C.coerceTypes),T=t.length>0&&!(0===k.length&&1===t.length&&(0,L.schemaHasRulesForType)(e,t[0]));if(T){const T=G(t,A,C.strictNumbers,W.Wrong);n.if(T,()=>{k.length?function(e,t,n){const{gen:A,data:C,opts:k}=e,T=A.let("dataType",(0,B._)(s||(s=j(["typeof ",""])),C)),N=A.let("coerced",(0,B._)(i||(i=j(["undefined"]))));"array"===k.coerceTypes&&A.if((0,B._)(r||(r=j([""," == 'object' && Array.isArray(",") && ",".length == 1"])),T,C,C),()=>A.assign(C,(0,B._)(o||(o=j(["","[0]"])),C)).assign(T,(0,B._)(a||(a=j(["typeof ",""])),C)).if(G(t,C,k.strictNumbers),()=>A.assign(N,C)));A.if((0,B._)(l||(l=j([""," !== undefined"])),N));for(const s of n)(q.has(s)||"array"===s&&"array"===k.coerceTypes)&&I(s);function I(e){switch(e){case"string":return void A.elseIf((0,B._)(d||(d=j(["",' == "number" || ',' == "boolean"'])),T,T)).assign(N,(0,B._)(u||(u=j(['"" + ',""])),C)).elseIf((0,B._)(h||(h=j([""," === null"])),C)).assign(N,(0,B._)(p||(p=j(['""']))));case"number":return void A.elseIf((0,B._)(f||(f=j(["",' == "boolean" || '," === null\n              || (",' == "string" && '," && "," == +",")"])),T,C,T,C,C,C)).assign(N,(0,B._)(m||(m=j(["+",""])),C));case"integer":return void A.elseIf((0,B._)(g||(g=j(["",' === "boolean" || '," === null\n              || (",' === "string" && '," && "," == +"," && !("," % 1))"])),T,C,T,C,C,C,C)).assign(N,(0,B._)(v||(v=j(["+",""])),C));case"boolean":return void A.elseIf((0,B._)(b||(b=j(["",' === "false" || '," === 0 || "," === null"])),C,C,C)).assign(N,!1).elseIf((0,B._)(y||(y=j(["",' === "true" || '," === 1"])),C,C)).assign(N,!0);case"null":return A.elseIf((0,B._)(_||(_=j(["",' === "" || '," === 0 || "," === false"])),C,C,C)),void A.assign(N,null);case"array":A.elseIf((0,B._)(w||(w=j(["",' === "string" || ',' === "number"\n              || ',' === "boolean" || '," === null"])),T,T,T,C)).assign(N,(0,B._)(x||(x=j(["[","]"])),C))}}A.else(),J(e),A.endIf(),A.if((0,B._)(c||(c=j([""," !== undefined"])),N),()=>{A.assign(C,N),function(e,t){let{gen:n,parentData:s,parentDataProperty:i}=e;n.if((0,B._)(E||(E=j([""," !== undefined"])),s),()=>n.assign((0,B._)(S||(S=j(["","[","]"])),s,i),t))}(e,N)})}(e,t,k):J(e)})}return T};const q=new Set(["string","number","integer","boolean","null"]);function z(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:W.Correct;const i=s===W.Correct?B.operators.EQ:B.operators.NEQ;let r;switch(e){case"null":return(0,B._)(A||(A=j([""," "," null"])),t,i);case"array":r=(0,B._)(C||(C=j(["Array.isArray(",")"])),t);break;case"object":r=(0,B._)(k||(k=j([""," && typeof ",' == "object" && !Array.isArray(',")"])),t,t,t);break;case"integer":r=o((0,B._)(T||(T=j(["!("," % 1) && !isNaN(",")"])),t,t));break;case"number":r=o();break;default:return(0,B._)(N||(N=j(["typeof "," "," ",""])),t,i,e)}return s===W.Correct?r:(0,B.not)(r);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B.nil;return(0,B.and)((0,B._)(I||(I=j(["typeof ",' == "number"'])),t),e,n?(0,B._)(P||(P=j(["isFinite(",")"])),t):B.nil)}}function G(e,t,n,s){if(1===e.length)return z(e[0],t,n,s);let i;const r=(0,V.toHash)(e);if(r.array&&r.object){const e=(0,B._)(R||(R=j(["typeof ",' != "object"'])),t);i=r.null?e:(0,B._)(M||(M=j(["!"," || ",""])),t,e),delete r.null,delete r.array,delete r.object}else i=B.nil;r.number&&delete r.integer;for(const o in r)i=(0,B.and)(i,z(o,t,n,s));return i}t.checkDataType=z,t.checkDataTypes=G;const K={message:e=>{let{schema:t}=e;return"must be ".concat(t)},params:e=>{let{schema:t,schemaValue:n}=e;return"string"==typeof t?(0,B._)(O||(O=j(["{type: ","}"])),t):(0,B._)(D||(D=j(["{type: ","}"])),n)}};function J(e){const t=function(e){const{gen:t,data:n,schema:s}=e,i=(0,V.schemaRefOrVal)(e,s,"type");return{gen:t,keyword:"type",data:n,schema:s.type,schemaCode:i,schemaValue:i,parentSchema:s,params:{},it:e}}(e);(0,U.reportError)(t,K)}t.reportTypeError=J},9281(e,t,n){"use strict";var s=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var i=n(5413);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return i.KeywordCxt}});var r=n(8584);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const o=n(6817),a=n(9550),l=n(4445),c=n(1762),d=n(8584),u=n(2302),h=n(9273),p=n(8396),f=n(3837),m=n(4601),g=(e,t)=>new RegExp(e,t);g.code="new RegExp";const v=["removeAdditional","useDefaults","coerceTypes"],b=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),y={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},_={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};class w{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts=s(s({},e),function(e){var t,n,i,r,o,a,l,c,d,u,h,p,f,v,b,y,_,w,x,E,S,A,C,k,T;const N=e.strict,I=null===(t=e.code)||void 0===t?void 0:t.optimize,P=!0===I||void 0===I?1:I||0,R=null!==(i=null===(n=e.code)||void 0===n?void 0:n.regExp)&&void 0!==i?i:g,M=null!==(r=e.uriResolver)&&void 0!==r?r:m.default;return{strictSchema:null===(a=null!==(o=e.strictSchema)&&void 0!==o?o:N)||void 0===a||a,strictNumbers:null===(c=null!==(l=e.strictNumbers)&&void 0!==l?l:N)||void 0===c||c,strictTypes:null!==(u=null!==(d=e.strictTypes)&&void 0!==d?d:N)&&void 0!==u?u:"log",strictTuples:null!==(p=null!==(h=e.strictTuples)&&void 0!==h?h:N)&&void 0!==p?p:"log",strictRequired:null!==(v=null!==(f=e.strictRequired)&&void 0!==f?f:N)&&void 0!==v&&v,code:e.code?s(s({},e.code),{},{optimize:P,regExp:R}):{optimize:P,regExp:R},loopRequired:null!==(b=e.loopRequired)&&void 0!==b?b:200,loopEnum:null!==(y=e.loopEnum)&&void 0!==y?y:200,meta:null===(_=e.meta)||void 0===_||_,messages:null===(w=e.messages)||void 0===w||w,inlineRefs:null===(x=e.inlineRefs)||void 0===x||x,schemaId:null!==(E=e.schemaId)&&void 0!==E?E:"$id",addUsedSchema:null===(S=e.addUsedSchema)||void 0===S||S,validateSchema:null===(A=e.validateSchema)||void 0===A||A,validateFormats:null===(C=e.validateFormats)||void 0===C||C,unicodeRegExp:null===(k=e.unicodeRegExp)||void 0===k||k,int32range:null===(T=e.int32range)||void 0===T||T,uriResolver:M}}(e));const{es5:t,lines:n}=this.opts.code;this.scope=new d.ValueScope({scope:{},prefixes:b,es5:t,lines:n}),this.logger=function(e){if(!1===e)return T;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const i=e.validateFormats;e.validateFormats=!1,this.RULES=(0,l.getRules)(),x.call(this,y,e,"NOT SUPPORTED"),x.call(this,_,e,"DEPRECATED","warn"),this._metaOpts=k.call(this),e.formats&&A.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&C.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),S.call(this),e.validateFormats=i}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:n}=this.opts;let i=f;"id"===n&&(i=s({},f),i.id=i.$id,delete i.$id),t&&e&&this.addMetaSchema(i,i[n],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let n;if("string"==typeof e){if(n=this.getSchema(e),!n)throw new Error('no schema with key or ref "'.concat(e,'"'))}else n=this.compile(e);const s=n(t);return"$async"in n||(this.errors=n.errors),s}compile(e,t){const n=this._addSchema(e,t);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:n}=this.opts;return s.call(this,e,t);async function s(e,t){await i.call(this,e.$schema);const n=this._addSchema(e,t);return n.validate||r.call(this,n)}async function i(e){e&&!this.getSchema(e)&&await s.call(this,{$ref:e},!0)}async function r(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof a.default))throw t;return o.call(this,t),await l.call(this,t.missingSchema),r.call(this,e)}}function o(e){let{missingSchema:t,missingRef:n}=e;if(this.refs[t])throw new Error("AnySchema ".concat(t," is loaded but ").concat(n," cannot be resolved"))}async function l(e){const n=await c.call(this,e);this.refs[e]||await i.call(this,n.$schema),this.refs[e]||this.addSchema(n,e,t)}async function c(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=n(e))}finally{delete this._loading[e]}}}addSchema(e,t,n){let s,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema;if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,n,i);return this}if("object"===typeof e){const{schemaId:t}=this.opts;if(s=e[t],void 0!==s&&"string"!=typeof s)throw new Error("schema ".concat(t," must be string"))}return t=(0,u.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,n,t,i,!0),this}addMetaSchema(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.validateSchema;return this.addSchema(e,t,!0,n),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let n;if(n=e.$schema,void 0!==n&&"string"!=typeof n)throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const s=this.validate(n,e);if(!s&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return s}getSchema(e){let t;for(;"string"==typeof(t=E.call(this,e));)e=t;if(void 0===t){const{schemaId:n}=this.opts,s=new c.SchemaEnv({schema:{},schemaId:n});if(t=c.resolveSchema.call(this,s,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=E.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let n=e[this.opts.schemaId];return n&&(n=(0,u.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let n;if("string"==typeof e)n=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=n);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(n=(t=e).keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(I.call(this,n,t),!t)return(0,p.eachItem)(n,e=>P.call(this,e)),this;M.call(this,t);const i=s(s({},t),{},{type:(0,h.getJSONTypes)(t.type),schemaType:(0,h.getJSONTypes)(t.schemaType)});return(0,p.eachItem)(n,0===i.type.length?e=>P.call(this,e,i):e=>i.type.forEach(t=>P.call(this,e,i,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const n of t.rules){const t=n.rules.findIndex(t=>t.keyword===e);t>=0&&n.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.errors,{separator:t=", ",dataVar:n="data"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&0!==e.length?e.map(e=>"".concat(n).concat(e.instancePath," ").concat(e.message)).reduce((e,n)=>e+t+n):"No errors"}$dataMetaSchema(e,t){const n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const s of t){const t=s.split("/").slice(1);let i=e;for(const e of t)i=i[e];for(const e in n){const t=n[e];if("object"!=typeof t)continue;const{$data:s}=t.definition,r=i[e];s&&r&&(i[e]=D(r))}}return e}_removeAllSchemas(e,t){for(const n in e){const s=e[n];t&&!t.test(n)||("string"==typeof s?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,t,n){let s,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.addUsedSchema;const{schemaId:o}=this.opts;if("object"==typeof e)s=e[o];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let a=this._cache.get(e);if(void 0!==a)return a;n=(0,u.normalizeId)(s||n);const l=u.getSchemaRefs.call(this,e,n);return a=new c.SchemaEnv({schema:e,schemaId:o,meta:t,baseId:n,localRefs:l}),this._cache.set(a.schema,a),r&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=a),i&&this.validateSchema(e,!0),a}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error('schema with key or id "'.concat(e,'" already exists'))}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):c.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{c.compileSchema.call(this,e)}finally{this.opts=t}}}function x(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"error";for(const i in e){const r=i;r in t&&this.logger[s]("".concat(n,": option ").concat(i,". ").concat(e[r]))}}function E(e){return e=(0,u.normalizeId)(e),this.schemas[e]||this.refs[e]}function S(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function A(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function C(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const n=e[t];n.keyword||(n.keyword=t),this.addKeyword(n)}}}function k(){const e=s({},this.opts);for(const t of v)delete e[t];return e}w.ValidationError=o.default,w.MissingRefError=a.default,t.default=w;const T={log(){},warn(){},error(){}};const N=/^[a-z_$][a-z0-9_$:-]*$/i;function I(e,t){const{RULES:n}=this;if((0,p.eachItem)(e,e=>{if(n.keywords[e])throw new Error("Keyword ".concat(e," is already defined"));if(!N.test(e))throw new Error("Keyword ".concat(e," has invalid name"))}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function P(e,t,n){var i;const r=null===t||void 0===t?void 0:t.post;if(n&&r)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let a=r?o.post:o.rules.find(e=>{let{type:t}=e;return t===n});if(a||(a={type:n,rules:[]},o.rules.push(a)),o.keywords[e]=!0,!t)return;const l={keyword:e,definition:s(s({},t),{},{type:(0,h.getJSONTypes)(t.type),schemaType:(0,h.getJSONTypes)(t.schemaType)})};t.before?R.call(this,a,l,t.before):a.rules.push(l),o.all[e]=l,null===(i=t.implements)||void 0===i||i.forEach(e=>this.addKeyword(e))}function R(e,t,n){const s=e.rules.findIndex(e=>e.keyword===n);s>=0?e.rules.splice(s,0,t):(e.rules.push(t),this.logger.warn("rule ".concat(n," is not defined")))}function M(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=D(t)),e.validateSchema=this.compile(t,!0))}const O={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function D(e){return{anyOf:[e,O]}}},9294(e,t,n){"use strict";var s,i,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const c=n(8584),d=n(8396),u=n(6754),h={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message(e){let{keyword:t,schemaCode:n}=e;const i="maxLength"===t?"more":"fewer";return(0,c.str)(s||(s=l(["must NOT have "," than "," characters"])),i,n)},params:e=>{let{schemaCode:t}=e;return(0,c._)(i||(i=l(["{limit: ","}"])),t)}},code(e){const{keyword:t,data:n,schemaCode:s,it:i}=e,h="maxLength"===t?c.operators.GT:c.operators.LT,p=!1===i.opts.unicode?(0,c._)(r||(r=l(["",".length"])),n):(0,c._)(o||(o=l(["","(",")"])),(0,d.useFunc)(e.gen,u.default),n);e.fail$data((0,c._)(a||(a=l([""," "," ",""])),p,h,s))}};t.default=h},9343(e,t,n){"use strict";var s=n(2897).default,i=n(1847).default;const r=["logger","errorHandler"],o=n(7599),a=n(5362),{log:l}=n(5597),c=n(1674),d=n(1600),{defaultOptions:u,spawnWorker:h,terminateWorker:p,onMessage:f,loadImage:m,send:g}=n(3919);let v=0;e.exports=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eng",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.LSTM_ONLY,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const y=c("Worker",v),_=o(s(s({},u),n)),{logger:w,errorHandler:x}=_,E=i(_,r),S={},A="string"===typeof e?e.split("+"):e;let C=t,k=b;const T=[d.DEFAULT,d.LSTM_ONLY].includes(t)&&!E.legacyCore;let N,I;const P=new Promise((e,t)=>{I=e,N=t});let R=h(E);R.onerror=e=>{N(e.message)},v+=1;const M=e=>{let{id:t,action:n,payload:s}=e;return new Promise((e,i)=>{l("[".concat(y,"]: Start ").concat(t,", action=").concat(n));const r="".concat(n,"-").concat(t);S[r]={resolve:e,reject:i},g(R,{workerId:y,jobId:t,action:n,payload:s})})},O=(e,t)=>M(a({id:t,action:"loadLanguage",payload:{langs:e,options:{langPath:E.langPath,dataPath:E.dataPath,cachePath:E.cachePath,cacheMethod:E.cacheMethod,gzip:E.gzip,lstmOnly:[d.DEFAULT,d.LSTM_ONLY].includes(C)&&!E.legacyLang}}})),D=(e,t,n,s)=>M(a({id:s,action:"initialize",payload:{langs:e,oem:t,config:n}}));f(R,e=>{let{workerId:t,jobId:n,status:i,action:r,data:o}=e;const a="".concat(r,"-").concat(n);if("resolve"===i)l("[".concat(t,"]: Complete ").concat(n)),S[a].resolve({jobId:n,data:o}),delete S[a];else if("reject"===i){if(S[a].reject(o),delete S[a],"load"===r&&N(o),!x)throw Error(o);x(o)}else"progress"===i&&w(s(s({},o),{},{userJobId:n}))});const j={id:y,worker:R,load:()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),writeText:(e,t,n)=>M(a({id:n,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>M(a({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>M(a({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,n)=>M(a({id:n,action:"FS",payload:{method:e,args:t}})),reinitialize:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eng",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(T&&[d.TESSERACT_ONLY,d.TESSERACT_LSTM_COMBINED].includes(t))throw Error("Legacy model requested but code missing.");const i=t||C;C=i;const r=n||k;k=r;const o=("string"===typeof e?e.split("+"):e).filter(e=>!A.includes(e));return A.push(...o),o.length>0?O(o,s).then(()=>D(e,i,r,s)):D(e,i,r,s)},setParameters:function(){return M(a({id:arguments.length>1?arguments[1]:void 0,action:"setParameters",payload:{params:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}))},recognize:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{text:!0};return M(a({id:arguments.length>3?arguments[3]:void 0,action:"recognize",payload:{image:await m(e),options:t,output:n}}))},detect:async(e,t)=>{if(T)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return M(a({id:t,action:"detect",payload:{image:await m(e)}}))},terminate:async()=>(null!==R&&(p(R),R=null),Promise.resolve())};var F;return M(a({id:F,action:"load",payload:{options:{lstmOnly:T,corePath:E.corePath,logging:E.logging}}})).then(()=>O(e)).then(()=>D(e,t,b)).then(()=>I(j)).catch(()=>{}),P}},9497(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(8617),i=n(2141),r=n(3939),o=n(3709),a=n(6280),l=[s.default,i.default,(0,r.default)(),o.default,a.metadataVocabulary,a.contentVocabulary];t.default=l},9550(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(2302);class i extends Error{constructor(e,t,n,i){super(i||"can't resolve reference ".concat(n," from id ").concat(t)),this.missingRef=(0,s.resolveUrl)(e,t,n),this.missingSchema=(0,s.normalizeId)((0,s.getFullPath)(e,this.missingRef))}}t.default=i}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(5043),t=n(4391);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function i(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function r(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const l={descritor:{tipo_documento:"Presta\xe7\xe3o de Contas de Conv\xeanio",municipio:0,entidade:0,ano:2025,mes:1},codigo_ajuste:"",retificacao:!1,relacao_empregados:[],relacao_bens:{relacao_bens_moveis_adquiridos:[],relacao_bens_moveis_cedidos:[],relacao_bens_moveis_baixados_devolvidos:[],relacao_bens_imoveis_adquiridos:[],relacao_bens_imoveis_cedidos:[],relacao_bens_imoveis_baixados_devolvidos:[]},contratos:[],documentos_fiscais:[],pagamentos:[],disponibilidades:{saldos:[],saldo_fundo_fixo:0},receitas:{repasses_recebidos:[],outras_receitas:[],recursos_proprios:[]},ajustes_saldo:{retificacao_repasses:[],inclusao_repasses:[],retificacao_pagamentos:[],inclusao_pagamentos:[]},servidores_cedidos:[],descontos:[],devolucoes:[],glosas:[],empenhos:[],repasses:[],relatorio_atividades:{programas:[]},dados_gerais_entidade_beneficiaria:{identificacao_certidao_dados_gerais:"",identificacao_certidao_corpo_diretivo:"",identificacao_certidao_membros_conselho:""},responsaveis_membros_orgao_concessor:{identificacao_certidao_responsaveis:"",identificacao_certidao_membros_comissao_avaliacao:"",identificacao_certidao_membros_controle_interno:""},declaracoes:{houve_contratacao_empresas_pertencentes:!1,houve_participacao_quadro_diretivo_administrativo:!1},relatorio_governamental_analise_execucao:{houve_emissao_relatorio_final:!1},demonstracoes_contabeis:{publicacoes:[],responsavel:{numero_crc:"",cpf:"",situacao_regular_crc:!1}},publicacoes_parecer_ata:[],prestacao_contas_entidade_beneficiaria:{data_prestacao:"",periodo_referencia_data_inicial:"",periodo_referencia_data_final:""},parecer_conclusivo:{identificacao_parecer:"",conclusao_parecer:1,declaracoes:[]},transparencia:{entidade_beneficiaria_mantem_sitio_internet:!1,sitios_internet:[],requisitos_artigos_7o_8o_paragrafo_1o:[],requisitos_sitio_artigo_8o_paragrafo_3o:[],requisitos_divulgacao_informacoes:[]}},c="undefined"!==typeof window&&"localhost"===window.location.hostname,d=c?"/proxy-login":"https://audesp-piloto.tce.sp.gov.br";"undefined"!==typeof window&&console.log("[Auth Init]",{hostname:window.location.hostname,isLocalhost:c,API_BASE:d,protocol:window.location.protocol,url:window.location.href});const u="audesp_token",h="audesp_expire";function p(){return sessionStorage.getItem(u)}function f(){if(!p())return!1;const e=sessionStorage.getItem(h);return!e||Date.now()<parseInt(e,10)}const m="audesp_protocolos";function g(e){const t=function(){const e=localStorage.getItem(m);if(!e)return[];try{return JSON.parse(e)}catch(t){return[]}}();t.unshift(e),localStorage.setItem(m,JSON.stringify(t))}class v{static logOperation(e){const t=a(a({},e),{},{id:this.generateId(),timestamp:(new Date).toISOString()}),n=[t,...this.getLog()].slice(0,this.MAX_ENTRIES);return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n)),console.log("[AUDIT]",t),t}static logCreate(e,t,n){return this.logOperation({action:"CREATE",section:e,newValue:t,status:"SUCCESS",userId:n})}static logUpdate(e,t,n,s,i){return this.logOperation({action:"UPDATE",section:e,field:t,oldValue:n,newValue:s,status:"SUCCESS",userId:i})}static logTransmission(e,t,n,s,i){return this.logOperation({action:"TRANSMIT",section:"TRANSMISSION",status:n,details:"".concat(e," - Protocolo: ").concat(t||"N/A"),errorMessage:s,userId:i})}static logValidation(e,t,n){return this.logOperation({action:"VALIDATE",section:"VALIDATION",status:e?"SUCCESS":"FAILED",details:"Erros encontrados: ".concat(t),userId:n})}static logLogin(e,t,n){return this.logOperation({action:"LOGIN",status:t?"SUCCESS":"FAILED",userId:e,errorMessage:n})}static logLogout(e){return this.logOperation({action:"LOGOUT",status:"SUCCESS",userId:e})}static logExport(e,t){return this.logOperation({action:"EXPORT",section:"EXPORT_".concat(e.toUpperCase()),status:"SUCCESS",userId:t})}static logImport(e,t,n,s){return this.logOperation({action:"IMPORT",section:"IMPORT_".concat(e.toUpperCase()),status:t?"SUCCESS":"FAILED",errorMessage:n,userId:s})}static getLog(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao ler log de auditoria"),[]}}static getLogByPeriod(e,t){const n=this.getLog(),s=new Date(e).getTime(),i=new Date(t).getTime();return n.filter(e=>{const t=new Date(e.timestamp).getTime();return t>=s&&t<=i})}static getLogByAction(e){return this.getLog().filter(t=>t.action===e)}static getLogBySection(e){return this.getLog().filter(t=>t.section===e)}static getLogByUser(e){return this.getLog().filter(t=>t.userId===e)}static clearLog(e){return"CONFIRM_CLEAR_AUDIT_LOG"!==e?(console.warn("Tentativa de limpar log sem confirma\xe7\xe3o"),!1):(localStorage.removeItem(this.STORAGE_KEY),console.warn("[AUDIT] Log de auditoria foi limpo"),!0)}static generateId(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}}v.STORAGE_KEY="audesp_audit_log",v.MAX_ENTRIES=1e4;class b{static async computeDataHash(e){var t;const n=JSON.stringify(e);if("undefined"!==typeof window&&null!==(t=window.crypto)&&void 0!==t&&t.subtle){const e=(new TextEncoder).encode(n),t=await window.crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}return this.simpleHash(n)}static simpleHash(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return(t>>>0).toString(16)}static async registerIntegrityCheck(e,t){var n;const s=await this.computeDataHash(e),i=this.getIntegrityHistory(),r={dataHash:s,previousHash:i.length>0?i[0].dataHash:void 0,timestamp:(new Date).toISOString(),userId:t,isValid:!0,hashAlgorithm:"undefined"!==typeof window&&null!==(n=window.crypto)&&void 0!==n&&n.subtle?"SHA-256":"SIMPLE_HASH"},o=[r,...i].slice(0,100);return localStorage.setItem(this.INTEGRITY_KEY,JSON.stringify(o)),v.logOperation({action:"VALIDATE",status:"SUCCESS",details:"Integrity check: ".concat(s),userId:t}),r}static async verifyIntegrity(e){const t=await this.computeDataHash(e),n=this.getIntegrityHistory();if(0===n.length)return!0;return t===n[0].dataHash}static getIntegrityHistory(){try{const e=localStorage.getItem(this.INTEGRITY_KEY);return e?JSON.parse(e):[]}catch(e){return[]}}static async detectUnregisteredChanges(e){const t=await this.computeDataHash(e),n=this.getIntegrityHistory();if(0===n.length)return!1;return t!==n[0].dataHash}}b.INTEGRITY_KEY="audesp_integrity_check";class y{static generateReport(e,t){const n=(new Date).toISOString(),s=e||new Date((new Date).getTime()-2592e6).toISOString(),i=t||n,r=v.getLogByPeriod(s,i),o={},a={},l=[];let c=0,d=0,u=0,h=0,p=0;return r.forEach(e=>{switch(o[e.action]=(o[e.action]||0)+1,"FAILED"===e.status&&p++,e.action){case"CREATE":c++;break;case"UPDATE":d++;break;case"DELETE":u++;break;case"TRANSMIT":h++}e.section&&(a[e.section]=(a[e.section]||0)+1),"UPDATE"===e.action&&e.field&&l.push({field:e.field,section:e.section||"N/A",timestamp:e.timestamp,oldValue:e.oldValue,newValue:e.newValue,userId:e.userId})}),{generatedAt:n,period:{from:s,to:i},totalOperations:r.length,operationsByType:o,changedSections:a,changedFields:l.slice(0,1e3),summary:{createsCount:c,updatesCount:d,deletesCount:u,transmitsCount:h,failuresCount:p}}}static exportReportJSON(e,t){const n=this.generateReport(e,t);return JSON.stringify(n,null,2)}static exportReportCSV(e,t){const n=this.generateReport(e,t),s=v.getLogByPeriod(n.period.from,n.period.to);let i="Timestamp,A\xe7\xe3o,Se\xe7\xe3o,Campo,Status,Usu\xe1rio,Detalhes\n";return s.forEach(e=>{const t=[e.timestamp,e.action,e.section||"-",e.field||"-",e.status,e.userId||"-",(e.details||"").replace(/,/g,";")].map(e=>'"'.concat(e,'"')).join(",");i+=t+"\n"}),i}}const _="undefined"!==typeof window&&"localhost"===window.location.hostname,w=_?"/proxy-f5":"https://audesp-piloto.tce.sp.gov.br/f5",x=new v;"undefined"!==typeof window&&console.log("[Transmission Init]",{hostname:window.location.hostname,isLocalhost:_,API_BASE:w,protocol:window.location.protocol,url:window.location.href});const E={"Presta\xe7\xe3o de Contas de Conv\xeanio":"/enviar-prestacao-contas-convenio","Presta\xe7\xe3o de Contas de Contrato de Gest\xe3o":"/enviar-prestacao-contas-contrato-gestao","Presta\xe7\xe3o de Contas de Termo de Parceria":"/enviar-prestacao-contas-parceria","Presta\xe7\xe3o de Contas de Termo de Fomento":"/enviar-prestacao-contas-termo-fomento","Presta\xe7\xe3o de Contas de Termo de Colabora\xe7\xe3o":"/enviar-prestacao-contas-termo-colaboracao","Declara\xe7\xe3o Negativa":"/enviar-prestacao-contas-declaracao-negativa"};var S=n(7003),A=n.n(S),C=n(483),k=n.n(C);const T=new(A())({allErrors:!0,verbose:!0,coerceTypes:!0});function N(e){const t={};return Array.from({length:27},(e,t)=>String(t+1)).forEach(n=>{const s=function(e,t){var n,s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b;const y=[];switch(e){case"1":t.descritor.municipio||y.push("Munic\xedpio \xe9 obrigat\xf3rio."),t.descritor.entidade||y.push("C\xf3digo da Entidade \xe9 obrigat\xf3rio."),t.descritor.ano||y.push("Ano \xe9 obrigat\xf3rio."),t.descritor.mes||y.push("M\xeas \xe9 obrigat\xf3rio.");break;case"2":t.codigo_ajuste||y.push("C\xf3digo do Ajuste \xe9 obrigat\xf3rio.");break;case"3":case"11":case"22":break;case"4":null===(n=t.relacao_empregados)||void 0===n||n.forEach((e,t)=>{var n;e.cpf&&11===e.cpf.length||y.push("Empregado #".concat(t+1,": CPF inv\xe1lido (deve ter 11 d\xedgitos).")),e.data_admissao||y.push("Empregado #".concat(t+1,": Data de admiss\xe3o obrigat\xf3ria.")),e.periodos_remuneracao&&0!==e.periodos_remuneracao.length||y.push("Empregado #".concat(t+1,": Deve ter ao menos um per\xedodo de remunera\xe7\xe3o.")),null===(n=e.periodos_remuneracao)||void 0===n||n.forEach((e,n)=>{e.remuneracao_bruta<=0&&y.push("Empregado #".concat(t+1,", M\xeas ").concat(e.mes,": Remunera\xe7\xe3o deve ser maior que zero.")),(e.mes>12||e.mes<1)&&y.push("Empregado #".concat(t+1,": M\xeas ").concat(e.mes," inv\xe1lido."))})});break;case"5":const e=null===(s=t.relacao_bens)||void 0===s?void 0:s.relacao_bens_moveis_adquiridos;null===e||void 0===e||e.forEach((e,t)=>{e.numero_patrimonio||y.push("Bem #".concat(t+1,": N\xba Patrim\xf4nio obrigat\xf3rio.")),e.descricao||y.push("Bem #".concat(t+1,": Descri\xe7\xe3o obrigat\xf3ria.")),(!e.valor_aquisicao||e.valor_aquisicao<=0)&&y.push("Bem #".concat(t+1,": Valor inv\xe1lido."))});break;case"6":null===(i=t.contratos)||void 0===i||i.forEach((e,t)=>{var n;e.numero||y.push("Contrato #".concat(t+1,": N\xfamero obrigat\xf3rio.")),null!==(n=e.credor)&&void 0!==n&&n.documento_numero||y.push("Contrato #".concat(t+1,": Credor obrigat\xf3rio.")),e.valor_montante<=0&&y.push("Contrato #".concat(t+1,": Valor deve ser positivo.")),e.vigencia_data_inicial&&e.vigencia_data_final&&new Date(e.vigencia_data_inicial)>new Date(e.vigencia_data_final)&&y.push("Contrato #".concat(t+1,": Data final de vig\xeancia anterior \xe0 inicial."))});break;case"7":null===(r=t.documentos_fiscais)||void 0===r||r.forEach((e,t)=>{var n;e.numero||y.push("Doc. Fiscal #".concat(t+1,": N\xfamero obrigat\xf3rio.")),e.valor_bruto<=0&&y.push("Doc. Fiscal #".concat(t+1,": Valor deve ser positivo.")),null!==(n=e.credor)&&void 0!==n&&n.documento_numero||y.push("Doc. Fiscal #".concat(t+1,": Credor obrigat\xf3rio.")),e.data_emissao||y.push("Doc. Fiscal #".concat(t+1,": Data emiss\xe3o obrigat\xf3ria."))});break;case"8":null===(o=t.pagamentos)||void 0===o||o.forEach((e,n)=>{var s;if(e.pagamento_data||y.push("Pagamento #".concat(n+1,": Data obrigat\xf3ria.")),e.pagamento_valor<=0&&y.push("Pagamento #".concat(n+1,": Valor deve ser positivo.")),null!==(s=e.identificacao_documento_fiscal)&&void 0!==s&&s.numero||y.push("Pagamento #".concat(n+1,": V\xednculo com Nota Fiscal obrigat\xf3rio.")),t.documentos_fiscais){const s=t.documentos_fiscais.find(t=>t.numero===e.identificacao_documento_fiscal.numero);s?s.data_emissao&&e.pagamento_data&&new Date(e.pagamento_data)<new Date(s.data_emissao)&&y.push("Pagamento #".concat(n+1,": Data do pagamento (").concat(e.pagamento_data,") anterior \xe0 emiss\xe3o da nota (").concat(s.data_emissao,").")):y.push("Pagamento #".concat(n+1,": Nota Fiscal vinculada (").concat(e.identificacao_documento_fiscal.numero,") n\xe3o encontrada na se\xe7\xe3o 7."))}});break;case"9":null===(a=t.disponibilidades)||void 0===a||a.saldos.forEach((e,t)=>{e.conta||y.push("Saldo #".concat(t+1,": Conta obrigat\xf3ria.")),e.banco||y.push("Saldo #".concat(t+1,": Banco obrigat\xf3rio.")),void 0===e.saldo_bancario&&y.push("Saldo #".concat(t+1,": Valor banc\xe1rio obrigat\xf3rio."))});break;case"10":null!==(l=t.receitas)&&void 0!==l&&l.repasses_recebidos&&t.receitas.repasses_recebidos.forEach((e,t)=>{e.data_repasse||y.push("Receita (Repasse) #".concat(t+1,": Data obrigat\xf3ria.")),e.valor<=0&&y.push("Receita (Repasse) #".concat(t+1,": Valor deve ser positivo."))});break;case"12":null===(c=t.servidores_cedidos)||void 0===c||c.forEach((e,t)=>{e.cpf||y.push("Servidor #".concat(t+1,": CPF obrigat\xf3rio.")),e.data_inicial_cessao||y.push("Servidor #".concat(t+1,": Data in\xedcio obrigat\xf3ria."))});break;case"16":null===(d=t.empenhos)||void 0===d||d.forEach((e,t)=>{e.numero||y.push("Empenho #".concat(t+1,": N\xfamero obrigat\xf3rio.")),e.valor<=0&&y.push("Empenho #".concat(t+1,": Valor inv\xe1lido."))});break;case"17":null===(u=t.repasses)||void 0===u||u.forEach((e,t)=>{(!e.valor_repasse||e.valor_repasse<=0)&&y.push("Repasse #".concat(t+1,": Valor inv\xe1lido.")),e.data_repasse||y.push("Repasse #".concat(t+1,": Data obrigat\xf3ria."))});break;case"18":null!==(h=t.relatorio_atividades)&&void 0!==h&&h.programas?(0===t.relatorio_atividades.programas.length&&y.push("Pelo menos um Programa deve ser cadastrado."),t.relatorio_atividades.programas.forEach((e,t)=>{e.nome_programa||y.push("Programa #".concat(t+1,": Nome obrigat\xf3rio.")),e.metas&&0!==e.metas.length||y.push("Programa #".concat(t+1,": Deve ter ao menos uma meta.")),e.metas.forEach((e,n)=>{e.codigo_meta||y.push("Programa #".concat(t+1,", Meta #").concat(n+1,": C\xf3digo obrigat\xf3rio.")),e.meta_atendida||e.justificativa||y.push("Programa #".concat(t+1,", Meta #").concat(n+1,": Justificativa obrigat\xf3ria para meta n\xe3o atendida."))})})):y.push("Relat\xf3rio de atividades vazio (Se\xe7\xe3o 18).");break;case"19":null!==(p=t.dados_gerais_entidade_beneficiaria)&&void 0!==p&&p.identificacao_certidao_dados_gerais||y.push("Certid\xe3o de Dados Gerais obrigat\xf3ria."),null!==(f=t.dados_gerais_entidade_beneficiaria)&&void 0!==f&&f.identificacao_certidao_corpo_diretivo||y.push("Certid\xe3o de Corpo Diretivo obrigat\xf3ria.");break;case"20":null!==(m=t.responsaveis_membros_orgao_concessor)&&void 0!==m&&m.identificacao_certidao_responsaveis||y.push("Certid\xe3o de Respons\xe1veis obrigat\xf3ria.");break;case"21":const _=t.declaracoes;null===_||void 0===_||!_.houve_contratacao_empresas_pertencentes||_.empresas_pertencentes&&0!==_.empresas_pertencentes.length||y.push("Se houve contrata\xe7\xe3o de empresas pertencentes, a lista de empresas \xe9 obrigat\xf3ria.");break;case"23":null!==(g=t.demonstracoes_contabeis)&&void 0!==g&&null!==(v=g.responsavel)&&void 0!==v&&v.cpf||y.push("CPF do Respons\xe1vel T\xe9cnico obrigat\xf3rio.");break;case"26":null!==(b=t.parecer_conclusivo)&&void 0!==b&&b.identificacao_parecer||y.push("Identifica\xe7\xe3o do Parecer Conclusivo obrigat\xf3ria.");break;case"27":const w=t.transparencia;null!==w&&void 0!==w&&w.entidade_beneficiaria_mantem_sitio_internet&&(w.sitios_internet&&0!==w.sitios_internet.length&&!w.sitios_internet.some(e=>!e.trim())||y.push("Se mant\xe9m s\xedtio na internet, informe a URL."))}return y}(n,e);let i="valid";const r=function(e,t){var n,s,i,r,o,a,l,c,d,u,h;switch(e){case"1":return!t.descritor.municipio;case"2":return!t.codigo_ajuste;case"3":case"27":return!1;case"4":return!t.relacao_empregados||0===t.relacao_empregados.length;case"5":return!(null!==(n=t.relacao_bens)&&void 0!==n&&n.relacao_bens_moveis_adquiridos)||0===t.relacao_bens.relacao_bens_moveis_adquiridos.length;case"6":return!t.contratos||0===t.contratos.length;case"7":return!t.documentos_fiscais||0===t.documentos_fiscais.length;case"8":return!t.pagamentos||0===t.pagamentos.length;case"9":return!(null!==(s=t.disponibilidades)&&void 0!==s&&s.saldos)||0===t.disponibilidades.saldos.length;case"10":return!(null!==(i=t.receitas)&&void 0!==i&&i.repasses_recebidos)||0===t.receitas.repasses_recebidos.length;case"11":return!(null!==(r=t.ajustes_saldo)&&void 0!==r&&r.retificacao_repasses)||0===t.ajustes_saldo.retificacao_repasses.length;case"12":return!t.servidores_cedidos||0===t.servidores_cedidos.length;case"13":return!t.descontos||0===t.descontos.length;case"14":return!t.devolucoes||0===t.devolucoes.length;case"15":return!t.glosas||0===t.glosas.length;case"16":return!t.empenhos||0===t.empenhos.length;case"17":return!t.repasses||0===t.repasses.length;case"18":return!(null!==(o=t.relatorio_atividades)&&void 0!==o&&o.programas)||0===t.relatorio_atividades.programas.length;case"19":return!(null!==(a=t.dados_gerais_entidade_beneficiaria)&&void 0!==a&&a.identificacao_certidao_dados_gerais);case"20":return!(null!==(l=t.responsaveis_membros_orgao_concessor)&&void 0!==l&&l.identificacao_certidao_responsaveis);case"21":return!t.declaracoes;case"22":return!(null!==(c=t.relatorio_governamental_analise_execucao)&&void 0!==c&&c.houve_emissao_relatorio_final);case"23":return!(null!==(d=t.demonstracoes_contabeis)&&void 0!==d&&d.publicacoes)||0===t.demonstracoes_contabeis.publicacoes.length;case"24":return!t.publicacoes_parecer_ata||0===t.publicacoes_parecer_ata.length;case"25":return!(null!==(u=t.prestacao_contas_entidade_beneficiaria)&&void 0!==u&&u.data_prestacao);case"26":return!(null!==(h=t.parecer_conclusivo)&&void 0!==h&&h.identificacao_parecer);default:return!0}}(n,e);s.length>0?i="invalid":r&&(i="empty",["1","2","18","19","20","21","26","27"].includes(n)&&(i="invalid",0===s.length&&s.push("Se\xe7\xe3o obrigat\xf3ria n\xe3o preenchida."))),t[n]={id:n,status:i,errors:s}}),t}k()(T);var I={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const P=["color","size","strokeWidth","absoluteStrokeWidth","children"];var R=(t,n)=>{const s=(0,e.forwardRef)((s,i)=>{let{color:r="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:c,children:d}=s,u=function(e,t){if(null==e)return{};var n,s,i=function(e,t){if(null==e)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;n[s]=e[s]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)n=r[s],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(s,P);return(0,e.createElement)("svg",a(a({ref:i},I),{},{width:o,height:o,stroke:r,strokeWidth:c?24*Number(l)/Number(o):l,className:"lucide lucide-".concat((h=t,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},u),[...n.map(t=>{let[n,s]=t;return(0,e.createElement)(n,s)}),...(Array.isArray(d)?d:[d])||[]]);var h});return s.displayName="".concat(t),s};const M=R("FolderInput",[["path",{d:"M2 9V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-1",key:"1gu97c"}],["path",{d:"M2 13h10",key:"pgb2dq"}],["path",{d:"m9 16 3-3-3-3",key:"6m91ic"}]]),O=R("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),D=R("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),j=R("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),F=R("FileJson",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);var L=n(579);const U=t=>{let{activeSection:n,setActiveSection:s,onTransmit:i,onDownload:r,onLoadJson:o,onNew:l,onSaveDraft:c,onImportFullPdf:d,sectionStatus:u}=t;const h=(0,e.useRef)(null),[p,f]=(0,e.useState)({S1:!0,S2:!0,S3:!1,S4:!1,S5:!1,S6:!1});return(0,L.jsxs)("div",{className:"w-72 bg-slate-900 text-white h-screen fixed left-0 top-0 flex flex-col shadow-2xl z-50 font-sans border-r border-slate-800",children:[(0,L.jsx)("div",{className:"p-5 border-b border-slate-800 bg-slate-950",children:(0,L.jsxs)("h1",{className:"text-xl font-extrabold flex flex-col",children:[(0,L.jsx)("span",{className:"text-blue-500 tracking-wide",children:"AUDESP"}),(0,L.jsx)("span",{className:"text-white tracking-widest text-xs",children:"CONNECT FASE V"})]})}),(0,L.jsx)("div",{className:"p-3 bg-slate-800/50 border-b border-slate-700",children:(0,L.jsxs)("button",{onClick:e=>{e.preventDefault(),d()},className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white py-2 rounded text-xs font-bold transition-colors shadow-md border border-indigo-500",children:[(0,L.jsx)(M,{size:14}),"Importar PDF Completo"]})}),(0,L.jsxs)("nav",{className:"flex-1 overflow-y-auto py-2 custom-scrollbar",children:[(0,L.jsxs)("button",{onClick:()=>s("dashboard"),className:"w-full text-left px-4 py-3 text-xs font-bold uppercase transition-all flex items-center gap-2 ".concat("dashboard"===n?"bg-blue-900/40 text-blue-300 border-l-4 border-blue-500":"text-slate-400 hover:text-white"),children:[(0,L.jsx)("div",{className:"w-4",children:"\ud83d\udcca"}),"Dashboard Geral"]}),(0,L.jsxs)("button",{onClick:()=>s("reports"),className:"w-full text-left px-4 py-3 text-xs font-bold uppercase transition-all flex items-center gap-2 ".concat("reports"===n?"bg-purple-900/40 text-purple-300 border-l-4 border-purple-500":"text-slate-400 hover:text-white"),children:[(0,L.jsx)("div",{className:"w-4",children:"\ud83d\udccb"}),"Valida\xe7\xe3o & Relat\xf3rios"]}),(0,L.jsx)("div",{className:"space-y-1 mt-2",children:[{id:"S1",title:"SE\xc7\xc3O 1 \u2014 IDENTIFICA\xc7\xc3O",items:[{id:"descritor",label:"Descritor"},{id:"codigo_ajuste",label:"C\xf3digo do Ajuste"},{id:"dados_gerais",label:"Dados da Entidade"},{id:"prestacao_benef",label:"Presta\xe7\xe3o Benefici\xe1ria"},{id:"responsaveis",label:"Respons\xe1veis"}]},{id:"S2",title:"SE\xc7\xc3O 2 \u2014 FINANCEIRO",items:[{id:"empenhos",label:"Empenhos"},{id:"repasses",label:"Repasses Recebidos"},{id:"receitas",label:"Outras Receitas"},{id:"contratos",label:"Contratos"},{id:"documentos_fiscais",label:"Documentos Fiscais"},{id:"pagamentos",label:"Pagamentos"},{id:"glosas",label:"Glosas"},{id:"ajustes_saldo",label:"Ajustes de Saldo"},{id:"descontos",label:"Descontos"},{id:"devolucoes",label:"Devolu\xe7\xf5es"},{id:"disponibilidades",label:"Disponibilidades"}]},{id:"S3",title:"SE\xc7\xc3O 3 \u2014 RELAT\xd3RIOS",items:[{id:"relatorio_atividades",label:"Relat\xf3rio Atividades"},{id:"relatorio_gov",label:"Relat\xf3rio Governamental"}]},{id:"S4",title:"SE\xc7\xc3O 4 \u2014 EMPREGADOS E BENS",items:[{id:"relacao_empregados",label:"Rela\xe7\xe3o de Empregados"},{id:"servidores_cedidos",label:"Servidores Cedidos"},{id:"relacao_bens",label:"Rela\xe7\xe3o de Bens"}]},{id:"S5",title:"SE\xc7\xc3O 5 \u2014 PUBLICA\xc7\xd5ES",items:[{id:"demonstracoes",label:"Demonstra\xe7\xf5es Cont\xe1beis"},{id:"publicacoes",label:"Publica\xe7\xf5es Parecer/Ata"}]},{id:"S6",title:"SE\xc7\xc3O 6 \u2014 DECLARA\xc7\xd5ES",items:[{id:"declaracoes",label:"Declara\xe7\xf5es"},{id:"transparencia",label:"Transpar\xeancia"},{id:"parecer",label:"Parecer Conclusivo"}]}].map(e=>(0,L.jsxs)("div",{className:"border-b border-slate-800/50",children:[(0,L.jsxs)("button",{onClick:()=>{return t=e.id,void f(e=>a(a({},e),{},{[t]:!e[t]}));var t},className:"w-full flex items-center justify-between px-4 py-2.5 text-[10px] font-bold uppercase tracking-wider text-slate-500 hover:text-slate-300 hover:bg-slate-800 transition-colors",children:[e.title,p[e.id]?(0,L.jsx)(O,{size:12}):(0,L.jsx)(D,{size:12})]}),p[e.id]&&(0,L.jsx)("ul",{className:"bg-slate-900/50 pb-2",children:e.items.map(e=>(0,L.jsx)("li",{children:(0,L.jsx)("button",{onClick:()=>s(e.id),className:"w-full text-left pl-8 pr-4 py-2 text-xs font-medium transition-all border-l-[3px] flex items-center justify-between ".concat(n===e.id?"bg-slate-800 border-blue-500 text-white":"border-transparent text-slate-400 hover:text-white hover:bg-slate-800/30"),children:e.label})},e.id))})]},e.id))})]}),(0,L.jsxs)("div",{className:"p-4 bg-slate-950 space-y-3 border-t border-slate-800",children:[(0,L.jsxs)("button",{onClick:i,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white h-10 rounded-md text-xs font-bold flex items-center justify-center gap-2 shadow-lg tracking-wide uppercase transition-transform active:scale-95",children:[(0,L.jsx)(j,{size:14})," Transmitir Audesp"]}),(0,L.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,L.jsxs)("button",{onClick:r,className:"bg-slate-800 hover:bg-slate-700 text-slate-300 h-8 rounded text-[10px] font-bold uppercase flex items-center justify-center gap-1",children:[(0,L.jsx)(F,{size:12})," Baixar"]}),(0,L.jsxs)("button",{onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},className:"bg-slate-800 hover:bg-slate-700 text-slate-300 h-8 rounded text-[10px] font-bold uppercase flex items-center justify-center gap-1",children:[(0,L.jsx)(M,{size:12})," Carregar"]}),(0,L.jsx)("input",{type:"file",ref:h,className:"hidden",accept:".json",onChange:e=>{e.target.files&&e.target.files[0]&&o(e.target.files[0]),h.current&&(h.current.value="")}})]})]})]})},B="http://localhost:8000";const V=t=>{let{section:n,onDataExtracted:s}=t;const[i,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)(null);e.useEffect(()=>{!async function(){try{return(await fetch("".concat(B,"/health"))).ok}catch(o){return console.warn("[OCRService] Backend n\xe3o dispon\xedvel:",o),!1}}()},[]);return(0,L.jsxs)("div",{className:"mb-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg shadow-sm",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsxs)("h3",{className:"text-sm font-bold text-indigo-800 flex items-center gap-2",children:[(0,L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,L.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),"OCR Inteligente (Gemini 2.0)"]}),(0,L.jsxs)("p",{className:"text-xs text-indigo-600 mt-1",children:["Extra\xe7\xe3o autom\xe1tica para se\xe7\xe3o: ",(0,L.jsx)("strong",{children:n})]})]}),(0,L.jsxs)("div",{className:"relative",children:[(0,L.jsx)("input",{type:"file",accept:"application/pdf",onChange:async e=>{if(e.target.files&&e.target.files[0]){const n=e.target.files[0];if(!n.type.includes("pdf"))return void a("\u274c Apenas PDF \xe9 suportado. Recebido: ".concat(n.type||"tipo desconhecido"));r(!0),a(null);try{console.log("[GeminiUploader] Enviando PDF para backend: ".concat(n.name));const e=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";if(!e.type.includes("pdf"))throw new Error("\u274c Apenas PDF \xe9 suportado");const n=new FormData;n.append("file",e);try{console.log("[OCRService] Extraindo dados de bloco:",t);const e=await fetch("".concat(B,"/api/ocr/extract-block?block_type=").concat(t),{method:"POST",body:n});if(!e.ok){const t=await e.json();throw new Error(t.detail||"HTTP ".concat(e.status))}return function(e,t){const n={};switch(t){case"general":e.cnpj&&e.cnpj.length>0&&(n.cnpj=e.cnpj[0]),e.cpf&&e.cpf.length>0&&(n.cpf=e.cpf[0]),e.dates&&e.dates.length>0&&(n.dates=e.dates),e.phones&&e.phones.length>0&&(n.phone=e.phones[0]),e.emails&&e.emails.length>0&&(n.email=e.emails[0]);break;case"finance":if(e.currency&&e.currency.length>0){n.values=e.currency;const t=e.currency[0].match(/[\d.,]+/);t&&(n.primary_value=t[0])}e.percentages&&e.percentages.length>0&&(n.percentages=e.percentages);break;default:n.patterns=e}return n}((await e.json()).patterns,t)}catch(o){const t=o.message||"Erro ao extrair dados de bloco";throw console.error("[OCRService] Erro ao extrair bloco:",t),new Error("\u274c Erro na extra\xe7\xe3o: ".concat(t))}}(n,"general");console.log("[GeminiUploader] Dados extra\xeddos com sucesso:",e),s(e)}catch(t){console.error("[GeminiUploader] Erro ao processar arquivo:",t);const e=(null===t||void 0===t?void 0:t.message)||"Erro ao processar PDF";a(e)}finally{r(!1)}}},disabled:i,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:"Selecione um arquivo PDF"}),(0,L.jsx)("button",{disabled:i,className:"px-4 py-2 rounded text-sm font-medium shadow transition-colors ".concat(i?"bg-indigo-300":"bg-indigo-600 hover:bg-indigo-700"," text-white"),children:i?"Lendo Documento...":"Upload PDF/Imagem"})]})]}),o&&(0,L.jsx)("p",{className:"text-red-600 text-xs mt-2 font-medium",children:o})]})},W="w-full h-10 px-3 rounded-md border border-slate-300 text-sm text-slate-700 shadow-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none transition-all placeholder:text-slate-400 disabled:bg-slate-50 disabled:text-slate-500",H="w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer transition-colors",q="block text-xs font-bold text-slate-500 uppercase mb-1.5 tracking-wider",z="bg-white p-6 rounded-lg shadow-sm border border-slate-200 mb-6 animate-in fade-in slide-in-from-bottom-2 duration-500",G="h-9 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium shadow-sm transition-colors flex items-center gap-2 cursor-pointer",K="text-red-500 hover:text-red-700 text-xs font-bold uppercase tracking-wide transition-colors px-2 py-1 rounded hover:bg-red-50 cursor-pointer",J="h-7 px-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded text-xs font-bold",Y="text-xl font-bold text-slate-800",$="flex justify-between items-center mb-6 pb-4 border-b border-slate-100",X="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",Q="flex items-center gap-3",Z=e=>{let{title:t,children:n}=e;return(0,L.jsxs)("div",{className:$,children:[(0,L.jsx)("h2",{className:Y,children:t}),(0,L.jsx)("div",{className:"flex gap-2",children:n})]})},ee=e=>{let{label:t,error:n,children:s}=e;return(0,L.jsxs)("div",{className:"mb-1",children:[(0,L.jsx)("label",{className:q,children:t}),s,n&&(0,L.jsx)("div",{className:"text-red-600 text-[10px] font-bold uppercase mt-1 animate-pulse",children:n})]})};function te(e){let{title:t,items:n,newItemTemplate:s,onAdd:i,onRemove:r,onUpdate:o,renderItem:l,ocrSection:c,onOcrData:d}=e;return(0,L.jsxs)("div",{className:"space-y-6",children:[(0,L.jsx)(Z,{title:t,children:(0,L.jsx)("button",{onClick:()=>i(s),className:G,children:"+ Adicionar Item"})}),c&&(0,L.jsx)(V,{section:c,onDataExtracted:e=>{e&&("relacao_empregados"===c&&e.empregados&&Array.isArray(e.empregados)?e.empregados.forEach(e=>i(e)):d?d(e):i(a(a({},s),e)))}}),n&&n.length>0?n.map((e,t)=>(0,L.jsxs)("div",{className:z+" relative border-l-4 border-l-slate-400",children:[(0,L.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,L.jsx)("button",{onClick:()=>r(t),className:K,children:"\ud83d\uddd1 Remover"})}),(0,L.jsx)("div",{className:"pt-2",children:l(e,t,(e,n)=>o(t,e,n))})]},t)):(0,L.jsx)("div",{className:"text-center p-8 border-2 border-dashed border-slate-200 rounded-lg bg-slate-50",children:(0,L.jsx)("p",{className:"text-slate-400 text-sm font-medium",children:"Nenhum registro adicionado."})})]})}const ne=e=>{let{label:t,value:n,onChange:s,type:i="text",error:r,options:o}=e;return(0,L.jsx)(ee,{label:t,error:r,children:o?(0,L.jsx)("select",{className:W,value:n,onChange:e=>s(e.target.value),children:o.map(e=>(0,L.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,L.jsx)("input",{type:i,className:W,value:n,onChange:e=>s("number"===i?Number(e.target.value):e.target.value),step:"number"===i?"0.01":void 0})})},se=e=>(e||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),ie=e=>{if(!e)return"-";const[t,n,s]=e.split("-");return"".concat(s,"/").concat(n,"/").concat(t)},re=e=>{var t,n,s,i,r,o;let{data:a,onDownloadJson:l}=e;const c=(null===(t=a.relacao_empregados)||void 0===t?void 0:t.reduce((e,t)=>{var n;return e+((null===(n=t.periodos_remuneracao)||void 0===n?void 0:n.reduce((e,t)=>e+t.remuneracao_bruta,0))||0)},0))||0,d=(null===(n=a.contratos)||void 0===n?void 0:n.reduce((e,t)=>e+t.valor_montante,0))||0,u=(null===(s=a.documentos_fiscais)||void 0===s?void 0:s.reduce((e,t)=>e+t.valor_bruto,0))||0,h=(null===(i=a.pagamentos)||void 0===i?void 0:i.reduce((e,t)=>e+t.pagamento_valor,0))||0,p=(null===(r=a.receitas)||void 0===r||null===(o=r.repasses_recebidos)||void 0===o?void 0:o.reduce((e,t)=>e+t.valor,0))||0;return(0,L.jsxs)("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden animate-in fade-in duration-500 max-w-5xl mx-auto border border-slate-200 print:shadow-none print:border-none",children:[(0,L.jsxs)("div",{className:"bg-slate-800 text-white p-6 flex justify-between items-center print:hidden",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("h2",{className:"text-xl font-bold",children:"Relat\xf3rio de Confer\xeancia"}),(0,L.jsx)("p",{className:"text-xs text-slate-400",children:"Espelho da Presta\xe7\xe3o de Contas - Audesp Fase V"})]}),(0,L.jsxs)("div",{className:"flex gap-3",children:[(0,L.jsx)("button",{onClick:()=>window.print(),className:"bg-slate-600 hover:bg-slate-500 px-4 py-2 rounded text-sm font-bold transition-colors",children:"\ud83d\udda8\ufe0f Imprimir"}),(0,L.jsx)("button",{onClick:l,className:G,children:"\u2b07\ufe0f Baixar JSON"})]})]}),(0,L.jsxs)("div",{className:"p-8 print:p-0 font-serif text-slate-900 space-y-8",children:[(0,L.jsxs)("div",{className:"text-center border-b-2 border-slate-800 pb-6",children:[(0,L.jsx)("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:"Presta\xe7\xe3o de Contas"}),(0,L.jsx)("h3",{className:"text-lg font-semibold",children:a.descritor.tipo_documento}),(0,L.jsxs)("div",{className:"mt-4 flex justify-center gap-8 text-sm",children:[(0,L.jsxs)("span",{children:[(0,L.jsx)("strong",{children:"Entidade:"})," ",a.descritor.entidade]}),(0,L.jsxs)("span",{children:[(0,L.jsx)("strong",{children:"Munic\xedpio:"})," ",a.descritor.municipio]}),(0,L.jsxs)("span",{children:[(0,L.jsx)("strong",{children:"Compet\xeancia:"})," ",a.descritor.mes,"/",a.descritor.ano]}),(0,L.jsxs)("span",{children:[(0,L.jsx)("strong",{children:"C\xf3digo Ajuste:"})," ",a.codigo_ajuste||"N/A"]})]})]}),(0,L.jsxs)("section",{children:[(0,L.jsx)("h4",{className:"bg-slate-100 p-2 font-bold uppercase text-sm border-l-4 border-slate-800 mb-4",children:"1. Resumo Financeiro"}),(0,L.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-center",children:[(0,L.jsxs)("div",{className:"p-3 border rounded",children:[(0,L.jsx)("span",{className:"block text-xs uppercase text-slate-500",children:"Repasses Recebidos"}),(0,L.jsx)("span",{className:"block font-bold text-lg",children:se(p)})]}),(0,L.jsxs)("div",{className:"p-3 border rounded",children:[(0,L.jsx)("span",{className:"block text-xs uppercase text-slate-500",children:"Total Contratado"}),(0,L.jsx)("span",{className:"block font-bold text-lg",children:se(d)})]}),(0,L.jsxs)("div",{className:"p-3 border rounded",children:[(0,L.jsx)("span",{className:"block text-xs uppercase text-slate-500",children:"Notas Fiscais"}),(0,L.jsx)("span",{className:"block font-bold text-lg",children:se(u)})]}),(0,L.jsxs)("div",{className:"p-3 border rounded",children:[(0,L.jsx)("span",{className:"block text-xs uppercase text-slate-500",children:"Pagamentos Efetuados"}),(0,L.jsx)("span",{className:"block font-bold text-lg",children:se(h)})]})]})]}),(0,L.jsxs)("section",{children:[(0,L.jsxs)("h4",{className:"bg-slate-100 p-2 font-bold uppercase text-sm border-l-4 border-slate-800 mb-2 flex justify-between",children:[(0,L.jsx)("span",{children:"2. Rela\xe7\xe3o de Empregados"}),(0,L.jsxs)("span",{className:"text-xs font-normal",children:["Total Folha: ",se(c)]})]}),a.relacao_empregados&&a.relacao_empregados.length>0?(0,L.jsxs)("table",{className:"w-full text-xs text-left",children:[(0,L.jsx)("thead",{className:"bg-slate-50 border-b",children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{className:"p-2",children:"CPF"}),(0,L.jsx)("th",{className:"p-2",children:"Admiss\xe3o"}),(0,L.jsx)("th",{className:"p-2",children:"CBO"}),(0,L.jsx)("th",{className:"p-2",children:"Sal\xe1rio Contratual"}),(0,L.jsx)("th",{className:"p-2",children:"Per\xedodos (M\xeas/Valor)"})]})}),(0,L.jsx)("tbody",{children:a.relacao_empregados.map((e,t)=>{var n,s;return(0,L.jsxs)("tr",{className:"border-b hover:bg-slate-50",children:[(0,L.jsx)("td",{className:"p-2",children:(s=e.cpf,s||"-")}),(0,L.jsx)("td",{className:"p-2",children:ie(e.data_admissao)}),(0,L.jsx)("td",{className:"p-2",children:e.cbo}),(0,L.jsx)("td",{className:"p-2",children:se(e.salario_contratual)}),(0,L.jsx)("td",{className:"p-2",children:null===(n=e.periodos_remuneracao)||void 0===n?void 0:n.map((e,t)=>(0,L.jsxs)("div",{children:["M\xeas ",e.mes,": ",se(e.remuneracao_bruta)]},t))})]},t)})})]}):(0,L.jsx)("p",{className:"text-xs text-slate-500 italic p-2",children:"Nenhum registro."})]}),(0,L.jsxs)("section",{children:[(0,L.jsx)("h4",{className:"bg-slate-100 p-2 font-bold uppercase text-sm border-l-4 border-slate-800 mb-2",children:"3. Documentos Fiscais"}),a.documentos_fiscais&&a.documentos_fiscais.length>0?(0,L.jsxs)("table",{className:"w-full text-xs text-left",children:[(0,L.jsx)("thead",{className:"bg-slate-50 border-b",children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{className:"p-2",children:"N\xfamero"}),(0,L.jsx)("th",{className:"p-2",children:"Emiss\xe3o"}),(0,L.jsx)("th",{className:"p-2",children:"Credor"}),(0,L.jsx)("th",{className:"p-2",children:"Descri\xe7\xe3o"}),(0,L.jsx)("th",{className:"p-2 text-right",children:"Valor"})]})}),(0,L.jsx)("tbody",{children:a.documentos_fiscais.map((e,t)=>{var n,s;return(0,L.jsxs)("tr",{className:"border-b hover:bg-slate-50",children:[(0,L.jsx)("td",{className:"p-2 font-bold",children:e.numero}),(0,L.jsx)("td",{className:"p-2",children:ie(e.data_emissao)}),(0,L.jsxs)("td",{className:"p-2",children:[null===(n=e.credor)||void 0===n?void 0:n.nome," ",(0,L.jsx)("br",{}),(0,L.jsx)("span",{className:"text-[10px] text-slate-500",children:null===(s=e.credor)||void 0===s?void 0:s.documento_numero})]}),(0,L.jsx)("td",{className:"p-2 max-w-[200px] truncate",children:e.descricao}),(0,L.jsx)("td",{className:"p-2 text-right font-mono",children:se(e.valor_bruto)})]},t)})})]}):(0,L.jsx)("p",{className:"text-xs text-slate-500 italic p-2",children:"Nenhum registro."})]}),(0,L.jsxs)("section",{children:[(0,L.jsx)("h4",{className:"bg-slate-100 p-2 font-bold uppercase text-sm border-l-4 border-slate-800 mb-2",children:"4. Pagamentos"}),a.pagamentos&&a.pagamentos.length>0?(0,L.jsxs)("table",{className:"w-full text-xs text-left",children:[(0,L.jsx)("thead",{className:"bg-slate-50 border-b",children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{className:"p-2",children:"Data"}),(0,L.jsx)("th",{className:"p-2",children:"NF Vinculada"}),(0,L.jsx)("th",{className:"p-2",children:"Meio Pgto"}),(0,L.jsx)("th",{className:"p-2 text-right",children:"Valor Pago"})]})}),(0,L.jsx)("tbody",{children:a.pagamentos.map((e,t)=>{var n;return(0,L.jsxs)("tr",{className:"border-b hover:bg-slate-50",children:[(0,L.jsx)("td",{className:"p-2",children:ie(e.pagamento_data)}),(0,L.jsx)("td",{className:"p-2",children:(null===(n=e.identificacao_documento_fiscal)||void 0===n?void 0:n.numero)||"N/A"}),(0,L.jsxs)("td",{className:"p-2",children:[1===e.meio_pagamento_tipo?"Cheque":2===e.meio_pagamento_tipo?"Transf/Pix":"Esp\xe9cie",e.numero_transacao&&(0,L.jsxs)("span",{className:"block text-[10px] text-slate-500",children:["Tx: ",e.numero_transacao]})]}),(0,L.jsx)("td",{className:"p-2 text-right font-mono",children:se(e.pagamento_valor)})]},t)})})]}):(0,L.jsx)("p",{className:"text-xs text-slate-500 italic p-2",children:"Nenhum registro."})]}),(0,L.jsx)("section",{className:"mt-12 pt-8 border-t break-inside-avoid",children:(0,L.jsxs)("div",{className:"grid grid-cols-2 gap-16",children:[(0,L.jsxs)("div",{className:"text-center",children:[(0,L.jsx)("div",{className:"border-b border-black mb-2 h-8"}),(0,L.jsx)("p",{className:"font-bold text-sm",children:"Respons\xe1vel Legal"}),(0,L.jsx)("p",{className:"text-xs text-slate-500",children:"Assinatura"})]}),(0,L.jsxs)("div",{className:"text-center",children:[(0,L.jsx)("div",{className:"border-b border-black mb-2 h-8"}),(0,L.jsx)("p",{className:"font-bold text-sm",children:"Contador Respons\xe1vel"}),(0,L.jsx)("p",{className:"text-xs text-slate-500",children:"CRC/Assinatura"})]})]})}),(0,L.jsxs)("div",{className:"text-[10px] text-slate-400 text-center mt-8",children:["Gerado via Audesp Connect Phase V \u2022 ",(new Date).toLocaleString()]})]})]})},oe=e=>{let{data:t,updateField:n}=e;return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"1. Descritor da Presta\xe7\xe3o"}),(0,L.jsx)(ne,{label:"Tipo de Documento",value:t.descritor.tipo_documento,onChange:e=>n("descritor.tipo_documento",e),options:[{value:"Presta\xe7\xe3o de Contas de Conv\xeanio",label:"Presta\xe7\xe3o de Contas de Conv\xeanio"},{value:"Presta\xe7\xe3o de Contas de Contrato de Gest\xe3o",label:"Presta\xe7\xe3o de Contas de Contrato de Gest\xe3o"},{value:"Presta\xe7\xe3o de Contas de Termo de Parceria",label:"Presta\xe7\xe3o de Contas de Termo de Parceria"},{value:"Presta\xe7\xe3o de Contas de Termo de Fomento",label:"Presta\xe7\xe3o de Contas de Termo de Fomento"},{value:"Presta\xe7\xe3o de Contas de Termo de Colabora\xe7\xe3o",label:"Presta\xe7\xe3o de Contas de Termo de Colabora\xe7\xe3o"},{value:"Declara\xe7\xe3o Negativa",label:"Declara\xe7\xe3o Negativa"}]}),(0,L.jsxs)("div",{className:X+" mt-4",children:[(0,L.jsx)(ne,{label:"Munic\xedpio (C\xf3digo IBGE)",type:"number",value:t.descritor.municipio,onChange:e=>n("descritor.municipio",e)}),(0,L.jsx)(ne,{label:"Entidade (C\xf3digo TCESP)",type:"number",value:t.descritor.entidade,onChange:e=>n("descritor.entidade",e)}),(0,L.jsx)(ne,{label:"Ano de Refer\xeancia",type:"number",value:t.descritor.ano,onChange:e=>n("descritor.ano",e)}),(0,L.jsx)(ne,{label:"M\xeas de Refer\xeancia",type:"number",value:t.descritor.mes,onChange:e=>n("descritor.mes",e)})]}),(0,L.jsx)("p",{className:"mt-4 text-xs text-slate-500 italic bg-blue-50 p-2 rounded",children:"Certifique-se de que o C\xf3digo da Entidade e o Munic\xedpio correspondam exatamente ao seu cadastro no TCESP para evitar rejei\xe7\xe3o do lote."})]})},ae=e=>{let{data:t,updateField:n}=e;return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"2. C\xf3digo do Ajuste"}),(0,L.jsx)("div",{className:"max-w-md",children:(0,L.jsx)(ne,{label:"C\xf3digo do Ajuste (Fornecido pelo Tribunal)",value:t.codigo_ajuste,onChange:e=>n("codigo_ajuste",e)})}),(0,L.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Este c\xf3digo identifica unicamente o Conv\xeanio/Parceria no sistema Audesp."})]})},le=e=>{let{data:t,updateField:n}=e;return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"3. Retifica\xe7\xe3o"}),(0,L.jsxs)("div",{className:"bg-orange-50 p-4 rounded border border-orange-200 flex items-center gap-3",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:t.retificacao,onChange:e=>n("retificacao",e.target.checked)}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"font-bold text-slate-800 text-sm",children:"Este envio \xe9 uma RETIFICA\xc7\xc3O?"}),(0,L.jsx)("p",{className:"text-xs text-slate-500",children:"Marque apenas se voc\xea j\xe1 enviou uma presta\xe7\xe3o para este m\xeas e deseja corrigir dados."})]})]})]})};function ce(e,t,n){t||(t=[]);var s=t.length++;return Object.defineProperty({},"_",{set:function(i){t[s]=i,e.apply(n,t)}})}function de(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ue(e,t){de(e,t),t.add(e)}function he(e,t,n){de(e,t),t.set(e,n)}function pe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function fe(e,t,n){return n(pe(e,t))}function me(e,t){return e.get(pe(e,t))}function ge(e,t,n){return e.set(pe(e,t),n),n}function ve(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return ve=function(e){this.s=e,this.n=e.next},ve.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new ve(e)}var be,ye,_e,we,xe,Ee,Se,Ae,Ce,ke,Te,Ne,Ie,Pe,Re,Me,Oe,De;const je="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),Fe=[.001,0,0,.001,0,0],Le=1.35,Ue=1,Be=2,Ve=4,We=16,He=32,qe=64,ze=128,Ge=256,Ke={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Je="pdfjs_internal_editor_",Ye={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},$e={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Xe=1,Qe=2,Ze=0,et=1,tt=2,nt=3,st=3,it=4,rt={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ot={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},at=1,lt=2,ct=3,dt=4,ut=5,ht={ERRORS:0,WARNINGS:1,INFOS:5},pt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ft=0,mt=1,gt=2,vt=3,bt=4;let yt=ht.WARNINGS;function _t(e){Number.isInteger(e)&&(yt=e)}function wt(){return yt}function xt(e){yt>=ht.INFOS&&console.info("Info: ".concat(e))}function Et(e){yt>=ht.WARNINGS&&console.warn("Warning: ".concat(e))}function St(e){throw new Error(e)}function At(e,t){e||St(t)}function Ct(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;if(n&&"string"===typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);(null===t||void 0===t?void 0:t.length)>=2&&(e="http://".concat(e))}if(n.tryConvertEncoding)try{e=decodeURIComponent(escape(e))}catch(i){}}const s=t?URL.parse(e,t):URL.parse(e);return function(e){switch(null===e||void 0===e?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(s)?s:null}function kt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=URL.parse(e);return s?(s.hash=t,s.href):n&&Ct(e,"http://example.com")?e.split("#",1)[0]+"".concat(t?"#".concat(t):""):""}function Tt(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:n,enumerable:!s,configurable:!0,writable:!1}),n}const Nt=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class It extends Nt{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Pt extends Nt{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Rt extends Nt{constructor(e){super(e,"InvalidPDFException")}}class Mt extends Nt{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class Ot extends Nt{constructor(e){super(e,"FormatError")}}class Dt extends Nt{constructor(e){super(e,"AbortException")}}function jt(e){"object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.length)||St("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const s=[];for(let i=0;i<t;i+=n){const r=Math.min(i+n,t),o=e.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Ft(e){"string"!==typeof e&&St("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let s=0;s<t;++s)n[s]=255&e.charCodeAt(s);return n}class Lt{static get isLittleEndian(){return Tt(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return Tt(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(e){return!1}}())}static get isOffscreenCanvasSupported(){return Tt(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return Tt(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get isFloat16ArraySupported(){return Tt(this,"isFloat16ArraySupported","undefined"!==typeof Float16Array)}static get isSanitizerSupported(){return Tt(this,"isSanitizerSupported","undefined"!==typeof Sanitizer)}static get platform(){const{platform:e,userAgent:t}=navigator;return Tt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Tt(this,"isCSSRoundSupported",null===(e=globalThis.CSS)||void 0===e||null===(t=e.supports)||void 0===t?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Ut=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));class Bt{static makeHexColor(e,t,n){return"#".concat(Ut[e]).concat(Ut[t]).concat(Ut[n])}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=e[n],i=e[n+1];e[n]=s*t[0]+i*t[2]+t[4],e[n+1]=s*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=t[0],i=t[1],r=t[2],o=t[3],a=t[4],l=t[5];for(let c=0;c<6;c+=2){const t=e[n+c],d=e[n+c+1];e[n+c]=t*s+d*r+a,e[n+c+1]=t*i+d*o+l}}static applyInverseTransform(e,t){const n=e[0],s=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,n){const s=t[0],i=t[1],r=t[2],o=t[3],a=t[4],l=t[5],c=e[0],d=e[1],u=e[2],h=e[3];let p=s*c+a,f=p,m=s*u+a,g=m,v=o*d+l,b=v,y=o*h+l,_=y;if(0!==i||0!==r){const e=i*c,t=i*u,n=r*d,s=r*h;p+=n,g+=n,m+=s,f+=s,v+=e,_+=e,y+=t,b+=t}n[0]=Math.min(n[0],p,m,f,g),n[1]=Math.min(n[1],v,y,b,_),n[2]=Math.max(n[2],p,m,f,g),n[3]=Math.max(n[3],v,y,b,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],i=e[2],r=e[3],o=n**2+s**2,a=n*i+s*r,l=i**2+r**2,c=(o+l)/2,d=Math.sqrt(c**2-(o*l-a**2));t[0]=Math.sqrt(c+d||1),t[1]=Math.sqrt(c-d||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>r?null:[n,i,s,r]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,i){i[0]=Math.min(i[0],e,n),i[1]=Math.min(i[1],t,s),i[2]=Math.max(i[2],e,n),i[3]=Math.max(i[3],t,s)}static bezierBoundingBox(e,t,n,s,i,r,o,a,l){l[0]=Math.min(l[0],e,o),l[1]=Math.min(l[1],t,a),l[2]=Math.max(l[2],e,o),l[3]=Math.max(l[3],t,a),pe(Bt,this,Wt).call(this,e,n,i,o,t,s,r,a,3*(3*(n-i)-e+o),6*(e-2*n+i),3*(n-e),l),pe(Bt,this,Wt).call(this,e,n,i,o,t,s,r,a,3*(3*(s-r)-t+a),6*(t-2*s+r),3*(s-t),l)}}function Vt(e,t,n,s,i,r,o,a,l,c){if(l<=0||l>=1)return;const d=1-l,u=l*l,h=u*l,p=d*(d*(d*e+3*l*t)+3*u*n)+h*s,f=d*(d*(d*i+3*l*r)+3*u*o)+h*a;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}function Wt(e,t,n,s,i,r,o,a,l,c,d,u){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&pe(be,this,Vt).call(this,e,t,n,s,i,r,o,a,-d/c,u));const h=c**2-4*d*l;if(h<0)return;const p=Math.sqrt(h),f=2*l;pe(be,this,Vt).call(this,e,t,n,s,i,r,o,a,(-c+p)/f,u),pe(be,this,Vt).call(this,e,t,n,s,i,r,o,a,(-c-p)/f,u)}be=Bt;let Ht=null,qt=null;function zt(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),jt(e)}const Gt="pdfjs_internal_id_";function Kt(e,t,n){return Math.min(Math.max(e,t),n)}function Jt(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(jt(e))}"function"!==typeof Promise.try&&(Promise.try=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new Promise(t=>{t(e(...n))})}),"function"!==typeof Math.sumPrecise&&(Math.sumPrecise=function(e){return e.reduce((e,t)=>e+t,0)});class Yt{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};return function e(n){var s;if(!n)return;let i=null;const r=n.name;if("#text"===r)i=n.value;else{if(!Yt.shouldBuildText(r))return;null!==n&&void 0!==n&&null!==(s=n.attributes)&&void 0!==s&&s.textContent?i=n.attributes.textContent:n.value&&(i=n.value)}if(null!==i&&t.push({str:i}),n.children)for(const t of n.children)e(t)}(e),n}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}class $t{static setupStorage(e,t,n,s,i){const r=s.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==r.value&&(e.textContent=r.value),"print"===i)break;e.addEventListener("input",e=>{s.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(r.value===n.attributes.xfaOn?e.setAttribute("checked",!0):r.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===i)break;e.addEventListener("change",e=>{s.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==r.value&&e.setAttribute("value",r.value),"print"===i)break;e.addEventListener("input",e=>{s.setValue(t,{value:e.target.value})})}break;case"select":if(null!==r.value){e.setAttribute("value",r.value);for(const e of n.children)e.attributes.value===r.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,i=-1===n.selectedIndex?"":n[n.selectedIndex].value;s.setValue(t,{value:i})})}}static setAttributes(e){let{html:t,element:n,storage:s=null,intent:i,linkService:r}=e;const{attributes:o}=n,a=t instanceof HTMLAnchorElement;"radio"===o.type&&(o.name="".concat(o.name,"-").concat(i));for(const[l,c]of Object.entries(o))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!a||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}a&&r.addLinkAttributes(t,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(t,o.dataId,n,s)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,i=e.intent||"display",r=document.createElement(s.name);s.attributes&&this.setAttributes({html:r,element:s,intent:i,linkService:n});const o="richText"!==i,a=e.div;if(a.append(r),e.viewport){const t="matrix(".concat(e.viewport.transform.join(","),")");a.style.transform=t}o&&a.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===s.children.length){if(s.value){const e=document.createTextNode(s.value);r.append(e),o&&Yt.shouldBuildText(s.name)&&l.push(e)}return{textDivs:l}}const c=[[s,-1,r]];for(;c.length>0;){var d,u;const[e,s,r]=c.at(-1);if(s+1===e.children.length){c.pop();continue}const a=e.children[++c.at(-1)[1]];if(null===a)continue;const{name:h}=a;if("#text"===h){const e=document.createTextNode(a.value);l.push(e),r.append(e);continue}const p=null!==a&&void 0!==a&&null!==(d=a.attributes)&&void 0!==d&&d.xmlns?document.createElementNS(a.attributes.xmlns,h):document.createElement(h);if(r.append(p),a.attributes&&this.setAttributes({html:p,element:a,storage:t,intent:i,linkService:n}),(null===(u=a.children)||void 0===u?void 0:u.length)>0)c.push([a,-1,p]);else if(a.value){const e=document.createTextNode(a.value);o&&Yt.shouldBuildText(h)&&l.push(e),p.append(e)}}for(const h of a.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t="matrix(".concat(e.viewport.transform.join(","),")");e.div.style.transform=t,e.div.hidden=!1}}const Xt="http://www.w3.org/2000/svg";class Qt{}async function Zt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(on(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);switch(t){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,s)=>{const i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE)if(200!==i.status&&0!==i.status)s(new Error(i.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void n(i.response)}n(i.responseText)}},i.send(null)})}ye=Qt,r(Qt,"CSS",96),r(Qt,"PDF",72),r(Qt,"PDF_TO_CSS_UNITS",ye.CSS/ye.PDF);class en{constructor(e){let{viewBox:t,userUnit:n,scale:s,rotation:i,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}=e;this.viewBox=t,this.userUnit=n,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=o,s*=n;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let d,u,h,p,f,m,g,v;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,u=0,h=0,p=1;break;case 90:d=0,u=1,h=1,p=0;break;case 270:d=0,u=-1,h=-1,p=0;break;case 0:d=1,u=0,h=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(h=-h,p=-p),0===d?(f=Math.abs(c-t[1])*s+r,m=Math.abs(l-t[0])*s+o,g=(t[3]-t[1])*s,v=(t[2]-t[0])*s):(f=Math.abs(l-t[0])*s+r,m=Math.abs(c-t[1])*s+o,g=(t[2]-t[0])*s,v=(t[3]-t[1])*s),this.transform=[d*s,u*s,h*s,p*s,f-d*s*l-h*s*c,m-u*s*l-p*s*c],this.width=g,this.height=v}get rawDims(){const e=this.viewBox;return Tt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new en({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:i})}convertToViewportPoint(e,t){const n=[e,t];return Bt.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Bt.applyTransform(t,this.transform);const n=[e[2],e[3]];return Bt.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Bt.applyInverseTransform(n,this.transform),n}}class tn extends Nt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function nn(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function sn(e){return"string"===typeof e&&/\.pdf$/i.test(e)}class rn{constructor(){r(this,"started",Object.create(null)),r(this,"times",[])}time(e){e in this.started&&Et("Timer is already running for ".concat(e)),this.started[e]=Date.now()}timeEnd(e){e in this.started||Et("Timer has not been started for ".concat(e)),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:i}of this.times)e.push("".concat(n.padEnd(t)," ").concat(i-s,"ms\n"));return e.join("")}}function on(e,t){const n=t?URL.parse(e,t):URL.parse(e);return"http:"===(null===n||void 0===n?void 0:n.protocol)||"https:"===(null===n||void 0===n?void 0:n.protocol)}function an(e){e.preventDefault()}function ln(e){e.preventDefault(),e.stopPropagation()}class cn{static toDateObject(e){if(e instanceof Date)return e;if(!e||"string"!==typeof e)return null;pe(cn,this,dn)._||(dn._=pe(cn,this,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?")));const t=pe(cn,this,dn)._.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let a=parseInt(t[6],10);a=a>=0&&a<=59?a:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(r+=c,o+=d):"+"===l&&(r-=c,o-=d),new Date(Date.UTC(n,s,i,r,o,a))}}var dn={_:void 0};function un(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Et('Not a valid color format: "'.concat(e,'"')),[0,0,0])}function hn(e){const{a:t,b:n,c:s,d:i,e:r,f:o}=e.getTransform();return[t,n,s,i,r,o]}function pn(e){const{a:t,b:n,c:s,d:i,e:r,f:o}=e.getTransform().invertSelf();return[t,n,s,i,r,o]}function fn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof en){const{pageWidth:s,pageHeight:i}=t.rawDims,{style:r}=e,o=Lt.isCSSRoundSupported,a="var(--total-scale-factor) * ".concat(s,"px"),l="var(--total-scale-factor) * ".concat(i,"px"),c=o?"round(down, ".concat(a,", var(--scale-round-x))"):"calc(".concat(a,")"),d=o?"round(down, ".concat(l,", var(--scale-round-y))"):"calc(".concat(l,")");n&&t.rotation%180!==0?(r.width=d,r.height=c):(r.width=c,r.height=d)}s&&e.setAttribute("data-main-rotation",t.rotation)}class mn{constructor(){const{pixelRatio:e}=mn;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,r=1/0,o=1/0,a=1/0;(n=mn.capPixels(n,i))>0&&(r=Math.sqrt(n/(e*t))),-1!==s&&(o=s/e,a=s/t);const l=Math.min(r,o,a);return(this.sx>l||this.sy>l)&&(this.sx=l,this.sy=l,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const gn=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class vn{static get isDarkMode(){var e,t;return Tt(this,"isDarkMode",!(null===(e=window)||void 0===e||null===(t=e.matchMedia)||void 0===t||!t.call(e,"(prefers-color-scheme: dark)").matches))}}function bn(e,t){const n=e[0]/255,s=e[1]/255,i=e[2]/255,r=Math.max(n,s,i),o=Math.min(n,s,i),a=(r+o)/2;if(r===o)t[0]=t[1]=0;else{const e=r-o;switch(t[1]=a<.5?e/(r+o):e/(2-r-o),r){case n:t[0]=60*((s-i)/e+(s<i?6:0));break;case s:t[0]=60*((i-n)/e+2);break;case i:t[0]=60*((n-s)/e+4)}}t[2]=a}function yn(e,t){const n=e[0],s=e[1],i=e[2],r=(1-Math.abs(2*i-1))*s,o=r*(1-Math.abs(n/60%2-1)),a=i-r/2;switch(Math.floor(n/60)){case 0:t[0]=r+a,t[1]=o+a,t[2]=a;break;case 1:t[0]=o+a,t[1]=r+a,t[2]=a;break;case 2:t[0]=a,t[1]=r+a,t[2]=o+a;break;case 3:t[0]=a,t[1]=o+a,t[2]=r+a;break;case 4:t[0]=o+a,t[1]=a,t[2]=r+a;break;case 5:case 6:t[0]=r+a,t[1]=a,t[2]=o+a}}function _n(e){return e<=.03928?e/12.92:((e+.055)/1.055)**2.4}function wn(e,t,n){yn(e,n),n.map(_n);const s=.2126*n[0]+.7152*n[1]+.0722*n[2];yn(t,n),n.map(_n);const i=.2126*n[0]+.7152*n[1]+.0722*n[2];return s>i?(s+.05)/(i+.05):(i+.05)/(s+.05)}const xn=new Map;function En(e,t){let{html:n,dir:s,className:i}=e;const r=document.createDocumentFragment();if("string"===typeof n){const e=document.createElement("p");e.dir=s||"auto";const t=n.split(/(?:\r\n?|\n)/);for(let n=0,s=t.length;n<s;++n){const i=t[n];e.append(document.createTextNode(i)),n<s-1&&e.append(document.createElement("br"))}r.append(e)}else $t.render({xfaHtml:n,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",i),t.append(r)}function Sn(e){const t=new Path2D;if(!e)return t;for(let n=0,s=e.length;n<s;)switch(e[n++]){case ft:t.moveTo(e[n++],e[n++]);break;case mt:t.lineTo(e[n++],e[n++]);break;case gt:t.bezierCurveTo(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);break;case vt:t.quadraticCurveTo(e[n++],e[n++],e[n++],e[n++]);break;case bt:t.closePath();break;default:Et("Unrecognized drawing path operator: ".concat(e[n-1]))}return t}var An=new WeakMap,Cn=new WeakMap,kn=new WeakMap,Tn=new WeakMap,Nn=new WeakMap,In=new WeakMap,Pn=new WeakMap,Rn=new WeakMap,Mn=new WeakSet;class On{constructor(e){ue(this,Mn),he(this,An,null),he(this,Cn,null),he(this,kn,void 0),he(this,Tn,null),he(this,Nn,null),he(this,In,null),he(this,Pn,null),he(this,Rn,null),ge(kn,this,e),Bn._||(Bn._=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=ge(An,this,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=me(kn,this)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",an,{signal:t}),e.addEventListener("pointerdown",Dn,{signal:t}));const n=ge(Tn,this,document.createElement("div"));n.className="buttons",e.append(n);const s=me(kn,this).toolbarPosition;if(s){const{style:t}=e,n="ltr"===me(kn,this)._uiManager.direction?1-s[0]:s[0];t.insetInlineEnd="".concat(100*n,"%"),t.top="calc(".concat(100*s[1],"% + var(--editor-toolbar-vert-offset))")}return e}get div(){return me(An,this)}hide(){var e;me(An,this).classList.add("hidden"),null===(e=me(Cn,this))||void 0===e||e.hideDropdown()}show(){var e,t;me(An,this).classList.remove("hidden"),null===(e=me(Nn,this))||void 0===e||e.shown(),null===(t=me(In,this))||void 0===t||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=me(kn,this),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",Bn._[e]),pe(Mn,this,Ln).call(this,n)&&n.addEventListener("click",e=>{t.delete()},{signal:t._signal}),me(Tn,this).append(n)}async addAltText(e){const t=await e.render();pe(Mn,this,Ln).call(this,t),me(Tn,this).append(t,fe(Mn,this,Un)),ge(Nn,this,e)}addComment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(me(In,this))return;const n=e.renderForToolbar();if(!n)return;pe(Mn,this,Ln).call(this,n);const s=ge(Pn,this,fe(Mn,this,Un));t?(me(Tn,this).insertBefore(n,t),me(Tn,this).insertBefore(s,t)):me(Tn,this).append(n,s),ge(In,this,e),e.toolbar=this}addColorPicker(e){if(me(Cn,this))return;ge(Cn,this,e);const t=e.renderButton();pe(Mn,this,Ln).call(this,t),me(Tn,this).append(t,fe(Mn,this,Un))}async addEditSignatureButton(e){const t=ge(Rn,this,await e.renderEditButton(me(kn,this)));pe(Mn,this,Ln).call(this,t),me(Tn,this).append(t,fe(Mn,this,Un))}removeButton(e){var t,n;if("comment"===e)null===(t=me(In,this))||void 0===t||t.removeToolbarCommentButton(),ge(In,this,null),null===(n=me(Pn,this))||void 0===n||n.remove(),ge(Pn,this,null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t)}}async addButtonBefore(e,t,n){if(!t&&"comment"===e)return;const s=me(Tn,this).querySelector(n);s&&"comment"===e&&this.addComment(t,s)}updateEditSignatureButton(e){me(Rn,this)&&(me(Rn,this).title=e)}remove(){var e;me(An,this).remove(),null===(e=me(Cn,this))||void 0===e||e.destroy(),ge(Cn,this,null)}}function Dn(e){e.stopPropagation()}function jn(e){me(kn,this)._focusEventsAllowed=!1,ln(e)}function Fn(e){me(kn,this)._focusEventsAllowed=!0,ln(e)}function Ln(e){const t=me(kn,this)._uiManager._signal;return t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("focusin",pe(Mn,this,jn).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",pe(Mn,this,Fn).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",an,{signal:t}),!0)}function Un(e){const t=document.createElement("div");return t.className="divider",t}var Bn={_:null},Vn=new WeakMap,Wn=new WeakMap,Hn=new WeakMap,qn=new WeakSet;class zn{constructor(e){ue(this,qn),he(this,Vn,null),he(this,Wn,null),he(this,Hn,void 0),ge(Hn,this,e)}show(e,t,n){const[s,i]=pe(qn,this,Kn).call(this,t,n),{style:r}=me(Wn,this)||ge(Wn,this,pe(qn,this,Gn).call(this));e.append(me(Wn,this)),r.insetInlineEnd="".concat(100*s,"%"),r.top="calc(".concat(100*i,"% + var(--editor-toolbar-vert-offset))")}hide(){me(Wn,this).remove()}}function Gn(){const e=ge(Wn,this,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=me(Hn,this)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",an,{signal:t});const n=ge(Vn,this,document.createElement("div"));return n.className="buttons",e.append(n),me(Hn,this).hasCommentManager()&&pe(qn,this,Jn).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{me(Hn,this).commentSelection("floating_button")}),pe(qn,this,Jn).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{me(Hn,this).highlightSelection("floating_button")}),e}function Kn(e,t){let n=0,s=0;for(const i of e){const e=i.y+i.height;if(e<n)continue;const r=i.x+(t?i.width:0);e>n?(s=r,n=e):t?r>s&&(s=r):r<s&&(s=r)}return[t?1-s:s,n]}function Jn(e,t,n,s){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const r=document.createElement("span");i.append(r),r.className="visuallyHidden",r.setAttribute("data-l10n-id",n);const o=me(Hn,this)._signal;o instanceof AbortSignal&&!o.aborted&&(i.addEventListener("contextmenu",an,{signal:o}),i.addEventListener("click",s,{signal:o})),me(Vn,this).append(i)}function Yn(e,t,n){for(const s of n)t.addEventListener(s,e[s].bind(e))}class $n{static initializeAndAddPointerId(e){(Qn._||(Qn._=new Set)).add(e)}static setPointer(e,t){var n;Xn._||(Xn._=t),null!==(n=es._)&&void 0!==n||(es._=e)}static setTimeStamp(e){Zn._=e}static isSamePointerId(e){return Xn._===e}static isSamePointerIdOrRemove(e){var t;return Xn._===e||(null===(t=Qn._)||void 0===t||t.delete(e),!1)}static isSamePointerType(e){return es._===e}static isInitializedAndDifferentPointerType(e){return null!==es._&&!$n.isSamePointerType(e)}static isSameTimeStamp(e){return Zn._===e}static isUsingMultiplePointers(){var e;return(null===(e=Qn._)||void 0===e?void 0:e.size)>=1}static clearPointerType(){es._=null}static clearPointerIds(){Xn._=NaN,Qn._=null}static clearTimeStamp(){Zn._=NaN}}var Xn={_:NaN},Qn={_:null},Zn={_:NaN},es={_:null},ts=new WeakMap;class ns{constructor(){he(this,ts,0)}get id(){var e,t;return"".concat(Je).concat((ge(ts,this,(e=me(ts,this),t=e++,e)),t))}}var ss=new WeakMap,is=new WeakMap,rs=new WeakMap,os=new WeakSet;class as{constructor(){ue(this,os),he(this,ss,zt()),he(this,is,0),he(this,rs,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return Tt(this,"_isSVGFittingCanvas",t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0])))}async getFromFile(e){const{lastModified:t,name:n,size:s,type:i}=e;return pe(os,this,ls).call(this,"".concat(t,"_").concat(n,"_").concat(s,"_").concat(i),e)}async getFromUrl(e){return pe(os,this,ls).call(this,e,e)}async getFromBlob(e,t){const n=await t;return pe(os,this,ls).call(this,e,n)}async getFromId(e){me(rs,this)||ge(rs,this,new Map);const t=me(rs,this).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){var n,s,i;me(rs,this)||ge(rs,this,new Map);let r=me(rs,this).get(e);if(null!==(i=r)&&void 0!==i&&i.bitmap)return r.refCounter+=1,r;const o=new OffscreenCanvas(t.width,t.height);return o.getContext("2d").drawImage(t,0,0),r={bitmap:o.transferToImageBitmap(),id:"image_".concat(me(ss,this),"_").concat((ge(is,this,(n=me(is,this),s=n++,n)),s)),refCounter:1,isSvg:!1},me(rs,this).set(e,r),me(rs,this).set(r.id,r),r}getSvgUrl(e){const t=me(rs,this).get(e);return null!==t&&void 0!==t&&t.isSvg?t.svgUrl:null}deleteId(e){var t;me(rs,this)||ge(rs,this,new Map);const n=me(rs,this).get(e);if(!n)return;if(n.refCounter-=1,0!==n.refCounter)return;const{bitmap:s}=n;if(!n.url&&!n.file){const e=new OffscreenCanvas(s.width,s.height);e.getContext("bitmaprenderer").transferFromImageBitmap(s),n.blobPromise=e.convertToBlob()}null===(t=s.close)||void 0===t||t.call(s),n.bitmap=null}isValidId(e){return e.startsWith("image_".concat(me(ss,this),"_"))}}async function ls(e,t){var n;me(rs,this)||ge(rs,this,new Map);let s=me(rs,this).get(e);if(null===s)return null;if(null!==(n=s)&&void 0!==n&&n.bitmap)return s.refCounter+=1,s;try{var i,r;let e;if(s||(s={bitmap:null,id:"image_".concat(me(ss,this),"_").concat((ge(is,this,(i=me(is,this),r=i++,i)),r)),refCounter:0,isSvg:!1}),"string"===typeof t?(s.url=t,e=await Zt(t,"blob")):t instanceof File?e=s.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=_e._isSVGFittingCanvas,n=new FileReader,i=new Image,r=new Promise((e,r)=>{i.onload=()=>{s.bitmap=i,s.isSvg=!0,e()},n.onload=async()=>{const e=s.svgUrl=n.result;i.src=await t?"".concat(e,"#svgView(preserveAspectRatio(none))"):e},i.onerror=n.onerror=r});n.readAsDataURL(e),await r}else s.bitmap=await createImageBitmap(e);s.refCounter=1}catch(o){Et(o),s=null}return me(rs,this).set(e,s),s&&me(rs,this).set(s.id,s),s}_e=as;var cs=new WeakMap,ds=new WeakMap,us=new WeakMap,hs=new WeakMap;class ps{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;he(this,cs,[]),he(this,ds,!1),he(this,us,void 0),he(this,hs,-1),ge(us,this,e)}add(e){let{cmd:t,undo:n,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}=e;if(i&&t(),me(ds,this))return;const l={cmd:t,undo:n,post:s,type:r};if(-1===me(hs,this))return me(cs,this).length>0&&(me(cs,this).length=0),ge(hs,this,0),void me(cs,this).push(l);if(o&&me(cs,this)[me(hs,this)].type===r)return a&&(l.undo=me(cs,this)[me(hs,this)].undo),void(me(cs,this)[me(hs,this)]=l);const c=me(hs,this)+1;c===me(us,this)?me(cs,this).splice(0,1):(ge(hs,this,c),c<me(cs,this).length&&me(cs,this).splice(c)),me(cs,this).push(l)}undo(){if(-1===me(hs,this))return;ge(ds,this,!0);const{undo:e,post:t}=me(cs,this)[me(hs,this)];e(),null===t||void 0===t||t(),ge(ds,this,!1),ge(hs,this,me(hs,this)-1)}redo(){if(me(hs,this)<me(cs,this).length-1){ge(hs,this,me(hs,this)+1),ge(ds,this,!0);const{cmd:e,post:t}=me(cs,this)[me(hs,this)];e(),null===t||void 0===t||t(),ge(ds,this,!1)}}hasSomethingToUndo(){return-1!==me(hs,this)}hasSomethingToRedo(){return me(hs,this)<me(cs,this).length-1}cleanType(e){if(-1!==me(hs,this)){for(let t=me(hs,this);t>=0;t--)if(me(cs,this)[t].type!==e)return me(cs,this).splice(t+1,me(hs,this)-t),void ge(hs,this,t);me(cs,this).length=0,ge(hs,this,-1)}}destroy(){ge(cs,this,null)}}var fs=new WeakSet;class ms{constructor(e){ue(this,fs),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Lt.platform;for(const[n,s,i={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:s,options:i}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:s,options:i}),this.allKeys.add(e.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(pe(fs,this,gs).call(this,t));if(!n)return;const{callback:s,options:{bubbles:i=!1,args:r=[],checker:o=null}}=n;o&&!o(e,t)||(s.bind(e,...r,t)(),i||ln(t))}}function gs(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}class vs{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const n of e.keys()){t.style.color=n;const s=window.getComputedStyle(t).color;e.set(n,un(s))}t.remove()}(e),Tt(this,"_colors",e)}convert(e){const t=un(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((e,n)=>e===t[n]))return vs._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Bt.makeHexColor(...t):e}}r(vs,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var bs=new WeakMap,ys=new WeakMap,_s=new WeakMap,ws=new WeakMap,xs=new WeakMap,Es=new WeakMap,Ss=new WeakMap,As=new WeakMap,Cs=new WeakMap,ks=new WeakMap,Ts=new WeakMap,Ns=new WeakMap,Is=new WeakMap,Ps=new WeakMap,Rs=new WeakMap,Ms=new WeakMap,Os=new WeakMap,Ds=new WeakMap,js=new WeakMap,Fs=new WeakMap,Ls=new WeakMap,Us=new WeakMap,Bs=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,Hs=new WeakMap,qs=new WeakMap,zs=new WeakMap,Gs=new WeakMap,Ks=new WeakMap,Js=new WeakMap,Ys=new WeakMap,$s=new WeakMap,Xs=new WeakMap,Qs=new WeakMap,Zs=new WeakMap,ei=new WeakMap,ti=new WeakMap,ni=new WeakMap,si=new WeakMap,ii=new WeakMap,ri=new WeakMap,oi=new WeakMap,ai=new WeakMap,li=new WeakMap,ci=new WeakMap,di=new WeakMap,ui=new WeakMap,hi=new WeakMap,pi=new WeakSet;class fi{static get _keyboardManager(){const e=fi.prototype,t=e=>me(ci,e).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),n=(e,t)=>{let{target:n}=t;if(n instanceof HTMLInputElement){const{type:e}=n;return"text"!==e&&"number"!==e}return!0},s=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return Tt(this,"_keyboardManager",new ms([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&me(ci,e).contains(n)&&!e.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&me(ci,e).contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,n,s,i,o,a,l,c,d,u,h,p,f,m,g){ue(this,pi),he(this,bs,new AbortController),he(this,ys,null),he(this,_s,null),he(this,ws,new Map),he(this,xs,new Map),he(this,Es,null),he(this,Ss,null),he(this,As,null),he(this,Cs,new ps),he(this,ks,null),he(this,Ts,null),he(this,Ns,null),he(this,Is,0),he(this,Ps,new Set),he(this,Rs,null),he(this,Ms,null),he(this,Os,new Set),r(this,"_editorUndoBar",null),he(this,Ds,!1),he(this,js,!1),he(this,Fs,!1),he(this,Ls,null),he(this,Us,null),he(this,Bs,null),he(this,Vs,null),he(this,Ws,!1),he(this,Hs,null),he(this,qs,new ns),he(this,zs,!1),he(this,Gs,!1),he(this,Ks,!1),he(this,Js,null),he(this,Ys,null),he(this,$s,null),he(this,Xs,null),he(this,Qs,null),he(this,Zs,Ye.NONE),he(this,ei,new Set),he(this,ti,null),he(this,ni,null),he(this,si,null),he(this,ii,null),he(this,ri,null),he(this,oi,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),he(this,ai,[0,0]),he(this,li,null),he(this,ci,null),he(this,di,null),he(this,ui,null),he(this,hi,null);const v=this._signal=me(bs,this).signal;ge(ci,this,e),ge(di,this,t),ge(ui,this,n),ge(Es,this,s),ge(ks,this,i),ge(ni,this,o),ge(ri,this,l),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:v}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),a._on("setpreference",this.onSetPreference.bind(this),{signal:v}),a._on("switchannotationeditorparams",e=>this.updateParams(e.type,e.value),{signal:v}),window.addEventListener("pointerdown",()=>{ge(Gs,this,!0)},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{ge(Gs,this,!1)},{capture:!0,signal:v}),pe(pi,this,_i).call(this),pe(pi,this,ki).call(this),pe(pi,this,Ei).call(this),ge(Ss,this,l.annotationStorage),ge(Ls,this,l.filterFactory),ge(si,this,c),ge(Vs,this,d||null),ge(Ds,this,u),ge(js,this,h),ge(Fs,this,p),ge(Qs,this,f||null),this.viewParameters={realScale:Qt.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=!1!==g,null===i||void 0===i||i.setSidebarUiManager(this)}destroy(){var e,t,n,s,i,r,o,a,l;null===(e=me(hi,this))||void 0===e||e.resolve(),ge(hi,this,null),null===(t=me(bs,this))||void 0===t||t.abort(),ge(bs,this,null),this._signal=null;for(const c of me(xs,this).values())c.destroy();me(xs,this).clear(),me(ws,this).clear(),me(Os,this).clear(),null===(n=me(Xs,this))||void 0===n||n.clear(),ge(ys,this,null),me(ei,this).clear(),me(Cs,this).destroy(),null===(s=me(Es,this))||void 0===s||s.destroy(),null===(i=me(ks,this))||void 0===i||i.destroy(),null===(r=me(ni,this))||void 0===r||r.destroy(),null===(o=me(Hs,this))||void 0===o||o.hide(),ge(Hs,this,null),null===(a=me($s,this))||void 0===a||a.destroy(),ge($s,this,null),ge(_s,this,null),me(Us,this)&&(clearTimeout(me(Us,this)),ge(Us,this,null)),me(li,this)&&(clearTimeout(me(li,this)),ge(li,this,null)),null===(l=this._editorUndoBar)||void 0===l||l.destroy(),ge(ri,this,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return me(Qs,this)}get useNewAltTextFlow(){return me(js,this)}get useNewAltTextWhenAddingImage(){return me(Fs,this)}get hcmFilter(){return Tt(this,"hcmFilter",me(si,this)?me(Ls,this).addHCMFilter(me(si,this).foreground,me(si,this).background):"none")}get direction(){return Tt(this,"direction",getComputedStyle(me(ci,this)).direction)}get _highlightColors(){return Tt(this,"_highlightColors",me(Vs,this)?new Map(me(Vs,this).split(",").map(e=>((e=e.split("=").map(e=>e.trim()))[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Tt(this,"highlightColors",null);const t=new Map,n=!!me(si,this);for(const[s,i]of e){const e=s.endsWith("_HCM");n&&e?t.set(s.replace("_HCM",""),i):n||e||t.set(s,i)}return Tt(this,"highlightColors",t)}get highlightColorNames(){return Tt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),ge(Ns,this,e)}setMainHighlightColorPicker(e){ge($s,this,e)}editAltText(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=me(Es,this))||void 0===t||t.editAltText(this,e,n)}hasCommentManager(){return!!me(ks,this)}editComment(e,t,n,s){var i;null===(i=me(ks,this))||void 0===i||i.showDialog(this,e,t,n,s)}selectComment(e,t){const n=me(xs,this).get(e),s=null===n||void 0===n?void 0:n.getEditorByUID(t);null===s||void 0===s||s.toggleComment(!0,!0)}updateComment(e){var t;null===(t=me(ks,this))||void 0===t||t.updateComment(e.getData())}updatePopupColor(e){var t;null===(t=me(ks,this))||void 0===t||t.updatePopupColor(e)}removeComment(e){var t;null===(t=me(ks,this))||void 0===t||t.removeComments([e.uid])}toggleComment(e,t){var n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;null===(n=me(ks,this))||void 0===n||n.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var n;return e&&(null===(n=me(ks,this))||void 0===n?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return(null===(e=me(ks,this))||void 0===e?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(me(xs,this).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=n=>{n.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){var t;null===(t=me(ni,this))||void 0===t||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return me(ni,this)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference(e){let{name:t,value:n}=e;if("enableNewAltTextWhenAddingImage"===t)ge(Fs,this,n)}onPageChanging(e){let{pageNumber:t}=e;ge(Is,this,t-1)}focusMainContainer(){me(ci,this).focus()}findParent(e,t){for(const n of me(xs,this).values()){const{x:s,y:i,width:r,height:o}=n.div.getBoundingClientRect();if(e>=s&&e<=s+r&&t>=i&&t<=i+o)return n}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];me(di,this).classList.toggle("noUserSelect",e)}addShouldRescale(e){me(Os,this).add(e)}removeShouldRescale(e){me(Os,this).delete(e)}onScaleChanging(e){var t;let{scale:n}=e;this.commitOrRemove(),this.viewParameters.realScale=n*Qt.PDF_TO_CSS_UNITS;for(const s of me(Os,this))s.onScaleChanging();null===(t=me(Ns,this))||void 0===t||t.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o}=n,a=n.toString(),l=pe(pi,this,mi).call(this,n).closest(".textLayer"),c=this.getSelectionBoxes(l);if(!c)return;n.empty();const d=pe(pi,this,gi).call(this,l),u=me(Zs,this)===Ye.NONE,h=()=>{const n=null===d||void 0===d?void 0:d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:c,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o,text:a});u&&this.showAllEditors("highlight",!0,!0),t&&(null===n||void 0===n||n.editComment())};u?this.switchToMode(Ye.HIGHLIGHT,h):h()}commentSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!me(Ss,this))return null;const t="".concat(Je).concat(e),n=me(Ss,this).getRawValue(t);return n&&me(Ss,this).remove(t),n}addToAnnotationStorage(e){e.isEmpty()||!me(Ss,this)||me(Ss,this).has(e.id)||me(Ss,this).setValue(e.id,e)}a11yAlert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=me(ui,this);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,me(Ws,this)&&(ge(Ws,this,!1),pe(pi,this,yi).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of me(ei,this))if(t.div.contains(e)){ge(Ys,this,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!me(Ys,this))return;const[e,t]=me(Ys,this);ge(Ys,this,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){pe(pi,this,Ei).call(this),this.setEditingState(!0)}removeEditListeners(){pe(pi,this,Si).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of me(Ms,this))if(n.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const n of me(Ms,this))if(n.isHandlingMimeForPasting(t.type))return n.paste(t,this.currentLayer),void e.preventDefault()}copy(e){var t;if(e.preventDefault(),null===(t=me(ys,this))||void 0===t||t.commitOrRemove(),!this.hasSelection)return;const n=[];for(const s of me(ei,this)){const e=s.serialize(!0);e&&n.push(e)}0!==n.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const e of me(Ms,this))if(e.isHandlingMimeForPasting(r.type))return void e.paste(r,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){return void Et('paste: "'.concat(i.message,'".'))}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const e=[];for(const r of n){const t=await s.deserialize(r);if(!t)return;e.push(t)}const t=()=>{for(const t of e)pe(pi,this,Ri).call(this,t);pe(pi,this,Di).call(this,e)},i=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:i,mustExec:!0})}catch(i){Et('paste: "'.concat(i.message,'".'))}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),me(Zs,this)===Ye.NONE||this.isEditorHandlingKeyboard||fi._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,me(Ws,this)&&(ge(Ws,this,!1),pe(pi,this,yi).call(this,"main_toolbar")))}onEditingAction(e){let{name:t}=e;switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu")}}setEditingState(e){e?(pe(pi,this,wi).call(this),pe(pi,this,Ai).call(this),pe(pi,this,Ti).call(this,{isEditing:me(Zs,this)!==Ye.NONE,isEmpty:pe(pi,this,Oi).call(this),hasSomethingToUndo:me(Cs,this).hasSomethingToUndo(),hasSomethingToRedo:me(Cs,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(pe(pi,this,xi).call(this),pe(pi,this,Ci).call(this),pe(pi,this,Ti).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!me(Ms,this)){ge(Ms,this,e);for(const e of me(Ms,this))pe(pi,this,Ni).call(this,e.defaultPropertiesToUpdate)}}getId(){return me(qs,this).id}get currentLayer(){return me(xs,this).get(me(Is,this))}getLayer(e){return me(xs,this).get(e)}get currentPageIndex(){return me(Is,this)}addLayer(e){me(xs,this).set(e.pageIndex,e),me(zs,this)?e.enable():e.disable()}removeLayer(e){me(xs,this).delete(e.pageIndex)}async updateMode(e){var t,n;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(me(Zs,this)!==e&&(!me(hi,this)||(await me(hi,this).promise,me(hi,this)))){var l,c;if(ge(hi,this,Promise.withResolvers()),null===(t=me(Ns,this))||void 0===t||t.commitOrRemove(),me(Zs,this)===Ye.POPUP)null===(l=me(ks,this))||void 0===l||l.hideSidebar();if(null===(n=me(ks,this))||void 0===n||n.destroyPopup(),ge(Zs,this,e),e===Ye.NONE){var d;this.setEditingState(!1),pe(pi,this,Pi).call(this);for(const e of me(ws,this).values())e.hideStandaloneCommentButton();return null===(d=this._editorUndoBar)||void 0===d||d.hide(),this.toggleComment(null),void me(hi,this).resolve()}for(const e of me(ws,this).values())e.addStandaloneCommentButton();if(e===Ye.SIGNATURE)await(null===(c=me(ni,this))||void 0===c?void 0:c.loadSignatures());i&&$n.clearPointerType(),this.setEditingState(!0),await pe(pi,this,Ii).call(this),this.unselectAll();for(const t of me(xs,this).values())t.updateMode(e);if(e===Ye.POPUP){var u;me(_s,this)||ge(_s,this,await me(ri,this).getAnnotationsByType(new Set(me(Ms,this).map(e=>e._editorType))));const e=new Set,t=[];for(const n of me(ws,this).values()){const{annotationElementId:s,hasComment:i,deleted:r}=n;s&&e.add(s),i&&!r&&t.push(n.getData())}for(const n of me(_s,this)){const{id:s,popupRef:i,contentsObj:r}=n;i&&null!==r&&void 0!==r&&r.str&&!e.has(s)&&!me(Ps,this).has(s)&&t.push(n)}null===(u=me(ks,this))||void 0===u||u.showSidebar(t)}if(!s)return r&&this.addNewEditorFromKeyboard(),void me(hi,this).resolve();for(const e of me(ws,this).values())e.uid===s?(this.setSelected(e),a?e.editComment():o?e.enterInEditMode():e.focus()):e.unselect();me(hi,this).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==me(Zs,this)&&this._eventBus.dispatch("switchannotationeditormode",a({source:this},e))}updateParams(e,t){if(me(Ms,this)){switch(e){case $e.CREATE:return void this.currentLayer.addNewEditor(t);case $e.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(me(ii,this)||ge(ii,this,new Map)).set(e,t),this.showAllEditors("highlight",t)}if(this.hasSelection)for(const n of me(ei,this))n.updateParams(e,t);else for(const n of me(Ms,this))n.updateDefaultParams(e,t)}}showAllEditors(e,t){var n,s;for(const i of me(ws,this).values())i.editorType===e&&i.show(t);(null===(n=null===(s=me(ii,this))||void 0===s?void 0:s.get($e.HIGHLIGHT_SHOW_ALL))||void 0===n||n)!==t&&pe(pi,this,Ni).call(this,[[$e.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(me(Ks,this)!==e){ge(Ks,this,e);for(const t of me(xs,this).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of me(ws,this).values())t.pageIndex===e&&(yield t)}getEditor(e){return me(ws,this).get(e)}addEditor(e){me(ws,this).set(e.id,e)}removeEditor(e){var t,n;(e.div.contains(document.activeElement)&&(me(Us,this)&&clearTimeout(me(Us,this)),ge(Us,this,setTimeout(()=>{this.focusMainContainer(),ge(Us,this,null)},0))),me(ws,this).delete(e.id),e.annotationElementId)&&(null===(t=me(Xs,this))||void 0===t||t.delete(e.annotationElementId));(this.unselect(e),e.annotationElementId&&me(Ps,this).has(e.annotationElementId))||(null===(n=me(Ss,this))||void 0===n||n.remove(e.id))}addDeletedAnnotationElement(e){me(Ps,this).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return me(Ps,this).has(e)}removeDeletedAnnotationElement(e){me(Ps,this).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){me(ys,this)!==e&&(ge(ys,this,e),e&&pe(pi,this,Ni).call(this,e.propertiesToUpdate))}updateUI(e){fe(pi,this,Mi)===e&&pe(pi,this,Ni).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){pe(pi,this,Ni).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(me(ei,this).has(e))return me(ei,this).delete(e),e.unselect(),void pe(pi,this,Ti).call(this,{hasSelectedEditor:this.hasSelection});me(ei,this).add(e),e.select(),pe(pi,this,Ni).call(this,e.propertiesToUpdate),pe(pi,this,Ti).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),null===(t=me(Ns,this))||void 0===t||t.commitOrRemove();for(const n of me(ei,this))n!==e&&n.unselect();me(ei,this).clear(),me(ei,this).add(e),e.select(),pe(pi,this,Ni).call(this,e.propertiesToUpdate),pe(pi,this,Ti).call(this,{hasSelectedEditor:!0})}isSelected(e){return me(ei,this).has(e)}get firstSelectedEditor(){return me(ei,this).values().next().value}unselect(e){e.unselect(),me(ei,this).delete(e),pe(pi,this,Ti).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==me(ei,this).size}get isEnterHandled(){return 1===me(ei,this).size&&this.firstSelectedEditor.isEnterHandled}undo(){var e;me(Cs,this).undo(),pe(pi,this,Ti).call(this,{hasSomethingToUndo:me(Cs,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:pe(pi,this,Oi).call(this)}),null===(e=this._editorUndoBar)||void 0===e||e.hide()}redo(){me(Cs,this).redo(),pe(pi,this,Ti).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:me(Cs,this).hasSomethingToRedo(),isEmpty:pe(pi,this,Oi).call(this)})}addCommands(e){me(Cs,this).add(e),pe(pi,this,Ti).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:pe(pi,this,Oi).call(this)})}cleanUndoStack(e){me(Cs,this).cleanType(e)}delete(){var e;this.commitOrRemove();const t=null===(e=this.currentLayer)||void 0===e?void 0:e.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const n=t?[t]:[...me(ei,this)],s=()=>{for(const e of n)pe(pi,this,Ri).call(this,e)};this.addCommands({cmd:()=>{var e;null===(e=this._editorUndoBar)||void 0===e||e.show(s,1===n.length?n[0].editorType:n.length);for(const t of n)t.remove()},undo:s,mustExec:!0})}commitOrRemove(){var e;null===(e=me(ys,this))||void 0===e||e.commitOrRemove()}hasSomethingToControl(){return me(ys,this)||this.hasSelection}selectAll(){for(const e of me(ei,this))e.commit();pe(pi,this,Di).call(this,me(ws,this).values())}unselectAll(){var e;if((!me(ys,this)||(me(ys,this).commitOrRemove(),me(Zs,this)===Ye.NONE))&&(null===(e=me(Ns,this))||void 0===e||!e.commitOrRemove())&&this.hasSelection){for(const e of me(ei,this))e.unselect();me(ei,this).clear(),pe(pi,this,Ti).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;me(ai,this)[0]+=e,me(ai,this)[1]+=t;const[n,s]=me(ai,this),i=[...me(ei,this)];me(li,this)&&clearTimeout(me(li,this)),ge(li,this,setTimeout(()=>{ge(li,this,null),me(ai,this)[0]=me(ai,this)[1]=0,this.addCommands({cmd:()=>{for(const e of i)me(ws,this).has(e.id)&&(e.translateInPage(n,s),e.translationDone())},undo:()=>{for(const e of i)me(ws,this).has(e.id)&&(e.translateInPage(-n,-s),e.translationDone())},mustExec:!1})},1e3));for(const r of i)r.translateInPage(e,t),r.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ge(Rs,this,new Map);for(const e of me(ei,this))me(Rs,this).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!me(Rs,this))return!1;this.disableUserSelect(!1);const e=me(Rs,this);ge(Rs,this,null);let t=!1;for(const[{x:s,y:i,pageIndex:r},o]of e)o.newX=s,o.newY=i,o.newPageIndex=r,t||(t=s!==o.savedX||i!==o.savedY||r!==o.savedPageIndex);if(!t)return!1;const n=(e,t,n,s)=>{if(me(ws,this).has(e.id)){const i=me(xs,this).get(s);i?e._setParentAndPosition(i,t,n):(e.pageIndex=s,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:s,newY:i,newPageIndex:r}]of e)n(t,s,i,r)},undo:()=>{for(const[t,{savedX:s,savedY:i,savedPageIndex:r}]of e)n(t,s,i,r)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(me(Rs,this))for(const n of me(Rs,this).keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return(null===(e=this.getActive())||void 0===e?void 0:e.shouldGetKeyboardEvents())||1===me(ei,this).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return me(ys,this)===e}getActive(){return me(ys,this)}getMode(){return me(Zs,this)}isEditingMode(){return me(Zs,this)!==Ye.NONE}get imageManager(){return Tt(this,"imageManager",new as)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:n,y:s,width:i,height:r}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(e,t,o,a)=>({x:(t-s)/r,y:1-(e+o-n)/i,width:a/r,height:o/i});break;case"180":o=(e,t,o,a)=>({x:1-(e+o-n)/i,y:1-(t+a-s)/r,width:o/i,height:a/r});break;case"270":o=(e,t,o,a)=>({x:1-(t+a-s)/r,y:(e-n)/i,width:a/r,height:o/i});break;default:o=(e,t,o,a)=>({x:(e-n)/i,y:(t-s)/r,width:o/i,height:a/r})}const a=[];for(let l=0,c=t.rangeCount;l<c;l++){const e=t.getRangeAt(l);if(!e.collapsed)for(const{x:t,y:n,width:s,height:i}of e.getClientRects())0!==s&&0!==i&&a.push(o(t,n,s,i))}return 0===a.length?null:a}addChangedExistingAnnotation(e){let{annotationElementId:t,id:n}=e;(me(As,this)||ge(As,this,new Map)).set(t,n)}removeChangedExistingAnnotation(e){var t;let{annotationElementId:n}=e;null===(t=me(As,this))||void 0===t||t.delete(n)}renderAnnotationElement(e){var t;const n=null===(t=me(As,this))||void 0===t?void 0:t.get(e.data.id);if(!n)return;const s=me(Ss,this).getRawValue(n);s&&(me(Zs,this)!==Ye.NONE||s.hasBeenModified)&&s.renderAnnotationElement(e)}setMissingCanvas(e,t,n){var s;const i=null===(s=me(Xs,this))||void 0===s?void 0:s.get(e);i&&(i.setCanvas(t,n),me(Xs,this).delete(e))}addMissingCanvas(e,t){(me(Xs,this)||ge(Xs,this,new Map)).set(e,t)}}function mi(e){let{anchorNode:t}=e;return t.nodeType===Node.TEXT_NODE?t.parentElement:t}function gi(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of me(xs,this).values())if(n.hasTextLayer(e))return n;return null}function vi(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=pe(pi,this,mi).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(t);n&&(me(Hs,this)||ge(Hs,this,new zn(this)),me(Hs,this).show(t,n,"ltr"===this.direction))}function bi(){var e;const t=document.getSelection();if(!t||t.isCollapsed){var n;if(me(ti,this))null===(n=me(Hs,this))||void 0===n||n.hide(),ge(ti,this,null),pe(pi,this,Ti).call(this,{hasSelectedText:!1});return}const{anchorNode:s}=t;if(s===me(ti,this))return;const i=pe(pi,this,mi).call(this,t).closest(".textLayer");var r;if(i){if(null===(e=me(Hs,this))||void 0===e||e.hide(),ge(ti,this,s),pe(pi,this,Ti).call(this,{hasSelectedText:!0}),(me(Zs,this)===Ye.HIGHLIGHT||me(Zs,this)===Ye.NONE)&&(me(Zs,this)===Ye.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),ge(Ws,this,this.isShiftKeyDown),!this.isShiftKeyDown)){const e=me(Zs,this)===Ye.HIGHLIGHT?pe(pi,this,gi).call(this,i):null;if(null===e||void 0===e||e.toggleDrawing(),me(Gs,this)){const t=new AbortController,n=this.combinedSignal(t),s=n=>{"pointerup"===n.type&&0!==n.button||(t.abort(),null===e||void 0===e||e.toggleDrawing(!0),"pointerup"===n.type&&pe(pi,this,yi).call(this,"main_toolbar"))};window.addEventListener("pointerup",s,{signal:n}),window.addEventListener("blur",s,{signal:n})}else null===e||void 0===e||e.toggleDrawing(!0),pe(pi,this,yi).call(this,"main_toolbar")}}else me(ti,this)&&(null===(r=me(Hs,this))||void 0===r||r.hide(),ge(ti,this,null),pe(pi,this,Ti).call(this,{hasSelectedText:!1}))}function yi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";me(Zs,this)===Ye.HIGHLIGHT?this.highlightSelection(e):me(Ds,this)&&pe(pi,this,vi).call(this)}function _i(){document.addEventListener("selectionchange",pe(pi,this,bi).bind(this),{signal:this._signal})}function wi(){if(me(Bs,this))return;ge(Bs,this,new AbortController);const e=this.combinedSignal(me(Bs,this));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}function xi(){var e;null===(e=me(Bs,this))||void 0===e||e.abort(),ge(Bs,this,null)}function Ei(){if(me(Js,this))return;ge(Js,this,new AbortController);const e=this.combinedSignal(me(Js,this));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}function Si(){var e;null===(e=me(Js,this))||void 0===e||e.abort(),ge(Js,this,null)}function Ai(){if(me(Ts,this))return;ge(Ts,this,new AbortController);const e=this.combinedSignal(me(Ts,this));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}function Ci(){var e;null===(e=me(Ts,this))||void 0===e||e.abort(),ge(Ts,this,null)}function ki(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}function Ti(e){Object.entries(e).some(e=>{let[t,n]=e;return me(oi,this)[t]!==n})&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(me(oi,this),e)}),me(Zs,this)===Ye.HIGHLIGHT&&!1===e.hasSelectedEditor&&pe(pi,this,Ni).call(this,[[$e.HIGHLIGHT_FREE,!0]]))}function Ni(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}async function Ii(){if(!me(zs,this)){ge(zs,this,!0);const e=[];for(const t of me(xs,this).values())e.push(t.enable());await Promise.all(e);for(const t of me(ws,this).values())t.enable()}}function Pi(){if(this.unselectAll(),me(zs,this)){ge(zs,this,!1);for(const e of me(xs,this).values())e.disable();for(const e of me(ws,this).values())e.disable()}}function Ri(e){const t=me(xs,this).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}function Mi(e){let t=null;for(t of me(ei,e));return t}function Oi(){if(0===me(ws,this).size)return!0;if(1===me(ws,this).size)for(const e of me(ws,this).values())return e.isEmpty();return!1}function Di(e){for(const t of me(ei,this))t.unselect();me(ei,this).clear();for(const t of e)t.isEmpty()||(me(ei,this).add(t),t.select());pe(pi,this,Ti).call(this,{hasSelectedEditor:this.hasSelection})}r(fi,"TRANSLATE_SMALL",1),r(fi,"TRANSLATE_BIG",10);var ji=new WeakMap,Fi=new WeakMap,Li=new WeakMap,Ui=new WeakMap,Bi=new WeakMap,Vi=new WeakMap,Wi=new WeakMap,Hi=new WeakMap,qi=new WeakMap,zi=new WeakMap,Gi=new WeakMap,Ki=new WeakMap,Ji=new WeakSet;class Yi{constructor(e){ue(this,Ji),he(this,ji,null),he(this,Fi,!1),he(this,Li,null),he(this,Ui,null),he(this,Bi,null),he(this,Vi,null),he(this,Wi,!1),he(this,Hi,null),he(this,qi,null),he(this,zi,null),he(this,Gi,null),he(this,Ki,!1),ge(qi,this,e),ge(Ki,this,e._uiManager.useNewAltTextFlow),Qi._||(Qi._=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){var t;null!==(t=Yi._l10n)&&void 0!==t||(Yi._l10n=e)}async render(){const e=ge(Li,this,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=ge(Ui,this,document.createElement("span"));e.append(t),me(Ki,this)?(e.classList.add("new"),e.setAttribute("data-l10n-id",Qi._.missing),t.setAttribute("data-l10n-id",Qi._["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=me(qi,this)._uiManager._signal;e.addEventListener("contextmenu",an,{signal:n}),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const s=e=>{e.preventDefault(),me(qi,this)._uiManager.editAltText(me(qi,this)),me(Ki,this)&&me(qi,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:fe(Ji,this,$i)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(ge(Wi,this,!0),s(t))},{signal:n}),await pe(Ji,this,Xi).call(this),e}finish(){me(Li,this)&&(me(Li,this).focus({focusVisible:me(Wi,this)}),ge(Wi,this,!1))}isEmpty(){return me(Ki,this)?null===me(ji,this):!me(ji,this)&&!me(Fi,this)}hasData(){return me(Ki,this)?null!==me(ji,this)||!!me(zi,this):this.isEmpty()}get guessedText(){return me(zi,this)}async setGuessedText(e){null===me(ji,this)&&(ge(zi,this,e),ge(Gi,this,await Yi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),pe(Ji,this,Xi).call(this))}toggleAltTextBadge(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(!me(Ki,this)||me(ji,this))return null===(t=me(Hi,this))||void 0===t||t.remove(),void ge(Hi,this,null);if(!me(Hi,this)){const e=ge(Hi,this,document.createElement("div"));e.className="noAltTextBadge",me(qi,this).div.append(e)}me(Hi,this).classList.toggle("hidden",!e)}serialize(e){let t=me(ji,this);return e||me(zi,this)!==t||(t=me(Gi,this)),{altText:t,decorative:me(Fi,this),guessedText:me(zi,this),textWithDisclaimer:me(Gi,this)}}get data(){return{altText:me(ji,this),decorative:me(Fi,this)}}set data(e){let{altText:t,decorative:n,guessedText:s,textWithDisclaimer:i,cancel:r=!1}=e;s&&(ge(zi,this,s),ge(Gi,this,i)),me(ji,this)===t&&me(Fi,this)===n||(r||(ge(ji,this,t),ge(Fi,this,n)),pe(Ji,this,Xi).call(this))}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];me(Li,this)&&(!e&&me(Vi,this)&&(clearTimeout(me(Vi,this)),ge(Vi,this,null)),me(Li,this).disabled=!e)}shown(){me(qi,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:fe(Ji,this,$i)}})}destroy(){var e,t;null===(e=me(Li,this))||void 0===e||e.remove(),ge(Li,this,null),ge(Ui,this,null),ge(Bi,this,null),null===(t=me(Hi,this))||void 0===t||t.remove(),ge(Hi,this,null)}}function $i(e){return(me(ji,e)?"added":null===me(ji,e)&&e.guessedText&&"review")||"missing"}async function Xi(){const e=me(Li,this);if(!e)return;if(me(Ki,this)){var t,n;if(e.classList.toggle("done",!!me(ji,this)),e.setAttribute("data-l10n-id",Qi._[fe(Ji,this,$i)]),null===(t=me(Ui,this))||void 0===t||t.setAttribute("data-l10n-id",Qi._["".concat(fe(Ji,this,$i),"-label")]),!me(ji,this))return void(null===(n=me(Bi,this))||void 0===n||n.remove())}else{var s;if(!me(ji,this)&&!me(Fi,this))return e.classList.remove("done"),void(null===(s=me(Bi,this))||void 0===s||s.remove());e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=me(Bi,this);if(!i){ge(Bi,this,i=document.createElement("span")),i.className="tooltip",i.setAttribute("role","tooltip"),i.id="alt-text-tooltip-".concat(me(qi,this).id);const t=100,n=me(qi,this)._uiManager._signal;n.addEventListener("abort",()=>{clearTimeout(me(Vi,this)),ge(Vi,this,null)},{once:!0}),e.addEventListener("mouseenter",()=>{ge(Vi,this,setTimeout(()=>{ge(Vi,this,null),me(Bi,this).classList.add("show"),me(qi,this)._reportTelemetry({action:"alt_text_tooltip"})},t))},{signal:n}),e.addEventListener("mouseleave",()=>{var e;me(Vi,this)&&(clearTimeout(me(Vi,this)),ge(Vi,this,null)),null===(e=me(Bi,this))||void 0===e||e.classList.remove("show")},{signal:n})}me(Fi,this)?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=me(ji,this)),i.parentNode||e.append(i);const r=me(qi,this).getElementForAltText();null===r||void 0===r||r.setAttribute("aria-describedby",i.id)}var Qi={_:null};r(Yi,"_l10n",null);var Zi=new WeakMap,er=new WeakMap,tr=new WeakMap,nr=new WeakMap,sr=new WeakMap,ir=new WeakMap,rr=new WeakMap,or=new WeakMap,ar=new WeakMap,lr=new WeakMap,cr=new WeakSet;class dr{constructor(e){ue(this,cr),he(this,Zi,null),he(this,er,null),he(this,tr,!1),he(this,nr,null),he(this,sr,null),he(this,ir,null),he(this,rr,null),he(this,or,null),he(this,ar,!1),he(this,lr,null),ge(nr,this,e)}renderForToolbar(){const e=ge(er,this,document.createElement("button"));return e.className="comment",pe(cr,this,ur).call(this,e,!1)}renderForStandalone(){const e=ge(Zi,this,document.createElement("button"));e.className="annotationCommentButton";const t=me(nr,this).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd="calc(".concat(100*("ltr"===me(nr,this)._uiManager.direction?1-t[0]:t[0]),"% - var(--comment-button-dim))"),n.top="calc(".concat(100*t[1],"% - var(--comment-button-dim))");const s=me(nr,this).commentButtonColor;s&&(n.backgroundColor=s)}return pe(cr,this,ur).call(this,e,!0)}focusButton(){setTimeout(()=>{var e,t;null===(e=null!==(t=me(Zi,this))&&void 0!==t?t:me(er,this))||void 0===e||e.focus()},0)}onUpdatedColor(){if(!me(Zi,this))return;const e=me(nr,this).commentButtonColor;e&&(me(Zi,this).style.backgroundColor=e),me(nr,this)._uiManager.updatePopupColor(me(nr,this))}get commentButtonWidth(){var e,t;return(null!==(e=null===(t=me(Zi,this))||void 0===t?void 0:t.getBoundingClientRect().width)&&void 0!==e?e:0)/me(nr,this).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(me(lr,this))return me(lr,this);if(!me(Zi,this))return null;const{x:e,y:t,height:n}=me(Zi,this).getBoundingClientRect(),{x:s,y:i,width:r,height:o}=me(nr,this).parent.boundingClientRect;return[(e-s)/r,(t+n-i)/o]}set commentPopupPositionInLayer(e){ge(lr,this,e)}hasDefaultPopupPosition(){return null===me(lr,this)}removeStandaloneCommentButton(){var e;null===(e=me(Zi,this))||void 0===e||e.remove(),ge(Zi,this,null)}removeToolbarCommentButton(){var e;null===(e=me(er,this))||void 0===e||e.remove(),ge(er,this,null)}setCommentButtonStates(e){let{selected:t,hasPopup:n}=e;me(Zi,this)&&(me(Zi,this).classList.toggle("selected",t),me(Zi,this).ariaExpanded=n)}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=me(nr,this).commentButtonPosition;const{width:e,height:t,x:i,y:r}=me(nr,this);n=i+n*e,s=r+s*t}const i=me(nr,this).parent.boundingClientRect,{x:r,y:o,width:l,height:c}=i;me(nr,this)._uiManager.editComment(me(nr,this),r+n*l,o+s*c,a(a({},e),{},{parentDimensions:i}))}finish(){me(er,this)&&(me(er,this).focus({focusVisible:me(tr,this)}),ge(tr,this,!1))}isDeleted(){return me(ar,this)||""===me(rr,this)}isEmpty(){return null===me(rr,this)}hasBeenEdited(){return this.isDeleted()||me(rr,this)!==me(sr,this)}serialize(){return this.data}get data(){return{text:me(rr,this),richText:me(ir,this),date:me(or,this),deleted:this.isDeleted()}}set data(e){if(e!==me(rr,this)&&ge(ir,this,null),null===e)return ge(rr,this,""),void ge(ar,this,!0);ge(rr,this,e),ge(or,this,new Date),ge(ar,this,!1)}setInitialText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;ge(sr,this,e),this.data=e,ge(or,this,null),ge(ir,this,t)}shown(){}destroy(){var e,t;null===(e=me(er,this))||void 0===e||e.remove(),ge(er,this,null),null===(t=me(Zi,this))||void 0===t||t.remove(),ge(Zi,this,null),ge(rr,this,""),ge(ir,this,null),ge(or,this,null),ge(nr,this,null),ge(tr,this,!1),ge(ar,this,!1)}}function ur(e,t){if(!me(nr,this)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[me(nr,this)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=me(nr,this)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",an,{signal:n}),t&&(e.addEventListener("focusin",e=>{me(nr,this)._focusEventsAllowed=!1,ln(e)},{capture:!0,signal:n}),e.addEventListener("focusout",e=>{me(nr,this)._focusEventsAllowed=!0,ln(e)},{capture:!0,signal:n})),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const s=t=>{t.preventDefault(),e===me(er,this)?this.edit():me(nr,this).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(ge(tr,this,!0),s(t))},{signal:n}),e.addEventListener("pointerenter",()=>{me(nr,this).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{me(nr,this).toggleComment(!1,!1)},{signal:n}),e}var hr=new WeakMap,pr=new WeakMap,fr=new WeakMap,mr=new WeakMap,gr=new WeakMap,vr=new WeakMap,br=new WeakMap,yr=new WeakMap,_r=new WeakMap,wr=new WeakMap,xr=new WeakMap,Er=new WeakMap,Sr=new WeakSet;class Ar{constructor(e){let{container:t,isPinchingDisabled:n=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:o=null,signal:a}=e;ue(this,Sr),he(this,hr,void 0),he(this,pr,!1),he(this,fr,null),he(this,mr,void 0),he(this,gr,void 0),he(this,vr,void 0),he(this,br,void 0),he(this,yr,null),he(this,_r,void 0),he(this,wr,null),he(this,xr,void 0),he(this,Er,null),ge(hr,this,t),ge(fr,this,s),ge(mr,this,n),ge(gr,this,i),ge(vr,this,r),ge(br,this,o),ge(xr,this,new AbortController),ge(_r,this,AbortSignal.any([a,me(xr,this).signal])),t.addEventListener("touchstart",pe(Sr,this,Cr).bind(this),{passive:!1,signal:me(_r,this)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/mn.pixelRatio}destroy(){var e,t;null===(e=me(xr,this))||void 0===e||e.abort(),ge(xr,this,null),null===(t=me(yr,this))||void 0===t||t.abort(),ge(yr,this,null)}}function Cr(e){var t,n;if(null!==(t=me(mr,this))&&void 0!==t&&t.call(this))return;if(1===e.touches.length){if(me(yr,this))return;const e=ge(yr,this,new AbortController),t=AbortSignal.any([me(_r,this),e.signal]),n=me(hr,this),s={capture:!0,signal:t,passive:!1},i=e=>{var t;"touch"===e.pointerType&&(null===(t=me(yr,this))||void 0===t||t.abort(),ge(yr,this,null))};return n.addEventListener("pointerdown",e=>{"touch"===e.pointerType&&(ln(e),i(e))},s),n.addEventListener("pointerup",i,s),void n.addEventListener("pointercancel",i,s)}if(!me(Er,this)){var s;ge(Er,this,new AbortController);const e=AbortSignal.any([me(_r,this),me(Er,this).signal]),t=me(hr,this),n={signal:e,capture:!1,passive:!1};t.addEventListener("touchmove",pe(Sr,this,kr).bind(this),n);const i=pe(Sr,this,Tr).bind(this);t.addEventListener("touchend",i,n),t.addEventListener("touchcancel",i,n),n.capture=!0,t.addEventListener("pointerdown",ln,n),t.addEventListener("pointermove",ln,n),t.addEventListener("pointercancel",ln,n),t.addEventListener("pointerup",ln,n),null===(s=me(gr,this))||void 0===s||s.call(this)}if(ln(e),2!==e.touches.length||null!==(n=me(fr,this))&&void 0!==n&&n.call(this))return void ge(wr,this,null);let[i,r]=e.touches;i.identifier>r.identifier&&([i,r]=[r,i]),ge(wr,this,{touch0X:i.screenX,touch0Y:i.screenY,touch1X:r.screenX,touch1Y:r.screenY})}function kr(e){var t;if(!me(wr,this)||2!==e.touches.length)return;ln(e);let[n,s]=e.touches;n.identifier>s.identifier&&([n,s]=[s,n]);const{screenX:i,screenY:r}=n,{screenX:o,screenY:a}=s,l=me(wr,this),{touch0X:c,touch0Y:d,touch1X:u,touch1Y:h}=l,p=u-c,f=h-d,m=o-i,g=a-r,v=Math.hypot(m,g)||1,b=Math.hypot(p,f)||1;if(!me(pr,this)&&Math.abs(b-v)<=we.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=r,l.touch1X=o,l.touch1Y=a,!me(pr,this))return void ge(pr,this,!0);const y=[(i+o)/2,(r+a)/2];null===(t=me(vr,this))||void 0===t||t.call(this,y,b,v)}function Tr(e){if(!(e.touches.length>=2)){var t;if(me(Er,this))me(Er,this).abort(),ge(Er,this,null),null===(t=me(br,this))||void 0===t||t.call(this);me(wr,this)&&(ln(e),ge(wr,this,null),ge(pr,this,!1))}}we=Ar;var Nr=new WeakMap,Ir=new WeakMap,Pr=new WeakMap,Rr=new WeakMap,Mr=new WeakMap,Or=new WeakMap,Dr=new WeakMap,jr=new WeakMap,Fr=new WeakMap,Lr=new WeakMap,Ur=new WeakMap,Br=new WeakMap,Vr=new WeakMap,Wr=new WeakMap,Hr=new WeakMap,qr=new WeakMap,zr=new WeakMap,Gr=new WeakMap,Kr=new WeakMap,Jr=new WeakMap,Yr=new WeakMap,$r=new WeakMap,Xr=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,eo=new WeakMap,to=new WeakSet;class no{static get _resizerKeyboardManager(){const e=no.prototype._resizeWithKeyboard,t=fi.TRANSLATE_SMALL,n=fi.TRANSLATE_BIG;return Tt(this,"_resizerKeyboardManager",new ms([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],no.prototype._stopResizingWithKeyboard]]))}constructor(e){ue(this,to),he(this,Nr,null),he(this,Ir,null),he(this,Pr,null),he(this,Rr,null),he(this,Mr,null),he(this,Or,!1),he(this,Dr,null),he(this,jr,""),he(this,Fr,null),he(this,Lr,null),he(this,Ur,null),he(this,Br,null),he(this,Vr,null),he(this,Wr,""),he(this,Hr,!1),he(this,qr,null),he(this,zr,!1),he(this,Gr,!1),he(this,Kr,!1),he(this,Jr,null),he(this,Yr,0),he(this,$r,0),he(this,Xr,null),he(this,Qr,null),r(this,"isSelected",!1),r(this,"_isCopy",!1),r(this,"_editToolbar",null),r(this,"_initialOptions",Object.create(null)),r(this,"_initialData",null),r(this,"_isVisible",!0),r(this,"_uiManager",null),r(this,"_focusEventsAllowed",!0),he(this,Zr,!1),he(this,eo,no._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[i,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Tt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Eo({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){var n;if(null!==(n=no._l10n)&&void 0!==n||(no._l10n=e),no._l10nResizer||(no._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==no._borderLineWidth)return;const s=getComputedStyle(document.documentElement);no._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){St("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return me(Zr,this)}set _isDraggable(e){var t;ge(Zr,this,e),null===(t=this.div)||void 0===t||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=me(eo,this)}setParent(e){var t;null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(pe(to,this,xo).call(this),null===(t=me(Br,this))||void 0===t||t.remove(),ge(Br,this,null));this.parent=e}focusin(e){this._focusEventsAllowed&&(me(Hr,this)?ge(Hr,this,!1):this.parent.setSelected(this))}focusout(e){var t;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=e.relatedTarget;null!==n&&void 0!==n&&n.closest("#".concat(this.id))||(e.preventDefault(),null!==(t=this.parent)&&void 0!==t&&t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[i,r]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/i,this.y=(t+s)/r,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}translate(e,t){pe(to,this,so).call(this,this.parentDimensions,e,t)}translateInPage(e,t){me(qr,this)||ge(qr,this,[this.x,this.y,this.width,this.height]),pe(to,this,so).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){me(qr,this)||ge(qr,this,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[s,i]}=this;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:o}=this;const[a,l]=this.getBaseTranslation();r+=a,o+=l;const{style:c}=n;c.left="".concat((100*r).toFixed(2),"%"),c.top="".concat((100*o).toFixed(2),"%"),this._onTranslating(r,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!me(qr,this)&&(me(qr,this)[0]!==this.x||me(qr,this)[1]!==this.y)}get _hasBeenResized(){return!!me(qr,this)&&(me(qr,this)[2]!==this.width||me(qr,this)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=no,s=n/e,i=n/t;switch(this.rotation){case 90:return[-s,i];case 180:return[s,i];case 270:return[s,-i];default:return[-s,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:t},pageDimensions:[n,s]}=this;let{x:i,y:r,width:o,height:a}=this;if(o*=n,a*=s,i*=n,r*=s,this._mustFixPosition)switch(e){case 0:i=Kt(i,0,n-o),r=Kt(r,0,s-a);break;case 90:i=Kt(i,0,n-a),r=Kt(r,o,s);break;case 180:i=Kt(i,o,n),r=Kt(r,a,s);break;case 270:i=Kt(i,a,n),r=Kt(r,0,s-o)}this.x=i/=n,this.y=r/=s;const[l,c]=this.getBaseTranslation();i+=l,r+=c,t.left="".concat((100*i).toFixed(2),"%"),t.top="".concat((100*r).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(e,t){return io.call(no,e,t,this.parentRotation)}pageTranslationToScreen(e,t){return io.call(no,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width="".concat((100*t).toFixed(2),"%"),e.height="".concat((100*n).toFixed(2),"%")}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(1e4*e)/1e4}_onResizing(){}altTextFinish(){var e;null===(e=me(Pr,this))||void 0===e||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||me(Gr,this))return this._editToolbar;this._editToolbar=new On(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;null===(e=this._editToolbar)||void 0===e||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;null===(e=this._editToolbar)||void 0===e||e.removeButton("comment")}removeEditToolbar(){var e,t;null===(e=this._editToolbar)||void 0===e||e.remove(),this._editToolbar=null,null===(t=me(Pr,this))||void 0===t||t.destroy()}addContainer(e){var t;const n=null===(t=this._editToolbar)||void 0===t?void 0:t.div;n?n.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return me(Pr,this)||(Yi.initialize(no._l10n),ge(Pr,this,new Yi(this)),me(Nr,this)&&(me(Pr,this).data=me(Nr,this),ge(Nr,this,null))),me(Pr,this)}get altTextData(){var e;return null===(e=me(Pr,this))||void 0===e?void 0:e.data}set altTextData(e){me(Pr,this)&&(me(Pr,this).data=e)}get guessedAltText(){var e;return null===(e=me(Pr,this))||void 0===e?void 0:e.guessedText}async setGuessedAltText(e){var t;await(null===(t=me(Pr,this))||void 0===t?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return null===(t=me(Pr,this))||void 0===t?void 0:t.serialize(e)}hasAltText(){return!!me(Pr,this)&&!me(Pr,this).isEmpty()}hasAltTextData(){var e,t;return null!==(e=null===(t=me(Pr,this))||void 0===t?void 0:t.hasData())&&void 0!==e&&e}focusCommentButton(){var e;null===(e=me(Rr,this))||void 0===e||e.focusButton()}addCommentButton(){return this.canAddComment?me(Rr,this)||ge(Rr,this,new dr(this)):null}addStandaloneCommentButton(){this._uiManager.hasCommentManager()&&(me(Mr,this)?this._uiManager.isEditingMode()&&me(Mr,this).classList.remove("hidden"):this.hasComment&&(ge(Mr,this,me(Rr,this).renderForStandalone()),this.div.append(me(Mr,this))))}removeStandaloneCommentButton(){me(Rr,this).removeStandaloneCommentButton(),ge(Mr,this,null)}hideStandaloneCommentButton(){var e;null===(e=me(Mr,this))||void 0===e||e.classList.add("hidden")}get comment(){var e;const{data:{richText:t,text:n,date:s,deleted:i}}=me(Rr,this);return{text:n,richText:t,date:s,deleted:i,color:this.getNonHCMColor(),opacity:null!==(e=this.opacity)&&void 0!==e?e:1}}set comment(e){me(Rr,this)||ge(Rr,this,new dr(this)),me(Rr,this).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData(e){let{comment:t,popupRef:n,richText:s}=e;if(!n)return;if(me(Rr,this)||ge(Rr,this,new dr(this)),me(Rr,this).setInitialText(t,s),!this.annotationElementId)return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return null===(e=me(Rr,this))||void 0===e?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return null===(e=me(Rr,this))||void 0===e?void 0:e.isDeleted()}get hasComment(){return!!me(Rr,this)&&!me(Rr,this).isEmpty()&&!me(Rr,this).isDeleted()}async editComment(e){me(Rr,this)||ge(Rr,this,new dr(this)),me(Rr,this).edit(e)}toggleComment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){me(Rr,this).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const t=180,n=100,[,,,s]=e.rect,[i]=this.pageDimensions,[r]=this.pageTranslation,o=r+i+1,a=s-n,l=o+t;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,a,l,s]}}}updateFromAnnotationLayer(e){let{popup:{contents:t,deleted:n}}=e;me(Rr,this).data=n?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var e;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=me(Or,this)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),pe(to,this,vo).call(this);const[n,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth="".concat((100*s/n).toFixed(2),"%"),t.style.maxHeight="".concat((100*n/s).toFixed(2),"%"));const[i,r]=this.getInitialTranslation();return this.translate(i,r),Yn(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(me(Qr,this)||ge(Qr,this,new Ar({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:pe(to,this,ho).bind(this),onPinching:pe(to,this,po).bind(this),onPinchEnd:pe(to,this,fo).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),null===(e=this._uiManager._editorUndoBar)||void 0===e||e.hide(),t}pointerdown(e){const{isMac:t}=Lt.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(ge(Hr,this,!0),this._isDraggable?pe(to,this,go).call(this,e):pe(to,this,mo).call(this,e))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){me(Jr,this)&&clearTimeout(me(Jr,this)),ge(Jr,this,setTimeout(()=>{var e;ge(Jr,this,null),null===(e=this.parent)||void 0===e||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const s=this.parentScale,[i,r]=this.pageDimensions,[o,a]=this.pageTranslation,l=e/s,c=t/s,d=this.x*i,u=this.y*r,h=this.width*i,p=this.height*r;switch(n){case 0:return[d+l+o,r-u-c-p+a,d+l+h+o,r-u-c+a];case 90:return[d+c+o,r-u+l+a,d+c+p+o,r-u+l+h+a];case 180:return[d-l-h+o,r-u+c+a,d-l+o,r-u+c+p+a];case 270:return[d-c-p+o,r-u-l-h+a,d-c+o,r-u-l+a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,i,r]=e,o=i-n,a=r-s;switch(this.rotation){case 0:return[n,t-r,o,a];case 90:return[n,t-s,a,o];case 180:return[i,t-s,o,a];case 270:return[i,t-r,a,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&no._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;null===(e=me(Rr,this))||void 0===e||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:i,richText:r},uid:o,pageIndex:a,creationDate:l,modificationDate:c}=this;return{id:o,pageIndex:a,rect:this.getPDFRect(),richText:r,contentsObj:{str:e},creationDate:l,modificationDate:n||c,popupRef:!i,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),ge(Gr,this,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),ge(Gr,this,!1),!0)}isInEditMode(){return me(Gr,this)}shouldGetKeyboardEvents(){return me(Kr,this)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:i,innerWidth:r}=window;return t<r&&s>0&&e<i&&n>0}rebuild(){pe(to,this,vo).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}serialize(){var e;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,ge(Nr,s,e.accessibilityData),s._isCopy=e.isCopy||!1;const[i,r]=s.pageDimensions,[o,a,l,c]=s.getRectInCurrentCoords(e.rect,r);return s.x=o/i,s.y=a/r,s.width=l/i,s.height=c/r,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){var e,t,n;if(null===(e=me(Vr,this))||void 0===e||e.abort(),ge(Vr,this,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),me(Jr,this)&&(clearTimeout(me(Jr,this)),ge(Jr,this,null)),pe(to,this,xo).call(this),this.removeEditToolbar(),me(Xr,this)){for(const e of me(Xr,this).values())clearTimeout(e);ge(Xr,this,null)}this.parent=null,null===(t=me(Qr,this))||void 0===t||t.destroy(),ge(Qr,this,null),null===(n=me(Br,this))||void 0===n||n.remove(),ge(Br,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(pe(to,this,oo).call(this),me(Fr,this).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return"ltr"===this._uiManager.direction?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,i,r]=this.getPDFRect();return[no._round(n+(i-n)*e),no._round(s+(r-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return me(Rr,this).commentPopupPositionInLayer}set commentPopupPosition(e){me(Rr,this).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return me(Rr,this).hasDefaultPopupPosition()}get commentButtonWidth(){return me(Rr,this).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;null===(t=me(Rr,this))||void 0===t||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),ge(Ur,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=me(Fr,this).children;if(!me(Ir,this)){ge(Ir,this,Array.from(t));const e=pe(to,this,bo).bind(this),n=pe(to,this,yo).bind(this),s=this._uiManager._signal;for(const t of me(Ir,this)){const i=t.getAttribute("data-resizer-name");t.setAttribute("role","spinbutton"),t.addEventListener("keydown",e,{signal:s}),t.addEventListener("blur",n,{signal:s}),t.addEventListener("focus",pe(to,this,_o).bind(this,i),{signal:s}),t.setAttribute("data-l10n-id",no._l10nResizer[i])}}const n=me(Ir,this)[0];let s=0;for(const r of t){if(r===n)break;s++}const i=(360-this.rotation+this.parentRotation)%360/90*(me(Ir,this).length/4);if(i!==s){if(i<s)for(let t=0;t<s-i;t++)me(Fr,this).append(me(Fr,this).firstElementChild);else if(i>s)for(let t=0;t<i-s;t++)me(Fr,this).firstElementChild.before(me(Fr,this).lastElementChild);let e=0;for(const n of t){const t=me(Ir,this)[e++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",no._l10nResizer[t])}}pe(to,this,wo).call(this,0),ge(Kr,this,!0),me(Fr,this).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){me(Kr,this)&&pe(to,this,uo).call(this,me(Wr,this),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){pe(to,this,xo).call(this),this.div.focus()}select(){var e,t,n;this.isSelected&&this._editToolbar?this._editToolbar.show():(this.isSelected=!0,this.makeResizable(),null===(e=this.div)||void 0===e||e.classList.add("selectedEditor"),this._editToolbar?(null===(t=this._editToolbar)||void 0===t||t.show(),null===(n=me(Pr,this))||void 0===n||n.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{var e,t;null!==(e=this.div)&&void 0!==e&&e.classList.contains("selectedEditor")&&(null===(t=this._editToolbar)||void 0===t||t.show())}))}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return null===(e=this.div)||void 0===e?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,s,i;this.isSelected&&(this.isSelected=!1,null===(e=me(Fr,this))||void 0===e||e.classList.add("hidden"),null===(t=this.div)||void 0===t||t.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null===(s=this._editToolbar)||void 0===s||s.hide(),null===(i=me(Pr,this))||void 0===i||i.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){"BUTTON"!==e.target.nodeName&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return me(zr,this)}set isEditing(e){ge(zr,this,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){me(Xr,this)||ge(Xr,this,new Map);const{action:t}=e;let n=me(Xr,this).get(t);return n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),me(Xr,this).delete(t),0===me(Xr,this).size&&ge(Xr,this,null)},no._telemetryTimeout),void me(Xr,this).set(t,n)}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),ge(Or,this,!1)}disable(){this.div&&(this.div.tabIndex=-1),ge(Or,this,!0)}updateFakeAnnotationElement(e){if(me(Br,this)||this.deleted)return this.deleted?(me(Br,this).remove(),void ge(Br,this,null)):void((this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&me(Br,this).updateEdited({rect:this.getPDFRect(),popup:this.comment}));ge(Br,this,e.addFakeAnnotation(this))}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;"DIV"===(null===t||void 0===t?void 0:t.nodeName)&&t.classList.contains("annotationContent")&&t.remove()}}function so(e,t,n){let[s,i]=e;[t,n]=this.screenToPageTranslation(t,n),this.x+=t/s,this.y+=n/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}function io(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}function ro(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}function oo(){if(me(Fr,this))return;ge(Fr,this,document.createElement("div")),me(Fr,this).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const e=document.createElement("div");me(Fr,this).append(e),e.classList.add("resizer",n),e.setAttribute("data-resizer-name",n),e.addEventListener("pointerdown",pe(to,this,ao).bind(this,n),{signal:t}),e.addEventListener("contextmenu",an,{signal:t}),e.tabIndex=-1}this.div.prepend(me(Fr,this))}function ao(e,t){var n;t.preventDefault();const{isMac:s}=Lt.platform;if(0!==t.button||t.ctrlKey&&s)return;null===(n=me(Pr,this))||void 0===n||n.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,ge(Lr,this,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",pe(to,this,uo).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",ln,{passive:!1,signal:o}),window.addEventListener("contextmenu",an,{signal:o}),ge(Ur,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var e;r.abort(),this.parent.togglePointerEvents(!0),null===(e=me(Pr,this))||void 0===e||e.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=l,pe(to,this,co).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})}function lo(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}function co(){if(!me(Ur,this))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=me(Ur,this);ge(Ur,this,null);const i=this.x,r=this.y,o=this.width,a=this.height;i===e&&r===t&&o===n&&a===s||this.addCommands({cmd:pe(to,this,lo).bind(this,i,r,o,a),undo:pe(to,this,lo).bind(this,e,t,n,s),mustExec:!0})}function uo(e,t){const[n,s]=this.parentDimensions,i=this.x,r=this.y,o=this.width,a=this.height,l=xe.MIN_SIZE/n,c=xe.MIN_SIZE/s,d=pe(to,this,ro).call(this,this.rotation),u=(e,t)=>[d[0]*e+d[2]*t,d[1]*e+d[3]*t],h=pe(to,this,ro).call(this,360-this.rotation);let p,f,m=!1,g=!1;switch(e){case"topLeft":m=!0,p=(e,t)=>[0,0],f=(e,t)=>[e,t];break;case"topMiddle":p=(e,t)=>[e/2,0],f=(e,t)=>[e/2,t];break;case"topRight":m=!0,p=(e,t)=>[e,0],f=(e,t)=>[0,t];break;case"middleRight":g=!0,p=(e,t)=>[e,t/2],f=(e,t)=>[0,t/2];break;case"bottomRight":m=!0,p=(e,t)=>[e,t],f=(e,t)=>[0,0];break;case"bottomMiddle":p=(e,t)=>[e/2,t],f=(e,t)=>[e/2,0];break;case"bottomLeft":m=!0,p=(e,t)=>[0,t],f=(e,t)=>[e,0];break;case"middleLeft":g=!0,p=(e,t)=>[0,t/2],f=(e,t)=>[e,t/2]}const v=p(o,a),b=f(o,a);let y=u(...b);const _=xe._round(i+y[0]),w=xe._round(r+y[1]);let x,E,S=1,A=1;if(t.fromKeyboard)({deltaX:x,deltaY:E}=t);else{const{screenX:e,screenY:n}=t,[s,i]=me(Lr,this);[x,E]=this.screenToPageTranslation(e-s,n-i),me(Lr,this)[0]=e,me(Lr,this)[1]=n}var C,k;if([x,E]=(C=x/n,k=E/s,[h[0]*C+h[2]*k,h[1]*C+h[3]*k]),m){const e=Math.hypot(o,a);S=A=Math.max(Math.min(Math.hypot(b[0]-v[0]-x,b[1]-v[1]-E)/e,1/o,1/a),l/o,c/a)}else g?S=Kt(Math.abs(b[0]-v[0]-x),l,1)/o:A=Kt(Math.abs(b[1]-v[1]-E),c,1)/a;const T=xe._round(o*S),N=xe._round(a*A);y=u(...f(T,N));const I=_-y[0],P=w-y[1];me(qr,this)||ge(qr,this,[this.x,this.y,this.width,this.height]),this.width=T,this.height=N,this.x=I,this.y=P,this.setDims(),this.fixAndSetPosition(),this._onResizing()}function ho(){var e;ge(Ur,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null===(e=me(Pr,this))||void 0===e||e.toggle(!1),this.parent.togglePointerEvents(!1)}function po(e,t,n){let s=n/t*.7+1-.7;if(1===s)return;const i=pe(to,this,ro).call(this,this.rotation),r=(e,t)=>[i[0]*e+i[2]*t,i[1]*e+i[3]*t],[o,a]=this.parentDimensions,l=this.x,c=this.y,d=this.width,u=this.height,h=xe.MIN_SIZE/o,p=xe.MIN_SIZE/a;s=Math.max(Math.min(s,1/d,1/u),h/d,p/u);const f=xe._round(d*s),m=xe._round(u*s);if(f===d&&m===u)return;me(qr,this)||ge(qr,this,[l,c,d,u]);const g=r(d/2,u/2),v=xe._round(l+g[0]),b=xe._round(c+g[1]),y=r(f/2,m/2);this.x=v-y[0],this.y=b-y[1],this.width=f,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()}function fo(){var e;null===(e=me(Pr,this))||void 0===e||e.toggle(!0),this.parent.togglePointerEvents(!0),pe(to,this,co).call(this)}function mo(e){const{isMac:t}=Lt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}function go(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,i=this._uiManager.combinedSignal(s),r={capture:!0,passive:!1,signal:i},o=e=>{s.abort(),ge(Dr,this,null),ge(Hr,this,!1),this._uiManager.endDragSession()||pe(to,this,mo).call(this,e),n&&this._onStopDragging()};t&&(ge(Yr,this,e.clientX),ge($r,this,e.clientY),ge(Dr,this,e.pointerId),ge(jr,this,e.pointerType),window.addEventListener("pointermove",e=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:t,clientY:s,pointerId:i}=e;if(i!==me(Dr,this))return void ln(e);const[r,o]=this.screenToPageTranslation(t-me(Yr,this),s-me($r,this));ge(Yr,this,t),ge($r,this,s),this._uiManager.dragSelectedEditors(r,o)},r),window.addEventListener("touchmove",ln,r),window.addEventListener("pointerdown",e=>{e.pointerType===me(jr,this)&&(me(Qr,this)||e.isPrimary)&&o(e),ln(e)},r));const a=e=>{me(Dr,this)&&me(Dr,this)!==e.pointerId?ln(e):o(e)};window.addEventListener("pointerup",a,{signal:i}),window.addEventListener("blur",a,{signal:i})}function vo(){if(me(Vr,this)||!this.div)return;ge(Vr,this,new AbortController);const e=this._uiManager.combinedSignal(me(Vr,this));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}function bo(e){xe._resizerKeyboardManager.exec(this,e)}function yo(e){var t;me(Kr,this)&&(null===(t=e.relatedTarget)||void 0===t?void 0:t.parentNode)!==me(Fr,this)&&pe(to,this,xo).call(this)}function _o(e){ge(Wr,this,me(Kr,this)?e:"")}function wo(e){if(me(Ir,this))for(const t of me(Ir,this))t.tabIndex=e}function xo(){ge(Kr,this,!1),pe(to,this,wo).call(this,-1),pe(to,this,co).call(this)}xe=no,r(no,"_l10n",null),r(no,"_l10nResizer",null),r(no,"_borderLineWidth",-1),r(no,"_colorManager",new vs),r(no,"_zIndex",1),r(no,"_telemetryTimeout",1e3);class Eo extends no{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const So=3285377520,Ao=4294901760,Co=65535;class ko{constructor(e){this.h1=e?4294967295&e:So,this.h2=e?4294967295&e:So}update(e){let t,n;if("string"===typeof e){t=new Uint8Array(2*e.length),n=0;for(let s=0,i=e.length;s<i;s++){const i=e.charCodeAt(s);i<=255?t[n++]=i:(t[n++]=i>>>8,t[n++]=255&i)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),n=t.byteLength}const s=n>>2,i=n-4*s,r=new Uint32Array(t.buffer,0,s);let o=0,a=0,l=this.h1,c=this.h2;const d=3432918353,u=461845907,h=11601,p=13715;for(let f=0;f<s;f++)1&f?(o=r[f],o=o*d&Ao|o*h&Co,o=o<<15|o>>>17,o=o*u&Ao|o*p&Co,l^=o,l=l<<13|l>>>19,l=5*l+3864292196):(a=r[f],a=a*d&Ao|a*h&Co,a=a<<15|a>>>17,a=a*u&Ao|a*p&Co,c^=a,c=c<<13|c>>>19,c=5*c+3864292196);switch(o=0,i){case 3:o^=t[4*s+2]<<16;case 2:o^=t[4*s+1]<<8;case 1:o^=t[4*s],o=o*d&Ao|o*h&Co,o=o<<15|o>>>17,o=o*u&Ao|o*p&Co,1&s?l^=o:c^=o}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&Ao|36045*e&Co,t=4283543511*t&Ao|(2950163797*(t<<16|e>>>16)&Ao)>>>16,e^=t>>>1,e=444984403*e&Ao|60499*e&Co,t=3301882366*t&Ao|(3120437893*(t<<16|e>>>16)&Ao)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const To=Object.freeze({map:null,hash:"",transfer:void 0});var No=new WeakMap,Io=new WeakMap,Po=new WeakMap,Ro=new WeakMap,Mo=new WeakSet;class Oo{constructor(){ue(this,Mo),he(this,No,!1),he(this,Io,null),he(this,Po,null),he(this,Ro,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=me(Ro,this).get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return me(Ro,this).get(e)}remove(e){const t=me(Ro,this).get(e);if(void 0!==t&&(t instanceof no&&me(Po,this).delete(t.annotationElementId),me(Ro,this).delete(e),0===me(Ro,this).size&&this.resetModified(),"function"===typeof this.onAnnotationEditor)){for(const e of me(Ro,this).values())if(e instanceof no)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=me(Ro,this).get(e);let s=!1;if(void 0!==n)for(const[i,r]of Object.entries(t))n[i]!==r&&(s=!0,n[i]=r);else s=!0,me(Ro,this).set(e,t);s&&pe(Mo,this,Do).call(this),t instanceof no&&((me(Po,this)||ge(Po,this,new Map)).set(t.annotationElementId,t),"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type))}has(e){return me(Ro,this).has(e)}get size(){return me(Ro,this).size}resetModified(){me(No,this)&&(ge(No,this,!1),"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new Fo(this)}get serializable(){if(0===me(Ro,this).size)return To;const e=new Map,t=new ko,n=[],s=Object.create(null);let i=!1;for(const[r,o]of me(Ro,this)){const n=o instanceof no?o.serialize(!1,s):o;n&&(e.set(r,n),t.update("".concat(r,":").concat(JSON.stringify(n))),i||(i=!!n.bitmap))}if(i)for(const r of e.values())r.bitmap&&n.push(r.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:To}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of me(Ro,this).values()){var i;if(!(o instanceof no)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const a=o.telemetryFinalData;if(!a)continue;const{type:l}=a;t.has(l)||t.set(l,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const c=(i=e)[l]||(i[l]=new Map);for(const[e,t]of Object.entries(a)){var r;if("type"===e)continue;let n=c.get(e);n||(n=new Map,c.set(e,n));const s=null!==(r=n.get(t))&&void 0!==r?r:0;n.set(t,s+1)}}if((s>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,a]of t)e[o]=a.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){ge(Io,this,null)}updateEditor(e,t){var n;const s=null===(n=me(Po,this))||void 0===n?void 0:n.get(e);return!!s&&(s.updateFromAnnotationLayer(t),!0)}getEditor(e){var t;return(null===(t=me(Po,this))||void 0===t?void 0:t.get(e))||null}get modifiedIds(){if(me(Io,this))return me(Io,this);const e=[];if(me(Po,this))for(const t of me(Po,this).values())t.serialize()&&e.push(t.annotationElementId);return ge(Io,this,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return me(Ro,this).entries()}}function Do(){me(No,this)||(ge(No,this,!0),"function"===typeof this.onSetModified&&this.onSetModified())}var jo=new WeakMap;class Fo extends Oo{constructor(e){super(),he(this,jo,void 0);const{map:t,hash:n,transfer:s}=e.serializable,i=structuredClone(t,s?{transfer:s}:null);ge(jo,this,{map:i,hash:n,transfer:s})}get print(){St("Should not call PrintAnnotationStorage.print")}get serializable(){return me(jo,this)}get modifiedIds(){return Tt(this,"modifiedIds",{ids:new Set,hash:""})}}var Lo=new WeakMap;class Uo{constructor(e){let{ownerDocument:t=globalThis.document,styleElement:n=null}=e;he(this,Lo,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),me(Lo,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){let{systemFontInfo:t,disableFontFace:n,_inspectFont:s}=e;if(t&&!me(Lo,this).has(t.loadedName)){if(At(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:n,style:r}=t,o=new FontFace(e,n,r);this.addNativeFontFace(o);try{await o.load(),me(Lo,this).add(e),null===s||void 0===s||s(t)}catch(i){Et("Cannot load system font: ".concat(t.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(o)}return}St("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw Et("Failed to load font '".concat(t.family,"': '").concat(n,"'.")),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var e;return Tt(this,"isFontLoadingAPISupported",!(null===(e=this._document)||void 0===e||!e.fonts))}get isSyncFontLoadingSupported(){return Tt(this,"isSyncFontLoadingSupported",je||Lt.platform.isFirefox)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for(At(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){return Tt(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function s(e,t,n,s){return e.substring(0,t)+s+e.substring(t+n)}let i,r;const o=this._document.createElement("canvas");o.width=1,o.height=1;const a=o.getContext("2d");let l=0;const c="lt".concat(Date.now()).concat(this.loadTestFontId++);let d=this._loadTestFont;d=s(d,976,c.length,c);const u=1482184792;let h=n(d,16);for(i=0,r=c.length-3;i<r;i+=4)h=h-u+n(c,i)|0;var p;i<c.length&&(h=h-u+n(c+"XXX",i)|0),d=s(d,16,4,(p=h,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f="url(data:font/opentype;base64,".concat(btoa(d),");"),m='@font-face {font-family:"'.concat(c,'";src:').concat(f,"}");this.insertRule(m);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const v of[e.loadedName,c]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=v,g.append(e)}this._document.body.append(g),function e(t,n){if(++l>30)return Et("Load test font never loaded."),void n();a.font="30px "+t,a.fillText(".",0,20),a.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(c,()=>{g.remove(),t.complete()})}}var Bo=new WeakMap;class Vo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;he(this,Bo,void 0),this.compiledGlyphs=Object.create(null),ge(Bo,this,e),this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return null===(e=this._inspectFont)||void 0===e||e.call(this,this),t}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const t="url(data:".concat(this.mimetype,";base64,").concat(Jt(this.data),");");let n;if(this.cssFontInfo){let e="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(e+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),n='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(e,"src:").concat(t,"}")}else n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return null===(e=this._inspectFont)||void 0===e||e.call(this,this,t),n}getPathGenerator(e,t){var n;if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(o){Et('getPathGenerator - ignoring character: "'.concat(o,'".'))}const r=Sn(null===(n=i)||void 0===n?void 0:n.path);return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}get black(){return me(Bo,this).black}get bold(){return me(Bo,this).bold}get disableFontFace(){var e;return null!==(e=me(Bo,this).disableFontFace)&&void 0!==e&&e}set disableFontFace(e){Tt(this,"disableFontFace",!!e)}get fontExtraProperties(){var e;return null!==(e=me(Bo,this).fontExtraProperties)&&void 0!==e&&e}get isInvalidPDFjsFont(){return me(Bo,this).isInvalidPDFjsFont}get isType3Font(){return me(Bo,this).isType3Font}get italic(){return me(Bo,this).italic}get missingFile(){return me(Bo,this).missingFile}get remeasure(){return me(Bo,this).remeasure}get vertical(){return me(Bo,this).vertical}get ascent(){return me(Bo,this).ascent}get defaultWidth(){return me(Bo,this).defaultWidth}get descent(){return me(Bo,this).descent}get bbox(){return me(Bo,this).bbox}set bbox(e){Tt(this,"bbox",e)}get fontMatrix(){return me(Bo,this).fontMatrix}get fallbackName(){return me(Bo,this).fallbackName}get loadedName(){return me(Bo,this).loadedName}get mimetype(){return me(Bo,this).mimetype}get name(){return me(Bo,this).name}get data(){return me(Bo,this).data}clearData(){me(Bo,this).clearData()}get cssFontInfo(){return me(Bo,this).cssFontInfo}get systemFontInfo(){return me(Bo,this).systemFontInfo}get defaultVMetrics(){return me(Bo,this).defaultVMetrics}}var Wo=new WeakMap,Ho=new WeakMap,qo=new WeakMap,zo=new WeakSet;class Go{static write(e){const t=new TextEncoder,n={};let s=0;for(const l of Go.strings){const i=t.encode(e[l]);n[l]=i,s+=4+i.length}const i=new ArrayBuffer(s),r=new Uint8Array(i),o=new DataView(i);let a=0;for(const l of Go.strings){const e=n[l],t=e.length;o.setUint32(a,t),r.set(e,a+4),a+=4+t}return At(a===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}constructor(e){ue(this,zo),he(this,Wo,void 0),he(this,Ho,void 0),he(this,qo,void 0),ge(Wo,this,e),ge(Ho,this,new DataView(me(Wo,this))),ge(qo,this,new TextDecoder)}get fontFamily(){return pe(zo,this,Ko).call(this,0)}get fontWeight(){return pe(zo,this,Ko).call(this,1)}get italicAngle(){return pe(zo,this,Ko).call(this,2)}}function Ko(e){At(e<Ee.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=me(Ho,this).getUint32(t)+4;const n=me(Ho,this).getUint32(t);return me(qo,this).decode(new Uint8Array(me(Wo,this),t+4,n))}Ee=Go,r(Go,"strings",["fontFamily","fontWeight","italicAngle"]);var Jo=new WeakMap,Yo=new WeakMap,$o=new WeakMap,Xo=new WeakSet;class Qo{static write(e){const t=new TextEncoder,n={};let s=0;for(const u of Qo.strings){const i=t.encode(e[u]);n[u]=i,s+=4+i.length}s+=4;let i,r,o=1+s;e.style&&(i=t.encode(e.style.style),r=t.encode(e.style.weight),o+=4+i.length+4+r.length);const a=new ArrayBuffer(o),l=new Uint8Array(a),c=new DataView(a);let d=0;c.setUint8(d++,e.guessFallback?1:0),c.setUint32(d,0),d+=4,s=0;for(const u of Qo.strings){const e=n[u],t=e.length;s+=4+t,c.setUint32(d,t),l.set(e,d+4),d+=4+t}return c.setUint32(d-s-4,s),e.style&&(c.setUint32(d,i.length),l.set(i,d+4),d+=4+i.length,c.setUint32(d,r.length),l.set(r,d+4),d+=4+r.length),At(d<=a.byteLength,"SubstitionInfo.write: Buffer overflow"),a.transferToFixedLength(d)}constructor(e){ue(this,Xo),he(this,Jo,void 0),he(this,Yo,void 0),he(this,$o,void 0),ge(Jo,this,e),ge(Yo,this,new DataView(me(Jo,this))),ge($o,this,new TextDecoder)}get guessFallback(){return 0!==me(Yo,this).getUint8(0)}get css(){return pe(Xo,this,Zo).call(this,0)}get loadedName(){return pe(Xo,this,Zo).call(this,1)}get baseFontName(){return pe(Xo,this,Zo).call(this,2)}get src(){return pe(Xo,this,Zo).call(this,3)}get style(){let e=1;e+=4+me(Yo,this).getUint32(e);const t=me(Yo,this).getUint32(e),n=me($o,this).decode(new Uint8Array(me(Jo,this),e+4,t));e+=4+t;const s=me(Yo,this).getUint32(e);return{style:n,weight:me($o,this).decode(new Uint8Array(me(Jo,this),e+4,s))}}}function Zo(e){At(e<Se.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=me(Yo,this).getUint32(t)+4;const n=me(Yo,this).getUint32(t);return me($o,this).decode(new Uint8Array(me(Jo,this),t+4,n))}Se=Qo,r(Qo,"strings",["css","loadedName","baseFontName","src"]);var ea=new WeakMap,ta=new WeakMap,na=new WeakMap,sa=new WeakSet;class ia{constructor(e){let{data:t,extra:n}=e;ue(this,sa),he(this,ea,void 0),he(this,ta,void 0),he(this,na,void 0),ge(ea,this,t),ge(ta,this,new TextDecoder),ge(na,this,new DataView(me(ea,this))),n&&Object.assign(this,n)}get black(){return pe(sa,this,ra).call(this,0)}get bold(){return pe(sa,this,ra).call(this,1)}get disableFontFace(){return pe(sa,this,ra).call(this,2)}get fontExtraProperties(){return pe(sa,this,ra).call(this,3)}get isInvalidPDFjsFont(){return pe(sa,this,ra).call(this,4)}get isType3Font(){return pe(sa,this,ra).call(this,5)}get italic(){return pe(sa,this,ra).call(this,6)}get missingFile(){return pe(sa,this,ra).call(this,7)}get remeasure(){return pe(sa,this,ra).call(this,8)}get vertical(){return pe(sa,this,ra).call(this,9)}get ascent(){return pe(sa,this,oa).call(this,0)}get defaultWidth(){return pe(sa,this,oa).call(this,1)}get descent(){return pe(sa,this,oa).call(this,2)}get bbox(){let e=ca._;if(0===me(na,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<4;n++)t.push(me(na,this).getInt16(e,!0)),e+=2;return t}get fontMatrix(){let e=da._;if(0===me(na,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<6;n++)t.push(me(na,this).getFloat64(e,!0)),e+=8;return t}get defaultVMetrics(){let e=ua._;if(0===me(na,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<3;n++)t.push(me(na,this).getInt16(e,!0)),e+=2;return t}get fallbackName(){return pe(sa,this,aa).call(this,0)}get loadedName(){return pe(sa,this,aa).call(this,1)}get mimetype(){return pe(sa,this,aa).call(this,2)}get name(){return pe(sa,this,aa).call(this,3)}get data(){let e=ha._;e+=4+me(na,this).getUint32(e);e+=4+me(na,this).getUint32(e);e+=4+me(na,this).getUint32(e);const t=me(na,this).getUint32(e);if(0!==t)return new Uint8Array(me(ea,this),e+4,t)}clearData(){let e=ha._;e+=4+me(na,this).getUint32(e);e+=4+me(na,this).getUint32(e);e+=4+me(na,this).getUint32(e);const t=me(na,this).getUint32(e);new Uint8Array(me(ea,this),e+4,t).fill(0),me(na,this).setUint32(e,0)}get cssFontInfo(){let e=ha._;e+=4+me(na,this).getUint32(e);e+=4+me(na,this).getUint32(e);const t=me(na,this).getUint32(e);if(0===t)return null;const n=new Uint8Array(t);return n.set(new Uint8Array(me(ea,this),e+4,t)),new Go(n.buffer)}get systemFontInfo(){let e=ha._;e+=4+me(na,this).getUint32(e);const t=me(na,this).getUint32(e);if(0===t)return null;const n=new Uint8Array(t);return n.set(new Uint8Array(me(ea,this),e+4,t)),new Qo(n.buffer)}static write(e){const t=e.systemFontInfo?Qo.write(e.systemFontInfo):null,n=e.cssFontInfo?Go.write(e.cssFontInfo):null,s=new TextEncoder,i={};let r=0;for(const f of ia.strings)i[f]=s.encode(e[f]),r+=4+i[f].length;const o=ha._+4+r+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),a=new ArrayBuffer(o),l=new Uint8Array(a),c=new DataView(a);let d=0;const u=ia.bools.length;let h=0,p=0;for(let f=0;f<u;f++){const t=e[ia.bools[f]];h|=(void 0===t?0:t?2:1)<<p,p+=2,8!==p&&f!==u-1||(c.setUint8(d++,h),h=0,p=0)}At(d===la._,"FontInfo.write: Boolean properties offset mismatch");for(const f of ia.numbers)c.setFloat64(d,e[f]),d+=8;if(At(d===ca._,"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(d++,4);for(const t of e.bbox)c.setInt16(d,t,!0),d+=2}else c.setUint8(d++,0),d+=8;if(At(d===da._,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(d++,6);for(const t of e.fontMatrix)c.setFloat64(d,t,!0),d+=8}else c.setUint8(d++,0),d+=48;if(At(d===ua._,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(d++,1);for(const t of e.defaultVMetrics)c.setInt16(d,t,!0),d+=2}else c.setUint8(d++,0),d+=6;At(d===ha._,"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(ha._,0),d+=4;for(const f of ia.strings){const e=i[f],t=e.length;c.setUint32(d,t),l.set(e,d+4),d+=4+t}if(c.setUint32(ha._,d-ha._-4),t){const e=t.byteLength;c.setUint32(d,e),At(d+4+e<=a.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),l.set(new Uint8Array(t),d+4),d+=4+e}else c.setUint32(d,0),d+=4;if(n){const e=n.byteLength;c.setUint32(d,e),At(d+4+e<=a.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),l.set(new Uint8Array(n),d+4),d+=4+e}else c.setUint32(d,0),d+=4;return void 0===e.data?(c.setUint32(d,0),d+=4):(c.setUint32(d,e.data.length),l.set(e.data,d+4),d+=4+e.data.length),At(d<=a.byteLength,"FontInfo.write: Buffer overflow"),a.transferToFixedLength(d)}}function ra(e){At(e<Ae.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=2*e%8,s=me(na,this).getUint8(t)>>n&3;return 0===s?void 0:2===s}function oa(e){return At(e<Ae.numbers.length,"Invalid number index"),me(na,this).getFloat64(la._+8*e)}function aa(e){At(e<Ae.strings.length,"Invalid string index");let t=ha._+4;for(let i=0;i<e;i++)t+=me(na,this).getUint32(t)+4;const n=me(na,this).getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(me(ea,this),t+4,n)),me(ta,this).decode(s)}Ae=ia,r(ia,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),r(ia,"numbers",["ascent","defaultWidth","descent"]),r(ia,"strings",["fallbackName","loadedName","mimetype","name"]);var la={_:Math.ceil(2*Ae.bools.length/8)},ca={_:pe(Ae,Ae,la)._+8*Ae.numbers.length},da={_:pe(Ae,Ae,ca)._+1+8},ua={_:pe(Ae,Ae,da)._+1+48},ha={_:pe(Ae,Ae,ua)._+1+6};class pa{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,s=[],i=[],r=[],o=[],a=null,l=null;switch(e[0]){case"RadialAxial":t="axial"===e[1]?1:2,n=e[2],r=e[3],1===t?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,a=e[1],s=e[2],i=e[3],o=e[4]||[],n=e[6],l=e[7];break;default:throw new Error("Unsupported pattern type: ".concat(e[0]))}const c=Math.floor(s.length/2),d=Math.floor(i.length/3),u=r.length,h=o.length;let p=0;for(const b of o)p+=1,p=4*Math.ceil(p/4),p+=4+4*b.coords.length,p+=4+4*b.colors.length,void 0!==b.verticesPerRow&&(p+=4);const f=new ArrayBuffer(20+8*c+3*d+8*u+(n?16:0)+(l?3:0)+p),m=new DataView(f),g=new Uint8Array(f);m.setUint8(fa._,t),m.setUint8(ma._,n?1:0),m.setUint8(ga._,l?1:0),m.setUint8(va._,a),m.setUint32(ba._,c,!0),m.setUint32(ya._,d,!0),m.setUint32(_a._,u,!0),m.setUint32(wa._,h,!0);let v=20;new Float32Array(f,v,2*c).set(s),v+=8*c,g.set(i,v),v+=3*d;for(const[b,y]of r)m.setFloat32(v,b,!0),v+=4,m.setUint32(v,parseInt(y.slice(1),16),!0),v+=4;if(n)for(const b of n)m.setFloat32(v,b,!0),v+=4;l&&(g.set(l,v),v+=3);for(let b=0;b<o.length;b++){const e=o[b];m.setUint8(v,e.type),v+=1,v=4*Math.ceil(v/4),m.setUint32(v,e.coords.length,!0),v+=4;new Int32Array(f,v,e.coords.length).set(e.coords),v+=4*e.coords.length,m.setUint32(v,e.colors.length,!0),v+=4;new Int32Array(f,v,e.colors.length).set(e.colors),v+=4*e.colors.length,void 0!==e.verticesPerRow&&(m.setUint32(v,e.verticesPerRow,!0),v+=4)}return f}getIR(){const e=this.view,t=this.data[fa._],n=!!this.data[ma._],s=!!this.data[ga._],i=e.getUint32(ba._,!0),r=e.getUint32(ya._,!0),o=e.getUint32(_a._,!0),a=e.getUint32(wa._,!0);let l=20;const c=new Float32Array(this.buffer,l,2*i);l+=8*i;const d=new Uint8Array(this.buffer,l,3*r);l+=3*r;const u=[];for(let m=0;m<o;++m){const t=e.getFloat32(l,!0);l+=4;const n=e.getUint32(l,!0);l+=4,u.push([t,"#".concat(n.toString(16).padStart(6,"0"))])}let h=null;if(n){h=[];for(let t=0;t<4;++t)h.push(e.getFloat32(l,!0)),l+=4}let p=null;s&&(p=new Uint8Array(this.buffer,l,3),l+=3);const f=[];for(let m=0;m<a;++m){const t=e.getUint8(l);l+=1,l=4*Math.ceil(l/4);const n=e.getUint32(l,!0);l+=4;const s=new Int32Array(this.buffer,l,n);l+=4*n;const i=e.getUint32(l,!0);l+=4;const r=new Int32Array(this.buffer,l,i);l+=4*i;const o={type:t,coords:s,colors:r};t===Qe&&(o.verticesPerRow=e.getUint32(l,!0),l+=4),f.push(o)}if(1===t)return["RadialAxial","axial",h,u,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(2===t)return["RadialAxial","radial",h,u,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(3===t){const e=this.data[va._];let t=null;if(c.length>0){let e=c[0],n=c[0],s=c[1],i=c[1];for(let t=0;t<c.length;t+=2){const r=c[t],o=c[t+1];e=e>r?r:e,s=s>o?o:s,n=n<r?r:n,i=i<o?o:i}t=[e,s,n,i]}return["Mesh",e,c,d,f,t,h,p]}throw new Error("Unsupported pattern kind: ".concat(t))}}var fa={_:0},ma={_:1},ga={_:2},va={_:3},ba={_:4},ya={_:8},_a={_:12},wa={_:16},xa=new WeakMap;class Ea{static write(e){let t,n;return Lt.isFloat16ArraySupported?(n=new ArrayBuffer(2*e.length),t=new Float16Array(n)):(n=new ArrayBuffer(4*e.length),t=new Float32Array(n)),t.set(e),n}constructor(e){he(this,xa,void 0),ge(xa,this,e)}get path(){return Lt.isFloat16ArraySupported?new Float16Array(me(xa,this)):new Float32Array(me(xa,this))}}function Sa(e){if("string"!==typeof e)return null;if(e.endsWith("/"))return e;throw new Error('Invalid factory url: "'.concat(e,'" must include trailing slash.'))}const Aa=e=>"object"===typeof e&&Number.isInteger(null===e||void 0===e?void 0:e.num)&&e.num>=0&&Number.isInteger(null===e||void 0===e?void 0:e.gen)&&e.gen>=0,Ca=function(e,t,n){if(!Array.isArray(n)||n.length<2)return!1;const[s,i,...r]=n;if(!e(s)&&!Number.isInteger(s))return!1;if(!t(i))return!1;const o=r.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return 0===o;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(4!==o)return!1;a=!1;break;default:return!1}for(const l of r)if(!("number"===typeof l||a&&null===l))return!1;return!0}.bind(null,Aa,e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name));var ka=new WeakMap,Ta=new WeakMap;class Na{constructor(){he(this,ka,new Map),he(this,Ta,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};me(Ta,this).then(()=>{for(const[e]of me(ka,this))e.call(this,n)})}addEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=null;if((null===n||void 0===n?void 0:n.signal)instanceof AbortSignal){const{signal:i}=n;if(i.aborted)return void Et("LoopbackPort - cannot use an `aborted` signal.");const r=()=>this.removeEventListener(e,t);s=()=>i.removeEventListener("abort",r),i.addEventListener("abort",r)}me(ka,this).set(t,s)}removeEventListener(e,t){const n=me(ka,this).get(t);null===n||void 0===n||n(),me(ka,this).delete(t)}terminate(){for(const[,e]of me(ka,this))null===e||void 0===e||e();me(ka,this).clear()}}const Ia=1,Pa=2,Ra=1,Ma=2,Oa=3,Da=4,ja=5,Fa=6,La=7,Ua=8;function Ba(){}function Va(e){if(e instanceof Dt||e instanceof Rt||e instanceof It||e instanceof Mt||e instanceof Pt)return e;switch(e instanceof Error||"object"===typeof e&&null!==e||St('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new Dt(e.message);case"InvalidPDFException":return new Rt(e.message);case"PasswordException":return new It(e.message,e.code);case"ResponseException":return new Mt(e.message,e.status,e.missing);case"UnknownErrorException":return new Pt(e.message,e.details)}return new Pt(e.message,e.toString())}var Wa=new WeakMap,Ha=new WeakSet;class qa{constructor(e,t,n){ue(this,Ha),he(this,Wa,new AbortController),this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",pe(Ha,this,za).bind(this),{signal:me(Wa,this).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error('There is already an actionName called "'.concat(e,'"'));n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[s]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(r){i.reject(r)}return i.promise}sendWithStream(e,t,n,s){const i=this.streamId++,r=this.sourceName,o=this.targetName,a=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[i]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:r,targetName:o,action:e,streamId:i,data:t,desiredSize:n.desiredSize},s),l.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[i].pullCall=t,a.postMessage({sourceName:r,targetName:o,stream:Fa,streamId:i,desiredSize:e.desiredSize}),t.promise},cancel:e=>{At(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[i].cancelCall=t,this.streamControllers[i].isClosed=!0,a.postMessage({sourceName:r,targetName:o,stream:Ra,streamId:i,reason:Va(e)}),t.promise}},n)}destroy(){var e;null===(e=me(Wa,this))||void 0===e||e.abort(),ge(Wa,this,null)}}function za(e){let{data:t}=e;if(t.targetName!==this.sourceName)return;if(t.stream)return void pe(Ha,this,Ka).call(this,t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error("Cannot resolve callback ".concat(e));if(delete this.callbackCapabilities[e],t.callback===Ia)n.resolve(t.data);else{if(t.callback!==Pa)throw new Error("Unexpected callback case");n.reject(Va(t.reason))}return}const n=this.actionHandler[t.action];if(!n)throw new Error("Unknown action from worker: ".concat(t.action));if(t.callbackId){const e=this.sourceName,s=t.sourceName,i=this.comObj;return void Promise.try(n,t.data).then(function(n){i.postMessage({sourceName:e,targetName:s,callback:Ia,callbackId:t.callbackId,data:n})},function(n){i.postMessage({sourceName:e,targetName:s,callback:Pa,callbackId:t.callbackId,reason:Va(n)})})}t.streamId?pe(Ha,this,Ga).call(this,t):n(t.data)}function Ga(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,i=this.comObj,r=this,o=this.actionHandler[e.action],a={enqueue(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const a=this.desiredSize;this.desiredSize-=r,a>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:s,stream:Da,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:s,stream:Oa,streamId:t}),delete r.streamSinks[t])},error(e){At(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:s,stream:ja,streamId:t,reason:Va(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[t]=a,Promise.try(o,e.data,a).then(function(){i.postMessage({sourceName:n,targetName:s,stream:Ua,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:s,stream:Ua,streamId:t,reason:Va(e)})})}function Ka(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,i=this.comObj,r=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Ua:e.success?r.startCall.resolve():r.startCall.reject(Va(e.reason));break;case La:e.success?r.pullCall.resolve():r.pullCall.reject(Va(e.reason));break;case Fa:if(!o){i.postMessage({sourceName:n,targetName:s,stream:La,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Ba).then(function(){i.postMessage({sourceName:n,targetName:s,stream:La,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:s,stream:La,streamId:t,reason:Va(e)})});break;case Da:if(At(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(e.chunk);break;case Oa:if(At(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),pe(Ha,this,Ja).call(this,r,t);break;case ja:At(r,"error should have stream controller"),r.controller.error(Va(e.reason)),pe(Ha,this,Ja).call(this,r,t);break;case Ma:e.success?r.cancelCall.resolve():r.cancelCall.reject(Va(e.reason)),pe(Ha,this,Ja).call(this,r,t);break;case Ra:if(!o)break;const a=Va(e.reason);Promise.try(o.onCancel||Ba,a).then(function(){i.postMessage({sourceName:n,targetName:s,stream:Ma,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:s,stream:Ma,streamId:t,reason:Va(e)})}),o.sinkCapability.reject(a),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async function Ja(e,t){var n,s,i;await Promise.allSettled([null===(n=e.startCall)||void 0===n?void 0:n.promise,null===(s=e.pullCall)||void 0===s?void 0:s.promise,null===(i=e.cancelCall)||void 0===i?void 0:i.promise]),delete this.streamControllers[t]}var Ya=new WeakMap;class $a{constructor(e){let{enableHWA:t=!1}=e;he(this,Ya,!1),ge(Ya,this,t)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!me(Ya,this)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){St("Abstract method `_createCanvas` called.")}}class Xa extends $a{constructor(e){let{ownerDocument:t=globalThis.document,enableHWA:n=!1}=e;super({enableHWA:n}),this._document=t}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class Qa{constructor(e){let{baseUrl:t=null,isCompressed:n=!0}=e;this.baseUrl=t,this.isCompressed=n}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const n=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(n).then(e=>({cMapData:e,isCompressed:this.isCompressed})).catch(e=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(n))})}async _fetch(e){St("Abstract method `_fetch` called.")}}class Za extends Qa{async _fetch(e){const t=await Zt(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Ft(t)}}class el{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,i){return"none"}destroy(){}}var tl=new WeakMap,nl=new WeakMap,sl=new WeakMap,il=new WeakMap,rl=new WeakMap,ol=new WeakMap,al=new WeakMap,ll=new WeakSet;class cl extends el{constructor(e){let{docId:t,ownerDocument:n=globalThis.document}=e;super(),ue(this,ll),he(this,tl,void 0),he(this,nl,void 0),he(this,sl,void 0),he(this,il,void 0),he(this,rl,void 0),he(this,ol,void 0),he(this,al,0),ge(il,this,t),ge(rl,this,n)}addFilter(e){var t,n;if(!e)return"none";let s=fe(ll,this,dl).get(e);if(s)return s;const[i,r,o]=pe(ll,this,pl).call(this,e),a=1===e.length?i:"".concat(i).concat(r).concat(o);if(s=fe(ll,this,dl).get(a),s)return fe(ll,this,dl).set(e,s),s;const l="g_".concat(me(il,this),"_transfer_map_").concat((ge(al,this,(t=me(al,this),n=t++,t)),n)),c=pe(ll,this,fl).call(this,l);fe(ll,this,dl).set(e,c),fe(ll,this,dl).set(a,c);const d=pe(ll,this,vl).call(this,l);return pe(ll,this,yl).call(this,i,r,o,d),c}addHCMFilter(e,t){var n;const s="".concat(e,"-").concat(t),i="base";let r=fe(ll,this,ul).get(i);if((null===(n=r)||void 0===n?void 0:n.key)===s)return r.url;var o;r?(null===(o=r.filter)||void 0===o||o.remove(),r.key=s,r.url="none",r.filter=null):(r={key:s,url:"none",filter:null},fe(ll,this,ul).set(i,r));if(!e||!t)return r.url;const a=pe(ll,this,wl).call(this,e);e=Bt.makeHexColor(...a);const l=pe(ll,this,wl).call(this,t);if(t=Bt.makeHexColor(...l),fe(ll,this,hl).style.color="","#000000"===e&&"#ffffff"===t||e===t)return r.url;const c=new Array(256);for(let f=0;f<=255;f++){const e=f/255;c[f]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const d=c.join(","),u="g_".concat(me(il,this),"_hcm_filter"),h=r.filter=pe(ll,this,vl).call(this,u);pe(ll,this,yl).call(this,d,d,d,h),pe(ll,this,gl).call(this,h);const p=(e,t)=>{const n=a[e]/255,s=l[e]/255,i=new Array(t+1);for(let r=0;r<=t;r++)i[r]=n+r/t*(s-n);return i.join(",")};return pe(ll,this,yl).call(this,p(0,5),p(1,5),p(2,5),h),r.url=pe(ll,this,fl).call(this,u),r.url}addAlphaFilter(e){var t,n;let s=fe(ll,this,dl).get(e);if(s)return s;const[i]=pe(ll,this,pl).call(this,[e]),r="alpha_".concat(i);if(s=fe(ll,this,dl).get(r),s)return fe(ll,this,dl).set(e,s),s;const o="g_".concat(me(il,this),"_alpha_map_").concat((ge(al,this,(t=me(al,this),n=t++,t)),n)),a=pe(ll,this,fl).call(this,o);fe(ll,this,dl).set(e,a),fe(ll,this,dl).set(r,a);const l=pe(ll,this,vl).call(this,o);return pe(ll,this,_l).call(this,i,l),a}addLuminosityFilter(e){var t,n;let s,i,r=fe(ll,this,dl).get(e||"luminosity");if(r)return r;if(e?([s]=pe(ll,this,pl).call(this,[e]),i="luminosity_".concat(s)):i="luminosity",r=fe(ll,this,dl).get(i),r)return fe(ll,this,dl).set(e,r),r;const o="g_".concat(me(il,this),"_luminosity_map_").concat((ge(al,this,(t=me(al,this),n=t++,t)),n)),a=pe(ll,this,fl).call(this,o);fe(ll,this,dl).set(e,a),fe(ll,this,dl).set(i,a);const l=pe(ll,this,vl).call(this,o);return pe(ll,this,ml).call(this,l),e&&pe(ll,this,_l).call(this,s,l),a}addHighlightHCMFilter(e,t,n,s,i){var r;const o="".concat(t,"-").concat(n,"-").concat(s,"-").concat(i);let a=fe(ll,this,ul).get(e);if((null===(r=a)||void 0===r?void 0:r.key)===o)return a.url;var l;a?(null===(l=a.filter)||void 0===l||l.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},fe(ll,this,ul).set(e,a));if(!t||!n)return a.url;const[c,d]=[t,n].map(pe(ll,this,wl).bind(this));let u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),h=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,f]=[s,i].map(pe(ll,this,wl).bind(this));h<u&&([u,h,p,f]=[h,u,f,p]),fe(ll,this,hl).style.color="";const m=(e,t,n)=>{const s=new Array(256),i=(h-u)/n,r=e/255,o=(t-e)/(255*n);let a=0;for(let l=0;l<=n;l++){const e=Math.round(u+l*i),t=r+l*o;for(let n=a;n<=e;n++)s[n]=t;a=e+1}for(let l=a;l<256;l++)s[l]=s[a-1];return s.join(",")},g="g_".concat(me(il,this),"_hcm_").concat(e,"_filter"),v=a.filter=pe(ll,this,vl).call(this,g);return pe(ll,this,gl).call(this,v),pe(ll,this,yl).call(this,m(p[0],f[0],5),m(p[1],f[1],5),m(p[2],f[2],5),v),a.url=pe(ll,this,fl).call(this,g),a.url}destroy(){var e,t,n,s;arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&null!==(e=me(ol,this))&&void 0!==e&&e.size||(null===(t=me(sl,this))||void 0===t||t.parentNode.parentNode.remove(),ge(sl,this,null),null===(n=me(nl,this))||void 0===n||n.clear(),ge(nl,this,null),null===(s=me(ol,this))||void 0===s||s.clear(),ge(ol,this,null),ge(al,this,0))}}function dl(e){return me(nl,e)||ge(nl,e,new Map)}function ul(e){return me(ol,e)||ge(ol,e,new Map)}function hl(e){if(!me(sl,e)){const t=me(rl,e).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const s=me(rl,e).createElementNS(Xt,"svg");s.setAttribute("width",0),s.setAttribute("height",0),ge(sl,e,me(rl,e).createElementNS(Xt,"defs")),t.append(s),s.append(me(sl,e)),me(rl,e).body.append(t)}return me(sl,e)}function pl(e){if(1===e.length){const t=e[0],n=new Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;const s=n.join(",");return[s,s,s]}const[t,n,s]=e,i=new Array(256),r=new Array(256),o=new Array(256);for(let a=0;a<256;a++)i[a]=t[a]/255,r[a]=n[a]/255,o[a]=s[a]/255;return[i.join(","),r.join(","),o.join(",")]}function fl(e){if(void 0===me(tl,this)){ge(tl,this,"");const e=me(rl,this).URL;e!==me(rl,this).baseURI&&(nn(e)?Et('#createUrl: ignore "data:"-URL for performance reasons.'):ge(tl,this,kt(e,"")))}return"url(".concat(me(tl,this),"#").concat(e,")")}function ml(e){const t=me(rl,this).createElementNS(Xt,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}function gl(e){const t=me(rl,this).createElementNS(Xt,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}function vl(e){const t=me(rl,this).createElementNS(Xt,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),fe(ll,this,hl).append(t),t}function bl(e,t,n){const s=me(rl,this).createElementNS(Xt,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}function yl(e,t,n,s){const i=me(rl,this).createElementNS(Xt,"feComponentTransfer");s.append(i),pe(ll,this,bl).call(this,i,"feFuncR",e),pe(ll,this,bl).call(this,i,"feFuncG",t),pe(ll,this,bl).call(this,i,"feFuncB",n)}function _l(e,t){const n=me(rl,this).createElementNS(Xt,"feComponentTransfer");t.append(n),pe(ll,this,bl).call(this,n,"feFuncA",e)}function wl(e){return fe(ll,this,hl).style.color=e,un(getComputedStyle(fe(ll,this,hl)).getPropertyValue("color"))}class xl{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load font data at: ".concat(n))})}async _fetch(e){St("Abstract method `_fetch` called.")}}class El extends xl{async _fetch(e){const t=await Zt(e,"arraybuffer");return new Uint8Array(t)}}class Sl{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load wasm data at: ".concat(n))})}async _fetch(e){St("Abstract method `_fetch` called.")}}class Al extends Sl{async _fetch(e){const t=await Zt(e,"arraybuffer");return new Uint8Array(t)}}async function Cl(e){const t=process.getBuiltinModule("fs"),n=await t.promises.readFile(e);return new Uint8Array(n)}je&&Et("Please use the `legacy` build in Node.js environments.");class kl extends el{}class Tl extends $a{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///workspaces/audesp/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(e,t)}}class Nl extends Qa{async _fetch(e){return Cl(e)}}class Il extends xl{async _fetch(e){return Cl(e)}}class Pl extends Sl{async _fetch(e){return Cl(e)}}const Rl="__forcedDependency",{floor:Ml,ceil:Ol}=Math;function Dl(e,t,n,s,i,r){e[4*t+0]=Math.min(e[4*t+0],n),e[4*t+1]=Math.min(e[4*t+1],s),e[4*t+2]=Math.max(e[4*t+2],i),e[4*t+3]=Math.max(e[4*t+3],r)}const jl=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Fl=new WeakMap,Ll=new WeakMap;class Ul{constructor(e,t){he(this,Fl,void 0),he(this,Ll,void 0),ge(Fl,this,e),ge(Ll,this,t)}get length(){return me(Fl,this).length}isEmpty(e){return me(Fl,this)[e]===jl}minX(e){return me(Ll,this)[4*e+0]/256}minY(e){return me(Ll,this)[4*e+1]/256}maxX(e){return(me(Ll,this)[4*e+2]+1)/256}maxY(e){return(me(Ll,this)[4*e+3]+1)/256}}const Bl=(e,t)=>{if(!e)return;let n=e.get(t);return n||(n={dependencies:new Set,isRenderingOperation:!1},e.set(t,n)),n};var Vl=new WeakMap,Wl=new WeakMap,Hl=new WeakMap,ql=new WeakMap,zl=new WeakMap,Gl=new WeakMap,Kl=new WeakMap,Jl=new WeakMap,Yl=new WeakMap,$l=new WeakMap,Xl=new WeakMap,Ql=new WeakMap,Zl=new WeakMap,ec=new WeakMap,tc=new WeakMap,nc=new WeakMap,sc=new WeakMap,ic=new WeakSet;class rc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ue(this,ic),he(this,Vl,{__proto__:null}),he(this,Wl,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Rl]:[]}),he(this,Hl,new Map),he(this,ql,[]),he(this,zl,[]),he(this,Gl,[[1,0,0,1,0,0]]),he(this,Kl,[-1/0,-1/0,1/0,1/0]),he(this,Jl,new Float64Array([1/0,1/0,-1/0,-1/0])),he(this,Yl,-1),he(this,$l,new Set),he(this,Xl,new Map),he(this,Ql,new Map),he(this,Zl,void 0),he(this,ec,void 0),he(this,tc,void 0),he(this,nc,void 0),he(this,sc,void 0),ge(Zl,this,e.width),ge(ec,this,e.height),pe(ic,this,oc).call(this,t),n&&ge(sc,this,new Map)}growOperationsCount(e){e>=me(nc,this).length&&pe(ic,this,oc).call(this,e,me(nc,this))}save(e){return ge(Vl,this,{__proto__:me(Vl,this)}),ge(Wl,this,{__proto__:me(Wl,this),transform:{__proto__:me(Wl,this).transform},moveText:{__proto__:me(Wl,this).moveText},sameLineText:{__proto__:me(Wl,this).sameLineText},[Rl]:{__proto__:me(Wl,this)[Rl]}}),ge(Kl,this,{__proto__:me(Kl,this)}),me(ql,this).push(e),this}restore(e){const t=Object.getPrototypeOf(me(Vl,this));if(null===t)return this;ge(Vl,this,t),ge(Wl,this,Object.getPrototypeOf(me(Wl,this))),ge(Kl,this,Object.getPrototypeOf(me(Kl,this)));const n=me(ql,this).pop();var s;void 0!==n&&(null===(s=Bl(me(sc,this),e))||void 0===s||s.dependencies.add(n),me(nc,this)[e]=me(nc,this)[n]);return this}recordOpenMarker(e){return me(ql,this).push(e),this}getOpenMarker(){return 0===me(ql,this).length?null:me(ql,this).at(-1)}recordCloseMarker(e){const t=me(ql,this).pop();var n;void 0!==t&&(null===(n=Bl(me(sc,this),e))||void 0===n||n.dependencies.add(t),me(nc,this)[e]=me(nc,this)[t]);return this}beginMarkedContent(e){return me(zl,this).push(e),this}endMarkedContent(e){const t=me(zl,this).pop();var n;void 0!==t&&(null===(n=Bl(me(sc,this),e))||void 0===n||n.dependencies.add(t),me(nc,this)[e]=me(nc,this)[t]);return this}pushBaseTransform(e){return me(Gl,this).push(Bt.multiplyByDOMMatrix(me(Gl,this).at(-1),e.getTransform())),this}popBaseTransform(){return me(Gl,this).length>1&&me(Gl,this).pop(),this}recordSimpleData(e,t){return me(Vl,this)[e]=t,this}recordIncrementalData(e,t){return me(Wl,this)[e].push(t),this}resetIncrementalData(e,t){return me(Wl,this)[e].length=0,this}recordNamedData(e,t){return me(Hl,this).set(e,t),this}recordSimpleDataFromNamed(e,t,n){var s;me(Vl,this)[e]=null!==(s=me(Hl,this).get(t))&&void 0!==s?s:n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Rl,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in me(Vl,this)&&this.recordFutureForcedDependency(t,me(Vl,this)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of me($l,this))this.recordFutureForcedDependency(Rl,e);return this}resetBBox(e){return me(Yl,this)!==e&&(ge(Yl,this,e),me(Jl,this)[0]=1/0,me(Jl,this)[1]=1/0,me(Jl,this)[2]=-1/0,me(Jl,this)[3]=-1/0),this}recordClipBox(e,t,n,s,i,r){const o=Bt.multiplyByDOMMatrix(me(Gl,this).at(-1),t.getTransform()),a=[1/0,1/0,-1/0,-1/0];Bt.axialAlignedBoundingBox([n,i,s,r],o,a);const l=Bt.intersect(me(Kl,this),a);return l?(me(Kl,this)[0]=l[0],me(Kl,this)[1]=l[1],me(Kl,this)[2]=l[2],me(Kl,this)[3]=l[3]):(me(Kl,this)[0]=me(Kl,this)[1]=1/0,me(Kl,this)[2]=me(Kl,this)[3]=-1/0),this}recordBBox(e,t,n,s,i,r){const o=me(Kl,this);if(o[0]===1/0)return this;const a=Bt.multiplyByDOMMatrix(me(Gl,this).at(-1),t.getTransform());if(o[0]===-1/0)return Bt.axialAlignedBoundingBox([n,i,s,r],a,me(Jl,this)),this;const l=[1/0,1/0,-1/0,-1/0];return Bt.axialAlignedBoundingBox([n,i,s,r],a,l),me(Jl,this)[0]=Math.min(me(Jl,this)[0],Math.max(l[0],o[0])),me(Jl,this)[1]=Math.min(me(Jl,this)[1],Math.max(l[1],o[1])),me(Jl,this)[2]=Math.max(me(Jl,this)[2],Math.min(l[2],o[2])),me(Jl,this)[3]=Math.max(me(Jl,this)[3],Math.min(l[3],o[3])),this}recordCharacterBBox(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;const a=n.bbox;let l,c;if(a&&(l=a[2]!==a[0]&&a[3]!==a[1]&&me(Ql,this).get(n),!1!==l&&(c=[0,0,0,0],Bt.axialAlignedBoundingBox(a,n.fontMatrix,c),1===s&&0===i&&0===r||Bt.scaleMinMax([s,0,0,-s,i,r],c),l)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!o)return this.recordFullPageBBox(e);const d=o();return a&&c&&void 0===l&&(l=c[0]<=i-d.actualBoundingBoxLeft&&c[2]>=i+d.actualBoundingBoxRight&&c[1]<=r-d.actualBoundingBoxAscent&&c[3]>=r+d.actualBoundingBoxDescent,me(Ql,this).set(n,l),l)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,i-d.actualBoundingBoxLeft,i+d.actualBoundingBoxRight,r-d.actualBoundingBoxAscent,r+d.actualBoundingBoxDescent)}recordFullPageBBox(e){return me(Jl,this)[0]=Math.max(0,me(Kl,this)[0]),me(Jl,this)[1]=Math.max(0,me(Kl,this)[1]),me(Jl,this)[2]=Math.min(me(Zl,this),me(Kl,this)[2]),me(Jl,this)[3]=Math.min(me(ec,this),me(Kl,this)[3]),this}getSimpleIndex(e){return me(Vl,this)[e]}recordDependencies(e,t){const n=me($l,this),s=me(Vl,this),i=me(Wl,this);for(const r of t)r in me(Vl,this)?n.add(s[r]):r in i&&i[r].forEach(n.add,n);return this}recordNamedDependency(e,t){return me(Hl,this).has(t)&&me($l,this).add(me(Hl,this).get(t)),this}recordOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.recordDependencies(e,[Rl]),me(sc,this)){const t=Bl(me(sc,this),e),{dependencies:n}=t;me($l,this).forEach(n.add,n),me(ql,this).forEach(n.add,n),me(zl,this).forEach(n.add,n),n.delete(e),t.isRenderingOperation=!0}if(me(Yl,this)===e){const n=Ml(256*me(Jl,this)[0]/me(Zl,this)),s=Ml(256*me(Jl,this)[1]/me(ec,this)),i=Ol(256*me(Jl,this)[2]/me(Zl,this)),r=Ol(256*me(Jl,this)[3]/me(ec,this));Dl(me(tc,this),e,n,s,i,r);for(const t of me($l,this))t!==e&&Dl(me(tc,this),t,n,s,i,r);for(const t of me(ql,this))t!==e&&Dl(me(tc,this),t,n,s,i,r);for(const t of me(zl,this))t!==e&&Dl(me(tc,this),t,n,s,i,r);t||(me($l,this).clear(),ge(Yl,this,-1))}return this}recordShowTextOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Array.from(me($l,this));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return me(Yl,this)===e&&(ge(Yl,this,-1),me(Kl,this)[0]=Math.max(me(Kl,this)[0],me(Jl,this)[0]),me(Kl,this)[1]=Math.max(me(Kl,this)[1],me(Jl,this)[1]),me(Kl,this)[2]=Math.min(me(Kl,this)[2],me(Jl,this)[2]),me(Kl,this)[3]=Math.min(me(Kl,this)[3],me(Jl,this)[3]),t||me($l,this).clear()),this}_takePendingDependencies(){const e=me($l,this);return ge($l,this,new Set),e}_extractOperation(e){const t=me(Xl,this).get(e);return me(Xl,this).delete(e),t}_pushPendingDependencies(e){for(const t of e)me($l,this).add(t)}take(){return me(Ql,this).clear(),new Ul(me(nc,this),me(tc,this))}takeDebugMetadata(){return me(sc,this)}}function oc(e,t){const n=new ArrayBuffer(4*e);ge(tc,this,new Uint8ClampedArray(n)),ge(nc,this,new Uint32Array(n)),t&&t.length>0?(me(nc,this).set(t),me(nc,this).fill(jl,t.length)):me(nc,this).fill(jl)}var ac=new WeakMap,lc=new WeakMap,cc=new WeakMap,dc=new WeakMap,uc=new WeakMap;class hc{constructor(e,t,n){if(he(this,ac,void 0),he(this,lc,void 0),he(this,cc,void 0),he(this,dc,0),he(this,uc,0),e instanceof hc&&me(cc,e)===!!n)return e;ge(ac,this,e),ge(lc,this,t),ge(cc,this,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){var t;return ge(uc,this,(t=me(uc,this),t++,t)),me(ac,this).save(me(lc,this)),this}restore(e){var t;me(uc,this)>0&&(me(ac,this).restore(me(lc,this)),ge(uc,this,(t=me(uc,this),t--,t)));return this}recordOpenMarker(e){var t;return ge(dc,this,(t=me(dc,this),t++,t)),this}getOpenMarker(){return me(dc,this)>0?me(lc,this):me(ac,this).getOpenMarker()}recordCloseMarker(e){var t;return ge(dc,this,(t=me(dc,this),t--,t)),this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return me(ac,this).pushBaseTransform(e),this}popBaseTransform(){return me(ac,this).popBaseTransform(),this}recordSimpleData(e,t){return me(ac,this).recordSimpleData(e,me(lc,this)),this}recordIncrementalData(e,t){return me(ac,this).recordIncrementalData(e,me(lc,this)),this}resetIncrementalData(e,t){return me(ac,this).resetIncrementalData(e,me(lc,this)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return me(ac,this).recordSimpleDataFromNamed(e,t,me(lc,this)),this}recordFutureForcedDependency(e,t){return me(ac,this).recordFutureForcedDependency(e,me(lc,this)),this}inheritSimpleDataAsFutureForcedDependencies(e){return me(ac,this).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return me(ac,this).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return me(cc,this)||me(ac,this).resetBBox(me(lc,this)),this}recordClipBox(e,t,n,s,i,r){return me(cc,this)||me(ac,this).recordClipBox(me(lc,this),t,n,s,i,r),this}recordBBox(e,t,n,s,i,r){return me(cc,this)||me(ac,this).recordBBox(me(lc,this),t,n,s,i,r),this}recordCharacterBBox(e,t,n,s,i,r,o){return me(cc,this)||me(ac,this).recordCharacterBBox(me(lc,this),t,n,s,i,r,o),this}recordFullPageBBox(e){return me(cc,this)||me(ac,this).recordFullPageBBox(me(lc,this)),this}getSimpleIndex(e){return me(ac,this).getSimpleIndex(e)}recordDependencies(e,t){return me(ac,this).recordDependencies(me(lc,this),t),this}recordNamedDependency(e,t){return me(ac,this).recordNamedDependency(me(lc,this),t),this}recordOperation(e){return me(ac,this).recordOperation(me(lc,this),!0),this}recordShowTextOperation(e){return me(ac,this).recordShowTextOperation(me(lc,this),!0),this}bboxToClipBoxDropOperation(e){return me(cc,this)||me(ac,this).bboxToClipBoxDropOperation(me(lc,this),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const pc=["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fc=["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],mc=["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],gc=["filter","fillColor","fillAlpha"],vc=["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],bc=["transform"],yc=["transform","fillColor"],_c="Fill",wc="Stroke",xc="Shading";function Ec(e,t){if(!t)return;const n=t[2]-t[0],s=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],n,s),e.clip(i)}class Sc{isModifyingCurrentTransform(){return!1}getPattern(){St("Abstract method `getPattern` called.")}}class Ac extends Sc{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return 0===this._p0[0]&&0===this._p0[1]&&(!this.isRadial()||0===this._p1[0]&&0===this._p1[1])}isRadial(){return"radial"===this._type}_createGradient(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this._p0,i=this._p1;if(n&&(s=s.slice(),i=i.slice(),Bt.applyTransform(s,n),Bt.applyTransform(i,n)),"axial"===this._type)t=e.createLinearGradient(s[0],s[1],i[0],i[1]);else if("radial"===this._type){let r=this._r0,o=this._r1;if(n){const e=new Float32Array(2);Bt.singularValueDecompose2dScale(n,e),r*=e[0],o*=e[0]}t=e.createRadialGradient(s[0],s[1],r,i[0],i[1],o)}for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,n,s){let i;if(s===wc||s===_c){if(this.isOriginBased()){let s=Bt.transform(n,t.baseTransform);this.matrix&&(s=Bt.transform(s,this.matrix));const i=.001,r=Math.hypot(s[0],s[1]),o=Math.hypot(s[2],s[3]),a=(s[0]*s[2]+s[1]*s[3])/(r*o);if(Math.abs(a)<i){if(!this.isRadial())return this._createGradient(e,s);if(Math.abs(r-o)<i)return this._createGradient(e,s)}}const r=t.current.getClippedPathBoundingBox(s,hn(e))||[0,0,0,0],o=Math.ceil(r[2]-r[0])||1,a=Math.ceil(r[3]-r[1])||1,l=t.cachedCanvases.getCanvas("pattern",o,a),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),n=Bt.transform(n,[1,0,0,1,r[0],r[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),Ec(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),i=e.createPattern(l.canvas,"no-repeat");const d=new DOMMatrix(n);i.setTransform(d)}else Ec(e,this._bbox),i=this._createGradient(e);return i}}function Cc(e,t,n,s,i,r,o,a){const l=t.coords,c=t.colors,d=e.data,u=4*e.width;let h;l[n+1]>l[s+1]&&(h=n,n=s,s=h,h=r,r=o,o=h),l[s+1]>l[i+1]&&(h=s,s=i,i=h,h=o,o=a,a=h),l[n+1]>l[s+1]&&(h=n,n=s,s=h,h=r,r=o,o=h);const p=(l[n]+t.offsetX)*t.scaleX,f=(l[n+1]+t.offsetY)*t.scaleY,m=(l[s]+t.offsetX)*t.scaleX,g=(l[s+1]+t.offsetY)*t.scaleY,v=(l[i]+t.offsetX)*t.scaleX,b=(l[i+1]+t.offsetY)*t.scaleY;if(f>=b)return;const y=c[r],_=c[r+1],w=c[r+2],x=c[o],E=c[o+1],S=c[o+2],A=c[a],C=c[a+1],k=c[a+2],T=Math.round(f),N=Math.round(b);let I,P,R,M,O,D,j,F;for(let L=T;L<=N;L++){if(L<g){const e=L<f?0:(f-L)/(f-g);I=p-(p-m)*e,P=y-(y-x)*e,R=_-(_-E)*e,M=w-(w-S)*e}else{let e;e=L>b?1:g===b?0:(g-L)/(g-b),I=m-(m-v)*e,P=x-(x-A)*e,R=E-(E-C)*e,M=S-(S-k)*e}let e;e=L<f?0:L>b?1:(f-L)/(f-b),O=p-(p-v)*e,D=y-(y-A)*e,j=_-(_-C)*e,F=w-(w-k)*e;const t=Math.round(Math.min(I,O)),n=Math.round(Math.max(I,O));let s=u*L+4*t;for(let i=t;i<=n;i++)e=(I-i)/(I-O),e<0?e=0:e>1&&(e=1),d[s++]=P-(P-D)*e|0,d[s++]=R-(R-j)*e|0,d[s++]=M-(M-F)*e|0,d[s++]=255}}function kc(e,t,n){const s=t.coords,i=t.colors;let r,o;switch(t.type){case Qe:const a=t.verticesPerRow,l=Math.floor(s.length/a)-1,c=a-1;for(r=0;r<l;r++){let t=r*a;for(let r=0;r<c;r++,t++)Cc(e,n,s[t],s[t+1],s[t+a],i[t],i[t+1],i[t+a]),Cc(e,n,s[t+a+1],s[t+1],s[t+a],i[t+a+1],i[t+1],i[t+a])}break;case Xe:for(r=0,o=s.length;r<o;r+=3)Cc(e,n,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class Tc extends Sc{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const s=Math.floor(this._bounds[0]),i=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-s,o=Math.ceil(this._bounds[3])-i,a=Math.min(Math.ceil(Math.abs(r*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(o*e[1]*1.1)),3e3),c=r/a,d=o/l,u={coords:this._coords,colors:this._colors,offsetX:-s,offsetY:-i,scaleX:1/c,scaleY:1/d},h=a+4,p=l+4,f=n.getCanvas("mesh",h,p),m=f.context,g=m.createImageData(a,l);if(t){const e=g.data;for(let n=0,s=e.length;n<s;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const v of this._figures)kc(g,v,u);m.putImageData(g,2,2);return{canvas:f.canvas,offsetX:s-2*c,offsetY:i-2*d,scaleX:c,scaleY:d}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){Ec(e,this._bbox);const i=new Float32Array(2);if(s===xc)Bt.singularValueDecompose2dScale(hn(e),i);else if(this.matrix){Bt.singularValueDecompose2dScale(this.matrix,i);const[e,n]=i;Bt.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=e,i[1]*=n}else Bt.singularValueDecompose2dScale(t.baseTransform,i);const r=this._createMeshCanvas(i,s===xc?null:this._background,t.cachedCanvases);return s!==xc&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class Nc extends Sc{getPattern(){return"hotpink"}}const Ic=1,Pc=2;class Rc{constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){var n,s;const{bbox:i,operatorList:r,paintType:o,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:d,ystep:u}=this;d=Math.abs(d),u=Math.abs(u),xt("TilingType: "+a);const h=i[0],p=i[1],f=i[2],m=i[3],g=f-h,v=m-p,b=new Float32Array(2);Bt.singularValueDecompose2dScale(this.matrix,b);const[y,_]=b;Bt.singularValueDecompose2dScale(this.baseTransform,b);const w=y*b[0],x=_*b[1];let E=g,S=v,A=!1,C=!1;const k=Math.ceil(d*w),T=Math.ceil(u*x);k>=Math.ceil(g*w)?E=d:A=!0,T>=Math.ceil(v*x)?S=u:C=!0;const N=this.getSizeAndScale(E,this.ctx.canvas.width,w),I=this.getSizeAndScale(S,this.ctx.canvas.height,x),P=e.cachedCanvases.getCanvas("pattern",N.size,I.size),R=P.context,M=c.createCanvasGraphics(R,t);if(M.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(M,o,l),R.translate(-N.scale*h,-I.scale*p),M.transform(0,N.scale,0,0,I.scale,0,0),R.save(),null===(n=M.dependencyTracker)||void 0===n||n.save(),this.clipBbox(M,h,p,f,m),M.baseTransform=hn(M.ctx),M.executeOperatorList(r),M.endDrawing(),null===(s=M.dependencyTracker)||void 0===s||s.restore(),R.restore(),A||C){const t=P.canvas;A&&(E=d),C&&(S=u);const n=this.getSizeAndScale(E,this.ctx.canvas.width,w),s=this.getSizeAndScale(S,this.ctx.canvas.height,x),i=n.size,r=s.size,o=e.cachedCanvases.getCanvas("pattern-workaround",i,r),a=o.context,l=A?Math.floor(g/d):0,c=C?Math.floor(v/u):0;for(let e=0;e<=l;e++)for(let n=0;n<=c;n++)a.drawImage(t,i*e,r*n,i,r,0,0,i,r);return{canvas:o.canvas,scaleX:n.scale,scaleY:s.scale,offsetX:h,offsetY:p}}return{canvas:P.canvas,scaleX:N.scale,scaleY:I.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,n){const s=Math.max(Rc.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=s?i=s:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,s,i){const r=s-t,o=i-n;e.ctx.rect(t,n,r,o),Bt.axialAlignedBoundingBox([t,n,s,i],hn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,i=e.current;switch(t){case Ic:const{fillStyle:e,strokeStyle:r}=this.ctx;s.fillStyle=i.fillColor=e,s.strokeStyle=i.strokeColor=r;break;case Pc:s.fillStyle=s.strokeStyle=n,i.fillColor=i.strokeColor=n;break;default:throw new Ot("Unsupported paint type: ".concat(t))}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,i){let r=n;s!==xc&&(r=Bt.transform(r,t.baseTransform),this.matrix&&(r=Bt.transform(r,this.matrix)));const o=this.createPatternCanvas(t,i);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}}function Mc(e){let{src:t,srcPos:n=0,dest:s,width:i,height:r,nonBlackColor:o=4294967295,inverseDecode:a=!1}=e;const l=Lt.isLittleEndian?4278190080:255,[c,d]=a?[o,l]:[l,o],u=i>>3,h=7&i,p=t.length;s=new Uint32Array(s.buffer);let f=0;for(let m=0;m<r;m++){for(const i=n+u;n<i;n++){const e=n<p?t[n]:255;s[f++]=128&e?d:c,s[f++]=64&e?d:c,s[f++]=32&e?d:c,s[f++]=16&e?d:c,s[f++]=8&e?d:c,s[f++]=4&e?d:c,s[f++]=2&e?d:c,s[f++]=1&e?d:c}if(0===h)continue;const e=n<p?t[n++]:255;for(let t=0;t<h;t++)s[f++]=e&1<<7-t?d:c}return{srcPos:n,destPos:f}}r(Rc,"MAX_PATTERN_SIZE",3e3);const Oc=16,Dc=new DOMMatrix,jc=new Float32Array(2),Fc=new Float32Array([1/0,1/0,-1/0,-1/0]);class Lc{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return void 0!==this.cache[e]?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Uc(e,t,n,s,i,r,o,a,l,c){const[d,u,h,p,f,m]=hn(e);if(0===u&&0===h){const g=o*d+f,v=Math.round(g),b=a*p+m,y=Math.round(b),_=(o+l)*d+f,w=Math.abs(Math.round(_)-v)||1,x=(a+c)*p+m,E=Math.abs(Math.round(x)-y)||1;return e.setTransform(Math.sign(d),0,0,Math.sign(p),v,y),e.drawImage(t,n,s,i,r,0,0,w,E),e.setTransform(d,u,h,p,f,m),[w,E]}if(0===d&&0===p){const g=a*h+f,v=Math.round(g),b=o*u+m,y=Math.round(b),_=(a+c)*h+f,w=Math.abs(Math.round(_)-v)||1,x=(o+l)*u+m,E=Math.abs(Math.round(x)-y)||1;return e.setTransform(0,Math.sign(u),Math.sign(h),0,v,y),e.drawImage(t,n,s,i,r,0,0,E,w),e.setTransform(d,u,h,p,f,m),[E,w]}e.drawImage(t,n,s,i,r,o,a,l,c);return[Math.hypot(d,u)*l,Math.hypot(h,p)*c]}class Bc{constructor(e,t,n){r(this,"alphaIsShape",!1),r(this,"fontSize",0),r(this,"fontSizeScale",1),r(this,"textMatrix",null),r(this,"textMatrixScale",1),r(this,"fontMatrix",Fe),r(this,"leading",0),r(this,"x",0),r(this,"y",0),r(this,"lineX",0),r(this,"lineY",0),r(this,"charSpacing",0),r(this,"wordSpacing",0),r(this,"textHScale",1),r(this,"textRenderingMode",Ze),r(this,"textRise",0),r(this,"fillColor","#000000"),r(this,"strokeColor","#000000"),r(this,"patternFill",!1),r(this,"patternStroke",!1),r(this,"fillAlpha",1),r(this,"strokeAlpha",1),r(this,"lineWidth",1),r(this,"activeSMask",null),r(this,"transferMaps","none"),null===n||void 0===n||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Fc.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_c,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.minMax.slice();if(e===wc){t||St("Stroke bounding box must include transform."),Bt.singularValueDecompose2dScale(t,jc);const e=jc[0]*this.lineWidth/2,s=jc[1]*this.lineWidth/2;n[0]-=e,n[1]-=s,n[2]+=e,n[3]+=s}return n}updateClipFromPath(){const e=Bt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Fc,0)}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_c,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Bt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Vc(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,s=t.width,i=n%Oc,r=(n-i)/Oc,o=0===i?r:r+1,a=e.createImageData(s,Oc);let l,c=0;const d=t.data,u=a.data;let h,p,f,m;if(t.kind===rt.GRAYSCALE_1BPP){const t=d.byteLength,n=new Uint32Array(u.buffer,0,u.byteLength>>2),m=n.length,g=s+7>>3,v=4294967295,b=Lt.isLittleEndian?4278190080:255;for(h=0;h<o;h++){for(f=h<r?Oc:i,l=0,p=0;p<f;p++){const e=t-c;let i=0;const r=e>g?s:8*e-7,o=-8&r;let a=0,u=0;for(;i<o;i+=8)u=d[c++],n[l++]=128&u?v:b,n[l++]=64&u?v:b,n[l++]=32&u?v:b,n[l++]=16&u?v:b,n[l++]=8&u?v:b,n[l++]=4&u?v:b,n[l++]=2&u?v:b,n[l++]=1&u?v:b;for(;i<r;i++)0===a&&(u=d[c++],a=128),n[l++]=u&a?v:b,a>>=1}for(;l<m;)n[l++]=0;e.putImageData(a,0,h*Oc)}}else if(t.kind===rt.RGBA_32BPP){for(p=0,m=s*Oc*4,h=0;h<r;h++)u.set(d.subarray(c,c+m)),c+=m,e.putImageData(a,0,p),p+=Oc;h<o&&(m=s*i*4,u.set(d.subarray(c,c+m)),e.putImageData(a,0,p))}else{if(t.kind!==rt.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(f=Oc,m=s*f,h=0;h<o;h++){for(h>=r&&(f=i,m=s*f),l=0,p=m;p--;)u[l++]=d[c++],u[l++]=d[c++],u[l++]=d[c++],u[l++]=255;e.putImageData(a,0,h*Oc)}}}function Wc(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,s=t.width,i=n%Oc,r=(n-i)/Oc,o=0===i?r:r+1,a=e.createImageData(s,Oc);let l=0;const c=t.data,d=a.data;for(let u=0;u<o;u++){const t=u<r?Oc:i;({srcPos:l}=Mc({src:c,srcPos:l,dest:d,width:s,height:t,nonBlackColor:0})),e.putImageData(a,0,u*Oc)}}function Hc(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of n)void 0!==e[s]&&(t[s]=e[s]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function qc(e){e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0);const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}function zc(e,t){if(t)return!0;Bt.singularValueDecompose2dScale(e,jc);const n=Math.fround(mn.pixelRatio*Qt.PDF_TO_CSS_UNITS);return jc[0]<=n&&jc[1]<=n}const Gc=["butt","round","square"],Kc=["miter","round","bevel"],Jc={},Yc={};var $c=new WeakSet;class Xc{constructor(e,t,n,s,i,r,o,a,l){let{optionalContentConfig:c,markedContentStack:d=null}=r;ue(this,$c),this.ctx=e,this.current=new Bc(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=d||[],this.optionalContentConfig=c,this.cachedCanvases=new Lc(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=a,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=null!==l&&void 0!==l?l:null}getObject(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var s;return"string"===typeof t?(null===(s=this.dependencyTracker)||void 0===s||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing(e){let{transform:t,viewport:n,transparency:s=!1,background:i=null}=e;const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const e=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...hn(this.compositeCtx))}this.ctx.save(),qc(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=hn(this.ctx)}executeOperatorList(e,t,n,s,i){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const c=l-a>10&&"function"===typeof n,d=c?Date.now()+15:0;let u=0;const h=this.commonObjs,p=this.objs;let f,m;for(;;){if(void 0!==s&&a===s.nextBreakPoint)return s.breakIt(a,n),a;var g;if(!i||i(a))if(f=o[a],m=null!==(g=r[a])&&void 0!==g?g:null,f!==pt.dependency)null===m?this[f](a):this[f](a,...m);else for(const e of m){var v;null===(v=this.dependencyTracker)||void 0===v||v.recordNamedData(e,a);const t=e.startsWith("g_")?h:p;if(!t.has(e))return t.get(e,n),a}if(a++,a===l)return a;if(c&&++u>10){if(Date.now()>d)return n(),a;u=0}}}endDrawing(){pe($c,this,Qc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),pe($c,this,Zc).call(this)}_scaleImage(e,t){var n,s;const i=null!==(n=e.width)&&void 0!==n?n:e.displayWidth,r=null!==(s=e.height)&&void 0!==s?s:e.displayHeight;let o,a,l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),d=i,u=r,h="prescale1";for(;l>2&&d>1||c>2&&u>1;){let t=d,n=u;l>2&&d>1&&(t=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d/2),l/=d/t),c>2&&u>1&&(n=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,c/=u/n),o=this.cachedCanvases.getCanvas(h,t,n),a=o.context,a.clearRect(0,0,t,n),a.drawImage(e,0,0,d,u,0,0,t,n),e=o.canvas,d=t,u=n,h="prescale1"===h?"prescale2":"prescale1"}return{img:e,paintWidth:d,paintHeight:u}}_createMaskCanvas(e,t){var n;const s=this.ctx,{width:i,height:r}=t,o=this.current.fillColor,a=this.current.patternFill,l=hn(s);let c,d,u,h;if((t.bitmap||t.data)&&t.count>1){const n=t.bitmap||t.data.buffer;d=JSON.stringify(a?l:[l.slice(0,4),o]),c=this._cachedBitmapsMap.get(n),c||(c=new Map,this._cachedBitmapsMap.set(n,c));const s=c.get(d);if(s&&!a){var p;const t=Math.round(Math.min(l[0],l[2])+l[4]),n=Math.round(Math.min(l[1],l[3])+l[5]);return null===(p=this.dependencyTracker)||void 0===p||p.recordDependencies(e,yc),{canvas:s,offsetX:t,offsetY:n}}u=s}u||(h=this.cachedCanvases.getCanvas("maskCanvas",i,r),Wc(h.context,t));let f=Bt.transform(l,[1/i,0,0,-1/r,0,0]);f=Bt.transform(f,[1,0,0,1,0,-r]);const m=Fc.slice();Bt.axialAlignedBoundingBox([0,0,i,r],f,m);const[g,v,b,y]=m,_=Math.round(b-g)||1,w=Math.round(y-v)||1,x=this.cachedCanvases.getCanvas("fillCanvas",_,w),E=x.context,S=g,A=v;E.translate(-S,-A),E.transform(...f),u||(u=this._scaleImage(h.canvas,pn(E)),u=u.img,c&&a&&c.set(d,u)),E.imageSmoothingEnabled=zc(hn(E),t.interpolate),Uc(E,u,0,0,u.width,u.height,0,0,i,r),E.globalCompositeOperation="source-in";const C=Bt.transform(pn(E),[1,0,0,1,-S,-A]);return E.fillStyle=a?o.getPattern(s,this,C,_c,e):o,E.fillRect(0,0,i,r),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,x.canvas)),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,yc),{canvas:x.canvas,offsetX:Math.round(S),offsetY:Math.round(A)}}setLineWidth(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineCap",e),this.ctx.lineCap=Gc[t]}setLineJoin(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Kc[t]}setMiterLimit(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var s;null===(s=this.dependencyTracker)||void 0===s||s.recordSimpleData("dash",e);const i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,s,i,r,o;for(const[a,l]of t)switch(a){case"LW":this.setLineWidth(e,l);break;case"LC":this.setLineCap(e,l);break;case"LJ":this.setLineJoin(e,l);break;case"ML":this.setMiterLimit(e,l);break;case"D":this.setDash(e,l[0],l[1]);break;case"RI":this.setRenderingIntent(e,l);break;case"FL":this.setFlatness(e,l);break;case"Font":this.setFont(e,l[0],l[1]);break;case"CA":null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=l;break;case"ca":null===(s=this.dependencyTracker)||void 0===s||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=l;break;case"BM":null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=l;break;case"SMask":null===(r=this.dependencyTracker)||void 0===r||r.recordSimpleData("SMask",e),this.current.activeSMask=l?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":null===(o=this.dependencyTracker)||void 0===o||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(l)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),Hc(this.suspendedCtx,r),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,s,i,r,o){t.transform(e,n,s,i,r,o),this.__originalTransform(e,n,s,i,r,o)},e.setTransform=function(e,n,s,i,r,o){t.setTransform(e,n,s,i,r,o),this.__originalSetTransform(e,n,s,i,r,o)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,s,i,r,o){t.bezierCurveTo(e,n,s,i,r,o),this.__originalBezierCurveTo(e,n,s,i,r,o)},e.rect=function(e,n,s,i){t.rect(e,n,s,i),this.__originalRect(e,n,s,i)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Hc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const i=s[0],r=s[1],o=s[2]-i,a=s[3]-r;0!==o&&0!==a&&(this.genericComposeSMask(t.context,n,o,a,t.subtype,t.backdrop,t.transferMap,i,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,i,r,o,a,l,c,d){let u=e.canvas,h=a-c,p=l-d;if(r)if(h<0||p<0||h+n>u.width||p+s>u.height){const e=this.cachedCanvases.getCanvas("maskExtension",n,s),t=e.context;t.drawImage(u,-h,-p),t.globalCompositeOperation="destination-atop",t.fillStyle=r,t.fillRect(0,0,n,s),t.globalCompositeOperation="source-over",u=e.canvas,h=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const t=new Path2D;t.rect(h,p,n,s),e.clip(t),e.globalCompositeOperation="destination-atop",e.fillStyle=r,e.fillRect(h,p,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===i&&o?t.filter=this.filterFactory.addAlphaFilter(o):"Luminosity"===i&&(t.filter=this.filterFactory.addLuminosityFilter(o));const f=new Path2D;f.rect(a,l,n,s),t.clip(f),t.globalCompositeOperation="destination-in",t.drawImage(u,h,p,n,s,a,l,n,s),t.restore()}save(e){var t;this.inSMaskMode&&Hc(this.ctx,this.suspendedCtx),this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone(),null===(t=this.dependencyTracker)||void 0===t||t.save(e)}restore(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.restore(e),0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Hc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(e,t,n,s,i,r,o){var a;null===(a=this.dependencyTracker)||void 0===a||a.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[i]=n;if(!s)return i||(i=n[0]=new Path2D),void this[t](e,i);if(null!==this.dependencyTracker){const n=t===pt.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-n,s[2]+n,s[1]-n,s[3]+n).recordDependencies(e,["transform"])}i instanceof Path2D||(i=n[0]=Sn(i)),Bt.axialAlignedBoundingBox(s,hn(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t){var n;let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"===typeof r&&null!==r&&void 0!==r&&r.getPattern){const n=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,pn(i),wc,e),n){const e=new Path2D;e.addPath(t,i.getTransform().invertSelf().multiplySelf(n)),t=e}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,pc),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(wc,hn(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t){var n;let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.ctx,r=this.current.fillColor;let o=!1;if(this.current.patternFill){var a;const n=r.isModifyingCurrentTransform()?i.getTransform():null;if(null===(a=this.dependencyTracker)||void 0===a||a.save(e),i.save(),i.fillStyle=r.getPattern(i,this,pn(i),_c,e),n){const e=new Path2D;e.addPath(t,i.getTransform().invertSelf().multiplySelf(n)),t=e}o=!0}const l=this.current.getClippedPathBoundingBox();var c;(this.contentVisible&&null!==l&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,fc),o)&&(i.restore(),null===(c=this.dependencyTracker)||void 0===c||c.restore(e));s&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,gc).recordOperation(e)}clip(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Jc}eoClip(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Yc}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,null===(t=this.dependencyTracker)||void 0===t||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;void 0!==t&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",e),n.recordCloseMarker(e)}if(void 0!==t){const e=new Path2D,s=n.getTransform().invertSelf();for(const{transform:n,x:i,y:r,fontSize:o,path:a}of t)a&&e.addPath(a,new DOMMatrix(n).preMultiplySelf(s).translate(i,r).scale(o,-o));n.clip(e)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var s,i;null===(s=this.dependencyTracker)||void 0===s||s.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),o=this.current;if(!r)throw new Error("Can't find font for ".concat(t));if(o.fontMatrix=r.fontMatrix||Fe,0!==o.fontMatrix[0]&&0!==o.fontMatrix[3]||Et("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const a=r.loadedName||"sans-serif",l=(null===(i=r.systemFontInfo)||void 0===i?void 0:i.css)||'"'.concat(a,'", ').concat(r.fallbackName);let c="normal";r.black?c="900":r.bold&&(c="bold");const d=r.italic?"italic":"normal";let u=n;n<16?u=16:n>100&&(u=100),this.current.fontSizeScale=n/u,this.ctx.font="".concat(d," ").concat(c," ").concat(u,"px ").concat(l)}setTextRenderingMode(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var s;null===(s=this.dependencyTracker)||void 0===s||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t,n;this.moveText(e,0,this.current.leading),null===(t=this.dependencyTracker)||void 0===t||t.recordIncrementalData("moveText",null!==(n=this.dependencyTracker.getSimpleIndex("leading"))&&void 0!==n?n:e)}paintChar(e,t,n,s,i,r){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,d=a.fontSize/a.fontSizeScale,u=c&st,h=!!(c&it),p=a.patternFill&&!l.missingFile,f=a.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||h||p||f)&&!l.missingFile&&(m=l.getPathGenerator(this.commonObjs,t)),m&&(l.disableFontFace||p||f)){var g;let t;if(o.save(),o.translate(n,s),o.scale(d,-d),null===(g=this.dependencyTracker)||void 0===g||g.recordCharacterBBox(e,o,l),u===Ze||u===tt)if(i){t=o.getTransform(),o.setTransform(...i);const e=pe($c,this,ed).call(this,m,t,i);o.fill(e)}else o.fill(m);if(u===et||u===tt)if(r){t||(t=o.getTransform()),o.setTransform(...r);const{a:e,b:n,c:s,d:i}=t,a=Bt.inverseTransform(r),l=Bt.transform([e,n,s,i,0,0],a);Bt.singularValueDecompose2dScale(l,jc),o.lineWidth*=Math.max(jc[0],jc[1])/d,o.stroke(pe($c,this,ed).call(this,m,t,r))}else o.lineWidth/=d,o.stroke(m);o.restore()}else{var v;if(u===Ze||u===tt)o.fillText(t,n,s),null===(v=this.dependencyTracker)||void 0===v||v.recordCharacterBBox(e,o,l,d,n,s,()=>o.measureText(t));if(u===et||u===tt){var b;if(this.dependencyTracker)null===(b=this.dependencyTracker)||void 0===b||b.recordCharacterBBox(e,o,l,d,n,s,()=>o.measureText(t)).recordDependencies(e,pc);o.strokeText(t,n,s)}}if(h){var y;(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:hn(o),x:n,y:s,fontSize:d,path:m}),null===(y=this.dependencyTracker)||void 0===y||y.recordCharacterBBox(e,o,l,d,n,s)}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Tt(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var n;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,vc).resetBBox(e),this.current.textRenderingMode&it&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,i=s.font;var r;if(i.isType3Font)return this.showType3Text(e,t),void(null===(r=this.dependencyTracker)||void 0===r||r.recordShowTextOperation(e));const o=s.fontSize;var a;if(0===o)return void(null===(a=this.dependencyTracker)||void 0===a||a.recordOperation(e));const l=this.ctx,c=s.fontSizeScale,d=s.charSpacing,u=s.wordSpacing,h=s.fontDirection,p=s.textHScale*h,f=t.length,m=i.vertical,g=m?1:-1,v=i.defaultVMetrics,b=o*s.fontMatrix[0],y=s.textRenderingMode===Ze&&!i.disableFontFace&&!s.patternFill;let _,w;l.save(),s.textMatrix&&l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),h>0?l.scale(p,-1):l.scale(p,1);const x=s.textRenderingMode&st,E=x===et||x===tt;if((x===Ze||x===tt)&&s.patternFill){l.save();const t=s.fillColor.getPattern(l,this,pn(l),_c,e);_=hn(l),l.restore(),l.fillStyle=t}if(E&&s.patternStroke){l.save();const t=s.strokeColor.getPattern(l,this,pn(l),wc,e);w=hn(l),l.restore(),l.strokeStyle=t}let S=s.lineWidth;const A=s.textMatrixScale;if(0===A||0===S?E&&(S=this.getSinglePixelWidth()):S/=A,1!==c&&(l.scale(c,c),S/=c),l.lineWidth=S,i.isInvalidPDFjsFont){const n=[];let i=0;for(const e of t)n.push(e.unicode),i+=e.width;const r=n.join("");if(l.fillText(r,0,0),null!==this.dependencyTracker){const t=l.measureText(r);this.dependencyTracker.recordBBox(e,this.ctx,-t.actualBoundingBoxLeft,t.actualBoundingBoxRight,-t.actualBoundingBoxAscent,t.actualBoundingBoxDescent).recordShowTextOperation(e)}return s.x+=i*b*p,l.restore(),void this.compose()}let C,k=0;for(C=0;C<f;++C){const n=t[C];if("number"===typeof n){k+=g*n*o/1e3;continue}let s=!1;const r=(n.isSpace?u:0)+d,a=n.fontChar,p=n.accent;let f,x,E,S=n.width;if(m){const e=n.vmetric||v,t=-(n.vmetric?e[1]:.5*S)*b,s=e[2]*b;S=e?-e[0]:S,f=t/c,x=(k+s)/c}else f=k/c,x=0;if(i.remeasure&&S>0){E=l.measureText(a);const e=1e3*E.width/o*c;if(S<e&&this.isFontSubpixelAAEnabled){const t=S/e;s=!0,l.save(),l.scale(t,1),f/=t}else S!==e&&(f+=(S-e)/2e3*o/c)}var T;if(this.contentVisible&&(n.isInFont||i.missingFile))if(y&&!p)l.fillText(a,f,x),null===(T=this.dependencyTracker)||void 0===T||T.recordCharacterBBox(e,l,E?{bbox:null}:i,o/c,f,x,()=>null!==E&&void 0!==E?E:l.measureText(a));else if(this.paintChar(e,a,f,x,_,w),p){const t=f+o*p.offset.x/c,n=x-o*p.offset.y/c;this.paintChar(e,p.fontChar,t,n,_,w)}k+=m?S*b-r*h:S*b+r*h,s&&l.restore()}m?s.y-=k:s.x+=k*p,l.restore(),this.compose(),null===(n=this.dependencyTracker)||void 0===n||n.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,i=s.font,r=s.fontSize,o=s.fontDirection,a=i.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,d=s.textHScale*o,u=s.fontMatrix||Fe,h=t.length;let p,f,m,g;if(s.textRenderingMode===nt||0===r)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(d,o);const v=this.dependencyTracker;for(this.dependencyTracker=v?new hc(v,e):null,p=0;p<h;++p){if(f=t[p],"number"===typeof f){g=a*f*r/1e3,this.ctx.translate(g,0),s.x+=g*d;continue}const e=(f.isSpace?c:0)+l,o=i.charProcOperatorList[f.operatorListId];o?this.contentVisible&&(this.save(),n.scale(r,r),n.transform(...u),this.executeOperatorList(o),this.restore()):Et('Type3 character "'.concat(f.operatorListId,'" is not available.'));const h=[f.width,0];Bt.applyTransform(h,u),m=h[0]*r+e,n.translate(m,0),s.x+=m*d}n.restore(),v&&(this.dependencyTracker=v)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,i,r,o){var a;const l=new Path2D;l.rect(s,i,r-s,o-i),this.ctx.clip(l),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,this.ctx,s,r,i,o).recordClipBox(e,this.ctx,s,r,i,o),this.endPath(e)}getColorN_Pattern(e,t){let n;if("TilingPattern"===t[0]){const e=this.baseTransform||hn(this.ctx),s={createCanvasGraphics:(e,t)=>new Xc(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new hc(this.dependencyTracker,t,!0):null)};n=new Rc(t,this.ctx,s,e)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("strokeColor",e);for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];this.current.strokeColor=this.getColorN_Pattern(e,s),this.current.patternStroke=!0}setFillColorN(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("fillColor",e);for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];this.current.fillColor=this.getColorN_Pattern(e,s),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t){let n,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=function(e){switch(e[0]){case"RadialAxial":return new Ac(e);case"Mesh":return new Tc(e);case"Dummy":return new Nc}throw new Error("Unknown IR type: ".concat(e[0]))}(this.getObject(e,t)),this.cachedPatterns.set(t,n)),s&&(n.matrix=s),n}shadingFill(e,t){var n;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const i=this._getPattern(e,t);s.fillStyle=i.getPattern(s,this,pn(s),xc,e);const r=pn(s);if(r){const{width:e,height:t}=s.canvas,n=Fc.slice();Bt.axialAlignedBoundingBox([0,0,e,t],r,n);const[i,o,a,l]=n;this.ctx.fillRect(i,o,a-i,l-o)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,bc).recordDependencies(e,fc).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){St("Should not call beginInlineImage")}beginImageData(){St("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=hn(this.ctx),n)){var s;Bt.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[t,i,r,o]=n,a=new Path2D;a.rect(t,i,r-t,o-i),this.ctx.clip(a),null===(s=this.dependencyTracker)||void 0===s||s.recordClipBox(e,this.ctx,t,r,i,o),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var n;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||xt("TODO: Support non-isolated groups."),t.knockout&&Et("Knockout groups not supported.");const i=hn(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Fc.slice();Bt.axialAlignedBoundingBox(t.bbox,hn(s),r);const o=[0,0,s.canvas.width,s.canvas.height];r=Bt.intersect(r,o)||[0,0,0,0];const a=Math.floor(r[0]),l=Math.floor(r[1]),c=Math.max(Math.ceil(r[2])-a,1),d=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,d]);let u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(u,c,d),p=h.context;p.translate(-a,-l),p.transform(...i);let f=new Path2D;const[m,g,v,b]=t.bbox;if(f.rect(m,g,v-m,b-g),t.matrix){const e=new Path2D;e.addPath(f,new DOMMatrix(t.matrix)),f=e}p.clip(f),t.smask&&this.smaskStack.push({canvas:h.canvas,context:p,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),t.smask&&!this.dependencyTracker||(s.setTransform(1,0,0,1,0,0),s.translate(a,l),s.save()),Hc(s,p),this.ctx=p,null===(n=this.dependencyTracker)||void 0===n||n.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var n;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,null===(n=this.dependencyTracker)||void 0===n||n.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const t=hn(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...t);const n=Fc.slice();Bt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],t,n),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,s,i,r){if(pe($c,this,Qc).call(this),qc(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const i=n[2]-n[0],o=n[3]-n[1];if(r&&this.annotationCanvasMap){(s=s.slice())[4]-=n[0],s[5]-=n[1],(n=n.slice())[0]=n[1]=0,n[2]=i,n[3]=o,Bt.singularValueDecompose2dScale(hn(this.ctx),jc);const{viewportScale:e}=this,r=Math.ceil(i*this.outputScaleX*e),a=Math.ceil(o*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(r,a);const{canvas:l,context:c}=this.annotationCanvas;this.annotationCanvasMap.set(t,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=c,this.ctx.save(),this.ctx.setTransform(jc[0],0,0,-jc[1],0,o*jc[1]),qc(this.ctx)}else{qc(this.ctx),this.endPath(e);const t=new Path2D;t.rect(n[0],n[1],i,o),this.ctx.clip(t)}}this.current=new Bc(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),pe($c,this,Zc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var n;if(!this.contentVisible)return;const s=t.count;(t=this.getObject(e,t.data,t)).count=s;const i=this.ctx,r=this._createMaskCanvas(e,t),o=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,r.offsetX,r.offsetY),null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+o.width,r.offsetY,r.offsetY+o.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n){var s,i;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const d=hn(c);c.transform(n,r,o,a,0,0);const u=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,u.offsetX-d[4],u.offsetY-d[5]),null===(s=this.dependencyTracker)||void 0===s||s.resetBBox(e);for(let p=0,f=l.length;p<f;p+=2){var h;const t=Bt.transform(d,[n,r,o,a,l[p],l[p+1]]);c.drawImage(u.canvas,t[4],t[5]),null===(h=this.dependencyTracker)||void 0===h||h.recordBBox(e,this.ctx,t[4],t[4]+u.canvas.width,t[5],t[5]+u.canvas.height)}c.restore(),this.compose(),null===(i=this.dependencyTracker)||void 0===i||i.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var n,s;if(!this.contentVisible)return;const i=this.ctx,r=this.current.fillColor,o=this.current.patternFill;null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordDependencies(e,yc);for(const l of t){var a;const{data:t,width:n,height:s,transform:c}=l,d=this.cachedCanvases.getCanvas("maskCanvas",n,s),u=d.context;u.save();Wc(u,this.getObject(e,t,l)),u.globalCompositeOperation="source-in",u.fillStyle=o?r.getPattern(u,this,pn(i),_c,e):r,u.fillRect(0,0,n,s),u.restore(),i.save(),i.transform(...c),i.scale(1,-1),Uc(i,d.canvas,0,0,n,s,0,-1,1,1),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,i,0,n,0,s),i.restore()}this.compose(),null===(s=this.dependencyTracker)||void 0===s||s.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);n?this.paintInlineImageXObject(e,n):Et("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,s,i){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r)return void Et("Dependent image isn't ready yet");const o=r.width,a=r.height,l=[];for(let c=0,d=i.length;c<d;c+=2)l.push({transform:[n,0,0,s,i[c],i[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(e,r,l)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:s}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,s),r=i.context;return r.filter=this.current.transferMaps,r.drawImage(t,0,0),r.filter="none",i.canvas}paintInlineImageXObject(e,t){var n;if(!this.contentVisible)return;const s=t.width,i=t.height,r=this.ctx;this.save(e);const{filter:o}=r;let a;if("none"!==o&&""!==o&&(r.filter="none"),r.scale(1/s,-1/i),t.bitmap)a=this.applyTransferMapsToBitmap(t);else if("function"===typeof HTMLElement&&t instanceof HTMLElement||!t.data)a=t;else{const e=this.cachedCanvases.getCanvas("inlineImage",s,i).context;Vc(e,t),a=this.applyTransferMapsToCanvas(e)}const l=this._scaleImage(a,pn(r));r.imageSmoothingEnabled=zc(hn(r),t.interpolate),null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordBBox(e,r,0,s,-i,0).recordDependencies(e,mc).recordOperation(e),Uc(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,s,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var s,i;if(!this.contentVisible)return;const r=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const e=t.width,n=t.height,s=this.cachedCanvases.getCanvas("inlineImage",e,n).context;Vc(s,t),o=this.applyTransferMapsToCanvas(s)}null===(s=this.dependencyTracker)||void 0===s||s.resetBBox(e);for(const l of n){var a;r.save(),r.transform(...l.transform),r.scale(1,-1),Uc(r,o,l.x,l.y,l.w,l.h,0,-1,1,1),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,r,0,1,-1,0),r.restore()}null===(i=this.dependencyTracker)||void 0===i||i.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&(null===(t=this.dependencyTracker)||void 0===t||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,fc).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var s;null===(s=this.dependencyTracker)||void 0===s||s.beginMarkedContent(e),"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const i=this.ctx;var r,o;this.pendingClip?(s||(this.pendingClip===Yc?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,null===(r=this.dependencyTracker)||void 0===r||r.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):null===(o=this.dependencyTracker)||void 0===o||o.recordOperation(e);this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=hn(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:i}=this.ctx.getTransform();let r,o;if(0===n&&0===s){const n=Math.abs(t),s=Math.abs(i);if(n===s)if(0===e)r=o=1/n;else{const t=n*e;r=o=t<1?1/t:1}else if(0===e)r=1/n,o=1/s;else{const t=n*e,i=s*e;r=t<1?1/t:1,o=i<1?1/i:1}}else{const a=Math.abs(t*i-n*s),l=Math.hypot(t,n),c=Math.hypot(s,i);if(0===e)r=c/a,o=l/a;else{const t=e*a;r=c>t?c/t:1,o=l>t?l/t:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[i,r]=this.getScaleForStroking();if(i===r)return n.lineWidth=(s||1)*i,void n.stroke(e);const o=n.getLineDash();t&&n.save(),n.scale(i,r),Dc.a=1/i,Dc.d=1/r;const a=new Path2D;if(a.addPath(e,Dc),o.length>0){const e=Math.max(i,r);n.setLineDash(o.map(t=>t/e)),n.lineDashOffset/=e}n.lineWidth=s||1,n.stroke(a),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}function Qc(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function Zc(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}function ed(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}for(const n in pt)void 0!==Xc.prototype[n]&&(Xc.prototype[pt[n]]=Xc.prototype[n]);class td{static get workerPort(){return pe(td,this,nd)._}static set workerPort(e){if(!("undefined"!==typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");nd._=pe(td,this,e)}static get workerSrc(){return pe(td,this,sd)._}static set workerSrc(e){if("string"!==typeof e)throw new Error("Invalid `workerSrc` type.");sd._=pe(td,this,e)}}var nd={_:null},sd={_:""},id=new WeakMap,rd=new WeakMap;class od{constructor(e){let{parsedData:t,rawData:n}=e;he(this,id,void 0),he(this,rd,void 0),ge(id,this,t),ge(rd,this,n)}getRaw(){return me(rd,this)}get(e){var t;return null!==(t=me(id,this).get(e))&&void 0!==t?t:null}[Symbol.iterator](){return me(id,this).entries()}}const ad=Symbol("INTERNAL");var ld=new WeakMap,cd=new WeakMap,dd=new WeakMap,ud=new WeakMap;class hd{constructor(e,t){let{name:n,intent:s,usage:i,rbGroups:r}=t;he(this,ld,!1),he(this,cd,!1),he(this,dd,!1),he(this,ud,!0),ge(ld,this,!!(e&Be)),ge(cd,this,!!(e&Ve)),this.name=n,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(me(dd,this))return me(ud,this);if(!me(ud,this))return!1;const{print:e,view:t}=this.usage;return me(ld,this)?"OFF"!==(null===t||void 0===t?void 0:t.viewState):!me(cd,this)||"OFF"!==(null===e||void 0===e?void 0:e.printState)}_setVisible(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==ad&&St("Internal method `_setVisible` called."),ge(dd,this,n),ge(ud,this,t)}}var pd=new WeakMap,fd=new WeakMap,md=new WeakMap,gd=new WeakMap,vd=new WeakSet;class bd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Be;if(ue(this,vd),he(this,pd,null),he(this,fd,new Map),he(this,md,null),he(this,gd,null),this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,ge(gd,this,e.order);for(const n of e.groups)me(fd,this).set(n.id,new hd(t,n));if("OFF"===e.baseState)for(const e of me(fd,this).values())e._setVisible(ad,!1);for(const t of e.on)me(fd,this).get(t)._setVisible(ad,!0);for(const t of e.off)me(fd,this).get(t)._setVisible(ad,!1);ge(md,this,this.getHash())}}isVisible(e){if(0===me(fd,this).size)return!0;if(!e)return xt("Optional content group not defined."),!0;if("OCG"===e.type)return me(fd,this).has(e.id)?me(fd,this).get(e.id).visible:(Et("Optional content group not found: ".concat(e.id)),!0);if("OCMD"===e.type){if(e.expression)return pe(vd,this,yd).call(this,e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!me(fd,this).has(t))return Et("Optional content group not found: ".concat(t)),!0;if(me(fd,this).get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!me(fd,this).has(t))return Et("Optional content group not found: ".concat(t)),!0;if(!me(fd,this).get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!me(fd,this).has(t))return Et("Optional content group not found: ".concat(t)),!0;if(!me(fd,this).get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!me(fd,this).has(t))return Et("Optional content group not found: ".concat(t)),!0;if(me(fd,this).get(t).visible)return!1}return!0}return Et("Unknown optional content policy ".concat(e.policy,".")),!0}return Et("Unknown group type ".concat(e.type,".")),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=me(fd,this).get(e);if(s){if(n&&t&&s.rbGroups.length)for(const t of s.rbGroups)for(const n of t){var i;if(n!==e)null===(i=me(fd,this).get(n))||void 0===i||i._setVisible(ad,!1,!0)}s._setVisible(ad,!!t,!0),ge(pd,this,null)}else Et("Optional content group not found: ".concat(e))}setOCGState(e){let t,{state:n,preserveRB:s}=e;for(const i of n){switch(i){case"ON":case"OFF":case"Toggle":t=i;continue}const e=me(fd,this).get(i);if(e)switch(t){case"ON":this.setVisibility(i,!0,s);break;case"OFF":this.setVisibility(i,!1,s);break;case"Toggle":this.setVisibility(i,!e.visible,s)}}ge(pd,this,null)}get hasInitialVisibility(){return null===me(md,this)||this.getHash()===me(md,this)}getOrder(){return me(fd,this).size?me(gd,this)?me(gd,this).slice():[...me(fd,this).keys()]:null}getGroup(e){return me(fd,this).get(e)||null}getHash(){if(null!==me(pd,this))return me(pd,this);const e=new ko;for(const[t,n]of me(fd,this))e.update("".concat(t,":").concat(n.visible));return ge(pd,this,e.hexdigest())}[Symbol.iterator](){return me(fd,this).entries()}}function yd(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const t=e[s];let i;if(Array.isArray(t))i=pe(vd,this,yd).call(this,t);else{if(!me(fd,this).has(t))return Et("Optional content group not found: ".concat(t)),!0;i=me(fd,this).get(t).visible}switch(n){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return"And"===n}class _d{constructor(e,t){let{disableRange:n=!1,disableStream:s=!1}=t;At(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(null===r||void 0===r?void 0:r.length)>0){const e=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!n,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),e.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),e.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData(e){let{begin:t,chunk:n}=e;const s=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{At(this._rangeReaders.some(function(e){return e._begin===t&&(e._enqueue(s),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}_onProgress(e){var t,n,s,i;void 0===e.total?null===(t=this._rangeReaders[0])||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded}):null===(s=this._fullRequestReader)||void 0===s||null===(i=s.onProgress)||void 0===i||i.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;null===(e=this._fullRequestReader)||void 0===e||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){At(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new wd(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new xd(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class wd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=e,this._done=n||!1,this._filename=sn(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class xd{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Ed(e,t){const n=new Headers;if(!e||!t||"object"!==typeof t)return n;for(const s in t){const e=t[s];void 0!==e&&n.append(s,e)}return n}function Sd(e){var t,n;return null!==(t=null===(n=URL.parse(e))||void 0===n?void 0:n.origin)&&void 0!==t?t:null}function Ad(e){let{responseHeaders:t,isHttp:n,rangeChunkSize:s,disableRange:i}=e;const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(t.get("Content-Length"),10);if(!Number.isInteger(o))return r;if(r.suggestedLength=o,o<=2*s)return r;if(i||!n)return r;if("bytes"!==t.get("Accept-Ranges"))return r;return"identity"!==(t.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r}function Cd(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,n=s("filename\\*","i").exec(e);if(n){n=n[1];let e=o(n);return e=unescape(e),e=a(e),e=l(e),r(e)}if(n=function(e){const t=[];let n;const i=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=i.exec(e));){let[,e,s,i]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[s,i]}const r=[];for(let s=0;s<t.length&&s in t;++s){let[e,n]=t[s];n=o(n),e&&(n=unescape(n),0===s&&(n=a(n))),r.push(n)}return r.join("")}(e),n)return r(l(n));if(n=s("filename","i").exec(e),n){n=n[1];let e=o(n);return e=l(e),r(e)}function s(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function i(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const s=new TextDecoder(e,{fatal:!0}),i=Ft(n);n=s.decode(i),t=!1}catch(s){}}return n}function r(e){return t&&/[\x80-\xff]/.test(e)&&(e=i("utf-8",e),t&&(e=i("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function a(e){const t=e.indexOf("'");return-1===t?e:i(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,s){if("q"===n||"Q"===n)return i(t,s=(s=s.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{s=atob(s)}catch(r){}return i(t,s)})}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(n){}if(sn(e))return e}return null}function kd(e,t){return new Mt("Unexpected server response (".concat(e,') while retrieving PDF "').concat(t,'".'),e,404===e||0===e&&t.startsWith("file:"))}function Td(e){return 200===e||206===e}function Nd(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Id(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(Et("getArrayBuffer - unexpected data format: ".concat(e)),new Uint8Array(e).buffer)}class Pd{constructor(e){r(this,"_responseOrigin",null),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Ed(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return At(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Rd(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Md(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Rd{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,Nd(n,this._withCredentials,this._abortController)).then(t=>{if(e._responseOrigin=Sd(t.url),!Td(t.status))throw kd(t.status,s);this._reader=t.body.getReader(),this._headersCapability.resolve();const n=t.headers,{allowRangeRequests:i,suggestedLength:r}=Ad({responseHeaders:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=r||this._contentLength,this._filename=Cd(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Dt("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Id(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class Md{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range","bytes=".concat(t,"-").concat(n-1));const r=s.url;fetch(r,Nd(i,this._withCredentials,this._abortController)).then(t=>{const n=Sd(t.url);if(n!==e._responseOrigin)throw new Error('Expected range response-origin "'.concat(n,'" to match "').concat(e._responseOrigin,'".'));if(!Td(t.status))throw kd(t.status,r);this._readCapability.resolve(),this._reader=t.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded}),{value:Id(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class Od{constructor(e){let{url:t,httpHeaders:n,withCredentials:s}=e;r(this,"_responseOrigin",null),this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Ed(this.isHttp,n),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,r]of this.headers)t.setRequestHeader(i,r);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),s.expectedStatus=206):s.expectedStatus=200,t.responseType="arraybuffer",At(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var n;const s=this.pendingRequests[e];s&&(null===(n=s.onProgress)||void 0===n||n.call(s,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==s.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===s.status&&this.isHttp)return void n.onError(s.status);const i=s.status||200;if(!(200===i&&206===n.expectedStatus)&&i!==n.expectedStatus)return void n.onError(s.status);const r=function(e){const t=e.response;return"string"!==typeof t?t:Ft(t).buffer}(s);if(206===i){const e=s.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?n.onDone({begin:parseInt(t[1],10),chunk:r}):(Et('Missing or invalid "Content-Range" header.'),n.onError(0))}else r?n.onDone({begin:0,chunk:r}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Dd{constructor(e){this._source=e,this._manager=new Od(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return At(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new jd(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new Fd(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class jd{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Sd(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(e=>{const[t,...n]=e.split(": ");return[t,n.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:r}=Ad({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Cd(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e)if(this._requests.length>0){this._requests.shift().resolve({value:e.chunk,done:!1})}else this._cachedChunks.push(e.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=kd(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Fd{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=Sd(null===(e=this._manager.getRequestXhr(this._requestId))||void 0===e?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error('Expected range response-origin "'.concat(t,'" to match "').concat(this._manager._responseOrigin,'".')),this._onError(0))}_close(){var e;null===(e=this.onClosed)||void 0===e||e.call(this,this)}_onDone(e){const t=e.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunk=t;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){var t;null!==(t=this._storedError)&&void 0!==t||(this._storedError=kd(e,this._url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Ld=/^[a-z][a-z0-9\-+.]+:/i;class Ud{constructor(e){this.source=e,this.url=function(e){if(Ld.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),At("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return At(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Bd(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Vd(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Bd{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(e=>{this._contentLength=e.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},e=>{"ENOENT"===e.code&&(e=kd(0,this._url.href)),this._storedError=e,this._headersCapability.reject(e)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Dt("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Vd{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Wd=Symbol("INITIAL_DATA");var Hd=new WeakMap,qd=new WeakSet;class zd{constructor(){ue(this,qd),he(this,Hd,Object.create(null))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const n=pe(qd,this,Gd).call(this,e);return n.promise.then(()=>t(n.data)),null}const n=me(Hd,this)[e];if(!n||n.data===Wd)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}has(e){const t=me(Hd,this)[e];return!!t&&t.data!==Wd}delete(e){const t=me(Hd,this)[e];return!(!t||t.data===Wd)&&(delete me(Hd,this)[e],!0)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=pe(qd,this,Gd).call(this,e);n.data=t,n.resolve()}clear(){for(const t in me(Hd,this)){var e;const{data:n}=me(Hd,this)[t];null===n||void 0===n||null===(e=n.bitmap)||void 0===e||e.close()}ge(Hd,this,Object.create(null))}*[Symbol.iterator](){for(const e in me(Hd,this)){const{data:t}=me(Hd,this)[e];t!==Wd&&(yield[e,t])}}}function Gd(e){var t;return(t=me(Hd,this))[e]||(t[e]=a(a({},Promise.withResolvers()),{},{data:Wd}))}var Kd=new WeakMap,Jd=new WeakMap,Yd=new WeakMap,$d=new WeakMap,Xd=new WeakMap,Qd=new WeakMap,Zd=new WeakMap,eu=new WeakMap,tu=new WeakMap,nu=new WeakMap,su=new WeakMap,iu=new WeakMap,ru=new WeakMap,ou=new WeakMap,au=new WeakMap,lu=new WeakMap,cu=new WeakMap,du=new WeakMap,uu=new WeakSet;class hu{constructor(e){var t;let{textContentSource:n,container:s,viewport:i}=e;if(ue(this,uu),he(this,Kd,Promise.withResolvers()),he(this,Jd,null),he(this,Yd,!1),he(this,$d,!(null===(t=globalThis.FontInspector)||void 0===t||!t.enabled)),he(this,Xd,null),he(this,Qd,null),he(this,Zd,0),he(this,eu,0),he(this,tu,null),he(this,nu,null),he(this,su,0),he(this,iu,0),he(this,ru,Object.create(null)),he(this,ou,[]),he(this,au,null),he(this,lu,[]),he(this,cu,new WeakMap),he(this,du,null),n instanceof ReadableStream)ge(au,this,n);else{if("object"!==typeof n)throw new Error('No "textContentSource" parameter specified.');ge(au,this,new ReadableStream({start(e){e.enqueue(n),e.close()}}))}ge(Jd,this,ge(nu,this,s)),ge(iu,this,i.scale*mn.pixelRatio),ge(su,this,i.rotation),ge(Qd,this,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:o,pageX:a,pageY:l}=i.rawDims;ge(du,this,[1,0,0,-1,-a,l+o]),ge(eu,this,r),ge(Zd,this,o),bu.call(hu),s.style.setProperty("--min-font-size",Eu._),fn(s,i),me(Kd,this).promise.finally(()=>{Su._.delete(this),ge(Qd,this,null),ge(ru,this,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Lt.platform;return Tt(this,"fontFamilyMap",new Map([["sans-serif","".concat(e&&t?"Calibri, ":"","sans-serif")],["monospace","".concat(e&&t?"Lucida Console, ":"","monospace")]]))}render(){const e=()=>{me(tu,this).read().then(t=>{var n;let{value:s,done:i}=t;i?me(Kd,this).resolve():(null!==(n=me(Xd,this))&&void 0!==n||ge(Xd,this,s.lang),Object.assign(me(ru,this),s.styles),pe(uu,this,pu).call(this,s.items),e())},me(Kd,this).reject)};return ge(tu,this,me(au,this).getReader()),Su._.add(this),e(),me(Kd,this).promise}update(e){let{viewport:t,onBefore:n=null}=e;const s=t.scale*mn.pixelRatio,i=t.rotation;if(i!==me(su,this)&&(null===n||void 0===n||n(),ge(su,this,i),fn(me(nu,this),{rotation:i})),s!==me(iu,this)){null===n||void 0===n||n(),ge(iu,this,s);const e={div:null,properties:null,ctx:gu.call(hu,me(Xd,this))};for(const t of me(lu,this))e.properties=me(cu,this).get(t),e.div=t,pe(uu,this,mu).call(this,e)}}cancel(){var e;const t=new Dt("TextLayer task cancelled.");null===(e=me(tu,this))||void 0===e||e.cancel(t).catch(()=>{}),ge(tu,this,null),me(Kd,this).reject(t)}get textDivs(){return me(lu,this)}get textContentItemsStr(){return me(ou,this)}static cleanup(){if(!(pe(hu,this,Su)._.size>0)){pe(hu,this,_u)._.clear();for(const{canvas:e}of pe(hu,this,wu)._.values())e.remove();pe(hu,this,wu)._.clear()}}}function pu(e){var t,n;if(me(Yd,this))return;null!==(n=(t=me(Qd,this)).ctx)&&void 0!==n||(t.ctx=gu.call(Ce,me(Xd,this)));const s=me(lu,this),i=me(ou,this);for(const r of e){if(s.length>1e5)return Et("Ignoring additional textDivs for performance reasons."),void ge(Yd,this,!0);if(void 0!==r.str)i.push(r.str),pe(uu,this,fu).call(this,r);else if("beginMarkedContentProps"===r.type||"beginMarkedContent"===r.type){const e=me(Jd,this);ge(Jd,this,document.createElement("span")),me(Jd,this).classList.add("markedContent"),r.id&&me(Jd,this).setAttribute("id","".concat(r.id)),e.append(me(Jd,this))}else"endMarkedContent"===r.type&&ge(Jd,this,me(Jd,this).parentNode)}}function fu(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};me(lu,this).push(t);const s=Bt.transform(me(du,this),e.transform);let i=Math.atan2(s[1],s[0]);const r=me(ru,this)[e.fontName];r.vertical&&(i+=Math.PI/2);let o=me($d,this)&&r.fontSubstitution||r.fontFamily;o=Ce.fontFamilyMap.get(o)||o;const a=Math.hypot(s[2],s[3]),l=a*yu.call(Ce,o,r,me(Xd,this));let c,d;0===i?(c=s[4],d=s[5]-l):(c=s[4]+l*Math.sin(i),d=s[5]-l*Math.cos(i));const u=t.style;u.left="".concat((100*c/me(eu,this)).toFixed(2),"%"),u.top="".concat((100*d/me(Zd,this)).toFixed(2),"%"),u.setProperty("--font-height","".concat(a.toFixed(2),"px")),u.fontFamily=o,n.fontSize=a,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,me($d,this)&&(t.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),0!==i&&(n.angle=i*(180/Math.PI));let h=!1;if(e.str.length>1)h=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),n=Math.abs(e.transform[3]);t!==n&&Math.max(t,n)/Math.min(t,n)>1.5&&(h=!0)}if(h&&(n.canvasWidth=r.vertical?e.height:e.width),me(cu,this).set(t,n),me(Qd,this).div=t,me(Qd,this).properties=n,pe(uu,this,mu).call(this,me(Qd,this)),n.hasText&&me(Jd,this).append(t),n.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),me(Jd,this).append(e)}}function mu(e){const{div:t,properties:n,ctx:s}=e,{style:i}=t;if(0!==n.canvasWidth&&n.hasText){const{fontFamily:e}=i,{canvasWidth:r,fontSize:o}=n;vu.call(Ce,s,o*me(iu,this),e);const{width:a}=s.measureText(t.textContent);a>0&&i.setProperty("--scale-x",r*me(iu,this)/a)}0!==n.angle&&i.setProperty("--rotate","".concat(n.angle,"deg"))}function gu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=pe(Ce,this,wu)._.get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),pe(Ce,this,wu)._.set(e,t),pe(Ce,this,xu)._.set(t,{size:0,family:""})}return t}function vu(e,t,n){const s=pe(Ce,this,xu)._.get(e);t===s.size&&n===s.family||(e.font="".concat(t,"px ").concat(n),s.size=t,s.family=n)}function bu(){if(null!==pe(Ce,this,Eu)._)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),Eu._=pe(Ce,this,e.getBoundingClientRect().height),e.remove()}function yu(e,t,n){const s=pe(Ce,this,_u)._.get(e);if(s)return s;const i=pe(Ce,this,gu).call(this,n);i.canvas.width=i.canvas.height=30,pe(Ce,this,vu).call(this,i,30,e);const r=i.measureText(""),o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let l=.8;return o?l=o/(o+a):(Lt.platform.isFirefox&&Et("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?l=t.ascent:t.descent&&(l=1+t.descent)),pe(Ce,this,_u)._.set(e,l),l}Ce=hu;var _u={_:new Map},wu={_:new Map},xu={_:new WeakMap},Eu={_:null},Su={_:new Set};function Au(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof n||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const s=new Cu,{docId:i}=s,r=n.url?function(e){if(e instanceof URL)return e.href;if("string"===typeof e){if(je)return e;const t=URL.parse(e,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(n.url):null,o=n.data?function(e){if(je&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return Ft(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"===typeof e&&!isNaN(null===e||void 0===e?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(n.data):null,a=n.httpHeaders||null,l=!0===n.withCredentials,c=null!==(e=n.password)&&void 0!==e?e:null,d=n.range instanceof Mu?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:65536;let h=n.worker instanceof qu?n.worker:null;const p=n.verbosity,f="string"!==typeof n.docBaseUrl||nn(n.docBaseUrl)?null:n.docBaseUrl,m=Sa(n.cMapUrl),g=!1!==n.cMapPacked,v=n.CMapReaderFactory||(je?Nl:Za),b=Sa(n.iccUrl),y=Sa(n.standardFontDataUrl),_=n.StandardFontDataFactory||(je?Il:El),w=Sa(n.wasmUrl),x=n.WasmFactory||(je?Pl:Al),E=!0!==n.stopAtErrors,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,A=!1!==n.isEvalSupported,C="boolean"===typeof n.isOffscreenCanvasSupported?n.isOffscreenCanvasSupported:!je,k="boolean"===typeof n.isImageDecoderSupported?n.isImageDecoderSupported:!je&&(Lt.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N="boolean"===typeof n.disableFontFace?n.disableFontFace:je,I=!0===n.fontExtraProperties,P=!0===n.enableXfa,R=n.ownerDocument||globalThis.document,M=!0===n.disableRange,O=!0===n.disableStream,D=!0===n.disableAutoFetch,j=!0===n.pdfBug,F=n.CanvasFactory||(je?Tl:Xa),L=n.FilterFactory||(je?kl:cl),U=!0===n.enableHWA,B=!1!==n.useWasm,V=d?d.length:null!==(t=n.length)&&void 0!==t?t:NaN,W="boolean"===typeof n.useSystemFonts?n.useSystemFonts:!je&&!N,H="boolean"===typeof n.useWorkerFetch?n.useWorkerFetch:!!(v===Za&&_===El&&x===Al&&m&&y&&w&&on(m,document.baseURI)&&on(y,document.baseURI)&&on(w,document.baseURI));_t(p);const q={canvasFactory:new F({ownerDocument:R,enableHWA:U}),filterFactory:new L({docId:i,ownerDocument:R}),cMapReaderFactory:H?null:new v({baseUrl:m,isCompressed:g}),standardFontDataFactory:H?null:new _({baseUrl:y}),wasmFactory:H?null:new x({baseUrl:w})};h||(h=qu.create({verbosity:p,port:td.workerPort}),s._worker=h);const z={docId:i,apiVersion:"5.4.530",data:o,password:c,disableAutoFetch:D,rangeChunkSize:u,length:V,docBaseUrl:f,enableXfa:P,evaluatorOptions:{maxImageSize:S,disableFontFace:N,ignoreErrors:E,isEvalSupported:A,isOffscreenCanvasSupported:C,isImageDecoderSupported:k,canvasMaxAreaInBytes:T,fontExtraProperties:I,useSystemFonts:W,useWasm:B,useWorkerFetch:H,cMapUrl:m,iccUrl:b,standardFontDataUrl:y,wasmUrl:w}},G={ownerDocument:R,pdfBug:j,styleElement:null,loadingParams:{disableAutoFetch:D,enableXfa:P}};return h.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const e=h.messageHandler.sendWithPromise("GetDocRequest",z,o?[o.buffer]:null);let t;if(d)t=new _d(d,{disableRange:M,disableStream:O});else if(!o){if(!r)throw new Error("getDocument - no `url` parameter provided.");const e=on(r)?Pd:je?Ud:Dd;t=new e({url:r,length:V,httpHeaders:a,withCredentials:l,rangeChunkSize:u,disableRange:M,disableStream:O})}return e.then(e=>{if(s.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const n=new qa(i,e,h.port),r=new rh(n,s,t,G,q,U);s._transport=r,n.send("Ready",null)})}).catch(s._capability.reject),s}class Cu{constructor(){r(this,"_capability",Promise.withResolvers()),r(this,"_transport",null),r(this,"_worker",null),r(this,"docId","d".concat((ku._=(ke=ku._,Te=ke++,ke),Te))),r(this,"destroyed",!1),r(this,"onPassword",null),r(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0;try{var t,n;null!==(t=this._worker)&&void 0!==t&&t.port&&(this._worker._pendingDestroy=!0),await(null===(n=this._transport)||void 0===n?void 0:n.destroy())}catch(i){var s;throw null!==(s=this._worker)&&void 0!==s&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,null===(e=this._worker)||void 0===e||e.destroy(),this._worker=null}async getData(){return this._transport.getData()}}var ku={_:0},Tu=new WeakMap,Nu=new WeakMap,Iu=new WeakMap,Pu=new WeakMap,Ru=new WeakMap;class Mu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;he(this,Tu,Promise.withResolvers()),he(this,Nu,[]),he(this,Iu,[]),he(this,Pu,[]),he(this,Ru,[]),this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){me(Ru,this).push(e)}addProgressListener(e){me(Pu,this).push(e)}addProgressiveReadListener(e){me(Iu,this).push(e)}addProgressiveDoneListener(e){me(Nu,this).push(e)}onDataRange(e,t){for(const n of me(Ru,this))n(e,t)}onDataProgress(e,t){me(Tu,this).promise.then(()=>{for(const n of me(Pu,this))n(e,t)})}onDataProgressiveRead(e){me(Tu,this).promise.then(()=>{for(const t of me(Iu,this))t(e)})}onDataProgressiveDone(){me(Tu,this).promise.then(()=>{for(const e of me(Nu,this))e()})}transportReady(){me(Tu,this).resolve()}requestDataRange(e,t){St("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Ou{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Tt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Du=new WeakMap,ju=new WeakSet;class Fu{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ue(this,ju),he(this,Du,!1),this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new rn:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new zd,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new en({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:i})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Tt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return(null===(e=this._transport._htmlForXfa)||void 0===e?void 0:e.children[this._pageIndex])||null}render(e){var t,n,s;let{canvasContext:i,canvas:r=i.canvas,viewport:o,intent:a="display",annotationMode:l=Ke.ENABLE,transform:c=null,background:d=null,optionalContentConfigPromise:u=null,annotationCanvasMap:h=null,pageColors:p=null,printAnnotationStorage:f=null,isEditing:m=!1,recordOperations:g=!1,operationsFilter:v=null}=e;null===(t=this._stats)||void 0===t||t.time("Overall");const b=this._transport.getRenderingIntent(a,l,f,m),{renderingIntent:y,cacheKey:_}=b;ge(Du,this,!1),u||(u=this._transport.getOptionalContentConfig(y));let w=this._intentStates.get(_);w||(w=Object.create(null),this._intentStates.set(_,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const x=!!(y&Ve);var E;w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(E=this._stats)||void 0===E||E.time("Page Request"),this._pumpOperatorList(b));const S=Boolean(this._pdfBug&&(null===(n=globalThis.StepperManager)||void 0===n?void 0:n.enabled)),A=!this.recordedBBoxes&&(g||S),C=e=>{if(w.renderTasks.delete(k),A){var t;const e=null===(t=k.gfx)||void 0===t?void 0:t.dependencyTracker.take();e&&(k.stepper&&k.stepper.setOperatorBBoxes(e,k.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=e))}var n;(x&&ge(Du,this,!0),pe(ju,this,Lu).call(this),e?(k.capability.reject(e),this._abortOperatorList({intentState:w,reason:e instanceof Error?e:new Error(e)})):k.capability.resolve(),this._stats)&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),null!==(n=globalThis.Stats)&&void 0!==n&&n.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new dh({callback:C,params:{canvas:r,canvasContext:i,dependencyTracker:A?new rc(r,w.operatorList.length,S):null,viewport:o,transform:c,background:d},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:v});((s=w).renderTasks||(s.renderTasks=new Set)).add(k);const T=k.task;return Promise.all([w.displayReadyCapability.promise,u]).then(e=>{var t;let[n,s]=e;if(this.destroyed)C();else{if(null===(t=this._stats)||void 0===t||t.time("Rendering"),!(s.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:n,optionalContentConfig:s}),k.operatorListChanged()}}).catch(C),T}getOperatorList(){let{intent:e="display",annotationMode:t=Ke.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this._transport.getRenderingIntent(e,t,n,s,!0);let r,o=this._intentStates.get(i.cacheKey);var a,l;(o||(o=Object.create(null),this._intentStates.set(i.cacheKey,o)),o.opListReadCapability)||(r=Object.create(null),r.operatorListChanged=function(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(r))},o.opListReadCapability=Promise.withResolvers(),((a=o).renderTasks||(a.renderTasks=new Set)).add(r),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(l=this._stats)||void 0===l||l.time("Page Request"),this._pumpOperatorList(i));return o.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(e=>Yt.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const s=t.getReader(),i={items:[],styles:Object.create(null),lang:null};!function t(){s.read().then(function(n){var s;let{value:r,done:o}=n;o?e(i):(null!==(s=i.lang)&&void 0!==s||(i.lang=r.lang),Object.assign(i.styles,r.styles),i.items.push(...r.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),ge(Du,this,!1),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ge(Du,this,!0);const t=pe(ju,this,Lu).call(this);return e&&t&&this._stats&&(this._stats=new rn),t}_startRenderPage(e,t){var n,s;const i=this._intentStates.get(t);i&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(s=i.displayReadyCapability)||void 0===s||s.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&pe(ju,this,Lu).call(this)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:n,annotationStorageSerializable:s,modifiedIds:i}=e;const{map:r,transfer:o}=s,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:r,modifiedIds:i},o).getReader(),l=this._intentStates.get(n);l.streamReader=a;const c=()=>{a.read().then(e=>{let{value:t,done:n}=e;n?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,l),c())},e=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const e of l.renderTasks)e.operatorListChanged();pe(ju,this,Lu).call(this)}if(l.displayReadyCapability)l.displayReadyCapability.reject(e);else{if(!l.opListReadCapability)throw e;l.opListReadCapability.reject(e)}}})};c()}_abortOperatorList(e){let{intentState:t,reason:n,force:s=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(n instanceof tn){let e=100;return n.extraDelay>0&&n.extraDelay<1e3&&(e+=n.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:n,force:!0})},e))}}if(t.streamReader.cancel(new Dt(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}function Lu(){if(!me(Du,this)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ge(Du,this,!1),!0}var Uu=new WeakMap,Bu=new WeakMap,Vu=new WeakMap,Wu=new WeakMap,Hu=new WeakSet;class qu{constructor(){let{name:e=null,port:t=null,verbosity:n=wt()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(ue(this,Hu),he(this,Uu,Promise.withResolvers()),he(this,Bu,null),he(this,Vu,null),he(this,Wu,null),this.name=e,this.destroyed=!1,this.verbosity=n,t){if(Qu._.has(t))throw new Error("Cannot use more than one PDFWorker per port.");Qu._.set(t,this),pe(Hu,this,Gu).call(this,t)}else pe(Hu,this,Ku).call(this)}get promise(){return me(Uu,this).promise}get port(){return me(Vu,this)}get messageHandler(){return me(Bu,this)}destroy(){var e,t;this.destroyed=!0,null===(e=me(Wu,this))||void 0===e||e.terminate(),ge(Wu,this,null),Qu._.delete(me(Vu,this)),ge(Vu,this,null),null===(t=me(Bu,this))||void 0===t||t.destroy(),ge(Bu,this,null)}static create(e){const t=pe(qu,this,Qu)._.get(null===e||void 0===e?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new qu(e)}static get workerSrc(){if(td.workerSrc)return td.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Tt(this,"_setupFakeWorkerGlobal",(async()=>{if(fe(qu,this,Yu))return fe(qu,this,Yu);return(await import(this.workerSrc)).WorkerMessageHandler})())}}function zu(){me(Uu,this).resolve(),me(Bu,this).send("configure",{verbosity:this.verbosity})}function Gu(e){ge(Vu,this,e),ge(Bu,this,new qa("main","worker",e)),me(Bu,this).on("ready",()=>{}),pe(Hu,this,zu).call(this)}function Ku(){if(Xu._||Yu(Ne))return void pe(Hu,this,Ju).call(this);let{workerSrc:e}=Ne;try{Ne._isSameOrigin(window.location,e)||(e=Ne._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new qa("main","worker",t),s=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?me(Uu,this).reject(new Error("Worker was destroyed")):pe(Hu,this,Ju).call(this)},i=new AbortController;t.addEventListener("error",()=>{me(Wu,this)||s()},{signal:i.signal}),n.on("test",e=>{i.abort(),!this.destroyed&&e?(ge(Bu,this,n),ge(Vu,this,t),ge(Wu,this,t),pe(Hu,this,zu).call(this)):s()}),n.on("ready",e=>{if(i.abort(),this.destroyed)s();else try{r()}catch(t){pe(Hu,this,Ju).call(this)}});const r=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void r()}catch(t){xt("The worker has been disabled.")}pe(Hu,this,Ju).call(this)}function Ju(){Xu._||(Et("Setting up fake worker."),Xu._=!0),Ne._setupFakeWorkerGlobal.then(e=>{var t,n;if(this.destroyed)return void me(Uu,this).reject(new Error("Worker was destroyed"));const s=new Na;ge(Vu,this,s);const i="fake".concat(($u._=(t=$u._,n=t++,t),n)),r=new qa(i+"_worker",i,s);e.setup(r,s),ge(Bu,this,new qa(i,i+"_worker",s)),pe(Hu,this,zu).call(this)}).catch(e=>{me(Uu,this).reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))})}function Yu(e){try{var t;return(null===(t=globalThis.pdfjsWorker)||void 0===t?void 0:t.WorkerMessageHandler)||null}catch(n){return null}}Ne=qu;var $u={_:0},Xu={_:!1},Qu={_:new WeakMap};je&&(Xu._=pe(Ne,Ne,!0),td.workerSrc||(td.workerSrc="./pdf.worker.mjs")),Ne._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(null===n||void 0===n||!n.origin||"null"===n.origin)return!1;const s=new URL(t,n);return n.origin===s.origin},Ne._createCDNWrapper=e=>{const t='await import("'.concat(e,'");');return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ne.fromPort=e=>{var t;if(t="`PDFWorker.fromPort` - please use `PDFWorker.create` instead.",console.log("Deprecated API usage: "+t),null===e||void 0===e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ne.create(e)};var Zu=new WeakMap,eh=new WeakMap,th=new WeakMap,nh=new WeakMap,sh=new WeakMap,ih=new WeakSet;class rh{constructor(e,t,n,s,i,r){ue(this,ih),he(this,Zu,new Map),he(this,eh,new Map),he(this,th,new Map),he(this,nh,new Map),he(this,sh,null),this.messageHandler=e,this.loadingTask=t,this.commonObjs=new zd,this.fontLoader=new Uo({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=r,this.setupMessageHandler()}get annotationStorage(){return Tt(this,"annotationStorage",new Oo)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ke.ENABLE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=Be,o=To;switch(e){case"any":r=Ue;break;case"display":break;case"print":r=Ve;break;default:Et("getRenderingIntent - invalid intent: ".concat(e))}const a=r&Ve&&n instanceof Fo?n:this.annotationStorage;switch(t){case Ke.DISABLE:r+=qe;break;case Ke.ENABLE:break;case Ke.ENABLE_FORMS:r+=We;break;case Ke.ENABLE_STORAGE:r+=He,o=a.serializable;break;default:Et("getRenderingIntent - invalid annotationMode: ".concat(t))}s&&(r+=ze),i&&(r+=Ge);const{ids:l,hash:c}=a.modifiedIds;return{renderingIntent:r,cacheKey:[r,o.hash,c].join("_"),annotationStorageSerializable:o,modifiedIds:l}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null===(e=me(sh,this))||void 0===e||e.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of me(eh,this).values())t.push(s._destroy());me(eh,this).clear(),me(th,this).clear(),me(nh,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{var e,t;this.commonObjs.clear(),this.fontLoader.clear(),me(Zu,this).clear(),this.filterFactory.destroy(),hu.cleanup(),null===(e=this._networkStream)||void 0===e||e.cancelAllRequests(new Dt("Worker was terminated.")),null===(t=this.messageHandler)||void 0===t||t.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{At(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function(e){let{value:n,done:s}=e;s?t.close():(At(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",async e=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:s,contentLength:i}=this._fullReader;if(!n||!s){var r;if(this._lastProgress)null===(r=t.onProgress)||void 0===r||r.call(t,this._lastProgress);this._fullReader.onProgress=e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}}return{isStreamingSupported:n,isRangeSupported:s,contentLength:i}}),e.on("GetRangeReader",(e,t)=>{At(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function(e){let{value:n,done:s}=e;s?t.close():(At(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",e=>{let{pdfInfo:n}=e;this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Ou(n,this))}),e.on("DocException",e=>{t._capability.reject(Va(e))}),e.on("PasswordRequest",e=>{ge(sh,this,Promise.withResolvers());try{if(!t.onPassword)throw Va(e);const n=e=>{e instanceof Error?me(sh,this).reject(e):me(sh,this).resolve({password:e})};t.onPassword(n,e.code)}catch(n){me(sh,this).reject(n)}return me(sh,this).promise}),e.on("DataLoaded",e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{if(this.destroyed)return;me(eh,this).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",t=>{var n;let[s,i,r]=t;if(this.destroyed)return null;if(this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const e=r.error;Et("Error during font loading: ".concat(e)),this.commonObjs.resolve(s,e);break}const t=new ia(r),o=this._params.pdfBug&&null!==(n=globalThis.FontInspector)&&void 0!==n&&n.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,a=new Vo(t,o,r.extra,r.charProcOperatorList);this.fontLoader.bind(a).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!a.fontExtraProperties&&a.data&&a.clearData(),this.commonObjs.resolve(s,a)});break;case"CopyLocalImage":const{imageRef:l}=r;At(l,"The imageRef must be defined.");for(const e of me(eh,this).values())for(const[,t]of e.objs)if((null===t||void 0===t?void 0:t.ref)===l)return t.dataLen?(this.commonObjs.resolve(s,structuredClone(t)),t.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new Ea(r));break;case"Image":this.commonObjs.resolve(s,r);break;case"Pattern":const c=new pa(r);this.commonObjs.resolve(s,c.getIR());break;default:throw new Error("Got unknown common object type ".concat(i))}return null}),e.on("obj",e=>{let[t,n,s,i]=e;if(this.destroyed)return;const r=me(eh,this).get(n);var o;if(!r.objs.has(t))if(0!==r._intentStates.size)switch(s){case"Image":case"Pattern":r.objs.resolve(t,i);break;default:throw new Error("Got unknown object type ".concat(s))}else null===i||void 0===i||null===(o=i.bitmap)||void 0===o||o.close()}),e.on("DocProgress",e=>{var n;this.destroyed||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}),e.on("FetchBinaryData",async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");const t=this[e.type];if(!t)throw new Error("".concat(e.type," not initialized, see the `useWorkerFetch` parameter."));return t.fetch(e)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e,t;this.annotationStorage.size<=0&&Et("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfer:s}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:null!==(e=null===(t=this._fullReader)||void 0===t?void 0:t.filename)&&void 0!==e?e:null},s).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=me(th,this).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&me(nh,this).set(n.refStr,e);const s=new Fu(t,n,this,this._params.pdfBug);return me(eh,this).set(t,s),s});return me(th,this).set(t,s),s}getPageIndex(e){return Aa(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return pe(ih,this,oh).call(this,"GetFieldObjects")}hasJSActions(){return pe(ih,this,oh).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return pe(ih,this,oh).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return pe(ih,this,oh).call(this,"GetOptionalContentConfig").then(t=>new bd(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=me(Zu,this).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>{var t,n,s,i;return{info:e[0],metadata:e[1]?new od(e[1]):null,contentDispositionFilename:null!==(t=null===(n=this._fullReader)||void 0===n?void 0:n.filename)&&void 0!==t?t:null,contentLength:null!==(s=null===(i=this._fullReader)||void 0===i?void 0:i.contentLength)&&void 0!==s?s:null,hasStructTree:e[2]}});return me(Zu,this).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of me(eh,this).values()){if(!e.cleanup())throw new Error("startCleanup: Page ".concat(e.pageNumber," is currently rendering."))}this.commonObjs.clear(),e||this.fontLoader.clear(),me(Zu,this).clear(),this.filterFactory.destroy(!0),hu.cleanup()}}cachedPageNumber(e){var t;if(!Aa(e))return null;const n=0===e.gen?"".concat(e.num,"R"):"".concat(e.num,"R").concat(e.gen);return null!==(t=me(nh,this).get(n))&&void 0!==t?t:null}}function oh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=me(Zu,this).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return me(Zu,this).set(e,s),s}var ah=new WeakMap;class lh{constructor(e){he(this,ah,null),r(this,"onContinue",null),r(this,"onError",null),ge(ah,this,e)}get promise(){return me(ah,this).capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;me(ah,this).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=me(ah,this).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=me(ah,this);return e.form||e.canvas&&(null===t||void 0===t?void 0:t.size)>0}}var ch=new WeakMap;class dh{constructor(e){let{callback:t,params:n,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:h=null,enableHWA:p=!1,operationsFilter:f=null}=e;he(this,ch,null),this.callback=t,this.params=n,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new lh(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvas,this._canvasContext=n.canvas?null:n.canvasContext,this._enableHWA=p,this._dependencyTracker=n.dependencyTracker,this._operationsFilter=f}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(e){var t,n;let{transparency:s=!1,optionalContentConfig:i}=e;if(this.cancelled)return;if(this._canvas){if(uh._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");uh._.add(this._canvas)}this._pdfBug&&null!==(t=globalThis.StepperManager)&&void 0!==t&&t.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:o,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Xc(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:o,viewport:r,transparency:s,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}cancel(){var e,t,n;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(e=this.gfx)||void 0===e||e.endDrawing(),me(ch,this)&&(window.cancelAnimationFrame(me(ch,this)),ge(ch,this,null)),uh._.delete(this._canvas),s||(s=new tn("Rendering cancelled, page ".concat(this._pageIndex+1),i)),this.callback(s),null===(t=(n=this.task).onError)||void 0===t||t.call(n,s)}operatorListChanged(){var e,t;this.graphicsReady?(null===(e=this.gfx.dependencyTracker)||void 0===e||e.growOperationsCount(this.operatorList.fnArray.length),null===(t=this.stepper)||void 0===t||t.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?ge(ch,this,window.requestAnimationFrame(()=>{ge(ch,this,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),uh._.delete(this._canvas),this.callback())))}}var uh={_:new WeakSet};const hh="5.4.530";var ph=new WeakMap,fh=new WeakMap,mh=new WeakMap,gh=new WeakMap,vh=new WeakMap,bh=new WeakMap,yh=new WeakMap,_h=new WeakMap,wh=new WeakMap,xh=new WeakMap,Eh=new WeakSet;class Sh{static get _keyboardManager(){return Tt(this,"_keyboardManager",new ms([[["Escape","mac+Escape"],Sh.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Sh.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Sh.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Sh.prototype._moveToPrevious],[["Home","mac+Home"],Sh.prototype._moveToBeginning],[["End","mac+End"],Sh.prototype._moveToEnd]]))}constructor(e){var t,n;let{editor:s=null,uiManager:i=null}=e;ue(this,Eh),he(this,ph,null),he(this,fh,null),he(this,mh,void 0),he(this,gh,null),he(this,vh,!1),he(this,bh,!1),he(this,yh,null),he(this,_h,void 0),he(this,wh,null),he(this,xh,null),s?(ge(bh,this,!1),ge(yh,this,s)):ge(bh,this,!0),ge(xh,this,(null===s||void 0===s?void 0:s._uiManager)||i),ge(_h,this,me(xh,this)._eventBus),ge(mh,this,(null===s||void 0===s||null===(t=s.color)||void 0===t?void 0:t.toUpperCase())||(null===(n=me(xh,this))||void 0===n?void 0:n.highlightColors.values().next().value)||"#FFFF98"),Ph._||(Ph._=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}renderButton(){const e=ge(ph,this,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",me(yh,this)&&(e.ariaControls="".concat(me(yh,this).id,"_colorpicker_dropdown"));const t=me(xh,this)._signal;e.addEventListener("click",pe(Eh,this,Th).bind(this),{signal:t}),e.addEventListener("keydown",pe(Eh,this,kh).bind(this),{signal:t});const n=ge(fh,this,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=me(mh,this),e.append(n),e}renderMainDropdown(){const e=ge(gh,this,pe(Eh,this,Ah).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===me(ph,this))return void pe(Eh,this,Th).call(this,e);const t=e.target.getAttribute("data-color");t&&pe(Eh,this,Ch).call(this,t,e)}_moveToNext(e){var t,n;fe(Eh,this,Ih)?e.target!==me(ph,this)?null===(t=e.target.nextSibling)||void 0===t||t.focus():null===(n=me(gh,this).firstElementChild)||void 0===n||n.focus():pe(Eh,this,Th).call(this,e)}_moveToPrevious(e){var t,n;e.target!==(null===(t=me(gh,this))||void 0===t?void 0:t.firstElementChild)&&e.target!==me(ph,this)?(fe(Eh,this,Ih)||pe(Eh,this,Th).call(this,e),null===(n=e.target.previousSibling)||void 0===n||n.focus()):fe(Eh,this,Ih)&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){var t;fe(Eh,this,Ih)?null===(t=me(gh,this).firstElementChild)||void 0===t||t.focus():pe(Eh,this,Th).call(this,e)}_moveToEnd(e){var t;fe(Eh,this,Ih)?null===(t=me(gh,this).lastElementChild)||void 0===t||t.focus():pe(Eh,this,Th).call(this,e)}hideDropdown(){var e,t;null===(e=me(gh,this))||void 0===e||e.classList.add("hidden"),me(ph,this).ariaExpanded="false",null===(t=me(wh,this))||void 0===t||t.abort(),ge(wh,this,null)}_hideDropdownFromKeyboard(){var e;me(bh,this)||(fe(Eh,this,Ih)?(this.hideDropdown(),me(ph,this).focus({preventScroll:!0,focusVisible:me(vh,this)})):null===(e=me(yh,this))||void 0===e||e.unselect())}updateColor(e){if(me(fh,this)&&(me(fh,this).style.backgroundColor=e),!me(gh,this))return;const t=me(xh,this).highlightColors.values();for(const n of me(gh,this).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;null===(e=me(ph,this))||void 0===e||e.remove(),ge(ph,this,null),ge(fh,this,null),null===(t=me(gh,this))||void 0===t||t.remove(),ge(gh,this,null)}}function Ah(){const e=document.createElement("div"),t=me(xh,this)._signal;e.addEventListener("contextmenu",an,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),me(yh,this)&&(e.id="".concat(me(yh,this).id,"_colorpicker_dropdown"));for(const[n,s]of me(xh,this).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",s),i.title=n,i.setAttribute("data-l10n-id",Ph._[n]);const r=document.createElement("span");i.append(r),r.className="swatch",r.style.backgroundColor=s,i.ariaSelected=s===me(mh,this),i.addEventListener("click",pe(Eh,this,Ch).bind(this,s),{signal:t}),e.append(i)}return e.addEventListener("keydown",pe(Eh,this,kh).bind(this),{signal:t}),e}function Ch(e,t){t.stopPropagation(),me(_h,this).dispatch("switchannotationeditorparams",{source:this,type:$e.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}function kh(e){Ie._keyboardManager.exec(this,e)}function Th(e){if(fe(Eh,this,Ih))return void this.hideDropdown();if(ge(vh,this,0===e.detail),me(wh,this)||(ge(wh,this,new AbortController),window.addEventListener("pointerdown",pe(Eh,this,Nh).bind(this),{signal:me(xh,this).combinedSignal(me(wh,this))})),me(ph,this).ariaExpanded="true",me(gh,this))return void me(gh,this).classList.remove("hidden");const t=ge(gh,this,pe(Eh,this,Ah).call(this));me(ph,this).append(t)}function Nh(e){var t;null!==(t=me(gh,this))&&void 0!==t&&t.contains(e.target)||this.hideDropdown()}function Ih(e){return me(gh,e)&&!me(gh,e).classList.contains("hidden")}Ie=Sh;var Ph={_:null},Rh=new WeakMap,Mh=new WeakMap,Oh=new WeakMap;class Dh{constructor(e){he(this,Rh,null),he(this,Mh,null),he(this,Oh,null),ge(Mh,this,e),ge(Oh,this,e._uiManager),jh._||(jh._=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(me(Rh,this))return me(Rh,this);const{editorType:e,colorType:t,color:n}=me(Mh,this),s=ge(Rh,this,document.createElement("input"));return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",jh._[e]),s.addEventListener("input",()=>{me(Oh,this).updateParams(t,s.value)},{signal:me(Oh,this)._signal}),s}update(e){me(Rh,this)&&(me(Rh,this).value=e)}destroy(){var e;null===(e=me(Rh,this))||void 0===e||e.remove(),ge(Rh,this,null)}hideDropdown(){}}var jh={_:null};function Fh(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function Lh(e){return Math.max(0,Math.min(255,255*e))}class Uh{static CMYK_G(e){let[t,n,s,i]=e;return["G",1-Math.min(1,.3*t+.59*s+.11*n+i)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=Lh(t),[t,t,t]}static G_HTML(e){let[t]=e;const n=Fh(t);return"#".concat(n).concat(n).concat(n)}static RGB_G(e){let[t,n,s]=e;return["G",.3*t+.59*n+.11*s]}static RGB_rgb(e){return e.map(Lh)}static RGB_HTML(e){return"#".concat(e.map(Fh).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,n,s,i]=e;return["RGB",1-Math.min(1,t+i),1-Math.min(1,s+i),1-Math.min(1,n+i)]}static CMYK_rgb(e){let[t,n,s,i]=e;return[Lh(1-Math.min(1,t+i)),Lh(1-Math.min(1,s+i)),Lh(1-Math.min(1,n+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,n,s]=e;const i=1-t,r=1-n,o=1-s;return["CMYK",i,r,o,Math.min(i,r,o)]}}class Bh{create(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width","".concat(e,"px")),s.setAttribute("height","".concat(t,"px"))),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox","0 0 ".concat(e," ").concat(t)),s}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){St("Abstract method `_createSVG` called.")}}class Vh extends Bh{_createSVG(e){return document.createElementNS(Xt,e)}}const Wh=new WeakSet,Hh=60*(new Date).getTimezoneOffset()*1e3;class qh{static create(e){switch(e.data.annotationType){case ot.LINK:return new Zh(e);case ot.TEXT:return new sp(e);case ot.WIDGET:switch(e.data.fieldType){case"Tx":return new rp(e);case"Btn":return e.data.radioButton?new lp(e):e.data.checkBox?new ap(e):new cp(e);case"Ch":return new dp(e);case"Sig":return new op(e)}return new ip(e);case ot.POPUP:return new hp(e);case ot.FREETEXT:return new tf(e);case ot.LINE:return new sf(e);case ot.SQUARE:return new of(e);case ot.CIRCLE:return new lf(e);case ot.POLYLINE:return new df(e);case ot.CARET:return new hf(e);case ot.INK:return new gf(e);case ot.POLYGON:return new uf(e);case ot.HIGHLIGHT:return new bf(e);case ot.UNDERLINE:return new yf(e);case ot.SQUIGGLY:return new _f(e);case ot.STRIKEOUT:return new wf(e);case ot.STAMP:return new xf(e);case ot.FILEATTACHMENT:return new Af(e);default:return new Yh(e)}}}var zh=new WeakMap,Gh=new WeakMap,Kh=new WeakMap,Jh=new WeakSet;class Yh{constructor(e){let{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ue(this,Jh),he(this,zh,null),he(this,Gh,!1),he(this,Kh,null),this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData(e){let{contentsObj:t,richText:n}=e;return!!(null!==t&&void 0!==t&&t.str||null!==n&&void 0!==n&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Yh._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var e;const{data:t}=this,n=null===(e=this.annotationStorage)||void 0===e?void 0:e.getEditor(t.id);return n?n.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var e;const t=null===(e=this.annotationStorage)||void 0===e?void 0:e.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:n,inkLists:s,rect:i}=this.data;let r=-1/0,o=-1/0;if((null===n||void 0===n?void 0:n.length)>=8){for(let e=0;e<n.length;e+=8)n[e+1]>o?(o=n[e+1],r=n[e+2]):n[e+1]===o&&(r=Math.max(r,n[e+2]));return[r,o]}if((null===s||void 0===s?void 0:s.length)>=1){for(const e of s)for(let t=0,n=e.length;t<n;t+=2)e[t+1]>o?(o=e[t+1],r=e[t]):e[t+1]===o&&(r=Math.max(r,e[t]));if(r!==1/0)return[r,o]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:i,pageY:r}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/n,e[1]=100*(e[1]-r)/s,e}get commentText(){var e,t;const{data:n}=this;return(null===(e=this.annotationStorage.getRawValue("".concat(Je).concat(n.id)))||void 0===e||null===(e=e.popup)||void 0===e?void 0:e.contents)||(null===(t=n.contentsObj)||void 0===t?void 0:t.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue("".concat(Je).concat(t.id),{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;null===(e=(null===(t=me(Kh,this))||void 0===t?void 0:t.popup)||this.popup)||void 0===e||e.remove(),ge(Kh,this,this.popup=null)}updateEdited(e){var t;if(!this.container)return;e.rect&&(me(zh,this)||ge(zh,this,{rect:this.data.rect.slice(0)}));const{rect:n,popup:s}=e;n&&pe(Jh,this,$h).call(this,n);let i=(null===(t=me(Kh,this))||void 0===t?void 0:t.popup)||this.popup;!i&&null!==s&&void 0!==s&&s.text&&(this._createPopup(s),i=me(Kh,this).popup),i&&(i.updateEdited(e),null!==s&&void 0!==s&&s.deleted&&(i.remove(),ge(Kh,this,null),this.popup=null))}resetEdited(){var e;me(zh,this)&&(pe(Jh,this,$h).call(this,me(zh,this).rect),null===(e=me(Kh,this))||void 0===e||e.popup.resetEdited(),ge(zh,this,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof ip||this instanceof Zh||(i.tabIndex=0);const{style:r}=i;if(r.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof hp){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,i),i}const{width:o,height:a}=this;if(!e&&t.borderStyle.width>0){r.borderWidth="".concat(t.borderStyle.width,"px");const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t="calc(".concat(e,"px * var(--total-scale-factor)) / calc(").concat(n,"px * var(--total-scale-factor))");r.borderRadius=t}else if(this instanceof lp){const e="calc(".concat(o,"px * var(--total-scale-factor)) / calc(").concat(a,"px * var(--total-scale-factor))");r.borderRadius=e}switch(t.borderStyle.style){case at:r.borderStyle="solid";break;case lt:r.borderStyle="dashed";break;case ct:Et("Unimplemented border style: beveled");break;case dt:Et("Unimplemented border style: inset");break;case ut:r.borderBottomStyle="solid"}const s=t.borderColor||null;s?(ge(Gh,this,!0),r.borderColor=Bt.makeHexColor(0|s[0],0|s[1],0|s[2])):r.borderWidth=0}const l=Bt.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:d,pageX:u,pageY:h}=s.rawDims;r.left="".concat(100*(l[0]-u)/c,"%"),r.top="".concat(100*(l[1]-h)/d,"%");const{rotation:p}=t;return t.hasOwnCanvas||0===p?(r.width="".concat(100*o/c,"%"),r.height="".concat(100*a/d,"%")):this.setRotation(p,i),i}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:i,height:r}=this;e%180!==0&&([i,r]=[r,i]),t.style.width="".concat(100*i/n,"%"),t.style.height="".concat(100*r/s,"%"),t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const s=n.detail[e],i=s[0],r=s.slice(1);n.target.style[t]=Uh["".concat(i,"_HTML")](r),this.annotationStorage.setValue(this.data.id,{[t]:Uh["".concat(i,"_rgb")](r)})};return Tt(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail)){const i=e[s]||n[s];null===i||void 0===i||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,i]of Object.entries(t)){const r=n[s];if(r){r({detail:{[s]:i},target:e}),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,i]=this.data.rect.map(e=>Math.fround(e));if(8===e.length){const[r,o,a,l]=e.subarray(2,6);if(s===r&&i===o&&t===a&&n===l)return}const{style:r}=this.container;let o;if(me(Gh,this)){const{borderColor:e,borderWidth:t}=r;r.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(e,'" stroke-width="').concat(t,'">')],this.container.classList.add("hasBorder")}const a=s-t,l=i-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0),d.role="none";const u=c.createElement("defs");d.append(u);const h=c.createElement("clipPath"),p="clippath_".concat(this.data.id);h.setAttribute("id",p),h.setAttribute("clipPathUnits","objectBoundingBox"),u.append(h);for(let m=2,g=e.length;m<g;m+=8){var f;const n=e[m],s=e[m+1],r=e[m+2],d=e[m+3],u=c.createElement("rect"),p=(r-t)/a,g=(i-s)/l,v=(n-r)/a,b=(s-d)/l;u.setAttribute("x",p),u.setAttribute("y",g),u.setAttribute("width",v),u.setAttribute("height",b),h.append(u),null===(f=o)||void 0===f||f.push('<rect vector-effect="non-scaling-stroke" x="'.concat(p,'" y="').concat(g,'" width="').concat(v,'" height="').concat(b,'"/>'))}me(Gh,this)&&(o.push("</g></svg>')"),r.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath="url(#".concat(p,")")}_createPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate),ge(Kh,this,new hp({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:"popup_".concat(t.id),rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(me(Kh,this)||this.popup||this.data.popupRef)}get extraPopupElement(){return me(Kh,this)}render(){St("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:e,id:i,exportValues:r}of s){if(-1===e)continue;if(i===t)continue;const s="string"===typeof r?r:null,o=document.querySelector('[data-element-id="'.concat(i,'"]'));!o||Wh.has(o)?n.push({id:i,exportValue:s,domElement:o}):Et("_getElementsByName - element not allowed: ".concat(i))}return n}for(const s of document.getElementsByName(e)){const{exportValue:e}=s,i=s.getAttribute("data-element-id");i!==t&&(Wh.has(s)&&n.push({id:i,exportValue:e,domElement:s}))}return n}show(){var e;this.container&&(this.container.hidden=!1),null===(e=this.popup)||void 0===e||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),null===(e=this.popup)||void 0===e||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}function $h(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:r,pageX:o,pageY:a}}}}=this;null===n||void 0===n||n.splice(0,4,...e),t.left="".concat(100*(e[0]-o)/i,"%"),t.top="".concat(100*(r-e[3]+a)/r,"%"),0===s?(t.width="".concat(100*(e[2]-e[0])/i,"%"),t.height="".concat(100*(e[3]-e[1])/r,"%")):this.setRotation(s)}class Xh extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Qh=new WeakSet;class Zh extends Yh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!(null===t||void 0===t||!t.ignoreBorder),createQuadrilaterals:!0}),ue(this,Qh),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(pe(Qh,this,tp).call(this,n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(pe(Qh,this,np).call(this,n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=n,this.container.append(n)),this.container}_bindLink(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&pe(Qh,this,ep).call(this),n&&(e.title=n)}_bindNamedAction(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),pe(Qh,this,ep).call(this)}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const i=n.get(s);i&&(e[i]=()=>{var e;return null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1})}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),pe(Qh,this,ep).call(this)}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),pe(Qh,this,ep).call(this),!this._fieldObjects)return Et('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{null===n||void 0===n||n();const{fields:e,refs:s,include:i}=t,r=[];if(0!==e.length||0!==s.length){const t=new Set(s);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===i&&r.push(n)}else for(const t of Object.values(this._fieldObjects))r.push(...t);const o=this.annotationStorage,a=[];for(const t of r){const{id:e}=t;switch(a.push(e),t.type){case"text":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;o.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}default:continue}const n=document.querySelector('[data-element-id="'.concat(e,'"]'));n&&(Wh.has(n)?n.dispatchEvent(new Event("resetform")):Et("_bindResetFormAction - element not allowed: ".concat(e)))}var l;this.enableScripting&&(null===(l=this.linkService.eventBus)||void 0===l||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:a,name:"ResetForm"}}));return!1}}}function ep(){this.container.setAttribute("data-internal-link","")}function tp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>{var e;return null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(t.content,t.filename,s),!1},pe(Qh,this,ep).call(this)}function np(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),pe(Qh,this,ep).call(this)}class sp extends Yh{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class ip extends Yh{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&("CANVAS"===(null===(t=e.previousSibling)||void 0===t?void 0:t.nodeName)&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Lt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,i){n.includes("mouse")?e.addEventListener(n,e=>{var t;null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{var r;if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}i&&(null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(e)}}))})}_setEventListeners(e,t,n,s){for(const[a,l]of n){var i,r,o;if("Action"===l||null!==(i=this.data.actions)&&void 0!==i&&i[l])"Focus"!==l&&"Blur"!==l||t||(t={focused:!1}),this._setEventListener(e,t,a,l,s),"Focus"!==l||null!==(r=this.data.actions)&&void 0!==r&&r.Blur?"Blur"!==l||null!==(o=this.data.actions)&&void 0!==o&&o.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null)}}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":Bt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||9,i=e.style;let r;const o=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(Le*s))||1);r=Math.min(s,o(t/Le))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(s,o(e/Le))}i.fontSize="calc(".concat(r,"px * var(--total-scale-factor))"),i.color=Bt.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class rp extends ip{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,s){const i=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=n),i.setValue(r.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){var s;const r=e.getValue(t,{value:this.data.fieldValue});let o=r.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&o.length>a&&(o=o.slice(0,a));let l=r.formattedValue||(null===(s=this.data.textContent)||void 0===s?void 0:s.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=null!==l&&void 0!==l?l:o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",null!==l&&void 0!==l?l:o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Wh.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:u,timeStep:h}=this.data,p=!!u&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),a&&(n.maxLength=a),n.addEventListener("input",s=>{e.setValue(t,{value:s.target.value}),this.setPropertyOnSiblings(n,"value",s.target.value,"value"),c.formattedValue=null}),n.addEventListener("resetform",e=>{var t;const s=null!==(t=this.data.defaultFieldValue)&&void 0!==t?t:"";n.value=c.userValue=s,c.formattedValue=null});let f=e=>{const{formattedValue:t}=c;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var i;n.addEventListener("focus",e=>{var t;if(c.focused)return;const{target:n}=e;if(p&&(n.type=u,h&&(n.step=h)),c.userValue){const e=c.userValue;if(p)if("time"===u){const t=new Date(e),s=[t.getHours(),t.getMinutes(),t.getSeconds()];n.value=s.map(e=>e.toString().padStart(2,"0")).join(":")}else n.value=new Date(e-Hh).toISOString().split("date"===u?"T":".",1)[0];else n.value=e}c.lastCommittedValue=n.value,c.commitKey=1,null!==(t=this.data.actions)&&void 0!==t&&t.Focus||(c.focused=!0)}),n.addEventListener("updatefromsandbox",n=>{this.showElementAndHideCanvas(n.target);const s={value(n){var s;c.userValue=null!==(s=n.detail.value)&&void 0!==s?s:"",p||e.setValue(t,{value:c.userValue.toString()}),n.target.value=c.userValue},formattedValue(n){const{formattedValue:s}=n.detail;c.formattedValue=s,null!==s&&void 0!==s&&n.target!==document.activeElement&&(n.target.value=s);const i={formattedValue:s};p&&(i.value=s),e.setValue(t,i)},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{var s;const{charLimit:i}=n.detail,{target:r}=n;if(0===i)return void r.removeAttribute("maxLength");r.setAttribute("maxLength",i);let o=c.userValue;!o||o.length<=i||(o=o.slice(0,i),r.value=c.userValue=o,e.setValue(t,{value:o}),null===(s=this.linkService.eventBus)||void 0===s||s.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,willCommit:!0,commitKey:1,selStart:r.selectionStart,selEnd:r.selectionEnd}}))}};this._dispatchEventFromSandbox(s,n)}),n.addEventListener("keydown",e=>{var n;c.commitKey=1;let s=-1;if("Escape"===e.key?s=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(c.commitKey=3):s=2,-1===s)return;const{value:i}=e.target;c.lastCommittedValue!==i&&(c.lastCommittedValue=i,c.userValue=i,null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,willCommit:!0,commitKey:s,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const s=f;f=null,n.addEventListener("blur",e=>{var n;if(!c.focused||!e.relatedTarget)return;null!==(n=this.data.actions)&&void 0!==n&&n.Blur||(c.focused=!1);const{target:i}=e;let{value:r}=i;if(p){if(r&&"time"===u){const e=r.split(":").map(e=>parseInt(e,10));r=new Date(2e3,0,1,e[0],e[1],e[2]||0).valueOf(),i.step=""}else r.includes("T")||(r="".concat(r,"T00:00")),r=new Date(r).valueOf();i.type="text"}var o;(c.userValue=r,c.lastCommittedValue!==r)&&(null===(o=this.linkService.eventBus)||void 0===o||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:c.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}));s(e)}),null!==(i=this.data.actions)&&void 0!==i&&i.Keystroke&&n.addEventListener("beforeinput",e=>{var n;c.lastCommittedValue=null;const{data:s,target:i}=e,{value:r,selectionStart:o,selectionEnd:a}=i;let l=o,d=a;switch(e.inputType){case"deleteWordBackward":{const e=r.substring(0,o).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=r.substring(o).match(/^[^\w]*\w*/);e&&(d+=e[0].length);break}case"deleteContentBackward":o===a&&(l-=1);break;case"deleteContentForward":o===a&&(d+=1)}e.preventDefault(),null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,change:s||"",willCommit:!1,selStart:l,selEnd:d}})}),this._setEventListeners(n,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(f&&n.addEventListener("blur",f),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/a;n.classList.add("comb"),n.style.letterSpacing="calc(".concat(e,"px * var(--total-scale-factor) - 1ch)")}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class op extends ip{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ap extends ip{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"===typeof s&&(s="Off"!==s,e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return Wh.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",s=>{const{name:i,checked:r}=s.target;for(const o of this._getElementsByName(i,n)){const n=r&&o.exportValue===t.exportValue;o.domElement&&(o.domElement.checked=n),e.setValue(o.id,{value:n})}e.setValue(n,{value:r})}),i.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",t=>{const s={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(s,t)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class lp extends ip{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if("string"===typeof s&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const r of this._getElementsByName(t.fieldName,n))e.setValue(r.id,{value:!1});const i=document.createElement("input");if(Wh.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",t=>{const{name:s,checked:i}=t.target;for(const r of this._getElementsByName(s,n))e.setValue(r.id,{value:!1});e.setValue(n,{value:i})}),i.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!==n&&void 0!==n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const s=t.buttonValue;i.addEventListener("updatefromsandbox",t=>{const i={value:t=>{const i=s===t.detail.value;for(const s of this._getElementsByName(t.target.name)){const t=i&&s.id===n;s.domElement&&(s.domElement.checked=t),e.setValue(s.id,{value:t})}}};this._dispatchEventFromSandbox(i,t)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class cp extends Zh{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class dp extends ip{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Wh.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const n of s.options)n.selected=n.value===t});for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,n.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),i=!1),s.append(e)}let r=null;if(i){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),s.prepend(e),r=()=>{e.remove(),s.removeEventListener("input",r),r=null},s.addEventListener("input",r)}const o=e=>{const t=e?"value":"textContent",{options:n,multiple:i}=s;return i?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let a=o(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",n=>{const i={value(n){var i;null===(i=r)||void 0===i||i();const l=n.detail.value,c=new Set(Array.isArray(l)?l:[l]);for(const e of s.options)e.selected=c.has(e.value);e.setValue(t,{value:o(!0)}),a=o(!1)},multipleSelection(e){s.multiple=!0},remove(n){const i=s.options,r=n.detail.remove;if(i[r].selected=!1,s.remove(r),i.length>0){-1===Array.prototype.findIndex.call(i,e=>e.selected)&&(i[0].selected=!0)}e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},clear(n){for(;0!==s.length;)s.remove(0);e.setValue(t,{value:null,items:[]}),a=o(!1)},insert(n){const{index:i,displayValue:r,exportValue:c}=n.detail.insert,d=s.children[i],u=document.createElement("option");u.textContent=r,u.value=c,d?d.before(u):s.append(u),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},items(n){const{items:i}=n.detail;for(;0!==s.length;)s.remove(0);for(const e of i){const{displayValue:t,exportValue:n}=e,i=document.createElement("option");i.textContent=t,i.value=n,s.append(i)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},indices(n){const s=new Set(n.detail.indices);for(const e of n.target.options)e.selected=s.has(e.index);e.setValue(t,{value:o(!0)}),a=o(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(i,n)}),s.addEventListener("input",n=>{var s;const i=o(!0),r=o(!1);e.setValue(t,{value:i}),n.preventDefault(),null===(s=this.linkService.eventBus)||void 0===s||s.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,change:r,changeEx:i,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):s.addEventListener("input",function(n){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var up=new WeakSet;class hp extends Yh{constructor(e){const{data:t,elements:n,parent:s}=e,i=!!s._commentManager;if(super(e,{isRenderable:!i&&Yh._hasPopupData(t)}),ue(this,up),this.elements=n,i&&Yh._hasPopupData(t)){const e=this.popup=pe(up,this,pp).call(this);for(const t of n)t.popup=e}else this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=pe(up,this,pp).call(this),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(e=>"".concat(Gt).concat(e)).join(",")),this.container}}function pp(){return new Vp({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}var fp=new WeakMap,mp=new WeakMap,gp=new WeakMap,vp=new WeakMap,bp=new WeakMap,yp=new WeakMap,_p=new WeakMap,wp=new WeakMap,xp=new WeakMap,Ep=new WeakMap,Sp=new WeakMap,Ap=new WeakMap,Cp=new WeakMap,kp=new WeakMap,Tp=new WeakMap,Np=new WeakMap,Ip=new WeakMap,Pp=new WeakMap,Rp=new WeakMap,Mp=new WeakMap,Op=new WeakMap,Dp=new WeakMap,jp=new WeakMap,Fp=new WeakMap,Lp=new WeakMap,Up=new WeakMap,Bp=new WeakSet;class Vp{constructor(e){let{container:t,color:n,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:c,parentRect:d,open:u,commentManager:h=null}=e;ue(this,Bp),he(this,fp,null),he(this,mp,pe(Bp,this,$p).bind(this)),he(this,gp,pe(Bp,this,ef).bind(this)),he(this,vp,pe(Bp,this,Zp).bind(this)),he(this,bp,pe(Bp,this,Qp).bind(this)),he(this,yp,null),he(this,_p,null),he(this,wp,null),he(this,xp,null),he(this,Ep,null),he(this,Sp,null),he(this,Ap,null),he(this,Cp,!1),he(this,kp,null),he(this,Tp,null),he(this,Np,null),he(this,Ip,null),he(this,Pp,null),he(this,Rp,null),he(this,Mp,null),he(this,Op,null),he(this,Dp,null),he(this,jp,null),he(this,Fp,!1),he(this,Lp,null),he(this,Up,null),ge(_p,this,t),ge(Dp,this,i),ge(wp,this,o),ge(Op,this,a),ge(Sp,this,l),ge(yp,this,n),ge(Mp,this,c),ge(Ap,this,d),ge(Ep,this,s),ge(fp,this,h),ge(Lp,this,s[0]),ge(xp,this,cn.toDateObject(r)),this.trigger=s.flatMap(e=>e.getElementsToTriggerPopup()),h||(pe(Bp,this,Wp).call(this),me(_p,this).hidden=!0,u&&pe(Bp,this,Qp).call(this))}renderCommentButton(){if(me(Ip,this))return void(me(Ip,this).parentNode||me(Lp,this).container.after(me(Ip,this)));if(me(Pp,this)||pe(Bp,this,Hp).call(this),!me(Pp,this))return;const{signal:e}=ge(Tp,this,new AbortController),t=me(Lp,this).hasOwnCommentButton,n=()=>{me(fp,this).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{me(fp,this).toggleCommentPopup(this,!1,!0,!t)},i=()=>{me(fp,this).toggleCommentPopup(this,!1,!1)};if(t){ge(Ip,this,me(Lp,this).container);for(const t of this.trigger)t.ariaHasPopup="dialog",t.ariaControls="commentPopup",t.addEventListener("keydown",me(mp,this),{signal:e}),t.addEventListener("click",n,{signal:e}),t.addEventListener("pointerenter",s,{signal:e}),t.addEventListener("pointerleave",i,{signal:e}),t.classList.add("popupTriggerArea")}else{const t=ge(Ip,this,document.createElement("button"));t.className="annotationCommentButton";const r=me(Lp,this).container;t.style.zIndex=r.style.zIndex+1,t.tabIndex=0,t.ariaHasPopup="dialog",t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button"),pe(Bp,this,zp).call(this),pe(Bp,this,qp).call(this),t.addEventListener("keydown",me(mp,this),{signal:e}),t.addEventListener("click",n,{signal:e}),t.addEventListener("pointerenter",s,{signal:e}),t.addEventListener("pointerleave",i,{signal:e}),r.after(t)}}get commentButtonColor(){const{color:e,opacity:t}=me(Lp,this).commentData;return e?me(Sp,this)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;null===(e=me(Ip,this))||void 0===e||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:i}=me(Lp,this).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:i}}get elementBeforePopup(){return me(Ip,this)}get comment(){return me(Up,this)||ge(Up,this,me(Lp,this).commentText),me(Up,this)}set comment(e){e!==this.comment&&(me(Lp,this).commentText=ge(Up,this,e))}focus(){var e;null===(e=me(Lp,this).container)||void 0===e||e.focus()}get parentBoundingClientRect(){return me(Lp,this).layer.getBoundingClientRect()}setCommentButtonStates(e){let{selected:t,hasPopup:n}=e;me(Ip,this)&&(me(Ip,this).classList.toggle("selected",t),me(Ip,this).ariaExpanded=n)}setSelectedCommentButton(e){me(Ip,this).classList.toggle("selected",e)}get commentPopupPosition(){if(me(Rp,this))return me(Rp,this);const{x:e,y:t,height:n}=me(Ip,this).getBoundingClientRect(),{x:s,y:i,width:r,height:o}=me(Lp,this).layer.getBoundingClientRect();return[(e-s)/r,(t+n-i)/o]}set commentPopupPosition(e){ge(Rp,this,e)}hasDefaultPopupPosition(){return null===me(Rp,this)}get commentButtonPosition(){return me(Pp,this)}get commentButtonWidth(){return me(Ip,this).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=me(Rp,this)||this.commentButtonPosition.map(e=>e/100),s=this.parentBoundingClientRect,{x:i,y:r,width:o,height:l}=s;me(fp,this).showDialog(null,this,i+t*o,r+n*l,a(a({},e),{},{parentDimensions:s}))}render(){var e,t;if(me(kp,this))return;const n=ge(kp,this,document.createElement("div"));if(n.className="popup",me(yp,this)){const e=n.style.outlineColor=Bt.makeHexColor(...me(yp,this));n.style.backgroundColor="color-mix(in srgb, ".concat(e," 30%, white)")}const s=document.createElement("span");if(s.className="header",null!==(e=me(Dp,this))&&void 0!==e&&e.str){const e=document.createElement("span");e.className="title",s.append(e),({dir:e.dir,str:e.textContent}=me(Dp,this))}if(n.append(s),me(xp,this)){const e=document.createElement("time");e.className="popupDate",e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:me(xp,this).valueOf()})),e.dateTime=me(xp,this).toISOString(),s.append(e)}En({html:fe(Bp,this,Gp)||me(wp,this).str,dir:null===(t=me(wp,this))||void 0===t?void 0:t.dir,className:"popupContent"},n),me(_p,this).append(n)}updateEdited(e){var t;let{rect:n,popup:s,deleted:i}=e;if(me(fp,this))return i?(this.remove(),ge(Up,this,null)):s&&(s.deleted?this.remove():(pe(Bp,this,zp).call(this),ge(Up,this,s.text))),void(n&&(ge(Pp,this,null),pe(Bp,this,Hp).call(this),pe(Bp,this,qp).call(this)));i||null!==s&&void 0!==s&&s.deleted?this.remove():(pe(Bp,this,Wp).call(this),me(jp,this)||ge(jp,this,{contentsObj:me(wp,this),richText:me(Op,this)}),n&&ge(Np,this,null),s&&s.text&&(ge(Op,this,pe(Bp,this,Yp).call(this,s.text)),ge(xp,this,cn.toDateObject(s.date)),ge(wp,this,null)),null===(t=me(kp,this))||void 0===t||t.remove(),ge(kp,this,null))}resetEdited(){var e;me(jp,this)&&(({contentsObj:ce(ge,[wp,this])._,richText:ce(ge,[Op,this])._}=me(jp,this)),ge(jp,this,null),null===(e=me(kp,this))||void 0===e||e.remove(),ge(kp,this,null),ge(Np,this,null))}remove(){var e,t,n;if(null===(e=me(Tp,this))||void 0===e||e.abort(),ge(Tp,this,null),null===(t=me(kp,this))||void 0===t||t.remove(),ge(kp,this,null),ge(Fp,this,!1),ge(Cp,this,!1),null===(n=me(Ip,this))||void 0===n||n.remove(),ge(Ip,this,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){ge(Fp,this,this.isVisible),me(Fp,this)&&(me(_p,this).hidden=!0)}maybeShow(){me(fp,this)||(pe(Bp,this,Wp).call(this),me(Fp,this)&&(me(kp,this)||pe(Bp,this,Zp).call(this),ge(Fp,this,!1),me(_p,this).hidden=!1))}get isVisible(){return!me(fp,this)&&!1===me(_p,this).hidden}}function Wp(){if(me(Tp,this))return;ge(Tp,this,new AbortController);const{signal:e}=me(Tp,this);for(const n of this.trigger)n.addEventListener("click",me(bp,this),{signal:e}),n.addEventListener("pointerenter",me(vp,this),{signal:e}),n.addEventListener("pointerleave",me(gp,this),{signal:e}),n.classList.add("popupTriggerArea");for(const n of me(Ep,this)){var t;null===(t=n.container)||void 0===t||t.addEventListener("keydown",me(mp,this),{signal:e})}}function Hp(){const e=me(Ep,this).find(e=>e.hasCommentButton);e&&ge(Pp,this,e._normalizePoint(e.commentButtonPosition))}function qp(){if(me(Lp,this).extraPopupElement&&!me(Lp,this).editor)return;me(Ip,this)||this.renderCommentButton();const[e,t]=me(Pp,this),{style:n}=me(Ip,this);n.left="calc(".concat(e,"%)"),n.top="calc(".concat(t,"% - var(--comment-button-dim))")}function zp(){me(Lp,this).extraPopupElement||(me(Ip,this)||this.renderCommentButton(),me(Ip,this).style.backgroundColor=this.commentButtonColor||"")}function Gp(e){const t=me(Op,e),n=me(wp,e);return null===t||void 0===t||!t.str||null!==n&&void 0!==n&&n.str&&n.str!==t.str?null:me(Op,e).html||null}function Kp(e){var t;return(null===(t=fe(Bp,e,Gp))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.fontSize)||0}function Jp(e){var t;return(null===(t=fe(Bp,e,Gp))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.color)||null}function Yp(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:fe(Bp,this,Jp),fontSize:fe(Bp,this,Kp)?"calc(".concat(fe(Bp,this,Kp),"px * var(--total-scale-factor))"):""}};for(const i of e.split("\n"))t.push({name:"span",value:i,attributes:s});return n}function $p(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&me(Cp,this))&&pe(Bp,this,Qp).call(this)}function Xp(){if(null!==me(Np,this))return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:i}}}=me(Sp,this);let r=!!me(Ap,this),o=me(r?Ap:Mp,this);for(const h of me(Ep,this))if(!o||null!==Bt.intersect(h.data.rect,o)){o=h.data.rect,r=!0;break}const a=Bt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),l=r?o[2]-o[0]+5:0,c=a[0]+l,d=a[1];ge(Np,this,[100*(c-s)/t,100*(d-i)/n]);const{style:u}=me(_p,this);u.left="".concat(me(Np,this)[0],"%"),u.top="".concat(me(Np,this)[1],"%")}function Qp(){me(fp,this)?me(fp,this).toggleCommentPopup(this,!1):(ge(Cp,this,!me(Cp,this)),me(Cp,this)?(pe(Bp,this,Zp).call(this),me(_p,this).addEventListener("click",me(bp,this)),me(_p,this).addEventListener("keydown",me(mp,this))):(pe(Bp,this,ef).call(this),me(_p,this).removeEventListener("click",me(bp,this)),me(_p,this).removeEventListener("keydown",me(mp,this))))}function Zp(){me(kp,this)||this.render(),this.isVisible?me(Cp,this)&&me(_p,this).classList.add("focused"):(pe(Bp,this,Xp).call(this),me(_p,this).hidden=!1,me(_p,this).style.zIndex=parseInt(me(_p,this).style.zIndex)+1e3)}function ef(){me(_p,this).classList.remove("focused"),!me(Cp,this)&&this.isVisible&&(me(_p,this).hidden=!0,me(_p,this).style.zIndex=parseInt(me(_p,this).style.zIndex)-1e3)}class tf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ye.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var nf=new WeakMap;class sf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),he(this,nf,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),i=ge(nf,this,this.svgFactory.createElement("svg:line"));return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),s.append(i),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return me(nf,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var rf=new WeakMap;class of extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),he(this,rf,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,r=ge(rf,this,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",i/2),r.setAttribute("y",i/2),r.setAttribute("width",t-i),r.setAttribute("height",n-i),r.setAttribute("stroke-width",i||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return me(rf,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var af=new WeakMap;class lf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),he(this,af,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,r=ge(af,this,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",t/2),r.setAttribute("cy",n/2),r.setAttribute("rx",t/2-i/2),r.setAttribute("ry",n/2-i/2),r.setAttribute("stroke-width",i||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return me(af,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var cf=new WeakMap;class df extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),he(this,cf,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:i,height:r}=this;if(!t)return this.container;const o=this.svgFactory.create(i,r,!0);let a=[];for(let c=0,d=t.length;c<d;c+=2){const n=t[c]-e[0],s=e[3]-t[c+1];a.push("".concat(n,",").concat(s))}a=a.join(" ");const l=ge(cf,this,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",a),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return me(cf,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class uf extends df{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class hf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var pf=new WeakMap,ff=new WeakMap,mf=new WeakSet;class gf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),ue(this,mf),he(this,pf,null),he(this,ff,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?Ye.HIGHLIGHT:Ye.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:i}}=this,{transform:r,width:o,height:a}=pe(mf,this,vf).call(this,t,e),l=this.svgFactory.create(o,a,!0),c=ge(pf,this,this.svgFactory.createElement("svg:g"));l.append(c),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",r);for(let d=0,u=n.length;d<u;d++){const e=this.svgFactory.createElement(this.svgElementName);me(ff,this).push(e),e.setAttribute("points",n[d].join(",")),c.append(e)}return!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,i=me(pf,this);if(t>=0&&i.setAttribute("stroke-width",t||1),n)for(let r=0,o=me(ff,this).length;r<o;r++)me(ff,this)[r].setAttribute("points",n[r].join(","));if(s){const{transform:e,width:t,height:n}=pe(mf,this,vf).call(this,this.data.rotation,s);i.parentElement.setAttribute("viewBox","0 0 ".concat(t," ").concat(n)),i.setAttribute("transform",e)}}getElementsToTriggerPopup(){return me(ff,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function vf(e,t){switch(e){case 90:return{transform:"rotate(90) translate(".concat(-t[0],",").concat(t[1],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:"rotate(180) translate(".concat(-t[2],",").concat(t[1],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:"rotate(270) translate(".concat(-t[2],",").concat(t[3],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:"translate(".concat(-t[0],",").concat(t[3],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]}}}class bf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ye.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const t=document.createElement("mark");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class yf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class _f extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class wf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const t=document.createElement("s");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class xf extends Yh{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ye.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Ef=new WeakMap,Sf=new WeakSet;class Af extends Yh{constructor(e){var t;super(e,{isRenderable:!0}),ue(this,Sf),he(this,Ef,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("fileattachmentannotation",a({source:this},n))}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(t.name)?"paperclip":"pushpin",".svg"),t.fillAlpha&&t.fillAlpha<1&&(n.style="filter: opacity(".concat(Math.round(100*t.fillAlpha),"%);"))),n.addEventListener("dblclick",pe(Sf,this,Cf).bind(this)),ge(Ef,this,n);const{isMac:s}=Lt.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(s?e.metaKey:e.ctrlKey)&&pe(Sf,this,Cf).call(this)}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return me(Ef,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function Cf(){var e;null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(this.content,this.filename)}var kf=new WeakMap,Tf=new WeakMap,Nf=new WeakMap,If=new WeakMap,Pf=new WeakMap,Rf=new WeakMap,Mf=new WeakMap,Of=new WeakMap,Df=new WeakSet;class jf{constructor(e){let{div:t,accessibilityManager:n,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:a,commentManager:l,linkService:c,annotationStorage:d}=e;ue(this,Df),he(this,kf,null),he(this,Tf,null),he(this,Nf,null),he(this,If,new Map),he(this,Pf,null),he(this,Rf,null),he(this,Mf,[]),he(this,Of,!1),this.div=t,ge(kf,this,n),ge(Tf,this,s),ge(Pf,this,a||null),ge(Rf,this,c||null),ge(Nf,this,d||new Oo),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return me(If,this).size>0}async render(e){const{annotations:t}=e,n=this.div;fn(n,this.viewport);const s=new Map,i=[],r={data:null,layer:n,linkService:me(Rf,this),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new Vh,annotationStorage:me(Nf,this),enableComment:!0===e.enableComment,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const e=a.annotationType===ot.POPUP;if(e){const e=s.get(a.id);if(!e)continue;if(!this._commentManager){i.push(a);continue}r.elements=e}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const t=qh.create(r);if(!t.isRenderable)continue;if(!e&&(me(Mf,this).push(t),a.popupRef)){const e=s.get(a.popupRef);e?e.push(t):s.set(a.popupRef,[t])}const n=t.render();var o;if(a.hidden&&(n.style.visibility="hidden"),t._isEditable)me(If,this).set(t.data.id,t),null===(o=this._annotationEditorUIManager)||void 0===o||o.renderAnnotationElement(t)}await pe(Df,this,Ff).call(this);for(const a of i){const e=r.elements=s.get(a.id);r.data=a;const t=qh.create(r);if(!t.isRenderable)continue;const n=t.render();t.contentElement.id="".concat(Gt).concat(a.id),a.hidden&&(n.style.visibility="hidden"),e.at(-1).container.after(n)}pe(Df,this,Lf).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:me(Rf,this),svgFactory:new Vh,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=jf._defaultBorderStyle),t.data=n;const e=qh.create(t);e.isRenderable&&(e.render(),e.contentElement.id="".concat(Gt).concat(n.id),me(Mf,this).push(e))}await pe(Df,this,Ff).call(this)}update(e){let{viewport:t}=e;const n=this.div;this.viewport=t,fn(n,{rotation:t.rotation}),pe(Df,this,Lf).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(me(If,this).values())}getEditableAnnotation(e){return me(If,this).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:s}=e,i=new Xh({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:me(Rf,this),annotationStorage:me(Nf,this)});return i.render(),i.contentElement.id="".concat(Gt).concat(n),i.createOrUpdatePopup(),me(Mf,this).push(i),i}removeAnnotation(e){var t;const n=me(Mf,this).findIndex(t=>t.data.id===e);if(n<0)return;const[s]=me(Mf,this).splice(n,1);null===(t=me(kf,this))||void 0===t||t.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(e){if(0!==e.length){for(const t of e)t.updateFakeAnnotationElement(this);pe(Df,this,Ff).call(this)}}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Tt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:at,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}async function Ff(){if(0===me(Mf,this).length)return;this.div.replaceChildren();const e=[];if(!me(Of,this)){ge(Of,this,!0);for(const{contentElement:n,data:{id:s}}of me(Mf,this)){var t;const i=n.id="".concat(Gt).concat(s);e.push(null===(t=me(Pf,this))||void 0===t?void 0:t.getAriaAttributes(i).then(e=>{if(e)for(const[t,s]of e)n.setAttribute(t,s)}))}}me(Mf,this).sort((e,t)=>{let{data:{rect:[n,s,i,r]}}=e,{data:{rect:[o,a,l,c]}}=t;if(n===i&&s===r)return 1;if(o===l&&a===c)return-1;const d=(s+r)/2,u=(a+c)/2;if(d>=c&&u<=s)return-1;if(u>=r&&d<=a)return 1;return(n+i)/2-(o+l)/2});const n=document.createDocumentFragment();for(const r of me(Mf,this)){var s,i;if(n.append(r.container),this._commentManager)null===(s=(null===(i=r.extraPopupElement)||void 0===i?void 0:i.popup)||r.popup)||void 0===s||s.renderCommentButton();else r.extraPopupElement&&n.append(r.extraPopupElement.render())}if(this.div.append(n),await Promise.all(e),me(kf,this))for(const r of me(Mf,this))me(kf,this).addPointerInTextLayer(r.contentElement,!1)}function Lf(){if(!me(Tf,this))return;const e=this.div;for(const[n,s]of me(Tf,this)){const i=e.querySelector('[data-annotation-id="'.concat(n,'"]'));if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?"CANVAS"===r.nodeName?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s);const o=me(If,this).get(n);var t;if(o)if(o._hasNoCanvas)null===(t=this._annotationEditorUIManager)||void 0===t||t.setMissingCanvas(n,i.id,s),o._hasNoCanvas=!1;else o.canvas=s}me(Tf,this).clear()}const Uf=/\r\n?|\n/g;var Bf=new WeakMap,Vf=new WeakMap,Wf=new WeakMap,Hf=new WeakMap,qf=new WeakSet;class zf extends no{static get _keyboardManager(){const e=zf.prototype,t=e=>e.isEmpty(),n=fi.TRANSLATE_SMALL,s=fi.TRANSLATE_BIG;return Tt(this,"_keyboardManager",new ms([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}constructor(e){super(a(a({},e),{},{name:"freeTextEditor"})),ue(this,qf),he(this,Bf,""),he(this,Vf,"".concat(this.id,"-editor")),he(this,Wf,null),he(this,Hf,void 0),r(this,"_colorPicker",null),this.color=e.color||zf._defaultColor||no._defaultLineColor,ge(Hf,this,e.fontSize||zf._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){no.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case $e.FREETEXT_SIZE:zf._defaultFontSize=t;break;case $e.FREETEXT_COLOR:zf._defaultColor=t}}updateParams(e,t){switch(e){case $e.FREETEXT_SIZE:pe(qf,this,Gf).call(this,t);break;case $e.FREETEXT_COLOR:pe(qf,this,Kf).call(this,t)}}static get defaultPropertiesToUpdate(){return[[$e.FREETEXT_SIZE,zf._defaultFontSize],[$e.FREETEXT_COLOR,zf._defaultColor||no._defaultLineColor]]}get propertiesToUpdate(){return[[$e.FREETEXT_SIZE,me(Hf,this)],[$e.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Dh(this)),[["colorPicker",this._colorPicker]]}get colorType(){return $e.FREETEXT_COLOR}onUpdatedColor(){var e;this.editorDiv.style.color=this.color,null===(e=this._colorPicker)||void 0===e||e.update(this.color),super.onUpdatedColor()}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-zf._internalPadding*e,-(zf._internalPadding+me(Hf,this))*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),ge(Wf,this,new AbortController);const e=this._uiManager.combinedSignal(me(Wf,this));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",me(Vf,this)),this._isDraggable=!0,null===(e=me(Wf,this))||void 0===e||e.abort(),ge(Wf,this,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var t;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),null!==(t=this._initialOptions)&&void 0!==t&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=me(Bf,this),t=ge(Bf,this,pe(qf,this,Jf).call(this).trimEnd());if(e===t)return;const n=e=>{ge(Bf,this,e),e?(pe(qf,this,Xf).call(this),this._uiManager.rebuild(this),pe(qf,this,Yf).call(this)):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),pe(qf,this,Yf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){zf._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",me(Vf,this)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize="calc(".concat(me(Hf,this),"px * var(--total-scale-factor))"),n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,s]=this.parentDimensions;if(this.annotationElementId){const{position:i}=this._initialData;let[r,o]=this.getInitialTranslation();[r,o]=this.pageTranslationToScreen(r,o);const[a,l]=this.pageDimensions,[c,d]=this.pageTranslation;let u,h;switch(this.rotation){case 0:u=e+(i[0]-c)/a,h=t+this.height-(i[1]-d)/l;break;case 90:u=e+(i[0]-c)/a,h=t-(i[1]-d)/l,[r,o]=[o,-r];break;case 180:u=e-this.width+(i[0]-c)/a,h=t-(i[1]-d)/l,[r,o]=[-r,-o];break;case 270:u=e+(i[0]-c-this.height*l)/a,h=t+(i[1]-d-this.width*a)/l,[r,o]=[-o,r]}this.setAt(u*n,h*s,r,o)}else this._moveAfterPaste(e,t);pe(qf,this,Xf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(1===n.length&&"text/plain"===n[0])return;e.preventDefault();const s=Zf.call(zf,t.getData("text")||"").replaceAll(Uf,"\n");if(!s)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const r=i.getRangeAt(0);if(!s.includes("\n"))return r.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),void i.collapseToStart();const{startContainer:o,startOffset:a}=r,l=[],c=[];if(o.nodeType===Node.TEXT_NODE){const e=o.parentElement;if(c.push(o.nodeValue.slice(a).replaceAll(Uf,"")),e!==this.editorDiv){let t=l;for(const n of this.editorDiv.childNodes)n!==e?t.push($f.call(zf,n)):t=c}l.push(o.nodeValue.slice(0,a).replaceAll(Uf,""))}else if(o===this.editorDiv){let e=l,t=0;for(const n of this.editorDiv.childNodes)t++===a&&(e=c),e.push($f.call(zf,n))}ge(Bf,this,"".concat(l.join("\n")).concat(s).concat(c.join("\n"))),pe(qf,this,Xf).call(this);const d=new Range;let u=Math.sumPrecise(l.map(e=>e.length));for(const{firstChild:h}of this.editorDiv.childNodes)if(h.nodeType===Node.TEXT_NODE){const e=h.nodeValue.length;if(u<=e){d.setStart(h,u),d.setEnd(h,u);break}u-=e}i.removeAllRanges(),i.addRange(d)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=zf._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let s=null;if(e instanceof tf){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:i,rotation:r,id:o,popupRef:a,richText:l,contentsObj:c,creationDate:d,modificationDate:u},textContent:h,textPosition:p,parent:{page:{pageNumber:f}}}=e;if(!h||0===h.length)return null;s=e={annotationType:Ye.FREETEXT,color:Array.from(n),fontSize:t,value:h.join("\n"),position:p,pageIndex:f-1,rect:i.slice(0),rotation:r,annotationElementId:o,id:o,deleted:!1,popupRef:a,comment:(null===c||void 0===c?void 0:c.str)||null,richText:l,creationDate:d,modificationDate:u}}const i=await super.deserialize(e,t,n);return ge(Hf,i,e.fontSize),i.color=Bt.makeHexColor(...e.color),ge(Bf,i,Zf.call(zf,e.value)),i._initialData=s,e.comment&&i.setCommentData(e),i}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=no._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:me(Hf,this),value:pe(qf,this,Qf).call(this)});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!pe(qf,this,em).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize="calc(".concat(me(Hf,this),"px * var(--total-scale-factor))"),n.color=this.color,t.replaceChildren();for(const s of me(Bf,this).split("\n")){const e=document.createElement("div");e.append(s?document.createTextNode(s):document.createElement("br")),t.append(e)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:me(Bf,this)}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}function Gf(e){const t=e=>{this.editorDiv.style.fontSize="calc(".concat(e,"px * var(--total-scale-factor))"),this.translate(0,-(e-me(Hf,this))*this.parentScale),ge(Hf,this,e),pe(qf,this,Yf).call(this)},n=me(Hf,this);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$e.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function Kf(e){const t=e=>{this.color=e,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$e.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function Jf(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes){var n;(null===(n=t)||void 0===n?void 0:n.nodeType)===Node.TEXT_NODE&&"BR"===s.nodeName||(e.push($f.call(Pe,s)),t=s)}return e.join("\n")}function Yf(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,s=t.style.display,i=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=s,t.classList.toggle("hidden",i)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}function $f(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Uf,"")}function Xf(){if(this.editorDiv.replaceChildren(),me(Bf,this))for(const e of me(Bf,this).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}function Qf(){return me(Bf,this).replaceAll("\xa0"," ")}function Zf(e){return e.replaceAll(" ","\xa0")}function em(e){const{value:t,fontSize:n,color:s,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((e,t)=>e!==s[t])||e.pageIndex!==i}Pe=zf,r(zf,"_freeTextDefaultContent",""),r(zf,"_internalPadding",0),r(zf,"_defaultColor",null),r(zf,"_defaultFontSize",10),r(zf,"_type","freetext"),r(zf,"_editorType",Ye.FREETEXT);class tm{toSVGPath(){St("Abstract method `toSVGPath` must be implemented.")}get box(){St("Abstract getter `box` must be implemented.")}serialize(e,t){St("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,i,r){r||(r=new Float32Array(e.length));for(let o=0,a=e.length;o<a;o+=2)r[o]=t+e[o]*s,r[o+1]=n+e[o+1]*i;return r}static _rescaleAndSwap(e,t,n,s,i,r){r||(r=new Float32Array(e.length));for(let o=0,a=e.length;o<a;o+=2)r[o]=t+e[o+1]*s,r[o+1]=n+e[o]*i;return r}static _translate(e,t,n,s){s||(s=new Float32Array(e.length));for(let i=0,r=e.length;i<r;i+=2)s[i]=t+e[i],s[i+1]=n+e[i+1];return s}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,n,s,i){switch(i){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,i,r){return[(e+5*n)/6,(t+5*s)/6,(5*n+i)/6,(5*s+r)/6,(n+i)/2,(s+r)/2]}}r(tm,"PRECISION",1e-4);var nm=new WeakMap,sm=new WeakMap,im=new WeakMap,rm=new WeakMap,om=new WeakMap,am=new WeakMap,lm=new WeakMap,cm=new WeakMap,dm=new WeakMap,um=new WeakMap,hm=new WeakMap,pm=new WeakMap,fm=new WeakMap,mm=new WeakSet;class gm{constructor(e,t,n,s,i){let{x:r,y:o}=e,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;ue(this,mm),he(this,nm,void 0),he(this,sm,[]),he(this,im,void 0),he(this,rm,void 0),he(this,om,[]),he(this,am,new Float32Array(18)),he(this,lm,void 0),he(this,cm,void 0),he(this,dm,void 0),he(this,um,void 0),he(this,hm,void 0),he(this,pm,void 0),he(this,fm,[]),ge(nm,this,t),ge(pm,this,s*n),ge(rm,this,i),me(am,this).set([NaN,NaN,NaN,NaN,r,o],6),ge(im,this,a),ge(um,this,Sm._*n),ge(dm,this,Am._*n),ge(hm,this,n),me(fm,this).push(r,o)}isEmpty(){return isNaN(me(am,this)[8])}add(e){var t;let{x:n,y:s}=e;ge(lm,this,n),ge(cm,this,s);const[i,r,o,a]=me(nm,this);let[l,c,d,u]=me(am,this).subarray(8,12);const h=n-d,p=s-u,f=Math.hypot(h,p);if(f<me(dm,this))return!1;const m=f-me(um,this),g=m/f,v=g*h,b=g*p;let y=l,_=c;l=d,c=u,d+=v,u+=b,null===(t=me(fm,this))||void 0===t||t.push(n,s);const w=v/m,x=-b/m*me(pm,this),E=w*me(pm,this);if(me(am,this).set(me(am,this).subarray(2,8),0),me(am,this).set([d+x,u+E],4),me(am,this).set(me(am,this).subarray(14,18),12),me(am,this).set([d-x,u-E],16),isNaN(me(am,this)[6]))return 0===me(om,this).length&&(me(am,this).set([l+x,c+E],2),me(om,this).push(NaN,NaN,NaN,NaN,(l+x-i)/o,(c+E-r)/a),me(am,this).set([l-x,c-E],14),me(sm,this).push(NaN,NaN,NaN,NaN,(l-x-i)/o,(c-E-r)/a)),me(am,this).set([y,_,l,c,d,u],6),!this.isEmpty();me(am,this).set([y,_,l,c,d,u],6);return Math.abs(Math.atan2(_-c,y-l)-Math.atan2(b,v))<Math.PI/2?([l,c,d,u]=me(am,this).subarray(2,6),me(om,this).push(NaN,NaN,NaN,NaN,((l+d)/2-i)/o,((c+u)/2-r)/a),[l,c,y,_]=me(am,this).subarray(14,18),me(sm,this).push(NaN,NaN,NaN,NaN,((y+l)/2-i)/o,((_+c)/2-r)/a),!0):([y,_,l,c,d,u]=me(am,this).subarray(0,6),me(om,this).push(((y+5*l)/6-i)/o,((_+5*c)/6-r)/a,((5*l+d)/6-i)/o,((5*c+u)/6-r)/a,((l+d)/2-i)/o,((c+u)/2-r)/a),[d,u,l,c,y,_]=me(am,this).subarray(12,18),me(sm,this).push(((y+5*l)/6-i)/o,((_+5*c)/6-r)/a,((5*l+d)/6-i)/o,((5*c+u)/6-r)/a,((l+d)/2-i)/o,((c+u)/2-r)/a),!0)}toSVGPath(){if(this.isEmpty())return"";const e=me(om,this),t=me(sm,this);if(isNaN(me(am,this)[6])&&!this.isEmpty())return pe(mm,this,bm).call(this);const n=[];n.push("M".concat(e[4]," ").concat(e[5]));for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push("L".concat(e[s+4]," ").concat(e[s+5])):n.push("C".concat(e[s]," ").concat(e[s+1]," ").concat(e[s+2]," ").concat(e[s+3]," ").concat(e[s+4]," ").concat(e[s+5]));pe(mm,this,_m).call(this,n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push("L".concat(t[s+4]," ").concat(t[s+5])):n.push("C".concat(t[s]," ").concat(t[s+1]," ").concat(t[s+2]," ").concat(t[s+3]," ").concat(t[s+4]," ").concat(t[s+5]));return pe(mm,this,ym).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,s,i,r){return new Om(e,t,n,s,i,r)}getOutlines(){var e,t;const n=me(om,this),s=me(sm,this),i=me(am,this),[r,o,a,l]=me(nm,this),c=new Float32Array((null!==(e=null===(t=me(fm,this))||void 0===t?void 0:t.length)&&void 0!==e?e:0)+2);for(let h=0,p=c.length-2;h<p;h+=2)c[h]=(me(fm,this)[h]-r)/a,c[h+1]=(me(fm,this)[h+1]-o)/l;if(c[c.length-2]=(me(lm,this)-r)/a,c[c.length-1]=(me(cm,this)-o)/l,isNaN(i[6])&&!this.isEmpty())return pe(mm,this,wm).call(this,c);const d=new Float32Array(me(om,this).length+24+me(sm,this).length);let u=n.length;for(let h=0;h<u;h+=2)isNaN(n[h])?d[h]=d[h+1]=NaN:(d[h]=n[h],d[h+1]=n[h+1]);u=pe(mm,this,Em).call(this,d,u);for(let h=s.length-6;h>=6;h-=6)for(let e=0;e<6;e+=2)isNaN(s[h+e])?(d[u]=d[u+1]=NaN,u+=2):(d[u]=s[h+e],d[u+1]=s[h+e+1],u+=2);return pe(mm,this,xm).call(this,d,u),this.newFreeDrawOutline(d,c,me(nm,this),me(hm,this),me(im,this),me(rm,this))}}function vm(){const e=me(am,this).subarray(4,6),t=me(am,this).subarray(16,18),[n,s,i,r]=me(nm,this);return[(me(lm,this)+(e[0]-t[0])/2-n)/i,(me(cm,this)+(e[1]-t[1])/2-s)/r,(me(lm,this)+(t[0]-e[0])/2-n)/i,(me(cm,this)+(t[1]-e[1])/2-s)/r]}function bm(){const[e,t,n,s]=me(nm,this),[i,r,o,a]=pe(mm,this,vm).call(this);return"M".concat((me(am,this)[2]-e)/n," ").concat((me(am,this)[3]-t)/s," L").concat((me(am,this)[4]-e)/n," ").concat((me(am,this)[5]-t)/s," L").concat(i," ").concat(r," L").concat(o," ").concat(a," L").concat((me(am,this)[16]-e)/n," ").concat((me(am,this)[17]-t)/s," L").concat((me(am,this)[14]-e)/n," ").concat((me(am,this)[15]-t)/s," Z")}function ym(e){const t=me(sm,this);e.push("L".concat(t[4]," ").concat(t[5]," Z"))}function _m(e){const[t,n,s,i]=me(nm,this),r=me(am,this).subarray(4,6),o=me(am,this).subarray(16,18),[a,l,c,d]=pe(mm,this,vm).call(this);e.push("L".concat((r[0]-t)/s," ").concat((r[1]-n)/i," L").concat(a," ").concat(l," L").concat(c," ").concat(d," L").concat((o[0]-t)/s," ").concat((o[1]-n)/i))}function wm(e){const t=me(am,this),[n,s,i,r]=me(nm,this),[o,a,l,c]=pe(mm,this,vm).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-s)/r,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-s)/r,NaN,NaN,NaN,NaN,o,a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-s)/r,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-s)/r],0),this.newFreeDrawOutline(d,e,me(nm,this),me(hm,this),me(im,this),me(rm,this))}function xm(e,t){const n=me(sm,this);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+6}function Em(e,t){const n=me(am,this).subarray(4,6),s=me(am,this).subarray(16,18),[i,r,o,a]=me(nm,this),[l,c,d,u]=pe(mm,this,vm).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-r)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,(s[0]-i)/o,(s[1]-r)/a],t),t+24}var Sm={_:8},Am={_:Sm._+2},Cm=new WeakMap,km=new WeakMap,Tm=new WeakMap,Nm=new WeakMap,Im=new WeakMap,Pm=new WeakMap,Rm=new WeakMap,Mm=new WeakSet;class Om extends tm{constructor(e,t,n,s,i,r){super(),ue(this,Mm),he(this,Cm,void 0),he(this,km,new Float32Array(4)),he(this,Tm,void 0),he(this,Nm,void 0),he(this,Im,void 0),he(this,Pm,void 0),he(this,Rm,void 0),ge(Rm,this,e),ge(Im,this,t),ge(Cm,this,n),ge(Pm,this,s),ge(Tm,this,i),ge(Nm,this,r),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],pe(Mm,this,Dm).call(this,r);const[o,a,l,c]=me(km,this);for(let d=0,u=e.length;d<u;d+=2)e[d]=(e[d]-o)/l,e[d+1]=(e[d+1]-a)/c;for(let d=0,u=t.length;d<u;d+=2)t[d]=(t[d]-o)/l,t[d+1]=(t[d+1]-a)/c}toSVGPath(){const e=["M".concat(me(Rm,this)[4]," ").concat(me(Rm,this)[5])];for(let t=6,n=me(Rm,this).length;t<n;t+=6)isNaN(me(Rm,this)[t])?e.push("L".concat(me(Rm,this)[t+4]," ").concat(me(Rm,this)[t+5])):e.push("C".concat(me(Rm,this)[t]," ").concat(me(Rm,this)[t+1]," ").concat(me(Rm,this)[t+2]," ").concat(me(Rm,this)[t+3]," ").concat(me(Rm,this)[t+4]," ").concat(me(Rm,this)[t+5]));return e.push("Z"),e.join(" ")}serialize(e,t){let[n,s,i,r]=e;const o=i-n,a=r-s;let l,c;switch(t){case 0:l=tm._rescale(me(Rm,this),n,r,o,-a),c=tm._rescale(me(Im,this),n,r,o,-a);break;case 90:l=tm._rescaleAndSwap(me(Rm,this),n,s,o,a),c=tm._rescaleAndSwap(me(Im,this),n,s,o,a);break;case 180:l=tm._rescale(me(Rm,this),i,s,-o,a),c=tm._rescale(me(Im,this),i,s,-o,a);break;case 270:l=tm._rescaleAndSwap(me(Rm,this),i,r,-o,-a),c=tm._rescaleAndSwap(me(Im,this),i,r,-o,-a)}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return me(km,this)}newOutliner(e,t,n,s,i){return new gm(e,t,n,s,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(e,t){const[n,s,i,r]=me(km,this),[o,a,l,c]=me(Cm,this),d=i*l,u=r*c,h=n*l+o,p=s*c+a,f=this.newOutliner({x:me(Im,this)[0]*d+h,y:me(Im,this)[1]*u+p},me(Cm,this),me(Pm,this),e,me(Nm,this),null!==t&&void 0!==t?t:me(Tm,this));for(let m=2;m<me(Im,this).length;m+=2)f.add({x:me(Im,this)[m]*d+h,y:me(Im,this)[m+1]*u+p});return f.getOutlines()}}function Dm(e){const t=me(Rm,this);let n=t[4],s=t[5];const i=[n,s,n,s];let r=n,o=s,a=n,l=s;const c=e?Math.max:Math.min,d=new Float32Array(4);for(let h=6,p=t.length;h<p;h+=6){const e=t[h+4],u=t[h+5];isNaN(t[h])?(Bt.pointBoundingBox(e,u,i),o>u?(r=e,o=u):o===u&&(r=c(r,e)),l<u?(a=e,l=u):l===u&&(a=c(a,e))):(d[0]=d[1]=1/0,d[2]=d[3]=-1/0,Bt.bezierBoundingBox(n,s,...t.slice(h,h+6),d),Bt.rectBoundingBox(d[0],d[1],d[2],d[3],i),o>d[1]?(r=d[0],o=d[1]):o===d[1]&&(r=c(r,d[0])),l<d[3]?(a=d[2],l=d[3]):l===d[3]&&(a=c(a,d[2]))),n=e,s=u}const u=me(km,this);u[0]=i[0]-me(Tm,this),u[1]=i[1]-me(Tm,this),u[2]=i[2]-i[0]+2*me(Tm,this),u[3]=i[3]-i[1]+2*me(Tm,this),this.firstPoint=[r,o],this.lastPoint=[a,l]}var jm=new WeakMap,Fm=new WeakMap,Lm=new WeakMap,Um=new WeakMap,Bm=new WeakMap,Vm=new WeakSet;class Wm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];ue(this,Vm),he(this,jm,void 0),he(this,Fm,void 0),he(this,Lm,void 0),he(this,Um,[]),he(this,Bm,[]);const i=[1/0,1/0,-1/0,-1/0],r=1e-4;for(const{x:f,y:m,width:g,height:v}of e){const e=Math.floor((f-t)/r)*r,n=Math.ceil((f+g+t)/r)*r,s=Math.floor((m-t)/r)*r,o=Math.ceil((m+v+t)/r)*r,a=[e,s,o,!0],l=[n,s,o,!1];me(Um,this).push(a,l),Bt.rectBoundingBox(e,s,n,o,i)}const o=i[2]-i[0]+2*n,a=i[3]-i[1]+2*n,l=i[0]-n,c=i[1]-n;let d=s?-1/0:1/0,u=1/0;const h=me(Um,this).at(s?-1:-2),p=[h[0],h[2]];for(const f of me(Um,this)){const[e,t,n,i]=f;!i&&s?t<u?(u=t,d=e):t===u&&(d=Math.max(d,e)):i&&!s&&(t<u?(u=t,d=e):t===u&&(d=Math.min(d,e))),f[0]=(e-l)/o,f[1]=(t-c)/a,f[2]=(n-c)/a}ge(jm,this,new Float32Array([l,c,o,a])),ge(Fm,this,[d,u]),ge(Lm,this,p)}getOutlines(){me(Um,this).sort((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]);const e=[];for(const t of me(Um,this))t[3]?(e.push(...pe(Vm,this,Km).call(this,t)),pe(Vm,this,zm).call(this,t)):(pe(Vm,this,Gm).call(this,t),e.push(...pe(Vm,this,Km).call(this,t)));return pe(Vm,this,Hm).call(this,e)}}function Hm(e){const t=[],n=new Set;for(const r of e){const[e,n,s]=r;t.push([e,n,r],[e,s,r])}t.sort((e,t)=>e[1]-t[1]||e[0]-t[0]);for(let r=0,o=t.length;r<o;r+=2){const e=t[r][2],s=t[r+1][2];e.push(s),s.push(e),n.add(e),n.add(s)}const s=[];let i;for(;n.size>0;){const e=n.values().next().value;let[t,r,o,a,l]=e;n.delete(e);let c=t,d=r;for(i=[t,o],s.push(i);;){let e;if(n.has(a))e=a;else{if(!n.has(l))break;e=l}n.delete(e),[t,r,o,a,l]=e,c!==t&&(i.push(c,d,t,d===r?r:o),c=t),d=d===r?o:r}i.push(c,d)}return new $m(s,me(jm,this),me(Fm,this),me(Lm,this))}function qm(e){const t=me(Bm,this);let n=0,s=t.length-1;for(;n<=s;){const i=n+s>>1,r=t[i][0];if(r===e)return i;r<e?n=i+1:s=i-1}return s+1}function zm(e){let[,t,n]=e;const s=pe(Vm,this,qm).call(this,t);me(Bm,this).splice(s,0,[t,n])}function Gm(e){let[,t,n]=e;const s=pe(Vm,this,qm).call(this,t);for(let i=s;i<me(Bm,this).length;i++){const[e,s]=me(Bm,this)[i];if(e!==t)break;if(e===t&&s===n)return void me(Bm,this).splice(i,1)}for(let i=s-1;i>=0;i--){const[e,s]=me(Bm,this)[i];if(e!==t)break;if(e===t&&s===n)return void me(Bm,this).splice(i,1)}}function Km(e){const[t,n,s]=e,i=[[t,n,s]],r=pe(Vm,this,qm).call(this,s);for(let o=0;o<r;o++){const[e,n]=me(Bm,this)[o];for(let s=0,r=i.length;s<r;s++){const[,o,a]=i[s];if(!(n<=o||a<=e))if(o>=e)if(a>n)i[s][1]=n;else{if(1===r)return[];i.splice(s,1),s--,r--}else i[s][2]=e,a>n&&i.push([t,n,a])}}return i}var Jm=new WeakMap,Ym=new WeakMap;class $m extends tm{constructor(e,t,n,s){super(),he(this,Jm,void 0),he(this,Ym,void 0),ge(Ym,this,e),ge(Jm,this,t),this.firstPoint=n,this.lastPoint=s}toSVGPath(){const e=[];for(const t of me(Ym,this)){let[n,s]=t;e.push("M".concat(n," ").concat(s));for(let i=2;i<t.length;i+=2){const r=t[i],o=t[i+1];r===n?(e.push("V".concat(o)),s=o):o===s&&(e.push("H".concat(r)),n=r)}e.push("Z")}return e.join(" ")}serialize(e,t){let[n,s,i,r]=e;const o=[],a=i-n,l=r-s;for(const c of me(Ym,this)){const e=new Array(c.length);for(let t=0;t<c.length;t+=2)e[t]=n+c[t]*a,e[t+1]=r-c[t+1]*l;o.push(e)}return o}get box(){return me(Jm,this)}get classNamesForOutlining(){return["highlightOutline"]}}class Xm extends gm{newFreeDrawOutline(e,t,n,s,i,r){return new Qm(e,t,n,s,i,r)}}class Qm extends Om{newOutliner(e,t,n,s,i){return new Xm(e,t,n,s,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}var Zm=new WeakMap,eg=new WeakMap,tg=new WeakMap,ng=new WeakMap,sg=new WeakMap,ig=new WeakMap,rg=new WeakMap,og=new WeakMap,ag=new WeakMap,lg=new WeakMap,cg=new WeakMap,dg=new WeakMap,ug=new WeakMap,hg=new WeakMap,pg=new WeakMap,fg=new WeakMap,mg=new WeakMap,gg=new WeakMap,vg=new WeakSet;class bg extends no{static get _keyboardManager(){const e=bg.prototype;return Tt(this,"_keyboardManager",new ms([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(a(a({},e),{},{name:"highlightEditor"})),ue(this,vg),he(this,Zm,null),he(this,eg,0),he(this,tg,void 0),he(this,ng,null),he(this,sg,null),he(this,ig,null),he(this,rg,null),he(this,og,0),he(this,ag,null),he(this,lg,null),he(this,cg,null),he(this,dg,!1),he(this,ug,null),he(this,hg,null),he(this,pg,null),he(this,fg,""),he(this,mg,void 0),he(this,gg,""),this.color=e.color||bg._defaultColor,ge(mg,this,e.thickness||bg._defaultThickness),this.opacity=e.opacity||bg._defaultOpacity,ge(tg,this,e.boxes||null),ge(gg,this,e.methodOfCreation||""),ge(fg,this,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(ge(dg,this,!0),pe(vg,this,_g).call(this,e),pe(vg,this,Ag).call(this)):me(tg,this)&&(ge(Zm,this,e.anchorNode),ge(eg,this,e.anchorOffset),ge(rg,this,e.focusNode),ge(og,this,e.focusOffset),pe(vg,this,yg).call(this),pe(vg,this,Ag).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:me(dg,this)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:me(mg,this),methodOfCreation:me(gg,this)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,t){var n;no.initialize(e,t),bg._defaultColor||(bg._defaultColor=(null===(n=t.highlightColors)||void 0===n?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,t){switch(e){case $e.HIGHLIGHT_COLOR:bg._defaultColor=t;break;case $e.HIGHLIGHT_THICKNESS:bg._defaultThickness=t}}translateInPage(e,t){}get toolbarPosition(){return me(hg,this)}get commentButtonPosition(){return me(ug,this)}updateParams(e,t){switch(e){case $e.HIGHLIGHT_COLOR:pe(vg,this,wg).call(this,t);break;case $e.HIGHLIGHT_THICKNESS:pe(vg,this,xg).call(this,t)}}static get defaultPropertiesToUpdate(){return[[$e.HIGHLIGHT_COLOR,bg._defaultColor],[$e.HIGHLIGHT_THICKNESS,bg._defaultThickness]]}get propertiesToUpdate(){return[[$e.HIGHLIGHT_COLOR,this.color||bg._defaultColor],[$e.HIGHLIGHT_THICKNESS,me(mg,this)||bg._defaultThickness],[$e.HIGHLIGHT_FREE,me(dg,this)]]}onUpdatedColor(){var e,t;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(me(cg,this),{root:{fill:this.color,"fill-opacity":this.opacity}}),null===(t=me(sg,this))||void 0===t||t.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){if(this._uiManager.highlightColors){return[["colorPicker",ge(sg,this,new Sh({editor:this}))]]}return super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(pe(vg,this,Ng).call(this))}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,pe(vg,this,Ng).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){pe(vg,this,Sg).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(pe(vg,this,Ag).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)pe(vg,this,Sg).call(this);else if(e){var n;pe(vg,this,Ag).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),this.show(this._isVisible),t&&this.select()}rotate(e){const{drawLayer:t}=this.parent;let n;me(dg,this)?(e=(e-this.rotation+360)%360,n=Cg.call(bg,me(lg,this).box,e)):n=Cg.call(bg,[this.x,this.y,this.width,this.height],e),t.updateProperties(me(cg,this),{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(me(pg,this),{bbox:Cg.call(bg,me(ig,this).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();me(fg,this)&&(e.setAttribute("aria-label",me(fg,this)),e.setAttribute("role","mark")),me(dg,this)?e.classList.add("free"):this.div.addEventListener("keydown",pe(vg,this,kg).bind(this),{signal:this._uiManager._signal});const t=ge(ag,this,document.createElement("div"));return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=me(ng,this),this.setDims(),Yn(this,me(ag,this),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(me(pg,this),{rootClass:{hovered:!0}}))}pointerleave(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(me(pg,this),{rootClass:{hovered:!1}}))}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:pe(vg,this,Tg).call(this,!0);break;case 1:case 3:pe(vg,this,Tg).call(this,!1)}}select(){var e;super.select(),me(pg,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(me(pg,this),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),me(pg,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(me(pg,this),{rootClass:{selected:!1}}),me(dg,this)||pe(vg,this,Tg).call(this,!1))}get _mustFixPosition(){return!me(dg,this)}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(me(cg,this),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(me(pg,this),{rootClass:{hidden:!e}}))}static startHighlighting(e,t,n){let{target:s,x:i,y:r}=n;const{x:o,y:a,width:l,height:c}=s.getBoundingClientRect(),d=new AbortController,u=e.combinedSignal(d),h=t=>{d.abort(),pe(bg,this,Mg).call(this,e,t)};window.addEventListener("blur",h,{signal:u}),window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("pointerdown",ln,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",an,{signal:u}),s.addEventListener("pointermove",pe(bg,this,Rg).bind(this,e),{signal:u}),this._freeHighlight=new Xm({x:i,y:r},[o,a,l,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(e,t,n){let s=null;if(e instanceof bf){const{data:{quadPoints:t,rect:n,rotation:i,id:r,color:o,opacity:a,popupRef:l,richText:c,contentsObj:d,creationDate:u,modificationDate:h},parent:{page:{pageNumber:p}}}=e;s=e={annotationType:Ye.HIGHLIGHT,color:Array.from(o),opacity:a,quadPoints:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:i,annotationElementId:r,id:r,deleted:!1,popupRef:l,richText:c,comment:(null===d||void 0===d?void 0:d.str)||null,creationDate:u,modificationDate:h}}else if(e instanceof gf){const{data:{inkLists:t,rect:n,rotation:i,id:r,color:o,borderStyle:{rawWidth:a},popupRef:l,richText:c,contentsObj:d,creationDate:u,modificationDate:h},parent:{page:{pageNumber:p}}}=e;s=e={annotationType:Ye.HIGHLIGHT,color:Array.from(o),thickness:a,inkLists:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:i,annotationElementId:r,id:r,deleted:!1,popupRef:l,richText:c,comment:(null===d||void 0===d?void 0:d.str)||null,creationDate:u,modificationDate:h}}const{color:i,quadPoints:r,inkLists:o,opacity:a}=e,l=await super.deserialize(e,t,n);l.color=Bt.makeHexColor(...i),l.opacity=a||1,o&&ge(mg,l,e.thickness),l._initialData=s,e.comment&&l.setCommentData(e);const[c,d]=l.pageDimensions,[u,h]=l.pageTranslation;if(r){const e=ge(tg,l,[]);for(let t=0;t<r.length;t+=8)e.push({x:(r[t]-u)/c,y:1-(r[t+1]-h)/d,width:(r[t+2]-r[t])/c,height:(r[t+1]-r[t+5])/d});pe(vg,l,yg).call(l),pe(vg,l,Ag).call(l),l.rotate(l.rotation)}else if(o){ge(dg,l,!0);const e=o[0],n={x:e[0]-u,y:d-(e[1]-h)},s=new Xm(n,[0,0,c,d],1,me(mg,l)/2,!0,.001);for(let t=0,o=e.length;t<o;t+=2)n.x=e[t]-u,n.y=d-(e[t+1]-h),s.add(n);const{id:i,clipPathId:r}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:s.toSVGPath()}},!0,!0);pe(vg,l,_g).call(l,{highlightOutlines:s.getOutlines(),highlightId:i,clipPathId:r}),pe(vg,l,Ag).call(l),l.rotate(l.parentRotation)}return l}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=no._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:me(mg,this),quadPoints:pe(vg,this,Ig).call(this),outlines:pe(vg,this,Pg).call(this,n.rect)}),this.addComment(n),this.annotationElementId&&!pe(vg,this,Og).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}function yg(){const e=new Wm(me(tg,this),.001);ge(lg,this,e.getOutlines()),[this.x,this.y,this.width,this.height]=me(lg,this).box;const t=new Wm(me(tg,this),.0025,.001,"ltr"===this._uiManager.direction);ge(ig,this,t.getOutlines());const{firstPoint:n}=me(lg,this);ge(ug,this,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]);const{lastPoint:s}=me(ig,this);ge(hg,this,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])}function _g(e){let{highlightOutlines:t,highlightId:n,clipPathId:s}=e;ge(lg,this,t);if(ge(ig,this,t.getNewOutline(me(mg,this)/2+1.5,.0025)),n>=0)ge(cg,this,n),ge(ng,this,s),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),ge(pg,this,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:me(ig,this).box,path:{d:me(ig,this).toSVGPath()}},!0));else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(me(cg,this),{bbox:Cg.call(Re,me(lg,this).box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(me(pg,this),{bbox:Cg.call(Re,me(ig,this).box,e),path:{d:me(ig,this).toSVGPath()}})}const[i,r,o,a]=t.box;switch(this.rotation){case 0:this.x=i,this.y=r,this.width=o,this.height=a;break;case 90:{const[e,t]=this.parentDimensions;this.x=r,this.y=1-i,this.width=o*t/e,this.height=a*e/t;break}case 180:this.x=1-i,this.y=1-r,this.width=o,this.height=a;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-r,this.y=i,this.width=o*t/e,this.height=a*e/t;break}}const{firstPoint:l}=t;ge(ug,this,[(l[0]-i)/o,(l[1]-r)/a]);const{lastPoint:c}=me(ig,this);ge(hg,this,[(c[0]-i)/o,(c[1]-r)/a])}function wg(e){const t=(e,t)=>{this.color=e,this.opacity=t,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:t.bind(this,e,Re._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$e.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}function xg(e){const t=me(mg,this),n=e=>{ge(mg,this,e),pe(vg,this,Eg).call(this,e)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$e.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}function Eg(e){me(dg,this)&&(pe(vg,this,_g).call(this,{highlightOutlines:me(lg,this).getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}function Sg(){null!==me(cg,this)&&this.parent&&(this.parent.drawLayer.remove(me(cg,this)),ge(cg,this,null),this.parent.drawLayer.remove(me(pg,this)),ge(pg,this,null))}function Ag(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===me(cg,this)&&(({id:ce(ge,[cg,this])._,clipPathId:ce(ge,[ng,this])._}=e.drawLayer.draw({bbox:me(lg,this).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:me(dg,this)},path:{d:me(lg,this).toSVGPath()}},!1,!0)),ge(pg,this,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:me(dg,this)},bbox:me(ig,this).box,path:{d:me(ig,this).toSVGPath()}},me(dg,this))),me(ag,this)&&(me(ag,this).style.clipPath=me(ng,this)))}function Cg(e,t){let[n,s,i,r]=e;switch(t){case 90:return[1-s-r,n,r,i];case 180:return[1-n-i,1-s-r,i,r];case 270:return[s,1-n-i,r,i]}return[n,s,i,r]}function kg(e){Re._keyboardManager.exec(this,e)}function Tg(e){if(!me(Zm,this))return;const t=window.getSelection();e?t.setPosition(me(Zm,this),me(eg,this)):t.setPosition(me(rg,this),me(og,this))}function Ng(){return me(dg,this)?this.rotation:0}function Ig(){if(me(dg,this))return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,i=me(tg,this),r=new Float32Array(8*i.length);let o=0;for(const{x:a,y:l,width:c,height:d}of i){const i=a*e+n,u=(1-l)*t+s;r[o]=r[o+4]=i,r[o+1]=r[o+3]=u,r[o+2]=r[o+6]=i+c*e,r[o+5]=r[o+7]=u-d*t,o+=8}return r}function Pg(e){return me(lg,this).serialize(e,pe(vg,this,Ng).call(this))}function Rg(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}function Mg(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}function Og(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((e,n)=>e!==t[n])}Re=bg,r(bg,"_defaultColor",null),r(bg,"_defaultOpacity",1),r(bg,"_defaultThickness",12),r(bg,"_type","highlight"),r(bg,"_editorType",Ye.HIGHLIGHT),r(bg,"_freeHighlightId",-1),r(bg,"_freeHighlight",null),r(bg,"_freeHighlightClipId","");var Dg=new WeakMap;class jg{constructor(){he(this,Dg,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){me(Dg,this)[e]=t}toSVGProperties(){const e=me(Dg,this);return ge(Dg,this,Object.create(null)),{root:e}}reset(){ge(Dg,this,Object.create(null))}updateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(e)}clone(){St("Not implemented")}}var Fg=new WeakMap,Lg=new WeakMap,Ug=new WeakSet;class Bg extends no{constructor(e){super(e),ue(this,Ug),he(this,Fg,null),he(this,Lg,void 0),r(this,"_colorPicker",null),r(this,"_drawId",null),ge(Lg,this,e.mustBeCommitted||!1),this._addOutlines(e)}onUpdatedColor(){var e;null===(e=this._colorPicker)||void 0===e||e.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(pe(Ug,this,Vg).call(this,e),pe(Ug,this,qg).call(this))}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,i]of Object.entries(t))n.has(s)?Object.assign(e[s],i):e[s]=i;return e}static getDefaultDrawingOptions(e){St("Not implemented")}static get typesMap(){St("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(Yg._.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,i=s[t],r=n=>{var i;s.updateProperty(t,n);const r=me(Fg,this).updateProperty(t,n);r&&pe(Ug,this,Kg).call(this,r),null===(i=this.parent)||void 0===i||i.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:r.bind(this,n),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,Bg._mergeSVGProperties(me(Fg,this).getPathResizingSVGProperties(pe(Ug,this,Gg).call(this)),{bbox:pe(Ug,this,Jg).call(this)}))}_onResized(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,Bg._mergeSVGProperties(me(Fg,this).getPathResizedSVGProperties(pe(Ug,this,Gg).call(this)),{bbox:pe(Ug,this,Jg).call(this)}))}_onTranslating(e,t){var n;null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,{bbox:pe(Ug,this,Jg).call(this)})}_onTranslated(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,Bg._mergeSVGProperties(me(Fg,this).getPathTranslatedSVGProperties(pe(Ug,this,Gg).call(this),this.parentDimensions),{bbox:pe(Ug,this,Jg).call(this)}))}_onStartDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,me(Lg,this)&&(ge(Lg,this,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){pe(Ug,this,Hg).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(pe(Ug,this,qg).call(this),pe(Ug,this,Kg).call(this,me(Fg,this).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)this._uiManager.removeShouldRescale(this),pe(Ug,this,Hg).call(this);else if(e){var n;this._uiManager.addShouldRescale(this),pe(Ug,this,qg).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),t&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Bg._mergeSVGProperties({bbox:pe(Ug,this,Jg).call(this)},me(Fg,this).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&pe(Ug,this,Kg).call(this,me(Fg,this).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,i){St("Not implemented")}static startDrawing(e,t,n,s){var i;const{target:r,offsetX:o,offsetY:a,pointerId:l,pointerType:c}=s;if($n.isInitializedAndDifferentPointerType(c))return;const{viewport:{rotation:d}}=e,{width:u,height:h}=r.getBoundingClientRect(),p=$g._=new AbortController,f=e.combinedSignal(p);$n.setPointer(c,l),window.addEventListener("pointerup",e=>{$n.isSamePointerIdOrRemove(e.pointerId)&&this._endDraw(e)},{signal:f}),window.addEventListener("pointercancel",e=>{$n.isSamePointerIdOrRemove(e.pointerId)&&this._currentParent.endDrawingSession()},{signal:f}),window.addEventListener("pointerdown",e=>{$n.isSamePointerType(e.pointerType)&&($n.initializeAndAddPointerId(e.pointerId),Yg._.isCancellable()&&(Yg._.removeLastElement(),Yg._.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",an,{signal:f}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:f}),r.addEventListener("touchmove",e=>{$n.isSameTimeStamp(e.timeStamp)&&ln(e)},{signal:f}),e.toggleDrawing(),null===(i=t._editorUndoBar)||void 0===i||i.hide(),Yg._?e.drawLayer.updateProperties(this._currentDrawId,Yg._.startNew(o,a,u,h,d)):(t.updateUIForDefaultProperties(this),Yg._=this.createDrawerInstance(o,a,u,h,d),Xg._=this.getDefaultDrawingOptions(),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Xg._.toSVGProperties(),Yg._.defaultSVGProperties),!0,!1)))}static _drawMove(e){if($n.isSameTimeStamp(e.timeStamp),!Yg._)return;const{offsetX:t,offsetY:n,pointerId:s}=e;$n.isSamePointerId(s)&&($n.isUsingMultiplePointers()?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,Yg._.add(t,n)),$n.setTimeStamp(e.timeStamp),ln(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Yg._=null,Xg._=null,$n.clearTimeStamp()),$g._&&($g._.abort(),$g._=null,$n.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),(null===e||void 0===e?void 0:e.target)===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Yg._.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=Yg._,n=this._currentDrawId,s=e.getLastElement();return void t.addCommands({cmd:()=>{t.drawLayer.updateProperties(n,e.setLastElement(s))},undo:()=>{t.drawLayer.updateProperties(n,e.removeLastElement())},mustExec:!1,type:$e.DRAW_STEP})}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack($e.DRAW_STEP),!Yg._.isEmpty()){const{pageDimensions:[n,s],scale:i}=t,r=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Yg._.getOutlines(n*i,s*i,i,this._INNER_MARGIN),drawingOptions:Xg._,mustBeCommitted:!e});return this._cleanup(!0),r}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,i,r){St("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=t.viewport,a=this.deserializeDraw(r,o,s,i,this._INNER_MARGIN,e),l=await super.deserialize(e,t,n);return l.createDrawingOptions(e),pe(Ug,l,Vg).call(l,{drawOutlines:a}),pe(Ug,l,qg).call(l),l.onScaleChanging(),l.rotate(),l}serializeDraw(e){const[t,n]=this.pageTranslation,[s,i]=this.pageDimensions;return me(Fg,this).serialize([t,n,s,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}function Vg(e){let{drawOutlines:t,drawId:n,drawingOptions:s}=e;ge(Fg,this,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-".concat(this.editorType,"-added-alert")),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=pe(Ug,this,Wg).call(this,t,this.parent),pe(Ug,this,Kg).call(this,t.box)}function Wg(e,t){const{id:n}=t.drawLayer.draw(Me._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}function Hg(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}function qg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=pe(Ug,this,Wg).call(this,me(Fg,this),e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))}function zg(e){let[t,n,s,i]=e;const{parentDimensions:[r,o],rotation:a}=this;switch(a){case 90:return[n,1-t,s*(o/r),i*(r/o)];case 180:return[1-t,1-n,s,i];case 270:return[1-n,t,s*(o/r),i*(r/o)];default:return[t,n,s,i]}}function Gg(){const{x:e,y:t,width:n,height:s,parentDimensions:[i,r],rotation:o}=this;switch(o){case 90:return[1-t,e,n*(i/r),s*(r/i)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(i/r),s*(r/i)];default:return[e,t,n,s]}}function Kg(e){[this.x,this.y,this.width,this.height]=pe(Ug,this,zg).call(this,e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}function Jg(){const{x:e,y:t,width:n,height:s,rotation:i,parentRotation:r,parentDimensions:[o,a]}=this;switch((4*i+r)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(o/a),s*(a/o),n*(o/a)];case 5:return[1-t,e,n*(o/a),s*(a/o)];case 6:return[1-e-s*(a/o),1-t,s*(a/o),n*(o/a)];case 7:return[t-n*(o/a),1-e-s*(a/o),n*(o/a),s*(a/o)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(a/o),t,s*(a/o),n*(o/a)];case 13:return[1-t-n*(o/a),e-s*(a/o),n*(o/a),s*(a/o)];case 14:return[1-e,1-t-n*(o/a),s*(a/o),n*(o/a)];case 15:return[t,1-e,n*(o/a),s*(a/o)];default:return[e,t,n,s]}}Me=Bg,r(Bg,"_currentDrawId",-1),r(Bg,"_currentParent",null);var Yg={_:null},$g={_:null},Xg={_:null};r(Bg,"_INNER_MARGIN",3);var Qg=new WeakMap,Zg=new WeakMap,ev=new WeakMap,tv=new WeakMap,nv=new WeakMap,sv=new WeakMap,iv=new WeakMap,rv=new WeakMap,ov=new WeakMap,av=new WeakMap,lv=new WeakMap,cv=new WeakSet;class dv{constructor(e,t,n,s,i,r){ue(this,cv),he(this,Qg,new Float64Array(6)),he(this,Zg,void 0),he(this,ev,void 0),he(this,tv,void 0),he(this,nv,void 0),he(this,sv,void 0),he(this,iv,""),he(this,rv,0),he(this,ov,new xv),he(this,av,void 0),he(this,lv,void 0),ge(av,this,n),ge(lv,this,s),ge(tv,this,i),ge(nv,this,r),[e,t]=pe(cv,this,uv).call(this,e,t);const o=ge(Zg,this,[NaN,NaN,NaN,NaN,e,t]);ge(sv,this,[e,t]),ge(ev,this,[{line:o,points:me(sv,this)}]),me(Qg,this).set(o,0)}updateProperty(e,t){"stroke-width"===e&&ge(nv,this,t)}isEmpty(){return!me(ev,this)||0===me(ev,this).length}isCancellable(){return me(sv,this).length<=10}add(e,t){[e,t]=pe(cv,this,uv).call(this,e,t);const[n,s,i,r]=me(Qg,this).subarray(2,6),o=e-i,a=t-r;return Math.hypot(me(av,this)*o,me(lv,this)*a)<=2?null:(me(sv,this).push(e,t),isNaN(n)?(me(Qg,this).set([i,r,e,t],2),me(Zg,this).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(me(Qg,this)[0])&&me(Zg,this).splice(6,6),me(Qg,this).set([n,s,i,r,e,t],0),me(Zg,this).push(...tm.createBezierPoints(n,s,i,r,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(2===me(sv,this).length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,i){ge(av,this,n),ge(lv,this,s),ge(tv,this,i),[e,t]=pe(cv,this,uv).call(this,e,t);const r=ge(Zg,this,[NaN,NaN,NaN,NaN,e,t]);ge(sv,this,[e,t]);const o=me(ev,this).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),me(ev,this).push({line:r,points:me(sv,this)}),me(Qg,this).set(r,0),ge(rv,this,0),this.toSVGPath(),null}getLastElement(){return me(ev,this).at(-1)}setLastElement(e){return me(ev,this)?(me(ev,this).push(e),ge(Zg,this,e.line),ge(sv,this,e.points),ge(rv,this,0),{path:{d:this.toSVGPath()}}):me(ov,this).setLastElement(e)}removeLastElement(){if(!me(ev,this))return me(ov,this).removeLastElement();me(ev,this).pop(),ge(iv,this,"");for(let e=0,t=me(ev,this).length;e<t;e++){const{line:t,points:n}=me(ev,this)[e];ge(Zg,this,t),ge(sv,this,n),ge(rv,this,0),this.toSVGPath()}return{path:{d:me(iv,this)}}}toSVGPath(){const e=tm.svgRound(me(Zg,this)[4]),t=tm.svgRound(me(Zg,this)[5]);if(2===me(sv,this).length)return ge(iv,this,"".concat(me(iv,this)," M ").concat(e," ").concat(t," Z")),me(iv,this);if(me(sv,this).length<=6){const n=me(iv,this).lastIndexOf("M");ge(iv,this,"".concat(me(iv,this).slice(0,n)," M ").concat(e," ").concat(t)),ge(rv,this,6)}if(4===me(sv,this).length){const e=tm.svgRound(me(Zg,this)[10]),t=tm.svgRound(me(Zg,this)[11]);return ge(iv,this,"".concat(me(iv,this)," L ").concat(e," ").concat(t)),ge(rv,this,12),me(iv,this)}const n=[];0===me(rv,this)&&(n.push("M ".concat(e," ").concat(t)),ge(rv,this,6));for(let s=me(rv,this),i=me(Zg,this).length;s<i;s+=6){const[e,t,i,r,o,a]=me(Zg,this).slice(s,s+6).map(tm.svgRound);n.push("C".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a))}return ge(iv,this,me(iv,this)+n.join(" ")),ge(rv,this,me(Zg,this).length),me(iv,this)}getOutlines(e,t,n,s){const i=me(ev,this).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),me(ov,this).build(me(ev,this),e,t,n,me(tv,this),me(nv,this),s),ge(Qg,this,null),ge(Zg,this,null),ge(ev,this,null),ge(iv,this,null),me(ov,this)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}function uv(e,t){return tm._normalizePoint(e,t,me(av,this),me(lv,this),me(tv,this))}var hv=new WeakMap,pv=new WeakMap,fv=new WeakMap,mv=new WeakMap,gv=new WeakMap,vv=new WeakMap,bv=new WeakMap,yv=new WeakMap,_v=new WeakMap,wv=new WeakSet;class xv extends tm{constructor(){super(...arguments),ue(this,wv),he(this,hv,void 0),he(this,pv,0),he(this,fv,void 0),he(this,mv,void 0),he(this,gv,void 0),he(this,vv,void 0),he(this,bv,void 0),he(this,yv,void 0),he(this,_v,void 0)}build(e,t,n,s,i,r,o){ge(gv,this,t),ge(vv,this,n),ge(bv,this,s),ge(yv,this,i),ge(_v,this,r),ge(fv,this,null!==o&&void 0!==o?o:0),ge(mv,this,e),pe(wv,this,Av).call(this)}get thickness(){return me(_v,this)}setLastElement(e){return me(mv,this).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return me(mv,this).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of me(mv,this))if(e.push("M".concat(tm.svgRound(t[4])," ").concat(tm.svgRound(t[5]))),6!==t.length)if(12===t.length&&isNaN(t[6]))e.push("L".concat(tm.svgRound(t[10])," ").concat(tm.svgRound(t[11])));else for(let n=6,s=t.length;n<s;n+=6){const[s,i,r,o,a,l]=t.subarray(n,n+6).map(tm.svgRound);e.push("C".concat(s," ").concat(i," ").concat(r," ").concat(o," ").concat(a," ").concat(l))}else e.push("Z");return e.join("")}serialize(e,t){let[n,s,i,r]=e;const o=[],a=[],[l,c,d,u]=pe(wv,this,Sv).call(this);let h,p,f,m,g,v,b,y,_;switch(me(yv,this)){case 0:_=tm._rescale,h=n,p=s+r,f=i,m=-r,g=n+l*i,v=s+(1-c-u)*r,b=n+(l+d)*i,y=s+(1-c)*r;break;case 90:_=tm._rescaleAndSwap,h=n,p=s,f=i,m=r,g=n+c*i,v=s+l*r,b=n+(c+u)*i,y=s+(l+d)*r;break;case 180:_=tm._rescale,h=n+i,p=s,f=-i,m=r,g=n+(1-l-d)*i,v=s+c*r,b=n+(1-l)*i,y=s+(c+u)*r;break;case 270:_=tm._rescaleAndSwap,h=n+i,p=s+r,f=-i,m=-r,g=n+(1-c-u)*i,v=s+(1-l-d)*r,b=n+(1-c)*i,y=s+(1-l)*r}for(const{line:w,points:x}of me(mv,this))o.push(_(w,h,p,f,m,t?new Array(w.length):null)),a.push(_(x,h,p,f,m,t?new Array(x.length):null));return{lines:o,points:a,rect:[g,v,b,y]}}static deserialize(e,t,n,s,i,r){let{paths:{lines:o,points:a},rotation:l,thickness:c}=r;const d=[];let u,h,p,f,m;switch(l){case 0:m=tm._rescale,u=-e/n,h=t/s+1,p=1/n,f=-1/s;break;case 90:m=tm._rescaleAndSwap,u=-t/s,h=-e/n,p=1/s,f=1/n;break;case 180:m=tm._rescale,u=e/n+1,h=-t/s,p=-1/n,f=1/s;break;case 270:m=tm._rescaleAndSwap,u=t/s+1,h=e/n+1,p=-1/s,f=-1/n}if(!o){o=[];for(const e of a){const t=e.length;if(2===t){o.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){o.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const n=new Float32Array(3*(t-2));o.push(n);let[s,i,r,a]=e.subarray(0,4);n.set([NaN,NaN,NaN,NaN,s,i],0);for(let o=4;o<t;o+=2){const t=e[o],l=e[o+1];n.set(tm.createBezierPoints(s,i,r,a,t,l),3*(o-2)),[s,i,r,a]=[r,a,t,l]}}}for(let v=0,b=o.length;v<b;v++)d.push({line:m(o[v].map(e=>null!==e&&void 0!==e?e:NaN),u,h,p,f),points:m(a[v].map(e=>null!==e&&void 0!==e?e:NaN),u,h,p,f)});const g=new this.prototype.constructor;return g.build(d,n,s,1,l,c,i),g}get box(){return me(hv,this)}updateProperty(e,t){return"stroke-width"===e?pe(wv,this,Cv).call(this,t):null}updateParentDimensions(e,t){let[n,s]=e;const[i,r]=pe(wv,this,Ev).call(this);ge(gv,this,n),ge(vv,this,s),ge(bv,this,t);const[o,a]=pe(wv,this,Ev).call(this),l=o-i,c=a-r,d=me(hv,this);return d[0]-=l,d[1]-=c,d[2]+=2*l,d[3]+=2*c,d}updateRotation(e){return ge(pv,this,e),{path:{transform:this.rotationTransform}}}get viewBox(){return me(hv,this).map(tm.svgRound).join(" ")}get defaultProperties(){const[e,t]=me(hv,this);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(tm.svgRound(e)," ").concat(tm.svgRound(t))}}}get rotationTransform(){const[,,e,t]=me(hv,this);let n=0,s=0,i=0,r=0,o=0,a=0;switch(me(pv,this)){case 90:s=t/e,i=-e/t,o=e;break;case 180:n=-1,r=-1,o=e,a=t;break;case 270:s=-t/e,i=e/t,a=t;break;default:return""}return"matrix(".concat(n," ").concat(s," ").concat(i," ").concat(r," ").concat(tm.svgRound(o)," ").concat(tm.svgRound(a),")")}getPathResizingSVGProperties(e){let[t,n,s,i]=e;const[r,o]=pe(wv,this,Ev).call(this),[a,l,c,d]=me(hv,this);if(Math.abs(c-r)<=tm.PRECISION||Math.abs(d-o)<=tm.PRECISION){const e=t+s/2-(a+c/2),r=n+i/2-(l+d/2);return{path:{"transform-origin":"".concat(tm.svgRound(t)," ").concat(tm.svgRound(n)),transform:"".concat(this.rotationTransform," translate(").concat(e," ").concat(r,")")}}}const u=(s-2*r)/(c-2*r),h=(i-2*o)/(d-2*o),p=c/s,f=d/i;return{path:{"transform-origin":"".concat(tm.svgRound(a)," ").concat(tm.svgRound(l)),transform:"".concat(this.rotationTransform," scale(").concat(p," ").concat(f,") ")+"translate(".concat(tm.svgRound(r)," ").concat(tm.svgRound(o),") scale(").concat(u," ").concat(h,") ")+"translate(".concat(tm.svgRound(-r)," ").concat(tm.svgRound(-o),")")}}}getPathResizedSVGProperties(e){let[t,n,s,i]=e;const[r,o]=pe(wv,this,Ev).call(this),a=me(hv,this),[l,c,d,u]=a;if(a[0]=t,a[1]=n,a[2]=s,a[3]=i,Math.abs(d-r)<=tm.PRECISION||Math.abs(u-o)<=tm.PRECISION){const e=t+s/2-(l+d/2),r=n+i/2-(c+u/2);for(const{line:t,points:n}of me(mv,this))tm._translate(t,e,r,t),tm._translate(n,e,r,n);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(tm.svgRound(t)," ").concat(tm.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}const h=(s-2*r)/(d-2*r),p=(i-2*o)/(u-2*o),f=-h*(l+r)+t+r,m=-p*(c+o)+n+o;if(1!==h||1!==p||0!==f||0!==m)for(const{line:g,points:v}of me(mv,this))tm._rescale(g,f,m,h,p,g),tm._rescale(v,f,m,h,p,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(tm.svgRound(t)," ").concat(tm.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(e,t){let[n,s]=e;const[i,r]=t,o=me(hv,this),a=n-o[0],l=s-o[1];if(me(gv,this)===i&&me(vv,this)===r)for(const{line:c,points:d}of me(mv,this))tm._translate(c,a,l,c),tm._translate(d,a,l,d);else{const e=me(gv,this)/i,t=me(vv,this)/r;ge(gv,this,i),ge(vv,this,r);for(const{line:n,points:s}of me(mv,this))tm._rescale(n,a,l,e,t,n),tm._rescale(s,a,l,e,t,s);o[2]*=e,o[3]*=t}return o[0]=n,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":"".concat(tm.svgRound(n)," ").concat(tm.svgRound(s))}}}get defaultSVGProperties(){const e=me(hv,this);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":"".concat(tm.svgRound(e[0])," ").concat(tm.svgRound(e[1])),transform:this.rotationTransform||null},bbox:e}}}function Ev(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me(_v,this);const t=me(fv,this)+e/2*me(bv,this);return me(yv,this)%180===0?[t/me(gv,this),t/me(vv,this)]:[t/me(vv,this),t/me(gv,this)]}function Sv(){const[e,t,n,s]=me(hv,this),[i,r]=pe(wv,this,Ev).call(this,0);return[e+i,t+r,n-2*i,s-2*r]}function Av(){const e=ge(hv,this,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of me(mv,this)){if(s.length<=12){for(let t=4,n=s.length;t<n;t+=6)Bt.pointBoundingBox(s[t],s[t+1],e);continue}let t=s[4],n=s[5];for(let i=6,r=s.length;i<r;i+=6){const[r,o,a,l,c,d]=s.subarray(i,i+6);Bt.bezierBoundingBox(t,n,r,o,a,l,c,d,e),t=c,n=d}}const[t,n]=pe(wv,this,Ev).call(this);e[0]=Kt(e[0]-t,0,1),e[1]=Kt(e[1]-n,0,1),e[2]=Kt(e[2]+t,0,1),e[3]=Kt(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}function Cv(e){const[t,n]=pe(wv,this,Ev).call(this);ge(_v,this,e);const[s,i]=pe(wv,this,Ev).call(this),[r,o]=[s-t,i-n],a=me(hv,this);return a[0]-=r,a[1]-=o,a[2]+=2*r,a[3]+=2*o,a}class kv extends jg{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:no._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(null!==t&&void 0!==t||(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new kv(this._viewParameters);return e.updateAll(this),e}}var Tv=new WeakSet;class Nv extends Bg{constructor(e){super(a(a({},e),{},{name:"inkEditor"})),ue(this,Tv),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){no.initialize(e,t),this._defaultDrawingOptions=new kv(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Tt(this,"typesMap",new Map([[$e.INK_THICKNESS,"stroke-width"],[$e.INK_COLOR,"stroke"],[$e.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,i){return new dv(e,t,n,s,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,i,r){return xv.deserialize(e,t,n,s,i,r)}static async deserialize(e,t,n){let s=null;if(e instanceof gf){const{data:{inkLists:t,rect:n,rotation:i,id:r,color:o,opacity:a,borderStyle:{rawWidth:l},popupRef:c,richText:d,contentsObj:u,creationDate:h,modificationDate:p},parent:{page:{pageNumber:f}}}=e;s=e={annotationType:Ye.INK,color:Array.from(o),thickness:l,opacity:a,paths:{points:t},boxes:null,pageIndex:f-1,rect:n.slice(0),rotation:i,annotationElementId:r,id:r,deleted:!1,popupRef:c,richText:d,comment:(null===u||void 0===u?void 0:u.str)||null,creationDate:h,modificationDate:p}}const i=await super.deserialize(e,t,n);return i._initialData=s,e.comment&&i.setCommentData(e),i}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Dh(this)),[["colorPicker",this._colorPicker]]}get colorType(){return $e.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(e){let{color:t,thickness:n,opacity:s}=e;this._drawingOptions=Nv.getDefaultDrawingOptions({stroke:Bt.makeHexColor(...t),"stroke-width":n,"stroke-opacity":s})}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":i,"stroke-width":r}}=this,o=Object.assign(super.serialize(e),{color:no._colorManager.convert(s),opacity:i,thickness:r,paths:{lines:t,points:n}});return this.addComment(o),e?(o.isCopy=!0,o):this.annotationElementId&&!pe(Tv,this,Iv).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}function Iv(e){const{color:t,thickness:n,opacity:s,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((e,n)=>e!==t[n])||e.thickness!==n||e.opacity!==s||e.pageIndex!==i}r(Nv,"_type","ink"),r(Nv,"_editorType",Ye.INK),r(Nv,"_defaultDrawingOptions",null);class Pv extends xv{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}class Rv{static extractContoursFromText(e,t,n,s,i,r){let{fontFamily:o,fontStyle:a,fontWeight:l}=t,c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1});const u=d.font="".concat(a," ").concat(l," ").concat(200,"px ").concat(o),{actualBoundingBoxLeft:h,actualBoundingBoxRight:p,actualBoundingBoxAscent:f,actualBoundingBoxDescent:m,fontBoundingBoxAscent:g,fontBoundingBoxDescent:v,width:b}=d.measureText(e),y=1.5,_=Math.ceil(Math.max(Math.abs(h)+Math.abs(p)||0,b)*y),w=Math.ceil(Math.max(Math.abs(f)+Math.abs(m)||200,Math.abs(g)+Math.abs(v)||200)*y);c=new OffscreenCanvas(_,w),d=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=u,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,_,w),d.fillStyle="black",d.fillText(e,.5*_/2,1.5*w/2);const x=pe(Rv,this,Vv).call(this,d.getImageData(0,0,_,w).data),E=pe(Rv,this,Bv).call(this,x),S=pe(Rv,this,Wv).call(this,E),A=pe(Rv,this,jv).call(this,x,_,w,S);return this.processDrawnLines({lines:{curves:A,width:_,height:w},pageWidth:n,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,i){const[r,o,a]=pe(Rv,this,Hv).call(this,e),[l,c]=pe(Rv,this,Uv).call(this,r,o,a,Math.hypot(o,a)*pe(Rv,this,qv)._.sigmaSFactor,pe(Rv,this,qv)._.sigmaR,pe(Rv,this,qv)._.kernelSize),d=pe(Rv,this,Wv).call(this,c),u=pe(Rv,this,jv).call(this,l,o,a,d);return this.processDrawnLines({lines:{curves:u,width:o,height:a},pageWidth:t,pageHeight:n,rotation:s,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines(e){var t;let{lines:n,pageWidth:s,pageHeight:i,rotation:r,innerMargin:o,mustSmooth:a,areContours:l}=e;r%180!==0&&([s,i]=[i,s]);const{curves:c,width:d,height:u}=n,h=null!==(t=n.thickness)&&void 0!==t?t:0,p=[],f=Math.min(s/d,i/u),m=f/s,g=f/i,v=[];for(const{points:y}of c){const e=a?pe(Rv,this,Lv).call(this,y):y;if(!e)continue;v.push(e);const t=e.length,n=new Float32Array(t),s=new Float32Array(3*(2===t?2:t-2));if(p.push({line:s,points:n}),2===t){n[0]=e[0]*m,n[1]=e[1]*g,s.set([NaN,NaN,NaN,NaN,n[0],n[1]],0);continue}let[i,r,o,l]=e;i*=m,r*=g,o*=m,l*=g,n.set([i,r,o,l],0),s.set([NaN,NaN,NaN,NaN,i,r],0);for(let a=4;a<t;a+=2){const t=n[a]=e[a]*m,c=n[a+1]=e[a+1]*g;s.set(tm.createBezierPoints(i,r,o,l,t,c),3*(a-2)),[i,r,o,l]=[o,l,t,c]}}if(0===p.length)return null;const b=l?new Pv:new xv;return b.build(p,s,i,1,r,l?0:h,o),{outline:b,newCurves:v,areContours:l,thickness:h,width:d,height:u}}static async compressSignature(e){let t,{outlines:n,areContours:s,thickness:i,width:r,height:o}=e,a=1/0,l=-1/0,c=0;for(const b of n){c+=b.length;for(let e=2,t=b.length;e<t;e++){const t=b[e]-b[e-2];a=Math.min(a,t),l=Math.max(l,t)}}t=a>=-128&&l<=127?Int8Array:a>=-32768&&l<=32767?Int16Array:Int32Array;const d=n.length,u=8+3*d,h=new Uint32Array(u);let p=0;h[p++]=u*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*t.BYTES_PER_ELEMENT,h[p++]=0,h[p++]=r,h[p++]=o,h[p++]=s?0:1,h[p++]=Math.max(0,Math.floor(null!==i&&void 0!==i?i:0)),h[p++]=d,h[p++]=t.BYTES_PER_ELEMENT;for(const b of n)h[p++]=b.length-2,h[p++]=b[0],h[p++]=b[1];const f=new CompressionStream("deflate-raw"),m=f.writable.getWriter();await m.ready,m.write(h);const g=t.prototype.constructor;for(const b of n){const e=new g(b.length-2);for(let t=2,n=b.length;t<n;t++)e[t-2]=b[t]-b[t-2];m.write(e)}m.close();const v=await new Response(f.readable).arrayBuffer();return Jt(new Uint8Array(v))}static async decompressSignature(e){try{const l=(o=e,Uint8Array.fromBase64?Uint8Array.fromBase64(o):Ft(atob(o))),{readable:c,writable:d}=new DecompressionStream("deflate-raw"),u=d.getWriter();await u.ready,u.write(l).then(async()=>{await u.ready,await u.close()}).catch(()=>{});let h=null,p=0;var t,n=!1,s=!1;try{for(var i,r=function(e){var t,n,s,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,s=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(s&&null!=(t=e[s]))return new ve(t.call(e));n="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}(c);n=!(i=await r.next()).done;n=!1){const e=i.value;h||(h=new Uint8Array(new Uint32Array(e.buffer,0,4)[0])),h.set(e,p),p+=e.length}}catch(a){s=!0,t=a}finally{try{n&&null!=r.return&&await r.return()}finally{if(s)throw t}}const f=new Uint32Array(h.buffer,0,h.length>>2),m=f[1];if(0!==m)throw new Error("Invalid version: ".concat(m));const g=f[2],v=f[3],b=0===f[4],y=f[5],_=f[6],w=f[7],x=[],E=(8+3*_)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(w){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(h.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(h.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(h.buffer,E)}p=0;for(let e=0;e<_;e++){const t=f[3*e+8],n=new Float32Array(t+2);x.push(n);for(let s=0;s<2;s++)n[s]=f[3*e+8+s+1];for(let e=0;e<t;e++)n[e+2]=n[e]+S[p++]}return{areContours:b,thickness:y,outlines:x,width:g,height:v}}catch(l){return Et("decompressSignature: ".concat(l)),null}var o}}function Mv(e,t,n,s){return s-=t,0===(n-=e)?s>0?0:4:1===n?s+6:2-s}function Ov(e,t,n,s,i,r,o){const a=pe(Oe,this,Mv).call(this,n,s,i,r);for(let l=0;l<8;l++){const i=(-l+a-o+16)%8;if(0!==e[(n+pe(Oe,this,zv)._[2*i])*t+(s+pe(Oe,this,zv)._[2*i+1])])return i}return-1}function Dv(e,t,n,s,i,r,o){const a=pe(Oe,this,Mv).call(this,n,s,i,r);for(let l=0;l<8;l++){const i=(l+a+o+16)%8;if(0!==e[(n+pe(Oe,this,zv)._[2*i])*t+(s+pe(Oe,this,zv)._[2*i+1])])return i}return-1}function jv(e,t,n,s){const i=e.length,r=new Int32Array(i);for(let c=0;c<i;c++)r[c]=e[c]<=s?1:0;for(let c=1;c<n-1;c++)r[c*t]=r[c*t+t-1]=0;for(let c=0;c<t;c++)r[c]=r[t*n-1-c]=0;let o,a=1;const l=[];for(let c=1;c<n-1;c++){o=1;for(let e=1;e<t-1;e++){const n=c*t+e,s=r[n];if(0===s)continue;let i=c,d=e;if(1===s&&0===r[n-1])a+=1,d-=1;else{if(!(s>=1&&0===r[n+1])){1!==s&&(o=Math.abs(s));continue}a+=1,d+=1,s>1&&(o=s)}const u=[e,c],h=d===e+1,p={isHole:h,points:u,id:a,parent:0};let f;l.push(p);for(const e of l)if(e.id===o){f=e;break}f?f.isHole?p.parent=h?f.parent:o:p.parent=h?o:f.parent:p.parent=h?o:0;const m=pe(Oe,this,Ov).call(this,r,t,c,e,i,d,0);if(-1===m){r[n]=-a,1!==r[n]&&(o=Math.abs(r[n]));continue}let g=pe(Oe,this,zv)._[2*m],v=pe(Oe,this,zv)._[2*m+1];const b=c+g,y=e+v;i=b,d=y;let _=c,w=e;for(;;){const s=pe(Oe,this,Dv).call(this,r,t,_,w,i,d,1);g=pe(Oe,this,zv)._[2*s],v=pe(Oe,this,zv)._[2*s+1];const l=_+g,h=w+v;u.push(h,l);const p=_*t+w;if(0===r[p+1]?r[p]=-a:1===r[p]&&(r[p]=a),l===c&&h===e&&_===b&&w===y){1!==r[n]&&(o=Math.abs(r[n]));break}i=_,d=w,_=l,w=h}}}return l}function Fv(e,t,n,s){if(n-t<=4){for(let i=t;i<n-2;i+=2)s.push(e[i],e[i+1]);return}const i=e[t],r=e[t+1],o=e[n-4]-i,a=e[n-3]-r,l=Math.hypot(o,a),c=o/l,d=a/l,u=c*r-d*i,h=a/o,p=1/l,f=Math.atan(h),m=Math.cos(f),g=Math.sin(f),v=p*(Math.abs(m)+Math.abs(g)),b=p*(1-v+v**2),y=Math.max(Math.atan(Math.abs(g+m)*b),Math.atan(Math.abs(g-m)*b));let _=0,w=t;for(let x=t+2;x<n-2;x+=2){const t=Math.abs(u-c*e[x+1]+d*e[x]);t>_&&(w=x,_=t)}_>(l*y)**2?(pe(Oe,this,Fv).call(this,e,t,w+2,s),pe(Oe,this,Fv).call(this,e,w,n,s)):s.push(i,r)}function Lv(e){const t=[],n=e.length;return pe(Oe,this,Fv).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}function Uv(e,t,n,s,i,r){const o=new Float32Array(r**2),a=-2*s**2,l=r>>1;for(let f=0;f<r;f++){const e=(f-l)**2;for(let t=0;t<r;t++)o[f*r+t]=Math.exp((e+(t-l)**2)/a)}const c=new Float32Array(256),d=-2*i**2;for(let f=0;f<256;f++)c[f]=Math.exp(f**2/d);const u=e.length,h=new Uint8Array(u),p=new Uint32Array(256);for(let f=0;f<n;f++)for(let s=0;s<t;s++){const i=f*t+s,a=e[i];let d=0,u=0;for(let h=0;h<r;h++){const i=f+h-l;if(!(i<0||i>=n))for(let n=0;n<r;n++){const p=s+n-l;if(p<0||p>=t)continue;const f=e[i*t+p],m=o[h*r+n]*c[Math.abs(f-a)];d+=f*m,u+=m}}p[h[i]=Math.round(d/u)]++}return[h,p]}function Bv(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}function Vv(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,i=1/0;for(let o=0,a=n.length;o<a;o++){const t=n[o]=e[o<<2];s=Math.max(s,t),i=Math.min(i,t)}const r=255/(s-i);for(let o=0,a=n.length;o<a;o++)n[o]=(n[o]-i)*r;return n}function Wv(e){let t,n=-1/0,s=-1/0;const i=e.findIndex(e=>0!==e);let r=i,o=i;for(t=i;t<256;t++){const i=e[t];i>n&&(t-r>s&&(s=t-r,o=t-1),n=i,r=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t}function Hv(e){const t=e,{width:n,height:s}=e,{maxDim:i}=pe(Oe,this,qv)._;let r=n,o=s;if(n>i||s>i){let a=n,l=s,c=Math.log2(Math.max(n,s)/i);const d=Math.floor(c);c=c===d?d-1:d;for(let n=0;n<c;n++){r=Math.ceil(a/2),o=Math.ceil(l/2);const n=new OffscreenCanvas(r,o);n.getContext("2d").drawImage(e,0,0,a,l,0,0,r,o),a=r,l=o,e!==t&&e.close(),e=n.transferToImageBitmap()}const u=Math.min(i/r,i/o);r=Math.round(r*u),o=Math.round(o*u)}const a=new OffscreenCanvas(r,o).getContext("2d",{willReadFrequently:!0});a.fillStyle="white",a.fillRect(0,0,r,o),a.filter="grayscale(1)",a.drawImage(e,0,0,e.width,e.height,0,0,r,o);const l=a.getImageData(0,0,r,o).data;return[pe(Oe,this,Vv).call(this,l),r,o]}Oe=Rv;var qv={_:{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}},zv={_:new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])};class Gv extends jg{constructor(){super(),super.updateProperties({fill:no._defaultLineColor,"stroke-width":0})}clone(){const e=new Gv;return e.updateAll(this),e}}class Kv extends kv{constructor(e){super(e),super.updateProperties({stroke:no._defaultLineColor,"stroke-width":1})}clone(){const e=new Kv(this._viewParameters);return e.updateAll(this),e}}var Jv=new WeakMap,Yv=new WeakMap,$v=new WeakMap,Xv=new WeakMap;class Qv extends Bg{constructor(e){super(a(a({},e),{},{mustBeCommitted:!0,name:"signatureEditor"})),he(this,Jv,!1),he(this,Yv,null),he(this,$v,null),he(this,Xv,null),this._willKeepAspectRatio=!0,ge($v,this,e.signatureData||null),ge(Yv,this,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){no.initialize(e,t),this._defaultDrawingOptions=new Gv,this._defaultDrawnSignatureOptions=new Kv(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Tt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!me(Yv,this)}}static computeTelemetryFinalData(e){var t,n;const s=e.get("hasDescription");return{hasAltText:null!==(t=s.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=s.get(!1))&&void 0!==n?n:0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),null===this._drawId)if(me($v,this)){const{lines:e,mustSmooth:t,areContours:n,description:s,uuid:i,heightInPage:r}=me($v,this),{rawDims:{pageWidth:o,pageHeight:a},rotation:l}=this.parent.viewport,c=Rv.processDrawnLines({lines:e,pageWidth:o,pageHeight:a,rotation:l,innerMargin:Qv._INNER_MARGIN,mustSmooth:t,areContours:n});this.addSignature(c,r,s,i)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:me(Yv,this)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){ge(Xv,this,e),this.addEditToolbar()}getUuid(){return me(Xv,this)}get description(){return me(Yv,this)}set description(e){ge(Yv,this,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{null===t||void 0===t||t.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:i}=me($v,this),r=Math.max(s,i);return{areContours:t,outline:Rv.processDrawnLines({lines:{curves:e.map(e=>({points:e})),thickness:n,width:s,height:i},pageWidth:r,pageHeight:r,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t}).outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:i,y:r}=this,{outline:o}=ge($v,this,e);let a;ge(Jv,this,o instanceof Pv),this.description=n,me(Jv,this)?a=Qv.getDefaultDrawingOptions():(a=Qv._defaultDrawnSignatureOptions.clone(),a.updateProperties({"stroke-width":o.thickness})),this._addOutlines({drawOutlines:o,drawingOptions:a});const[,l]=this.pageDimensions;let c=t/l;c=c>=1?.5:c,this.width*=c/this.height,this.width>=1&&(c*=.9/this.width,this.width=.9),this.height=c,this.setDims(),this.x=i,this.y=r,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return Rv.process(e,t,n,s,Qv._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:i}=this.parent.viewport;return Rv.extractContoursFromText(e,t,n,s,i,Qv._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return Rv.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:Qv._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions(e){let{areContours:t,thickness:n}=e;t?this._drawingOptions=Qv.getDefaultDrawingOptions():(this._drawingOptions=Qv._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,i=Object.assign(super.serialize(e),{isSignature:!0,areContours:me(Jv,this),color:[0,0,0],thickness:me(Jv,this)?0:s});return this.addComment(i),e?(i.paths={lines:t,points:n},i.uuid=me(Xv,this),i.isCopy=!0):i.lines=t,me(Yv,this)&&(i.accessibilityData={type:"Figure",alt:me(Yv,this)}),i}static deserializeDraw(e,t,n,s,i,r){return r.areContours?Pv.deserialize(e,t,n,s,i,r):xv.deserialize(e,t,n,s,i,r)}static async deserialize(e,t,n){var s;const i=await super.deserialize(e,t,n);return ge(Jv,i,e.areContours),i.description=(null===(s=e.accessibilityData)||void 0===s?void 0:s.alt)||"",ge(Xv,i,e.uuid),i}}r(Qv,"_type","signature"),r(Qv,"_editorType",Ye.SIGNATURE),r(Qv,"_defaultDrawingOptions",null);var Zv=new WeakMap,eb=new WeakMap,tb=new WeakMap,nb=new WeakMap,sb=new WeakMap,ib=new WeakMap,rb=new WeakMap,ob=new WeakMap,ab=new WeakMap,lb=new WeakMap,cb=new WeakMap,db=new WeakSet;class ub extends no{constructor(e){super(a(a({},e),{},{name:"stampEditor"})),ue(this,db),he(this,Zv,null),he(this,eb,null),he(this,tb,null),he(this,nb,null),he(this,sb,null),he(this,ib,""),he(this,rb,null),he(this,ob,!1),he(this,ab,null),he(this,lb,!1),he(this,cb,!1),ge(nb,this,e.bitmapUrl),ge(sb,this,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){no.initialize(e,t)}static isHandlingMimeForPasting(e){return gn.includes(e)}static paste(e,t){t.pasteEditor({mode:Ye.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!(null===(e=this.altTextData)||void 0===e||!e.altText)}}static computeTelemetryFinalData(e){var t,n;const s=e.get("hasAltText");return{hasAltText:null!==(t=s.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=s.get(!1))&&void 0!==n?n:0}}async mlGuessAltText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:i,height:r}=e||this.copyCanvas(null,null,!0).imageData,o=await n.guess({name:"altText",request:{data:s,width:i,height:r,channels:s.length/(i*r)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const a=o.output;return await this.setGuessedAltText(a),t&&!this.hasAltTextData()&&(this.altTextData={alt:a,decorative:!1}),a}remove(){var e;me(eb,this)&&(ge(Zv,this,null),this._uiManager.imageManager.deleteId(me(eb,this)),null===(e=me(rb,this))||void 0===e||e.remove(),ge(rb,this,null),me(ab,this)&&(clearTimeout(me(ab,this)),ge(ab,this,null)));super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(me(eb,this)&&null===me(rb,this)&&pe(db,this,fb).call(this),this.isAttachedToDOM||this.parent.add(this))):me(eb,this)&&pe(db,this,fb).call(this)}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(me(tb,this)||me(Zv,this)||me(nb,this)||me(sb,this)||me(eb,this)||me(ob,this))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),me(ob,this)||(me(Zv,this)?pe(db,this,mb).call(this):pe(db,this,fb).call(this)),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(ge(eb,this,n),s&&ge(Zv,this,s),ge(ob,this,!1),pe(db,this,mb).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==me(ab,this)&&clearTimeout(me(ab,this));ge(ab,this,setTimeout(()=>{ge(ab,this,null),pe(db,this,vb).call(this)},200))}copyCanvas(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=224);const{width:s,height:i}=me(Zv,this),r=new mn;let o=me(Zv,this),a=s,l=i,c=null;if(t){if(s>t||i>t){const e=Math.min(t/s,t/i);a=Math.floor(s*e),l=Math.floor(i*e)}c=document.createElement("canvas");const e=c.width=Math.ceil(a*r.sx),n=c.height=Math.ceil(l*r.sy);me(lb,this)||(o=pe(db,this,gb).call(this,e,n));const d=c.getContext("2d");d.filter=this._uiManager.hcmFilter;let u="white",h="#cfcfd8";"none"!==this._uiManager.hcmFilter?h="black":vn.isDarkMode&&(u="#8f8f9d",h="#42414d");const p=15,f=p*r.sx,m=p*r.sy,g=new OffscreenCanvas(2*f,2*m),v=g.getContext("2d");v.fillStyle=u,v.fillRect(0,0,2*f,2*m),v.fillStyle=h,v.fillRect(0,0,f,m),v.fillRect(f,m,f,m),d.fillStyle=d.createPattern(g,"repeat"),d.fillRect(0,0,e,n),d.drawImage(o,0,0,o.width,o.height,0,0,e,n)}let d=null;if(n){let t,n;if(r.symmetric&&o.width<e&&o.height<e)t=o.width,n=o.height;else if(o=me(Zv,this),s>e||i>e){const r=Math.min(e/s,e/i);t=Math.floor(s*r),n=Math.floor(i*r),me(lb,this)||(o=pe(db,this,gb).call(this,t,n))}const a=new OffscreenCanvas(t,n).getContext("2d",{willReadFrequently:!0});a.drawImage(o,0,0,o.width,o.height,0,0,t,n),d={width:t,height:n,data:a.getImageData(0,0,t,n).data}}return{canvas:c,width:a,height:l,imageData:d}}static async deserialize(e,t,n){let s=null,i=!1;if(e instanceof xf){var r;const{data:{rect:o,rotation:a,id:l,structParent:c,popupRef:d,richText:u,contentsObj:h,creationDate:p,modificationDate:f},container:m,parent:{page:{pageNumber:g}},canvas:v}=e;let b,y;v?(delete e.canvas,({id:b,bitmap:y}=n.imageManager.getFromCanvas(m.id,v)),v.remove()):(i=!0,e._hasNoCanvas=!0);const _=(null===(r=await t._structTree.getAriaAttributes("".concat(Gt).concat(l)))||void 0===r?void 0:r.get("aria-label"))||"";s=e={annotationType:Ye.STAMP,bitmapId:b,bitmap:y,pageIndex:g-1,rect:o.slice(0),rotation:a,annotationElementId:l,id:l,deleted:!1,accessibilityData:{decorative:!1,altText:_},isSvg:!1,structParent:c,popupRef:d,richText:u,comment:(null===h||void 0===h?void 0:h.str)||null,creationDate:p,modificationDate:f}}const o=await super.deserialize(e,t,n),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:d,isSvg:u,accessibilityData:h}=e;i?(n.addMissingCanvas(e.id,o),ge(ob,o,!0)):d&&n.imageManager.isValidId(d)?(ge(eb,o,d),l&&ge(Zv,o,l)):ge(nb,o,c),ge(lb,o,u);const[p,f]=o.pageDimensions;return o.width=(a[2]-a[0])/p,o.height=(a[3]-a[1])/f,h&&(o.altTextData=h),o._initialData=s,e.comment&&o.setCommentData(e),ge(cb,o,!!s),o}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:me(eb,this),isSvg:me(lb,this)});if(this.addComment(n),e)return n.bitmapUrl=pe(db,this,bb).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:i}=this.serializeAltText(!1);if(!s&&i&&(n.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const e=pe(db,this,yb).call(this,n);if(e.isSame)return null;var r;if(e.isSameAltText)delete n.accessibilityData;else n.accessibilityData.structParent=null!==(r=this._initialData.structParent)&&void 0!==r?r:-1;return n.id=this.annotationElementId,delete n.bitmapId,n}if(null===t)return n;t.stamps||(t.stamps=new Map);const o=me(lb,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(me(eb,this))){if(me(lb,this)){const e=t.stamps.get(me(eb,this));o>e.area&&(e.area=o,e.serialized.bitmap.close(),e.serialized.bitmap=pe(db,this,bb).call(this,!1))}}else t.stamps.set(me(eb,this),{area:o,serialized:n}),n.bitmap=pe(db,this,bb).call(this,!1);return n}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}function hb(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(ge(Zv,this,e.bitmap),t||(ge(eb,this,e.id),ge(lb,this,e.isSvg)),e.file&&ge(ib,this,e.file.name),pe(db,this,mb).call(this)):this.remove()}function pb(){if(ge(tb,this,null),this._uiManager.enableWaiting(!1),me(rb,this))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&me(Zv,this))this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&me(Zv,this)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch(e){}}this.div.focus()}}function fb(){if(me(eb,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(me(eb,this)).then(e=>pe(db,this,hb).call(this,e,!0)).finally(()=>pe(db,this,pb).call(this));if(me(nb,this)){const e=me(nb,this);return ge(nb,this,null),this._uiManager.enableWaiting(!0),void ge(tb,this,this._uiManager.imageManager.getFromUrl(e).then(e=>pe(db,this,hb).call(this,e)).finally(()=>pe(db,this,pb).call(this)))}if(me(sb,this)){const e=me(sb,this);return ge(sb,this,null),this._uiManager.enableWaiting(!0),void ge(tb,this,this._uiManager.imageManager.getFromFile(e).then(e=>pe(db,this,hb).call(this,e)).finally(()=>pe(db,this,pb).call(this)))}const e=document.createElement("input");e.type="file",e.accept=gn.join(",");const t=this._uiManager._signal;ge(tb,this,new Promise(n=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),pe(db,this,hb).call(this,t)}else this.remove();n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>pe(db,this,pb).call(this))),e.click()}function mb(){var e;const{div:t}=this;let{width:n,height:s}=me(Zv,this);const[i,r]=this.pageDimensions,o=.75;if(this.width)n=this.width*i,s=this.height*r;else if(n>o*i||s>o*r){const e=Math.min(o*i/n,o*r/s);n*=e,s*=e}this._uiManager.enableWaiting(!1);const a=ge(rb,this,document.createElement("canvas"));a.setAttribute("role","img"),this.addContainer(a),this.width=n/i,this.height=s/r,this.setDims(),null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),pe(db,this,vb).call(this),me(cb,this)||(this.parent.addUndoableEditor(this),ge(cb,this,!0)),this._reportTelemetry({action:"inserted_image"}),me(ib,this)&&this.div.setAttribute("aria-description",me(ib,this)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}function gb(e,t){const{width:n,height:s}=me(Zv,this);let i=n,r=s,o=me(Zv,this);for(;i>2*e||r>2*t;){const n=i,s=r;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const a=new OffscreenCanvas(i,r);a.getContext("2d").drawImage(o,0,0,n,s,0,0,i,r),o=a.transferToImageBitmap()}return o}function vb(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,i=new mn,r=Math.ceil(n*e*i.sx),o=Math.ceil(s*t*i.sy),a=me(rb,this);if(!a||a.width===r&&a.height===o)return;a.width=r,a.height=o;const l=me(lb,this)?me(Zv,this):pe(db,this,gb).call(this,r,o),c=a.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,r,o)}function bb(e){if(e){if(me(lb,this)){const e=this._uiManager.imageManager.getSvgUrl(me(eb,this));if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=me(Zv,this));return e.getContext("2d").drawImage(me(Zv,this),0,0),e.toDataURL()}if(me(lb,this)){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*Qt.PDF_TO_CSS_UNITS),s=Math.round(this.height*t*Qt.PDF_TO_CSS_UNITS),i=new OffscreenCanvas(n,s);return i.getContext("2d").drawImage(me(Zv,this),0,0,me(Zv,this).width,me(Zv,this).height,0,0,n,s),i.transferToImageBitmap()}return structuredClone(me(Zv,this))}function yb(e){var t;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,i=e.pageIndex===n,r=((null===(t=e.accessibilityData)||void 0===t?void 0:t.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&r,isSameAltText:r}}r(ub,"_type","stamp"),r(ub,"_editorType",Ye.STAMP);var _b=new WeakMap,wb=new WeakMap,xb=new WeakMap,Eb=new WeakMap,Sb=new WeakMap,Ab=new WeakMap,Cb=new WeakMap,kb=new WeakMap,Tb=new WeakMap,Nb=new WeakMap,Ib=new WeakMap,Pb=new WeakMap,Rb=new WeakMap,Mb=new WeakMap,Ob=new WeakMap,Db=new WeakMap,jb=new WeakSet;class Fb{constructor(e){let{uiManager:t,pageIndex:n,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:d}=e;ue(this,jb),he(this,_b,void 0),he(this,wb,!1),he(this,xb,null),he(this,Eb,null),he(this,Sb,null),he(this,Ab,new Map),he(this,Cb,!1),he(this,kb,!1),he(this,Tb,!1),he(this,Nb,null),he(this,Ib,null),he(this,Pb,null),he(this,Rb,null),he(this,Mb,null),he(this,Ob,-1),he(this,Db,void 0);const u=[...qb._.values()];if(!Fb._initialized){Fb._initialized=!0;for(const e of u)e.initialize(d,t)}t.registerEditorTypes(u),ge(Db,this,t),this.pageIndex=n,this.div=s,ge(_b,this,r),ge(xb,this,o),this.viewport=c,ge(Pb,this,l),this.drawLayer=a,this._structTree=i,me(Db,this).addLayer(this)}get isEmpty(){return 0===me(Ab,this).size}get isInvisible(){return this.isEmpty&&me(Db,this).getMode()===Ye.NONE}updateToolbar(e){me(Db,this).updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me(Db,this).getMode();switch(pe(jb,this,Hb).call(this),e){case Ye.NONE:return this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case Ye.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ye.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ye.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of qb._.values())t.toggle("".concat(n._type,"Editing"),e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===(null===(t=me(Pb,this))||void 0===t?void 0:t.div)}setEditingState(e){me(Db,this).setEditingState(e)}addCommands(e){me(Db,this).addCommands(e)}cleanUndoStack(e){me(Db,this).cleanUndoStack(e)}toggleDrawing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!e)}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=me(xb,this))||void 0===e||e.togglePointerEvents(t)}async enable(){var e;ge(Tb,this,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),null===(e=me(Mb,this))||void 0===e||e.abort(),ge(Mb,this,null);const t=new Set;for(const s of fe(jb,this,Lb))s.enableEditing(),s.show(!0),s.annotationElementId&&(me(Db,this).removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const n=me(xb,this);if(n)for(const s of n.getEditableAnnotations()){if(s.hide(),me(Db,this).isDeletedAnnotationElement(s.data.id))continue;if(t.has(s.data.id))continue;const e=await this.deserialize(s);e&&(this.addOrRebuild(e),e.enableEditing())}ge(Tb,this,!1),me(Db,this)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(ge(kb,this,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),me(Pb,this)&&!me(Mb,this)){ge(Mb,this,new AbortController);const e=me(Db,this).combinedSignal(me(Mb,this));me(Pb,this).div.addEventListener("pointerdown",e=>{const{clientX:t,clientY:n,timeStamp:s}=e;if(s-me(Ob,this)>500)return void ge(Ob,this,s);ge(Ob,this,-1);const{classList:i}=this.div;i.toggle("getElements",!0);const r=document.elementsFromPoint(t,n);if(i.toggle("getElements",!1),!this.div.contains(r[0]))return;let o;const a=new RegExp("^".concat(Je,"[0-9]+$"));for(const c of r)if(a.test(c.id)){o=c.id;break}if(!o)return;const l=me(Ab,this).get(o);null===(null===l||void 0===l?void 0:l.annotationElementId)&&(e.stopPropagation(),e.preventDefault(),l.dblclick(e))},{signal:e,capture:!0})}const e=me(xb,this),t=[];if(e){const s=new Map,i=new Map;for(const e of fe(jb,this,Lb)){var n;e.disableEditing(),e.annotationElementId?null===e.serialize()?(i.set(e.annotationElementId,e),null===(n=this.getEditableAnnotation(e.annotationElementId))||void 0===n||n.show(),e.remove()):s.set(e.annotationElementId,e):t.push(e)}const r=e.getEditableAnnotations();for(const e of r){const{id:t}=e.data;if(me(Db,this).isDeletedAnnotationElement(t)){e.updateEdited({deleted:!0});continue}let n=i.get(t);n?(n.resetAnnotationElement(e),n.show(!1),e.show()):(n=s.get(t),n&&(me(Db,this).addChangedExistingAnnotation(n),n.renderAnnotationElement(e)&&n.show(!1)),e.show())}}pe(jb,this,Hb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of qb._.values())s.remove("".concat(i._type,"Editing"));this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),null===e||void 0===e||e.updateFakeAnnotations(t),ge(kb,this,!1)}getEditableAnnotation(e){var t;return(null===(t=me(xb,this))||void 0===t?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){me(Db,this).getActive()!==e&&me(Db,this).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,null!==(e=me(Pb,this))&&void 0!==e&&e.div&&!me(Rb,this)){ge(Rb,this,new AbortController);const e=me(Db,this).combinedSignal(me(Rb,this));me(Pb,this).div.addEventListener("pointerdown",pe(jb,this,Ub).bind(this),{signal:e}),me(Pb,this).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,null!==(e=me(Pb,this))&&void 0!==e&&e.div&&me(Rb,this)&&(me(Rb,this).abort(),ge(Rb,this,null),me(Pb,this).div.classList.remove("highlighting"))}enableClick(){if(me(Eb,this))return;ge(Eb,this,new AbortController);const e=me(Db,this).combinedSignal(me(Eb,this));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;null===(e=me(Eb,this))||void 0===e||e.abort(),ge(Eb,this,null)}attach(e){me(Ab,this).set(e.id,e);const{annotationElementId:t}=e;t&&me(Db,this).isDeletedAnnotationElement(t)&&me(Db,this).removeDeletedAnnotationElement(e)}detach(e){var t;me(Ab,this).delete(e.id),null===(t=me(_b,this))||void 0===t||t.removePointerInTextLayer(e.contentDiv),!me(kb,this)&&e.annotationElementId&&me(Db,this).addDeletedAnnotationElement(e)}remove(e){this.detach(e),me(Db,this).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(me(Db,this).addDeletedAnnotationElement(e),no.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),null===(t=e.parent)||void 0===t||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),me(Db,this).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!me(Tb,this)),me(Db,this).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var t;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!me(Sb,this)&&(e._focusEventsAllowed=!1,ge(Sb,this,setTimeout(()=>{ge(Sb,this,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:me(Db,this)._signal}),n.focus())},0))),e._structTreeParentId=null===(t=me(_b,this))||void 0===t?void 0:t.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getEditorByUID(e){for(const t of me(Ab,this).values())if(t.uid===e)return t;return null}getNextId(){return me(Db,this).getId()}combinedSignal(e){return me(Db,this).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return null===(e=fe(jb,this,Bb))||void 0===e?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await me(Db,this).updateMode(e.mode);const{offsetX:n,offsetY:s}=pe(jb,this,Wb).call(this),i=this.getNextId(),r=pe(jb,this,Vb).call(this,a({parent:this,id:i,x:n,y:s,uiManager:me(Db,this),isCentered:!0},t));r&&this.add(r)}async deserialize(e){var t,n;return await(null===(t=qb._.get(null!==(n=e.annotationType)&&void 0!==n?n:e.annotationEditorType))||void 0===t?void 0:t.deserialize(e,this,me(Db,this)))||null}createAndAddNewEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=this.getNextId(),i=pe(jb,this,Vb).call(this,a({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:me(Db,this),isCentered:t},n));return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.createAndAddNewEditor(pe(jb,this,Wb).call(this),!0,e)}setSelected(e){me(Db,this).setSelected(e)}toggleSelected(e){me(Db,this).toggleSelected(e)}unselect(e){me(Db,this).unselect(e)}pointerup(e){var t;const{isMac:n}=Lt.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(!me(Cb,this))return;if(ge(Cb,this,!1),null!==(t=fe(jb,this,Bb))&&void 0!==t&&t.isDrawer&&fe(jb,this,Bb).supportMultipleDrawings)return;if(!me(wb,this))return void ge(wb,this,!0);const s=me(Db,this).getMode();s!==Ye.STAMP&&s!==Ye.SIGNATURE?this.createAndAddNewEditor(e,!1):me(Db,this).unselectAll()}pointerdown(e){var t;if(me(Db,this).getMode()===Ye.HIGHLIGHT&&this.enableTextSelection(),me(Cb,this))return void ge(Cb,this,!1);const{isMac:n}=Lt.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(ge(Cb,this,!0),null!==(t=fe(jb,this,Bb))&&void 0!==t&&t.isDrawer)return void this.startDrawingSession(e);const s=me(Db,this).getActive();ge(wb,this,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),me(Nb,this))return void fe(jb,this,Bb).startDrawing(this,me(Db,this),!1,e);me(Db,this).setCurrentDrawingSession(this),ge(Nb,this,new AbortController);const t=me(Db,this).combinedSignal(me(Nb,this));this.div.addEventListener("blur",e=>{let{relatedTarget:t}=e;t&&!this.div.contains(t)&&(ge(Ib,this,null),this.commitOrRemove())},{signal:t}),fe(jb,this,Bb).startDrawing(this,me(Db,this),!1,e)}pause(e){if(e){const{activeElement:e}=document;return void(this.div.contains(e)&&ge(Ib,this,e))}me(Ib,this)&&setTimeout(()=>{var e;null===(e=me(Ib,this))||void 0===e||e.focus(),ge(Ib,this,null)},0)}endDrawingSession(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return me(Nb,this)?(me(Db,this).setCurrentDrawingSession(null),me(Nb,this).abort(),ge(Nb,this,null),ge(Ib,this,null),fe(jb,this,Bb).endDrawing(e)):null}findNewParent(e,t,n){const s=me(Db,this).findParent(t,n);return null!==s&&s!==this&&(s.changeParent(e),!0)}commitOrRemove(){return!!me(Nb,this)&&(this.endDrawingSession(),!0)}onScaleChanging(){me(Nb,this)&&fe(jb,this,Bb).onScaleChangingWhenDrawing(this)}destroy(){var e;this.commitOrRemove(),(null===(e=me(Db,this).getActive())||void 0===e?void 0:e.parent)===this&&(me(Db,this).commitOrRemove(),me(Db,this).setActiveEditor(null)),me(Sb,this)&&(clearTimeout(me(Sb,this)),ge(Sb,this,null));for(const n of me(Ab,this).values()){var t;null===(t=me(_b,this))||void 0===t||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove()}this.div=null,me(Ab,this).clear(),me(Db,this).removeLayer(this)}render(e){let{viewport:t}=e;this.viewport=t,fn(this.div,t);for(const n of me(Db,this).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update(e){let{viewport:t}=e;me(Db,this).commitOrRemove(),pe(jb,this,Hb).call(this);const n=this.viewport.rotation,s=t.rotation;if(this.viewport=t,fn(this.div,{rotation:s}),n!==s)for(const i of me(Ab,this).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return me(Db,this).viewParameters.realScale}}function Lb(e){return 0!==me(Ab,e).size?me(Ab,e).values():me(Db,e).getEditors(e.pageIndex)}function Ub(e){me(Db,this).unselectAll();const{target:t}=e;if(t===me(Pb,this).div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&me(Pb,this).div.contains(t)){const{isMac:t}=Lt.platform;if(0!==e.button||e.ctrlKey&&t)return;me(Db,this).showAllEditors("highlight",!0,!0),me(Pb,this).div.classList.add("free"),this.toggleDrawing(),bg.startHighlighting(this,"ltr"===me(Db,this).direction,{target:me(Pb,this).div,x:e.x,y:e.y}),me(Pb,this).div.addEventListener("pointerup",()=>{me(Pb,this).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:me(Db,this)._signal}),e.preventDefault()}}function Bb(e){return qb._.get(me(Db,e).getMode())}function Vb(e){const t=fe(jb,this,Bb);return t?new t.prototype.constructor(e):null}function Wb(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,i=Math.max(0,e),r=Math.max(0,t),o=(i+Math.min(window.innerWidth,e+n))/2-e,a=(r+Math.min(window.innerHeight,t+s))/2-t,[l,c]=this.viewport.rotation%180===0?[o,a]:[a,o];return{offsetX:l,offsetY:c}}function Hb(){for(const e of me(Ab,this).values())e.isEmpty()&&e.remove()}r(Fb,"_initialized",!1);var qb={_:new Map([zf,Nv,ub,bg,Qv].map(e=>[e._editorType,e]))},zb=new WeakMap,Gb=new WeakMap,Kb=new WeakMap,Jb=new WeakSet;class Yb{constructor(e){let{pageIndex:t}=e;ue(this,Jb),he(this,zb,null),he(this,Gb,new Map),he(this,Kb,new Map),this.pageIndex=t}setParent(e){if(me(zb,this)){if(me(zb,this)!==e){if(me(Gb,this).size>0)for(const t of me(Gb,this).values())t.remove(),e.append(t);ge(zb,this,e)}}else ge(zb,this,e)}static get _svgFactory(){return Tt(this,"_svgFactory",new Vh)}draw(e){var t,n;let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=(ey._=(t=ey._,n=t++,t),n),o=pe(Jb,this,Xb).call(this),a=Yb._svgFactory.createElement("defs");o.append(a);const l=Yb._svgFactory.createElement("path");a.append(l);const c="path_p".concat(this.pageIndex,"_").concat(r);l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),s&&me(Kb,this).set(r,l);const d=i?pe(Jb,this,Qb).call(this,a,c):null,u=Yb._svgFactory.createElement("use");return o.append(u),u.setAttribute("href","#".concat(c)),this.updateProperties(o,e),me(Gb,this).set(r,o),{id:r,clipPathId:"url(#".concat(d,")")}}drawOutline(e,t){var n,s;const i=(ey._=(n=ey._,s=n++,n),s),r=pe(Jb,this,Xb).call(this),o=Yb._svgFactory.createElement("defs");r.append(o);const a=Yb._svgFactory.createElement("path");o.append(a);const l="path_p".concat(this.pageIndex,"_").concat(i);let c;if(a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t){const e=Yb._svgFactory.createElement("mask");o.append(e),c="mask_p".concat(this.pageIndex,"_").concat(i),e.setAttribute("id",c),e.setAttribute("maskUnits","objectBoundingBox");const t=Yb._svgFactory.createElement("rect");e.append(t),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill","white");const n=Yb._svgFactory.createElement("use");e.append(n),n.setAttribute("href","#".concat(l)),n.setAttribute("stroke","none"),n.setAttribute("fill","black"),n.setAttribute("fill-rule","nonzero"),n.classList.add("mask")}const d=Yb._svgFactory.createElement("use");r.append(d),d.setAttribute("href","#".concat(l)),c&&d.setAttribute("mask","url(#".concat(c,")"));const u=d.cloneNode();return r.append(u),d.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(r,e),me(Gb,this).set(i,r),i}finalizeDraw(e,t){me(Kb,this).delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:i,path:r}=t,o="number"===typeof e?me(Gb,this).get(e):e;if(o){if(n&&pe(Jb,this,Zb).call(this,o,n),s&&$b.call(Yb,o,s),i){const{classList:e}=o;for(const[t,n]of Object.entries(i))e.toggle(t,n)}if(r){const e=o.firstElementChild.firstElementChild;pe(Jb,this,Zb).call(this,e,r)}}}updateParent(e,t){if(t===this)return;const n=me(Gb,this).get(e);n&&(me(zb,t).append(n),me(Gb,this).delete(e),me(Gb,t).set(e,n))}remove(e){me(Kb,this).delete(e),null!==me(zb,this)&&(me(Gb,this).get(e).remove(),me(Gb,this).delete(e))}destroy(){ge(zb,this,null);for(const e of me(Gb,this).values())e.remove();me(Gb,this).clear(),me(Kb,this).clear()}}function $b(e,t){let[n,s,i,r]=t;const{style:o}=e;o.top="".concat(100*s,"%"),o.left="".concat(100*n,"%"),o.width="".concat(100*i,"%"),o.height="".concat(100*r,"%")}function Xb(){const e=De._svgFactory.create(1,1,!0);return me(zb,this).append(e),e.setAttribute("aria-hidden",!0),e}function Qb(e,t){const n=De._svgFactory.createElement("clipPath");e.append(n);const s="clip_".concat(t);n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const i=De._svgFactory.createElement("use");return n.append(i),i.setAttribute("href","#".concat(t)),i.classList.add("clip"),s}function Zb(e,t){for(const[n,s]of Object.entries(t))null===s?e.removeAttribute(n):e.setAttribute(n,s)}De=Yb;var ey={_:0};globalThis._pdfjsTestingUtils={HighlightOutliner:Wm},globalThis.pdfjsLib={AbortException:Dt,AnnotationEditorLayer:Fb,AnnotationEditorParamsType:$e,AnnotationEditorType:Ye,AnnotationEditorUIManager:fi,AnnotationLayer:jf,AnnotationMode:Ke,AnnotationType:ot,applyOpacity:function(e,t,n,s){const i=255*(1-(s=Math.min(Math.max(null!==s&&void 0!==s?s:1,0),1)));return[e=Math.round(e*s+i),t=Math.round(t*s+i),n=Math.round(n*s+i)]},build:"50cc4adac",ColorPicker:Sh,createValidAbsoluteUrl:Ct,CSSConstants:class{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Tt(this,"commentForegroundColor",un(n))}},DOMSVGFactory:Vh,DrawLayer:Yb,FeatureTest:Lt,fetchData:Zt,findContrastColor:function(e,t){const n=e[0]+256*e[1]+65536*e[2]+16777216*t[0]+4294967296*t[1]+1099511627776*t[2];let s=xn.get(n);if(s)return s;const i=new Float32Array(9),r=i.subarray(0,3),o=i.subarray(3,6);bn(e,o);const a=i.subarray(6,9);bn(t,a);const l=a[2]<.5,c=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),wn(o,a,r)<c){let e,t;l?(e=o[2],t=1):(e=0,t=o[2]);const n=.005;for(;t-e>n;){const n=o[2]=(e+t)/2;l===wn(o,a,r)<c?e=n:t=n}o[2]=l?t:e}return yn(o,r),s=Bt.makeHexColor(Math.round(255*r[0]),Math.round(255*r[1]),Math.round(255*r[2])),xn.set(n,s),s},getDocument:Au,getFilenameFromUrl:function(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)},getPdfFilenameFromUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(nn(e))return Et('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(e=>{try{return new URL(e)}catch(t){try{return new URL(decodeURIComponent(e))}catch(n){try{return new URL(e,"https://foo.bar")}catch(s){try{return new URL(decodeURIComponent(e),"https://foo.bar")}catch(i){return null}}}}})(e);if(!n)return t;const s=e=>{try{let t=decodeURIComponent(e);return t.includes("/")?(t=t.split("/").at(-1),t.test(/^\.pdf$/i)?t:e):t}catch(t){return e}},i=/\.pdf$/i,r=n.pathname.split("/").at(-1);if(i.test(r))return s(r);if(n.searchParams.size>0){const e=Array.from(n.searchParams.values()).reverse();for(const n of e)if(i.test(n))return s(n);const t=Array.from(n.searchParams.keys()).reverse();for(const n of t)if(i.test(n))return s(n)}if(n.hash){const e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(e)return s(e[0])}return t},getRGB:un,getUuid:zt,getXfaPageViewport:function(e,t){let{scale:n=1,rotation:s=0}=t;const{width:i,height:r}=e.attributes.style,o=[0,0,parseInt(i),parseInt(r)];return new en({viewBox:o,userUnit:1,scale:n,rotation:s})},GlobalWorkerOptions:td,ImageKind:rt,InvalidPDFException:Rt,isDataScheme:nn,isPdfFile:sn,isValidExplicitDest:Ca,MathClamp:Kt,noContextMenu:an,normalizeUnicode:function(e){return Ht||(Ht=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,qt=new Map([["\ufb05","\u017ft"]])),e.replaceAll(Ht,(e,t,n)=>t?t.normalize("NFKC"):qt.get(n))},OPS:pt,OutputScale:mn,PasswordResponses:{NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PDFDataRangeTransport:Mu,PDFDateString:cn,PDFWorker:qu,PermissionFlag:{PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},PixelsPerInch:Qt,RenderingCancelledException:tn,renderRichText:En,ResponseException:Mt,setLayerDimensions:fn,shadow:Tt,SignatureExtractor:Rv,stopEvent:ln,SupportedImageMimeTypes:gn,TextLayer:hu,TouchManager:Ar,updateUrlHash:kt,Util:Bt,VerbosityLevel:ht,version:hh,XfaLayer:$t};var ty=n(1257),ny=n.n(ty);function sy(e){return e.replace(/\D/g,"")}function iy(e){try{if(e.match(/\d{4}[-/]\d{2}[-/]\d{2}/)){const[t,n,s]=e.replace(/\//g,"-").split("-");return"".concat(t,"-").concat(n,"-").concat(s)}const[t,n,s]=e.replace(/\//g,"-").split("-");if(parseInt(s)>1900&&parseInt(n)>0&&parseInt(n)<=12&&parseInt(t)>0&&parseInt(t)<=31)return"".concat(s,"-").concat(n.padStart(2,"0"),"-").concat(t.padStart(2,"0"))}catch(t){return null}return null}async function ry(e){try{console.log("[OCR] Iniciando processamento de:",e.name);const t=await async function(e){console.log("[OCR] Iniciando extra\xe7\xe3o de PDF:",e.name);const t=await e.arrayBuffer(),n=await Au({data:t}).promise;let s="";for(let i=1;i<=Math.min(n.numPages,10);i++){const e=await n.getPage(i),t=e.getViewport({scale:2}),r=document.createElement("canvas"),o=r.getContext("2d");o&&(r.width=t.width,r.height=t.height,await e.render({canvasContext:o,viewport:t}).promise,console.log("[OCR] Processando p\xe1gina ".concat(i,"/").concat(n.numPages,"...")),s+=(await ny().recognize(r,"por+eng",{logger:e=>{"recognizing"===e.status&&console.log("[OCR] P\xe1gina ".concat(i,": ").concat(Math.round(100*e.progress),"%"))}})).data.text+"\n")}return console.log("[OCR] Extra\xe7\xe3o completa, tamanho:",s.length),s}(e),n=function(e){var t;const n={confidence:.5,rawText:e,valores:{},responsaveis:[],cpfs:[],datas:[],documentos_fiscais:[],contratos:[]},s=e.match(/(\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2})/);s&&(n.cnpj=s[1].replace(/\D/g,""),console.log("[OCR] CNPJ detectado:",n.cnpj));const i=e.matchAll(/(\d{3}\.?\d{3}\.?\d{3}-?\d{2})/g);for(const p of i){const e=sy(p[1]);n.cpfs.includes(e)||n.cpfs.push(e)}console.log("[OCR] CPFs detectados:",n.cpfs);const r=e.matchAll(/(\d{1,2}[-/]\d{1,2}[-/]\d{4}|\d{4}[-/]\d{1,2}[-/]\d{1,2})/g);for(const p of r){const e=iy(p[1]);e&&!n.datas.includes(e)&&n.datas.push(e)}console.log("[OCR] Datas detectadas:",n.datas);const o=e.match(/R\$[\s]*([\d.,]+)/gi);if(o){const e=o.map(e=>parseFloat(e.replace(/[^\d,]/g,"").replace(",",".")));e.length>0&&(n.valores.despesas=e.reduce((e,t)=>e+t,0)/e.length,console.log("[OCR] Valores detectados:",e))}const a=e.match(/(\d{4})/);a&&(n.ano=parseInt(a[1]),console.log("[OCR] Ano detectado:",n.ano));const l=["janeiro","fevereiro","mar\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];for(let p=0;p<l.length;p++)if(e.toLowerCase().includes(l[p])){n.mes=p+1,console.log("[OCR] M\xeas detectado:",n.mes,l[p]);break}(e.toLowerCase().includes("presta\xe7\xe3o")||e.toLowerCase().includes("contas"))&&(n.mes=12,console.log("[OCR] Detectado presta\xe7\xe3o de contas - for\xe7ando m\xeas 12"));const c=e.match(/(35\d{5})/);c&&(n.municipio=parseInt(c[1]),console.log("[OCR] Munic\xedpio detectado:",n.municipio));const d={responsaveis:["respons\xe1vel","diretor","presidente","gestor","ordenador"],documentos:["nf","nota fiscal","recibo","comprovante","fatura"],contratos:["contrato","termo","acordo","licita\xe7\xe3o"]},u=e.split("\n");for(const p of u)for(const[e,t]of Object.entries(d))t.some(e=>p.toLowerCase().includes(e))&&("responsaveis"!==e||n.responsaveis.includes(p.trim())?"documentos"!==e||n.documentos_fiscais.includes(p.trim())?"contratos"!==e||n.contratos.includes(p.trim())||n.contratos.push(p.trim()):n.documentos_fiscais.push(p.trim()):n.responsaveis.push(p.trim()));const h=[n.cnpj,n.ano,n.mes,n.cpfs&&n.cpfs.length>0,n.datas&&n.datas.length>0,null===(t=n.valores)||void 0===t?void 0:t.despesas].filter(Boolean).length;return n.confidence=Math.min(.95,h/6),console.log("[OCR] Confian\xe7a da extra\xe7\xe3o:",Math.round(100*n.confidence)+"%"),n}(t);return n}catch(t){throw console.error("[OCR] Erro ao processar PDF:",t),new Error("Erro ao processar PDF: ".concat(t instanceof Error?t.message:"Desconhecido"))}}function oy(e){var t,n;return{descritor:{municipio:e.municipio,entidade:e.entidade||1,ano:e.ano,mes:e.mes||12},dados_gerais_entidade_beneficiaria:{cnpj:e.cnpj,razao_social:e.razao_social},receitas:{repasses_recebidos:(null===(t=e.valores)||void 0===t?void 0:t.repasses)||0},disponibilidades:{saldos:[{saldo_bancario:(null===(n=e.valores)||void 0===n?void 0:n.disponibilidades)||0}]},extraction_metadata:{source:"PDF_OCR",confidence:e.confidence,timestamp:(new Date).toISOString(),extracted_cpfs:e.cpfs,extracted_datas:e.datas,raw_text_preview:e.rawText.substring(0,500)}}}"undefined"!==typeof window&&(td.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@".concat(hh,"/build/pdf.worker.min.js"));const ay=t=>{var n;let{onDataExtracted:s,onError:i,sectionType:r,label:o="Carregar PDF"}=t;const[a,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(0),[u,h]=(0,e.useState)(null),p=(0,e.useRef)(null);return(0,L.jsxs)("div",{className:"space-y-3",children:[(0,L.jsxs)("div",{className:"relative",children:[(0,L.jsx)("input",{ref:p,type:"file",accept:".pdf",onChange:async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n)if(n.type.includes("pdf")){l(!0),d(0);try{console.log("[PDFUploader] Iniciando processamento: ".concat(n.name));const e=setInterval(()=>{d(t=>t>=90?(clearInterval(e),90):t+20*Math.random())},500),t=await ry(n);clearInterval(e),d(100);const i=oy(t);h(t),s(t,i),console.log("[PDFUploader] Processamento conclu\xeddo:",t),console.log("[PDFUploader] Confian\xe7a: ".concat(Math.round(100*t.confidence),"%")),p.current&&(p.current.value=""),setTimeout(()=>{l(!1),d(0)},3e3)}catch(r){l(!1);const e=r instanceof Error?r.message:"Erro desconhecido ao processar PDF";i(e),console.error("[PDFUploader] Erro:",r)}}else i("Por favor, selecione um arquivo PDF v\xe1lido")},disabled:a,className:"sr-only"}),(0,L.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.click()},disabled:a,className:"w-full px-4 py-3 rounded-lg border-2 border-dashed transition-colors ".concat(a?"border-blue-300 bg-blue-50 text-blue-600":"border-slate-300 bg-slate-50 hover:border-blue-400 hover:bg-blue-50 text-slate-600 hover:text-blue-600"),children:a?(0,L.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,L.jsx)("div",{className:"animate-spin",children:"\u23f3"}),(0,L.jsxs)("span",{children:["Processando PDF... ",Math.round(c),"%"]})]}):u?(0,L.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,L.jsx)("span",{children:"\u2713"}),(0,L.jsx)("span",{children:"PDF Carregado com Sucesso!"})]}):(0,L.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,L.jsx)("span",{children:"\ud83d\udcc4"}),(0,L.jsx)("span",{children:o})]})})]}),a&&(0,L.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2 overflow-hidden",children:(0,L.jsx)("div",{className:"bg-blue-500 h-full transition-all duration-300",style:{width:"".concat(c,"%")}})}),u&&(0,L.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-sm",children:[(0,L.jsxs)("p",{className:"font-semibold text-green-900 mb-2",children:["\u2713 Dados Extra\xeddos (",Math.round(100*u.confidence),"% confian\xe7a)"]}),(0,L.jsxs)("div",{className:"space-y-1 text-green-800 text-xs",children:[u.cnpj&&(0,L.jsxs)("p",{children:["\u2022 CNPJ: ",u.cnpj]}),u.municipio&&(0,L.jsxs)("p",{children:["\u2022 Munic\xedpio: ",u.municipio]}),u.ano&&(0,L.jsxs)("p",{children:["\u2022 Ano: ",u.ano]}),u.mes&&(0,L.jsxs)("p",{children:["\u2022 M\xeas: ",u.mes]}),u.cpfs&&u.cpfs.length>0&&(0,L.jsxs)("p",{children:["\u2022 CPFs encontrados: ",u.cpfs.length]}),u.datas&&u.datas.length>0&&(0,L.jsxs)("p",{children:["\u2022 Datas encontradas: ",u.datas.length]}),(null===(n=u.valores)||void 0===n?void 0:n.despesas)&&(0,L.jsxs)("p",{children:["\u2022 Valor m\xe9dio: R$ ",u.valores.despesas.toFixed(2)]})]}),u.confidence<.6&&(0,L.jsx)("p",{className:"mt-2 text-yellow-700 text-xs bg-yellow-100 p-2 rounded",children:"\u26a0\ufe0f Baixa confian\xe7a na extra\xe7\xe3o. Revise os dados preenchidos."})]}),(0,L.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2 text-xs text-blue-700",children:[(0,L.jsx)("p",{className:"font-semibold mb-1",children:"\ud83d\udca1 Dica:"}),(0,L.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[(0,L.jsx)("li",{children:"PDF deve estar leg\xedvel e em portugu\xeas"}),(0,L.jsx)("li",{children:"Documentos escaneados funcionam melhor"}),(0,L.jsx)("li",{children:"At\xe9 10 p\xe1ginas ser\xe3o analisadas"}),(0,L.jsx)("li",{children:"Os dados extra\xeddos preencher\xe3o automaticamente o formul\xe1rio"})]})]})]})},ly=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"mb-6 p-4 bg-purple-50 border-2 border-purple-200 rounded-lg",children:[(0,L.jsx)("p",{className:"text-sm font-semibold text-purple-800 mb-2",children:"\ud83d\udcc4 Extrair Contratos de PDF"}),(0,L.jsx)("p",{className:"text-xs text-purple-700 mb-3",children:"Carregue um PDF com dados de contratos para pr\xe9-preenchimento autom\xe1tico:"}),(0,L.jsx)(ay,{onDataExtracted:(e,t)=>{const n=oy(e);n.contratos&&Array.isArray(n.contratos)&&(n.contratos.forEach(e=>s(e)),console.log("\u2713 ".concat(n.contratos.length," contrato(s) adicionado(s) com ").concat(Math.round(100*t),"% confian\xe7a")))},onError:e=>alert("\u274c Erro: ".concat(e))})]}),(0,L.jsx)(te,{title:"6. Contratos",items:t.contratos||[],newItemTemplate:{numero:"",credor:{documento_numero:"",nome:"",documento_tipo:2},valor_montante:0,data_assinatura:"",objeto:"",natureza_contratacao:[],criterio_selecao:1,valor_tipo:2,vigencia_tipo:1,vigencia_data_inicial:""},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"contratos",renderItem:(e,t,n)=>{var s,i;return(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,L.jsx)(ne,{label:"N\xfamero Contrato",value:e.numero,onChange:e=>n("numero",e)}),(0,L.jsx)(ne,{label:"Data Assinatura",type:"date",value:e.data_assinatura,onChange:e=>n("data_assinatura",e)}),(0,L.jsx)(ne,{label:"Vig\xeancia Inicial",type:"date",value:e.vigencia_data_inicial,onChange:e=>n("vigencia_data_inicial",e)}),(0,L.jsx)(ne,{label:"Valor Global (R$)",type:"number",value:e.valor_montante,onChange:e=>n("valor_montante",e)}),(0,L.jsx)("div",{className:"col-span-2",children:(0,L.jsx)(ne,{label:"Objeto",value:e.objeto,onChange:e=>n("objeto",e)})}),(0,L.jsxs)("div",{className:"col-span-2 p-3 bg-blue-50/50 border border-blue-100 rounded",children:[(0,L.jsx)("h4",{className:"text-[10px] font-bold uppercase text-blue-800 mb-2",children:"Credor"}),(0,L.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,L.jsx)(ne,{label:"CNPJ/CPF",value:null===(s=e.credor)||void 0===s?void 0:s.documento_numero,onChange:e=>n("credor.documento_numero",e)}),(0,L.jsx)(ne,{label:"Nome/Raz\xe3o Social",value:null===(i=e.credor)||void 0===i?void 0:i.nome,onChange:e=>n("credor.nome",e)})]})]})]})}})]})},cy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i,fullData:r}=e;const o=r.contratos||[];return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"mb-6 p-4 bg-cyan-50 border-2 border-cyan-200 rounded-lg",children:[(0,L.jsx)("p",{className:"text-sm font-semibold text-cyan-800 mb-2",children:"\ud83d\udcc4 Extrair Documentos Fiscais de PDF"}),(0,L.jsx)("p",{className:"text-xs text-cyan-700 mb-3",children:"Carregue um PDF com notas fiscais para pr\xe9-preenchimento autom\xe1tico:"}),(0,L.jsx)(ay,{onDataExtracted:(e,t)=>{const n=oy(e);n.documentos_fiscais&&Array.isArray(n.documentos_fiscais)&&(n.documentos_fiscais.forEach(e=>s(e)),console.log("\u2713 ".concat(n.documentos_fiscais.length," documento(s) fiscal(is) adicionado(s)")))},onError:e=>alert("\u274c Erro: ".concat(e))})]}),(0,L.jsx)(te,{title:"7. Documentos Fiscais",items:t.documentos_fiscais||[],newItemTemplate:{numero:"",data_emissao:"",valor_bruto:0,credor:{documento_numero:"",documento_tipo:2},descricao:"",estado_emissor:35,categoria_despesas_tipo:1,rateio_proveniente_tipo:2},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"documentos_fiscais",renderItem:(e,t,n)=>{var s,i,r;return(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"N\xfamero Nota/Recibo",value:e.numero,onChange:e=>n("numero",e)}),(0,L.jsx)(ne,{label:"Data Emiss\xe3o",type:"date",value:e.data_emissao,onChange:e=>n("data_emissao",e)}),(0,L.jsx)(ne,{label:"Valor Bruto (R$)",type:"number",value:e.valor_bruto,onChange:e=>n("valor_bruto",e)}),(0,L.jsx)("div",{className:"col-span-3 bg-amber-50 p-3 rounded border border-amber-100",children:(0,L.jsx)(ee,{label:"Vincular a Contrato Existente",children:(0,L.jsxs)("select",{className:W,value:(null===(s=e.identificacao_contrato)||void 0===s?void 0:s.numero)||"",onChange:t=>{const s=t.target.value,i=o.find(e=>e.numero===s);var r;i?(n("identificacao_contrato",{numero:s,data_assinatura:i.data_assinatura,identificacao_credor:i.credor}),null!==(r=e.credor)&&void 0!==r&&r.documento_numero||n("credor",i.credor)):n("identificacao_contrato",void 0)},children:[(0,L.jsx)("option",{value:"",children:"-- Sem V\xednculo Contratual --"}),o.map(e=>(0,L.jsxs)("option",{value:e.numero,children:["Contrato ",e.numero," - ",e.credor.nome]},e.numero))]})})}),(0,L.jsxs)("div",{className:"col-span-3 grid grid-cols-2 gap-4",children:[(0,L.jsx)(ne,{label:"CNPJ/CPF Emitente",value:null===(i=e.credor)||void 0===i?void 0:i.documento_numero,onChange:e=>n("credor.documento_numero",e)}),(0,L.jsx)(ne,{label:"Nome Emitente",value:null===(r=e.credor)||void 0===r?void 0:r.nome,onChange:e=>n("credor.nome",e)})]})]})}})]})},dy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i,fullData:r}=e;const o=r.documentos_fiscais||[];return(0,L.jsx)(te,{title:"8. Pagamentos",items:t.pagamentos||[],newItemTemplate:{identificacao_documento_fiscal:{numero:"",identificacao_credor:{documento_numero:"",documento_tipo:2}},pagamento_data:"",pagamento_valor:0,fonte_recurso_tipo:1,meio_pagamento_tipo:2},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"pagamentos",renderItem:(e,t,n)=>{var s;return(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)("div",{className:"col-span-3 bg-emerald-50 p-3 rounded border border-emerald-100",children:(0,L.jsx)(ee,{label:"Vincular Documento Fiscal (Nota)",children:(0,L.jsxs)("select",{className:W,value:null===(s=e.identificacao_documento_fiscal)||void 0===s?void 0:s.numero,onChange:t=>{const s=t.target.value,i=o.find(e=>e.numero===s);n("identificacao_documento_fiscal.numero",s),i&&(n("identificacao_documento_fiscal.identificacao_credor",i.credor),0===e.pagamento_valor&&n("pagamento_valor",i.valor_bruto))},children:[(0,L.jsx)("option",{value:"",children:"-- Selecione Nota --"}),o.map(e=>(0,L.jsxs)("option",{value:e.numero,children:["NF ",e.numero," (",e.credor.nome,") - R$",e.valor_bruto]},e.numero))]})})}),(0,L.jsx)(ne,{label:"Data Pagamento",type:"date",value:e.pagamento_data,onChange:e=>n("pagamento_data",e)}),(0,L.jsx)(ne,{label:"Valor Pago (R$)",type:"number",value:e.pagamento_valor,onChange:e=>n("pagamento_valor",e)}),(0,L.jsx)(ne,{label:"Meio Pagamento",value:e.meio_pagamento_tipo,onChange:e=>n("meio_pagamento_tipo",Number(e)),options:[{value:1,label:"Cheque"},{value:2,label:"Transfer\xeancia/DOC/TED/Pix"},{value:3,label:"Esp\xe9cie"}]}),2===e.meio_pagamento_tipo&&(0,L.jsx)(ne,{label:"ID Transa\xe7\xe3o / Autentica\xe7\xe3o",value:e.numero_transacao,onChange:e=>n("numero_transacao",e)})]})}})},uy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsx)(te,{title:"4. Rela\xe7\xe3o de Empregados",items:t.relacao_empregados||[],newItemTemplate:{cpf:"",data_admissao:"",salario_contratual:0,cbo:"",cns:"",data_demissao:"",periodos_remuneracao:[]},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"relacao_empregados",renderItem:(e,t,n)=>{var s;return(0,L.jsxs)("div",{className:"space-y-4",children:[(0,L.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,L.jsx)(ne,{label:"CPF",value:e.cpf,onChange:e=>n("cpf",e)}),(0,L.jsx)(ne,{label:"Data Admiss\xe3o",type:"date",value:e.data_admissao,onChange:e=>n("data_admissao",e)}),(0,L.jsx)(ne,{label:"Data Demiss\xe3o",type:"date",value:e.data_demissao||"",onChange:e=>n("data_demissao",e)}),(0,L.jsx)(ne,{label:"CBO",value:e.cbo,onChange:e=>n("cbo",e)}),(0,L.jsx)(ne,{label:"CNS (Cart\xe3o SUS)",value:e.cns||"",onChange:e=>n("cns",e)}),(0,L.jsx)(ne,{label:"Sal\xe1rio Contratual",type:"number",value:e.salario_contratual,onChange:e=>n("salario_contratual",e)})]}),(0,L.jsxs)("div",{className:"bg-slate-50 p-3 rounded border border-slate-200",children:[(0,L.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,L.jsx)("h5",{className:"text-xs font-bold uppercase text-slate-500",children:"Holerites / Remunera\xe7\xf5es"}),(0,L.jsx)("button",{onClick:()=>{const t=[...e.periodos_remuneracao||[],{mes:1,carga_horaria:160,remuneracao_bruta:e.salario_contratual}];n("periodos_remuneracao",t)},className:"text-[10px] text-blue-600 font-bold hover:underline",children:"+ Adicionar Per\xedodo"})]}),null===(s=e.periodos_remuneracao)||void 0===s?void 0:s.map((t,s)=>(0,L.jsxs)("div",{className:"flex gap-2 items-end mb-2 border-b border-slate-100 pb-2",children:[(0,L.jsxs)("div",{className:"w-16",children:[(0,L.jsx)("label",{className:"text-[9px] font-bold text-slate-400",children:"M\xeas"}),(0,L.jsx)("input",{type:"number",min:"1",max:"12",className:W+" h-8 py-0 text-xs",value:t.mes,onChange:t=>{const i=[...e.periodos_remuneracao];i[s].mes=Number(t.target.value),n("periodos_remuneracao",i)}})]}),(0,L.jsxs)("div",{className:"w-20",children:[(0,L.jsx)("label",{className:"text-[9px] font-bold text-slate-400",children:"C. Hor\xe1ria"}),(0,L.jsx)("input",{type:"number",className:W+" h-8 py-0 text-xs",value:t.carga_horaria,onChange:t=>{const i=[...e.periodos_remuneracao];i[s].carga_horaria=Number(t.target.value),n("periodos_remuneracao",i)}})]}),(0,L.jsxs)("div",{className:"flex-1",children:[(0,L.jsx)("label",{className:"text-[9px] font-bold text-slate-400",children:"Bruto (R$)"}),(0,L.jsx)("input",{type:"number",className:W+" h-8 py-0 text-xs",value:t.remuneracao_bruta,onChange:t=>{const i=[...e.periodos_remuneracao];i[s].remuneracao_bruta=Number(t.target.value),n("periodos_remuneracao",i)}})]}),(0,L.jsx)("button",{onClick:()=>{const t=[...e.periodos_remuneracao];t.splice(s,1),n("periodos_remuneracao",t)},className:"text-red-400 font-bold text-xs pb-1 hover:text-red-600",children:"\u2715"})]},s))]})]})}})},hy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsx)(te,{title:"12. Servidores Cedidos",items:t.servidores_cedidos||[],newItemTemplate:{cpf:"",cargo_publico_ocupado:"",funcao_desempenhada_entidade_beneficiaria:"",data_inicial_cessao:"",onus_pagamento:1,periodos_cessao:[]},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"servidores_cedidos",renderItem:(e,t,n)=>(0,L.jsx)("div",{className:"space-y-4",children:(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,L.jsx)(ne,{label:"CPF",value:e.cpf,onChange:e=>n("cpf",e)}),(0,L.jsx)(ne,{label:"Data In\xedcio Cess\xe3o",type:"date",value:e.data_inicial_cessao,onChange:e=>n("data_inicial_cessao",e)}),(0,L.jsx)(ne,{label:"Cargo Origem",value:e.cargo_publico_ocupado,onChange:e=>n("cargo_publico_ocupado",e)}),(0,L.jsx)(ne,{label:"Fun\xe7\xe3o Entidade",value:e.funcao_desempenhada_entidade_beneficiaria,onChange:e=>n("funcao_desempenhada_entidade_beneficiaria",e)}),(0,L.jsx)(ne,{label:"\xd4nus Pagamento",value:e.onus_pagamento,onChange:e=>n("onus_pagamento",Number(e)),options:[{value:1,label:"Origem"},{value:2,label:"Destino"},{value:3,label:"Parcial"}]})]})})})},py=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;const r=t.ajustes_saldo||{};return(0,L.jsxs)("div",{className:"space-y-8",children:[(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"11. Ajustes de Saldo"}),(0,L.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:"Utilize esta se\xe7\xe3o apenas para corrigir diverg\xeancias de saldo conciliado banc\xe1rio x cont\xe1bil."})]}),(0,L.jsx)(te,{title:"11.1 Retifica\xe7\xe3o de Repasses",items:r.retificacao_repasses||[],newItemTemplate:{data_prevista:"",data_repasse:"",valor_retificado:0,fonte_recurso_tipo:1},onAdd:e=>s(a(a({},r),{},{retificacao_repasses:[...r.retificacao_repasses||[],e]}),"ajustes_saldo"),onRemove:e=>{const t=[...r.retificacao_repasses||[]];t.splice(e,1),n("ajustes_saldo.retificacao_repasses",t)},onUpdate:(e,t,s)=>{const i=[...r.retificacao_repasses||[]];i[e]=a(a({},i[e]),{},{[t]:s}),n("ajustes_saldo.retificacao_repasses",i)},renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"Data Repasse",type:"date",value:e.data_repasse,onChange:e=>n("data_repasse",e)}),(0,L.jsx)(ne,{label:"Valor Retificado",type:"number",value:e.valor_retificado,onChange:e=>n("valor_retificado",e)}),(0,L.jsx)(ne,{label:"Fonte Recurso",type:"number",value:e.fonte_recurso_tipo,onChange:e=>n("fonte_recurso_tipo",e)})]})}),(0,L.jsx)(te,{title:"11.3 Retifica\xe7\xe3o de Pagamentos",items:r.retificacao_pagamentos||[],newItemTemplate:{identificacao_documento_fiscal:{numero:"",identificacao_credor:{documento_numero:"",documento_tipo:2}},pagamento_data:"",pagamento_valor:0,fonte_recurso_tipo:1,valor_retificado:0},onAdd:e=>s(a(a({},r),{},{retificacao_pagamentos:[...r.retificacao_pagamentos||[],e]}),"ajustes_saldo"),onRemove:e=>{const t=[...r.retificacao_pagamentos||[]];t.splice(e,1),n("ajustes_saldo.retificacao_pagamentos",t)},onUpdate:(e,t,s)=>{const i=[...r.retificacao_pagamentos||[]];i[e]=a(a({},i[e]),{},{[t]:s}),n("ajustes_saldo.retificacao_pagamentos",i)},renderItem:(e,t,n)=>{var s;return(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,L.jsx)(ne,{label:"N\xfamero NF Original",value:null===(s=e.identificacao_documento_fiscal)||void 0===s?void 0:s.numero,onChange:e=>n("identificacao_documento_fiscal.numero",e)}),(0,L.jsx)(ne,{label:"Valor Retificado (Correto)",type:"number",value:e.valor_retificado,onChange:e=>n("valor_retificado",e)})]})}})]})},fy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i,fullData:r}=e;const o=r.empenhos||[];return(0,L.jsx)(te,{title:"17. Repasses Recebidos (Financeiro)",items:t.repasses||[],newItemTemplate:{identificacao_empenho:{numero:"",data_emissao:""},data_prevista:"",data_repasse:"",valor_previsto:0,valor_repasse:0,tipo_documento_bancario:1,numero_documento:"",banco:0,agencia:0,conta:""},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"repasses",renderItem:(e,t,n)=>{var s;return(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsxs)("div",{className:"col-span-3 bg-indigo-50 p-3 rounded border border-indigo-100 mb-2",children:[(0,L.jsx)("label",{className:q,children:"Vincular a Empenho"}),(0,L.jsxs)("select",{className:W,value:null===(s=e.identificacao_empenho)||void 0===s?void 0:s.numero,onChange:t=>{const s=t.target.value,i=o.find(e=>e.numero===s);i&&(n("identificacao_empenho",{numero:i.numero,data_emissao:i.data_emissao}),0===e.valor_repasse&&n("valor_repasse",i.valor))},children:[(0,L.jsx)("option",{value:"",children:"-- Selecione Empenho --"}),o.map(e=>(0,L.jsxs)("option",{value:e.numero,children:["Empenho ",e.numero," (",e.data_emissao,") - R$",e.valor]},e.numero))]})]}),(0,L.jsx)(ne,{label:"Data Repasse",type:"date",value:e.data_repasse,onChange:e=>n("data_repasse",e)}),(0,L.jsx)(ne,{label:"Valor Recebido (R$)",type:"number",value:e.valor_repasse,onChange:e=>n("valor_repasse",e)}),(0,L.jsx)(ne,{label:"Nr. Doc Banc\xe1rio",value:e.numero_documento,onChange:e=>n("numero_documento",e)}),(0,L.jsx)(ne,{label:"Banco",type:"number",value:e.banco,onChange:e=>n("banco",e)}),(0,L.jsx)(ne,{label:"Ag\xeancia",type:"number",value:e.agencia,onChange:e=>n("agencia",e)}),(0,L.jsx)(ne,{label:"Conta",value:e.conta,onChange:e=>n("conta",e)})]})}})},my=e=>{var t;let{data:n,onUpdate:s,onAdd:i,onRemove:r}=e;return(0,L.jsx)(te,{title:"5. Rela\xe7\xe3o de Bens (M\xf3veis Adquiridos)",items:(null===(t=n.relacao_bens)||void 0===t?void 0:t.relacao_bens_moveis_adquiridos)||[],newItemTemplate:{numero_patrimonio:"",descricao:"",valor_aquisicao:0,data_aquisicao:""},onAdd:e=>{const t=n.relacao_bens||{},s=t.relacao_bens_moveis_adquiridos||[];i(a(a({},t),{},{relacao_bens_moveis_adquiridos:[...s,e]}),"relacao_bens")},onRemove:e=>{var t;const i=[...(null===(t=n.relacao_bens)||void 0===t?void 0:t.relacao_bens_moveis_adquiridos)||[]];i.splice(e,1),s("relacao_bens.relacao_bens_moveis_adquiridos",i)},onUpdate:(e,t,i)=>{var r;const o=[...(null===(r=n.relacao_bens)||void 0===r?void 0:r.relacao_bens_moveis_adquiridos)||[]];o[e]=a(a({},o[e]),{},{[t]:i}),s("relacao_bens.relacao_bens_moveis_adquiridos",o)},ocrSection:"relacao_bens",renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,L.jsx)(ne,{label:"Patrim\xf4nio",value:e.numero_patrimonio,onChange:e=>n("numero_patrimonio",e)}),(0,L.jsx)("div",{className:"md:col-span-2",children:(0,L.jsx)(ne,{label:"Descri\xe7\xe3o",value:e.descricao,onChange:e=>n("descricao",e)})}),(0,L.jsx)(ne,{label:"Data Aquisi\xe7\xe3o",type:"date",value:e.data_aquisicao,onChange:e=>n("data_aquisicao",e)}),(0,L.jsx)(ne,{label:"Valor (R$)",type:"number",value:e.valor_aquisicao,onChange:e=>n("valor_aquisicao",e)})]})})},gy=e=>{var t,n;let{data:s,onUpdate:i,onAdd:r,onRemove:o}=e;return(0,L.jsxs)("div",{className:"space-y-6",children:[(0,L.jsx)(te,{title:"9. Disponibilidades (Saldos Banc\xe1rios)",items:(null===(t=s.disponibilidades)||void 0===t?void 0:t.saldos)||[],newItemTemplate:{banco:0,agencia:0,conta:"",saldo_bancario:0,saldo_contabil:0,conta_tipo:1},onAdd:e=>{const t=s.disponibilidades||{saldo_fundo_fixo:0,saldos:[]},n=t.saldos||[];r(a(a({},t),{},{saldos:[...n,e]}),"disponibilidades")},onRemove:e=>{var t;const n=[...(null===(t=s.disponibilidades)||void 0===t?void 0:t.saldos)||[]];n.splice(e,1),i("disponibilidades.saldos",n)},onUpdate:(e,t,n)=>{var r;const o=[...(null===(r=s.disponibilidades)||void 0===r?void 0:r.saldos)||[]];o[e]=a(a({},o[e]),{},{[t]:n}),i("disponibilidades.saldos",o)},ocrSection:"disponibilidades",renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,L.jsx)(ne,{label:"Banco",type:"number",value:e.banco,onChange:e=>n("banco",e)}),(0,L.jsx)(ne,{label:"Ag\xeancia",type:"number",value:e.agencia,onChange:e=>n("agencia",e)}),(0,L.jsx)(ne,{label:"Conta",value:e.conta,onChange:e=>n("conta",e)}),(0,L.jsx)(ne,{label:"Saldo Banco (R$)",type:"number",value:e.saldo_bancario,onChange:e=>n("saldo_bancario",e)}),(0,L.jsx)(ne,{label:"Saldo Cont\xe1bil (R$)",type:"number",value:e.saldo_contabil,onChange:e=>n("saldo_contabil",e)})]})}),(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)("h4",{className:"text-sm font-bold text-slate-700 uppercase mb-4",children:"Outros Saldos"}),(0,L.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3",children:(0,L.jsx)(ne,{label:"Saldo Fundo Fixo (Caixa)",type:"number",value:(null===(n=s.disponibilidades)||void 0===n?void 0:n.saldo_fundo_fixo)||0,onChange:e=>i("disponibilidades.saldo_fundo_fixo",e)})})]})]})},vy=e=>{var t,n,s,i;let{data:r,onUpdate:o,onAdd:l,onRemove:c}=e;return(0,L.jsxs)("div",{className:"space-y-6",children:[(0,L.jsx)(te,{title:"10.1 Repasses Recebidos",items:(null===(t=r.receitas)||void 0===t?void 0:t.repasses_recebidos)||[],newItemTemplate:{data_repasse:"",valor:0,fonte_recurso_tipo:1,data_prevista:""},onAdd:e=>{const t=r.receitas||{},n=t.repasses_recebidos||[];l(a(a({},t),{},{repasses_recebidos:[...n,e]}),"receitas")},onRemove:e=>{var t;const n=[...(null===(t=r.receitas)||void 0===t?void 0:t.repasses_recebidos)||[]];n.splice(e,1),o("receitas.repasses_recebidos",n)},onUpdate:(e,t,n)=>{var s;const i=[...(null===(s=r.receitas)||void 0===s?void 0:s.repasses_recebidos)||[]];i[e]=a(a({},i[e]),{},{[t]:n}),o("receitas.repasses_recebidos",i)},ocrSection:"receitas",renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"Data Prevista",type:"date",value:e.data_prevista,onChange:e=>n("data_prevista",e)}),(0,L.jsx)(ne,{label:"Data Efetiva",type:"date",value:e.data_repasse,onChange:e=>n("data_repasse",e)}),(0,L.jsx)(ne,{label:"Valor (R$)",type:"number",value:e.valor,onChange:e=>n("valor",e)})]})}),(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"10.2 Rendimentos de Aplica\xe7\xe3o Financeira"}),(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"Rend. Municipal (R$)",type:"number",value:(null===(n=r.receitas)||void 0===n?void 0:n.receitas_aplic_financ_repasses_publicos_municipais)||0,onChange:e=>o("receitas.receitas_aplic_financ_repasses_publicos_municipais",e)}),(0,L.jsx)(ne,{label:"Rend. Estadual (R$)",type:"number",value:(null===(s=r.receitas)||void 0===s?void 0:s.receitas_aplic_financ_repasses_publicos_estaduais)||0,onChange:e=>o("receitas.receitas_aplic_financ_repasses_publicos_estaduais",e)}),(0,L.jsx)(ne,{label:"Rend. Federal (R$)",type:"number",value:(null===(i=r.receitas)||void 0===i?void 0:i.receitas_aplic_financ_repasses_publicos_federais)||0,onChange:e=>o("receitas.receitas_aplic_financ_repasses_publicos_federais",e)})]})]})]})},by=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsx)(te,{title:"13. Descontos",items:t.descontos||[],newItemTemplate:{data:"",descricao:"",valor:0},onAdd:s,onRemove:i,onUpdate:n,renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)("div",{className:"md:col-span-2",children:(0,L.jsx)(ne,{label:"Descri\xe7\xe3o",value:e.descricao,onChange:e=>n("descricao",e)})}),(0,L.jsx)(ne,{label:"Data",type:"date",value:e.data,onChange:e=>n("data",e)}),(0,L.jsx)(ne,{label:"Valor (R$)",type:"number",value:e.valor,onChange:e=>n("valor",e)})]})})},yy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsx)(te,{title:"14. Devolu\xe7\xf5es de Saldo",items:t.devolucoes||[],newItemTemplate:{data:"",natureza_devolucao_tipo:1,valor:0},onAdd:s,onRemove:i,onUpdate:n,renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"Data",type:"date",value:e.data,onChange:e=>n("data",e)}),(0,L.jsx)(ne,{label:"Valor (R$)",type:"number",value:e.valor,onChange:e=>n("valor",e)}),(0,L.jsx)(ne,{label:"Natureza",value:e.natureza_devolucao_tipo,onChange:e=>n("natureza_devolucao_tipo",Number(e)),options:[{value:1,label:"Saldo de Recursos n\xe3o Utilizados"},{value:2,label:"Glosas"},{value:3,label:"Rendimentos de Aplica\xe7\xe3o"}]})]})})},_y=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsx)(te,{title:"15. Glosas",items:t.glosas||[],newItemTemplate:{identificacao_documento_fiscal:{numero:"",identificacao_credor:{documento_numero:"",documento_tipo:2}},resultado_analise:1,valor_glosa:0},onAdd:s,onRemove:i,onUpdate:n,renderItem:(e,t,n)=>{var s;return(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"N\xfamero Nota Fiscal",value:null===(s=e.identificacao_documento_fiscal)||void 0===s?void 0:s.numero,onChange:e=>n("identificacao_documento_fiscal.numero",e)}),(0,L.jsx)(ne,{label:"Valor Glosado (R$)",type:"number",value:e.valor_glosa,onChange:e=>n("valor_glosa",e)}),(0,L.jsx)(ne,{label:"Tipo Glosa",value:e.resultado_analise,onChange:e=>n("resultado_analise",Number(e)),options:[{value:1,label:"Total"},{value:2,label:"Parcial"}]})]})}})},wy=e=>{let{data:t,onUpdate:n,onAdd:s,onRemove:i}=e;return(0,L.jsx)(te,{title:"16. Empenhos",items:t.empenhos||[],newItemTemplate:{numero:"",data_emissao:"",valor:0,historico:"",classificacao_economica_tipo:"",fonte_recurso_tipo:1,cpf_ordenador_despesa:""},onAdd:s,onRemove:i,onUpdate:n,ocrSection:"empenhos",renderItem:(e,t,n)=>(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"N\xfamero Empenho",value:e.numero,onChange:e=>n("numero",e)}),(0,L.jsx)(ne,{label:"Data Emiss\xe3o",type:"date",value:e.data_emissao,onChange:e=>n("data_emissao",e)}),(0,L.jsx)(ne,{label:"Valor (R$)",type:"number",value:e.valor,onChange:e=>n("valor",e)}),(0,L.jsx)("div",{className:"md:col-span-3",children:(0,L.jsx)(ne,{label:"Hist\xf3rico",value:e.historico,onChange:e=>n("historico",e)})})]})})},xy=e=>{var t;let{data:n,updateField:s}=e;const i=n.relatorio_atividades||{programas:[]},r=e=>{s("relatorio_atividades.programas",e)};return(0,L.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"18. Relat\xf3rio de Atividades",children:(0,L.jsx)("button",{onClick:()=>r([...i.programas||[],{nome_programa:"",metas:[]}]),className:G,children:"+ Novo Programa"})}),(0,L.jsx)(V,{section:"relatorio_atividades",onDataExtracted:e=>{if(e&&Array.isArray(e.programas)){const t=[...i.programas||[]];r([...t,...e.programas])}}}),(!i.programas||0===i.programas.length)&&(0,L.jsx)("p",{className:"text-slate-400 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded",children:"Nenhum programa cadastrado. Adicione manualmente ou use o OCR."})]}),null===(t=i.programas)||void 0===t?void 0:t.map((e,t)=>(0,L.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-l-indigo-500 border-y border-r border-slate-200 relative",children:[(0,L.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,L.jsxs)("div",{className:"w-full mr-4",children:[(0,L.jsxs)("h3",{className:"text-sm font-bold uppercase text-indigo-600 mb-2",children:["Programa #",t+1]}),(0,L.jsx)(ne,{label:"Nome do Programa",value:e.nome_programa,onChange:e=>{const n=[...i.programas];n[t].nome_programa=e,r(n)}})]}),(0,L.jsx)("button",{onClick:()=>{const e=[...i.programas];e.splice(t,1),r(e)},className:K+" mt-6",children:"Remover Programa"})]}),(0,L.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[(0,L.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b border-slate-200 pb-2",children:[(0,L.jsx)("h4",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Metas do Programa"}),(0,L.jsx)("button",{onClick:()=>{const e=[...i.programas];e[t].metas.push({codigo_meta:"",periodicidades:[],meta_atendida:!1,justificativa:""}),r(e)},className:J,children:"+ Adicionar Meta"})]}),e.metas.map((e,n)=>(0,L.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200 mb-4 shadow-sm",children:[(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 mb-4",children:[(0,L.jsx)("div",{className:"md:col-span-3",children:(0,L.jsx)(ne,{label:"C\xf3digo Meta",value:e.codigo_meta,onChange:e=>{const s=[...i.programas];s[t].metas[n].codigo_meta=e,r(s)}})}),(0,L.jsx)("div",{className:"md:col-span-7",children:(0,L.jsx)(ne,{label:"Descri\xe7\xe3o (Opcional)",value:e.descricao||"",onChange:e=>{const s=[...i.programas];s[t].metas[n].descricao=e,r(s)}})}),(0,L.jsx)("div",{className:"md:col-span-2 flex items-center justify-end",children:(0,L.jsx)("button",{onClick:()=>{const e=[...i.programas];e[t].metas.splice(n,1),r(e)},className:"text-red-500 hover:bg-red-50 p-2 rounded",title:"Remover Meta",children:"\u2715"})})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2 mb-4 bg-indigo-50 p-2 rounded w-fit",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:e.meta_atendida,onChange:e=>{const s=[...i.programas];s[t].metas[n].meta_atendida=e.target.checked,r(s)}}),(0,L.jsx)("label",{className:"text-xs font-bold text-indigo-900 cursor-pointer",children:"A Meta foi plenamente atendida?"})]}),!e.meta_atendida&&(0,L.jsx)("div",{className:"mb-4 animate-in fade-in",children:(0,L.jsx)(ne,{label:"Justificativa do N\xe3o Atendimento",value:e.justificativa||"",onChange:e=>{const s=[...i.programas];s[t].metas[n].justificativa=e,r(s)}})}),(0,L.jsxs)("div",{className:"pl-4 border-l-2 border-indigo-100",children:[(0,L.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,L.jsx)("h5",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Execu\xe7\xe3o F\xedsica (Periodicidade)"}),(0,L.jsx)("button",{onClick:()=>{const e=[...i.programas];e[t].metas[n].periodicidades.push({periodo:1,quantidade_realizada:0}),r(e)},className:"text-[10px] text-blue-600 font-bold hover:underline",children:"+ Adicionar Per\xedodo"})]}),(0,L.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:e.periodicidades.map((e,s)=>(0,L.jsxs)("div",{className:"flex gap-2 items-center bg-slate-50 p-2 rounded border border-slate-100",children:[(0,L.jsx)("div",{className:"w-24",children:(0,L.jsx)("select",{className:W+" h-8 py-0 text-xs",value:e.periodo,onChange:e=>{const o=[...i.programas];o[t].metas[n].periodicidades[s].periodo=Number(e.target.value),r(o)},children:Array.from({length:12},(e,t)=>(0,L.jsx)("option",{value:t+1,children:new Date(0,t).toLocaleString("pt-BR",{month:"long"})},t+1))})}),(0,L.jsx)("div",{className:"flex-1",children:(0,L.jsx)("input",{type:"number",placeholder:"Qtd.",className:W+" h-8 py-0 text-xs",value:e.quantidade_realizada,onChange:e=>{const o=[...i.programas];o[t].metas[n].periodicidades[s].quantidade_realizada=Number(e.target.value),r(o)}})}),(0,L.jsx)("button",{onClick:()=>{const e=[...i.programas];e[t].metas[n].periodicidades.splice(s,1),r(e)},className:"text-red-400 hover:text-red-600 text-xs font-bold px-1",children:"\u2715"})]},s))})]})]},n))]})]},t))]})},Ey=e=>{let{data:t,updateField:n}=e;const s=t.parecer_conclusivo||{};return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"26. Parecer Conclusivo"}),(0,L.jsxs)("div",{className:"grid grid-cols-1 gap-4 mb-6",children:[(0,L.jsx)(ne,{label:"Identifica\xe7\xe3o do Parecer (ID/N\xfamero)",value:s.identificacao_parecer,onChange:e=>n("parecer_conclusivo.identificacao_parecer",e)}),(0,L.jsx)(ne,{label:"Conclus\xe3o",value:s.conclusao_parecer,onChange:e=>n("parecer_conclusivo.conclusao_parecer",Number(e)),options:[{value:1,label:"Aprovado"},{value:2,label:"Aprovado com Ressalvas"},{value:3,label:"Rejeitado"}]}),(0,L.jsxs)("div",{className:"col-span-1",children:[(0,L.jsx)("label",{className:q,children:"Considera\xe7\xf5es do Conselho Fiscal"}),(0,L.jsx)("textarea",{className:W+" h-24 py-2",value:s.consideracoes_parecer,onChange:e=>n("parecer_conclusivo.consideracoes_parecer",e.target.value)})]})]}),(0,L.jsxs)("div",{className:"bg-slate-50 p-4 rounded border border-slate-200",children:[(0,L.jsx)("h4",{className:"font-bold text-slate-700 mb-4",children:"Declara\xe7\xf5es do Parecer"}),(0,L.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>{var t,i,r,o;return(0,L.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center border-b border-slate-100 pb-2",children:[(0,L.jsxs)("div",{className:"flex-1 text-sm font-medium text-slate-600",children:[1===e&&"A entidade aplicou os recursos conforme o plano de trabalho?",2===e&&"As despesas est\xe3o comprovadas por documentos fiscais?",3===e&&"Houve cumprimento das metas estabelecidas?"]}),(0,L.jsxs)("div",{className:"flex gap-4",children:[(0,L.jsxs)("label",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"radio",name:"dec_".concat(e),checked:1===(null===(t=s.declaracoes)||void 0===t||null===(i=t.find(t=>t.tipo_declaracao===e))||void 0===i?void 0:i.declaracao),onChange:()=>{const t=[...s.declaracoes||[]],i=t.findIndex(t=>t.tipo_declaracao===e);i>=0?t[i].declaracao=1:t.push({tipo_declaracao:e,declaracao:1}),n("parecer_conclusivo.declaracoes",t)}})," Sim"]}),(0,L.jsxs)("label",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"radio",name:"dec_".concat(e),checked:2===(null===(r=s.declaracoes)||void 0===r||null===(o=r.find(t=>t.tipo_declaracao===e))||void 0===o?void 0:o.declaracao),onChange:()=>{const t=[...s.declaracoes||[]],i=t.findIndex(t=>t.tipo_declaracao===e);i>=0?t[i].declaracao=2:t.push({tipo_declaracao:e,declaracao:2}),n("parecer_conclusivo.declaracoes",t)}})," N\xe3o"]})]})]},e)})})]})]})},Sy=e=>{var t,n,s;let{data:i,updateField:r}=e;const o=i.demonstracoes_contabeis||{};return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"23. Demonstra\xe7\xf5es Cont\xe1beis"}),(0,L.jsxs)("div",{className:"bg-blue-50 p-4 rounded border border-blue-100 mb-6",children:[(0,L.jsx)("h4",{className:"text-xs font-bold uppercase text-blue-800 mb-2",children:"Respons\xe1vel T\xe9cnico (Contador)"}),(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,L.jsx)(ne,{label:"Nome",value:null===(t=o.responsavel)||void 0===t?void 0:t.numero_crc,onChange:e=>r("demonstracoes_contabeis.responsavel.numero_crc",e)})," ",(0,L.jsx)(ne,{label:"CPF",value:null===(n=o.responsavel)||void 0===n?void 0:n.cpf,onChange:e=>r("demonstracoes_contabeis.responsavel.cpf",e)}),(0,L.jsxs)("div",{className:Q+" h-10 mt-5",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:null===(s=o.responsavel)||void 0===s?void 0:s.situacao_regular_crc,onChange:e=>r("demonstracoes_contabeis.responsavel.situacao_regular_crc",e.target.checked)}),(0,L.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Regular no CRC?"})]})]})]}),(0,L.jsx)("h4",{className:q,children:"Publica\xe7\xf5es das Demonstra\xe7\xf5es"}),(o.publicacoes||[]).map((e,t)=>(0,L.jsxs)("div",{className:"flex gap-2 items-center mb-2",children:[(0,L.jsx)("input",{className:W,placeholder:"Ve\xedculo",value:e.nome_veiculo,onChange:e=>{const n=[...o.publicacoes||[]];n[t].nome_veiculo=e.target.value,r("demonstracoes_contabeis.publicacoes",n)}}),(0,L.jsx)("input",{type:"date",className:W,value:e.data_publicacao,onChange:e=>{const n=[...o.publicacoes||[]];n[t].data_publicacao=e.target.value,r("demonstracoes_contabeis.publicacoes",n)}}),(0,L.jsx)("button",{className:K,onClick:()=>{const e=[...o.publicacoes||[]];e.splice(t,1),r("demonstracoes_contabeis.publicacoes",e)},children:"X"})]},t)),(0,L.jsx)("button",{onClick:()=>{const e=[...o.publicacoes||[]];e.push({tipo_veiculo_publicacao:1,data_publicacao:"",nome_veiculo:""}),r("demonstracoes_contabeis.publicacoes",e)},className:G,children:"+ Publica\xe7\xe3o"})]})},Ay=e=>{let{data:t,updateField:n}=e;const s=t.relatorio_governamental_analise_execucao||{};return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"22. Relat\xf3rio Governamental (An\xe1lise Execu\xe7\xe3o)"}),(0,L.jsxs)("div",{className:"mb-6 bg-yellow-50 p-4 rounded border border-yellow-100",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:s.houve_emissao_relatorio_final,onChange:e=>n("relatorio_governamental_analise_execucao.houve_emissao_relatorio_final",e.target.checked)}),(0,L.jsx)("label",{className:"font-bold text-slate-800 text-sm",children:"Houve emiss\xe3o de Relat\xf3rio Final pelo \xd3rg\xe3o P\xfablico?"})]}),s.houve_emissao_relatorio_final&&(0,L.jsxs)("div",{className:"animate-in fade-in space-y-4",children:[(0,L.jsx)(ne,{label:"Conclus\xe3o do Relat\xf3rio",value:s.conclusao_relatorio,onChange:e=>n("relatorio_governamental_analise_execucao.conclusao_relatorio",Number(e)),options:[{value:1,label:"Favor\xe1vel"},{value:2,label:"Favor\xe1vel com Ressalvas"},{value:3,label:"Desfavor\xe1vel"}]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:q,children:"Justificativa / Considera\xe7\xf5es"}),(0,L.jsx)("textarea",{className:W+" h-24 py-2",value:s.justificativa,onChange:e=>n("relatorio_governamental_analise_execucao.justificativa",e.target.value)})]})]})]})]})},Cy=e=>{let{data:t,updateField:n}=e;const s=t.publicacoes_parecer_ata||[],i=(e,t,i)=>{const r=[...s];"root"===t?r[e]=a(a({},r[e]),i):r[e][t]=i,n("publicacoes_parecer_ata",r)};return(0,L.jsxs)("div",{className:"space-y-6",children:[(0,L.jsx)("div",{className:z,children:(0,L.jsx)(Z,{title:"24. Publica\xe7\xf5es de Pareceres e Atas",children:(0,L.jsx)("button",{onClick:()=>{n("publicacoes_parecer_ata",[...s,{tipo_parecer_ata:1,houve_publicacao:!1,conclusao_parecer:1,publicacoes:[]}])},className:G,children:"+ Adicionar Registro"})})}),s.map((e,t)=>(0,L.jsxs)("div",{className:z+" border-l-4 border-purple-400",children:[(0,L.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,L.jsx)(ne,{label:"Tipo de Documento",value:e.tipo_parecer_ata,onChange:e=>i(t,"tipo_parecer_ata",Number(e)),options:[{value:1,label:"Parecer do Conselho Fiscal"},{value:2,label:"Ata da Assembleia Geral"},{value:3,label:"Ata do Conselho de Administra\xe7\xe3o"}]}),(0,L.jsx)("button",{onClick:()=>(e=>{const t=[...s];t.splice(e,1),n("publicacoes_parecer_ata",t)})(t),className:K+" mt-4",children:"Remover"})]}),(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3 h-10 mt-5 bg-slate-50 px-3 rounded border",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:e.houve_publicacao,onChange:e=>i(t,"houve_publicacao",e.target.checked)}),(0,L.jsx)("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Houve Publica\xe7\xe3o?"})]}),(0,L.jsx)(ne,{label:"Conclus\xe3o",value:e.conclusao_parecer,onChange:e=>i(t,"conclusao_parecer",Number(e)),options:[{value:1,label:"Aprova\xe7\xe3o"},{value:2,label:"Aprova\xe7\xe3o com Ressalvas"},{value:3,label:"Rejei\xe7\xe3o"}]})]}),e.houve_publicacao&&(0,L.jsxs)("div",{className:"pl-4 border-l-2 border-purple-100 mt-4",children:[(0,L.jsx)("label",{className:q+" text-purple-700",children:"Ve\xedculos de Publica\xe7\xe3o"}),(e.publicacoes||[]).map((n,s)=>(0,L.jsxs)("div",{className:"flex gap-2 mb-2 items-center",children:[(0,L.jsx)("input",{className:W,placeholder:"Nome Ve\xedculo",value:n.nome_veiculo,onChange:n=>{const r=[...e.publicacoes||[]];r[s]=a(a({},r[s]),{},{nome_veiculo:n.target.value}),i(t,"publicacoes",r)}}),(0,L.jsx)("input",{type:"date",className:W,value:n.data_publicacao,onChange:n=>{const r=[...e.publicacoes||[]];r[s]=a(a({},r[s]),{},{data_publicacao:n.target.value}),i(t,"publicacoes",r)}}),(0,L.jsx)("button",{onClick:()=>{const n=[...e.publicacoes||[]];n.splice(s,1),i(t,"publicacoes",n)},className:"text-red-500 font-bold px-2",children:"X"})]},s)),(0,L.jsx)("button",{onClick:()=>{const n=[...e.publicacoes||[]];n.push({tipo_veiculo_publicacao:1,nome_veiculo:"",data_publicacao:""}),i(t,"publicacoes",n)},className:"text-xs font-bold text-blue-600 hover:underline",children:"+ Adicionar Publica\xe7\xe3o"})]})]},t))]})},ky=e=>{let{data:t,updateField:n}=e;const s=t.prestacao_contas_entidade_beneficiaria||{};return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"25. Dados da Presta\xe7\xe3o (Entidade)"}),(0,L.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,L.jsx)(ne,{label:"Data da Presta\xe7\xe3o",type:"date",value:s.data_prestacao,onChange:e=>n("prestacao_contas_entidade_beneficiaria.data_prestacao",e)}),(0,L.jsx)(ne,{label:"Per\xedodo Ref. In\xedcio",type:"date",value:s.periodo_referencia_data_inicial,onChange:e=>n("prestacao_contas_entidade_beneficiaria.periodo_referencia_data_inicial",e)}),(0,L.jsx)(ne,{label:"Per\xedodo Ref. Final",type:"date",value:s.periodo_referencia_data_final,onChange:e=>n("prestacao_contas_entidade_beneficiaria.periodo_referencia_data_final",e)})]}),(0,L.jsx)("p",{className:"mt-4 text-xs text-slate-500 bg-slate-50 p-2 rounded border border-slate-100",children:"Estes dados referem-se ao per\xedodo de execu\xe7\xe3o e \xe0 data em que a entidade finalizou internamente a presta\xe7\xe3o de contas."})]})},Ty=e=>{let{data:t,updateField:n}=e;const s=t.dados_gerais_entidade_beneficiaria||{};return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"19. Dados Gerais da Entidade"}),(0,L.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,L.jsx)(ne,{label:"Certid\xe3o de Dados Gerais (C\xf3digo/Hash)",value:s.identificacao_certidao_dados_gerais,onChange:e=>n("dados_gerais_entidade_beneficiaria.identificacao_certidao_dados_gerais",e)}),(0,L.jsx)(ne,{label:"Certid\xe3o Corpo Diretivo (C\xf3digo/Hash)",value:s.identificacao_certidao_corpo_diretivo,onChange:e=>n("dados_gerais_entidade_beneficiaria.identificacao_certidao_corpo_diretivo",e)}),(0,L.jsx)(ne,{label:"Certid\xe3o Membros Conselho (C\xf3digo/Hash)",value:s.identificacao_certidao_membros_conselho,onChange:e=>n("dados_gerais_entidade_beneficiaria.identificacao_certidao_membros_conselho",e)})]}),(0,L.jsx)("p",{className:"mt-4 text-xs text-slate-500 italic",children:"* Informe o c\xf3digo de autentica\xe7\xe3o das certid\xf5es emitidas no cadastro do TCESP."})]})},Ny=e=>{let{data:t,updateField:n}=e;const s=t.responsaveis_membros_orgao_concessor||{};return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"20. Respons\xe1veis (\xd3rg\xe3o Concessor)"}),(0,L.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,L.jsx)(ne,{label:"Certid\xe3o Respons\xe1veis (C\xf3digo)",value:s.identificacao_certidao_responsaveis,onChange:e=>n("responsaveis_membros_orgao_concessor.identificacao_certidao_responsaveis",e)}),(0,L.jsx)(ne,{label:"Certid\xe3o Comiss\xe3o Avalia\xe7\xe3o (C\xf3digo)",value:s.identificacao_certidao_membros_comissao_avaliacao,onChange:e=>n("responsaveis_membros_orgao_concessor.identificacao_certidao_membros_comissao_avaliacao",e)}),(0,L.jsx)(ne,{label:"Certid\xe3o Controle Interno (C\xf3digo)",value:s.identificacao_certidao_membros_controle_interno,onChange:e=>n("responsaveis_membros_orgao_concessor.identificacao_certidao_membros_controle_interno",e)})]})]})},Iy=e=>{let{data:t,updateField:n}=e;const s=t.declaracoes||{},i=(e,t)=>{n("declaracoes.".concat(e),t)};return(0,L.jsx)("div",{className:"space-y-6",children:(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"21. Declara\xe7\xf5es Obrigat\xf3rias"}),(0,L.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border-2 border-blue-200 rounded-lg",children:[(0,L.jsx)("p",{className:"text-sm font-semibold text-blue-800 mb-2",children:"\ud83d\udcc4 Pr\xe9-preenchimento Autom\xe1tico"}),(0,L.jsx)("p",{className:"text-xs text-blue-700 mb-3",children:"Carregue um PDF com dados de empresas e respons\xe1veis para pr\xe9-preenchimento autom\xe1tico:"}),(0,L.jsx)(ay,{onDataExtracted:(e,t)=>{const s=oy(e);s.dados_gerais_entidade_beneficiaria&&n("dados_gerais_entidade_beneficiaria",s.dados_gerais_entidade_beneficiaria),s.descritor&&n("descritor",s.descritor);const i="\u2713 Dados extra\xeddos com ".concat(Math.round(100*t),"% confian\xe7a!");console.log(i,s)},onError:e=>{console.error("OCR Error:",e),alert("\u274c Erro na extra\xe7\xe3o: ".concat(e))}})]}),(0,L.jsxs)("div",{className:"mb-6 border-b border-slate-100 pb-6",children:[(0,L.jsxs)("div",{className:Q+" mb-4",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:s.houve_contratacao_empresas_pertencentes,onChange:e=>i("houve_contratacao_empresas_pertencentes",e.target.checked)}),(0,L.jsx)("label",{className:"font-bold text-slate-700",children:"Houve contrata\xe7\xe3o de empresas pertencentes a dirigentes?"})]}),s.houve_contratacao_empresas_pertencentes&&(0,L.jsxs)("div",{className:"pl-6 bg-red-50 p-4 rounded border border-red-100",children:[(0,L.jsx)("h4",{className:"text-sm font-bold text-red-800 mb-2",children:"Relacionar Empresas"}),(s.empresas_pertencentes||[]).map((e,t)=>(0,L.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,L.jsx)("div",{className:"w-1/2",children:(0,L.jsx)("input",{className:W,placeholder:"CNPJ",value:e.cnpj,onChange:e=>{const n=[...s.empresas_pertencentes||[]];n[t].cnpj=e.target.value,i("empresas_pertencentes",n)}})}),(0,L.jsx)("div",{className:"w-1/2",children:(0,L.jsx)("input",{className:W,placeholder:"CPF Dirigente",value:e.cpf,onChange:e=>{const n=[...s.empresas_pertencentes||[]];n[t].cpf=e.target.value,i("empresas_pertencentes",n)}})}),(0,L.jsx)("button",{onClick:()=>{const e=[...s.empresas_pertencentes||[]];e.splice(t,1),i("empresas_pertencentes",e)},className:K,children:"X"})]},t)),(0,L.jsx)("button",{onClick:()=>{const e=[...s.empresas_pertencentes||[]];e.push({cnpj:"",cpf:""}),i("empresas_pertencentes",e)},className:G+" mt-2",children:"+ Adicionar Empresa"})]})]}),(0,L.jsx)("div",{children:(0,L.jsxs)("div",{className:Q+" mb-4",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:s.houve_participacao_quadro_diretivo_administrativo,onChange:e=>i("houve_participacao_quadro_diretivo_administrativo",e.target.checked)}),(0,L.jsx)("label",{className:"font-bold text-slate-700",children:"Houve participa\xe7\xe3o do quadro diretivo em contrata\xe7\xf5es?"})]})})]})})},Py=e=>{let{title:t,items:n,onChange:s}=e;return(0,L.jsxs)("div",{className:"mb-6 border border-slate-200 rounded-lg overflow-hidden",children:[(0,L.jsx)("div",{className:"bg-slate-50 p-3 border-b border-slate-200",children:(0,L.jsx)("h4",{className:"font-bold text-slate-700 text-sm uppercase",children:t})}),(0,L.jsx)("div",{className:"p-4 space-y-3 bg-white",children:[{id:1,label:"Registro das compet\xeancias e estrutura organizacional"},{id:2,label:"Endere\xe7os, telefones e hor\xe1rios de atendimento"},{id:3,label:"Registros de repasses ou transfer\xeancias de recursos financeiros"},{id:4,label:"Registros das despesas"},{id:5,label:"Informa\xe7\xf5es sobre procedimentos licitat\xf3rios/compras"},{id:6,label:"Disponibiliza\xe7\xe3o de dados para acompanhamento de programas"}].map(e=>{const t=n.find(t=>t.requisito===e.id),i=!0===(null===t||void 0===t?void 0:t.atende);return(0,L.jsxs)("div",{className:"flex items-start gap-3 p-2 hover:bg-slate-50 rounded transition-colors",children:[(0,L.jsx)("input",{type:"checkbox",className:H+" mt-1",checked:i,onChange:t=>((e,t)=>{let i=[...n];const r=i.find(t=>t.requisito===e);t?r?r.atende=!0:i.push({requisito:e,atende:!0}):r?r.atende=!1:i.push({requisito:e,atende:!1}),s(i)})(e.id,t.target.checked)}),(0,L.jsxs)("div",{children:[(0,L.jsx)("span",{className:"text-sm text-slate-700 font-medium block",children:e.label}),(0,L.jsxs)("span",{className:"text-[10px] text-slate-400 font-mono",children:["C\xf3digo Requisito: ",e.id]})]})]},e.id)})})]})},Ry=e=>{let{data:t,updateField:n}=e;const s=t.transparencia||{entidade_beneficiaria_mantem_sitio_internet:!1,sitios_internet:[],requisitos_artigos_7o_8o_paragrafo_1o:[],requisitos_sitio_artigo_8o_paragrafo_3o:[],requisitos_divulgacao_informacoes:[]};return(0,L.jsx)("div",{className:"space-y-6",children:(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"27. Transpar\xeancia e Acesso \xe0 Informa\xe7\xe3o"}),(0,L.jsx)("div",{className:"mb-6 bg-blue-50 p-4 rounded border border-blue-100",children:(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[(0,L.jsx)("input",{type:"checkbox",className:H,checked:s.entidade_beneficiaria_mantem_sitio_internet,onChange:e=>n("transparencia.entidade_beneficiaria_mantem_sitio_internet",e.target.checked)}),(0,L.jsx)("label",{className:"font-bold text-blue-900",children:"Entidade benefici\xe1ria mant\xe9m S\xedtio na Internet?"})]})}),s.entidade_beneficiaria_mantem_sitio_internet&&(0,L.jsxs)("div",{className:"animate-in fade-in space-y-6",children:[(0,L.jsx)(te,{title:"Endere\xe7os dos S\xedtios Eletr\xf4nicos",items:s.sitios_internet||[],newItemTemplate:"",onAdd:()=>n("transparencia.sitios_internet",[...s.sitios_internet||[],""]),onRemove:e=>{const t=[...s.sitios_internet||[]];t.splice(e,1),n("transparencia.sitios_internet",t)},onUpdate:(e,t,i)=>{const r=[...s.sitios_internet||[]];r[e]=i,n("transparencia.sitios_internet",r)},renderItem:(e,t,n)=>(0,L.jsx)(ne,{label:"URL do S\xedtio",value:e,onChange:e=>n("",e)})}),(0,L.jsx)("hr",{className:"border-slate-200"}),(0,L.jsx)(Py,{title:"Requisitos Art. 7\xba e 8\xba, \xa7 1\xba (Conte\xfado M\xednimo)",items:s.requisitos_artigos_7o_8o_paragrafo_1o||[],onChange:e=>n("transparencia.requisitos_artigos_7o_8o_paragrafo_1o",e)}),(0,L.jsx)(Py,{title:"Requisitos Art. 8\xba, \xa7 3\xba (Ferramentas do S\xedtio)",items:s.requisitos_sitio_artigo_8o_paragrafo_3o||[],onChange:e=>n("transparencia.requisitos_sitio_artigo_8o_paragrafo_3o",e)}),(0,L.jsx)(Py,{title:"Requisitos de Divulga\xe7\xe3o de Informa\xe7\xf5es (Prazos e Formatos)",items:s.requisitos_divulgacao_informacoes||[],onChange:e=>n("transparencia.requisitos_divulgacao_informacoes",e)})]})]})})},My=e=>{let{activeSection:t,formData:n,updateField:s,updateItem:i,addItem:r,removeItem:o,handleDownload:a}=e;const l=(e,t)=>{"string"===typeof t?s(t,e):console.error("Critical: handleComplexAdd received invalid path:",t)};switch(t){case"descritor":case"1":return(0,L.jsx)(oe,{data:n,updateField:s});case"codigo_ajuste":case"2":return(0,L.jsx)(ae,{data:n,updateField:s});case"retificacao":case"3":return(0,L.jsx)(le,{data:n,updateField:s});case"dados_gerais":case"19":return(0,L.jsx)(Ty,{data:n,updateField:s});case"prestacao_benef":case"25":return(0,L.jsx)(ky,{data:n,updateField:s});case"responsaveis":case"20":return(0,L.jsx)(Ny,{data:n,updateField:s});case"empenhos":case"16":return(0,L.jsx)(wy,{data:n,onUpdate:(e,t,n)=>i("empenhos",e,t,n),onAdd:e=>r("empenhos",e),onRemove:e=>o("empenhos",e)});case"repasses":case"17":return(0,L.jsx)(fy,{data:n,fullData:n,onUpdate:(e,t,n)=>i("repasses",e,t,n),onAdd:e=>r("repasses",e),onRemove:e=>o("repasses",e)});case"receitas":case"10":return(0,L.jsx)(vy,{data:n,onUpdate:s,onAdd:l,onRemove:()=>{}});case"contratos":case"6":return(0,L.jsx)(ly,{data:n,onUpdate:(e,t,n)=>i("contratos",e,t,n),onAdd:e=>r("contratos",e),onRemove:e=>o("contratos",e)});case"documentos_fiscais":case"7":return(0,L.jsx)(cy,{data:n,fullData:n,onUpdate:(e,t,n)=>i("documentos_fiscais",e,t,n),onAdd:e=>r("documentos_fiscais",e),onRemove:e=>o("documentos_fiscais",e)});case"pagamentos":case"8":return(0,L.jsx)(dy,{data:n,fullData:n,onUpdate:(e,t,n)=>i("pagamentos",e,t,n),onAdd:e=>r("pagamentos",e),onRemove:e=>o("pagamentos",e)});case"glosas":case"15":return(0,L.jsx)(_y,{data:n,onUpdate:(e,t,n)=>i("glosas",e,t,n),onAdd:e=>r("glosas",e),onRemove:e=>o("glosas",e)});case"ajustes_saldo":case"11":return(0,L.jsx)(py,{data:n,onUpdate:s,onAdd:l,onRemove:()=>{}});case"descontos":case"13":return(0,L.jsx)(by,{data:n,onUpdate:(e,t,n)=>i("descontos",e,t,n),onAdd:e=>r("descontos",e),onRemove:e=>o("descontos",e)});case"devolucoes":case"14":return(0,L.jsx)(yy,{data:n,onUpdate:(e,t,n)=>i("devolucoes",e,t,n),onAdd:e=>r("devolucoes",e),onRemove:e=>o("devolucoes",e)});case"disponibilidades":case"9":return(0,L.jsx)(gy,{data:n,onUpdate:s,onAdd:l,onRemove:()=>{}});case"relatorio_atividades":case"18":return(0,L.jsx)(xy,{data:n,updateField:s});case"relatorio_gov":case"22":return(0,L.jsx)(Ay,{data:n,updateField:s});case"relacao_empregados":case"4":return(0,L.jsx)(uy,{data:n,onUpdate:(e,t,n)=>i("relacao_empregados",e,t,n),onAdd:e=>r("relacao_empregados",e),onRemove:e=>o("relacao_empregados",e)});case"servidores_cedidos":case"12":return(0,L.jsx)(hy,{data:n,onUpdate:(e,t,n)=>i("servidores_cedidos",e,t,n),onAdd:e=>r("servidores_cedidos",e),onRemove:e=>o("servidores_cedidos",e)});case"relacao_bens":case"5":return(0,L.jsx)(my,{data:n,onUpdate:s,onAdd:l,onRemove:()=>{}});case"demonstracoes":case"23":return(0,L.jsx)(Sy,{data:n,updateField:s});case"publicacoes":case"24":return(0,L.jsx)(Cy,{data:n,updateField:s});case"declaracoes":case"21":return(0,L.jsx)(Iy,{data:n,updateField:s});case"transparencia":case"27":return(0,L.jsx)(Ry,{data:n,updateField:s});case"parecer":case"26":return(0,L.jsx)(Ey,{data:n,updateField:s});case"preview":return(0,L.jsx)(re,{data:n,onDownloadJson:a});case"dashboard":return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"Dashboard"}),(0,L.jsx)("p",{className:"text-slate-500",children:"Vis\xe3o geral do preenchimento."})]});default:return(0,L.jsxs)("div",{className:z,children:[(0,L.jsx)(Z,{title:"Se\xe7\xe3o ".concat(t)}),(0,L.jsx)("p",{className:"text-slate-500",children:"Selecione uma se\xe7\xe3o no menu lateral."})]})}};function Oy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Dy,jy,Fy,Ly;let Uy,By;function Vy(e,t,n,s){var i,r;if(!(null===e||void 0===e?void 0:e.baseUrl)){const e={geminiUrl:Uy,vertexUrl:By};return t?null!==(i=e.vertexUrl)&&void 0!==i?i:n:null!==(r=e.geminiUrl)&&void 0!==r?r:s}return e.baseUrl}class Wy{}function Hy(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return void 0!==e&&null!==e?String(e):""}throw new Error("Key '".concat(n,"' not found in valueMap."))})}function qy(e,t,n){for(let r=0;r<t.length-1;r++){const s=t[r];if(s.endsWith("[]")){const i=s.slice(0,-2);if(!(i in e)){if(!Array.isArray(n))throw new Error("Value must be a list given an array path ".concat(s));e[i]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[i])){const s=e[i];if(Array.isArray(n))for(let e=0;e<s.length;e++){qy(s[e],t.slice(r+1),n[e])}else for(const e of s)qy(e,t.slice(r+1),n)}return}if(s.endsWith("[0]")){const i=s.slice(0,-3);i in e||(e[i]=[{}]);return void qy(e[i][0],t.slice(r+1),n)}e[s]&&"object"===typeof e[s]||(e[s]={}),e=e[s]}const s=t[t.length-1],i=e[s];if(void 0!==i){if(!n||"object"===typeof n&&0===Object.keys(n).length)return;if(n===i)return;if("object"!==typeof i||"object"!==typeof n||null===i||null===n)throw new Error("Cannot set value for an existing key. Key: ".concat(s));Object.assign(i,n)}else if("_self"!==s||"object"!==typeof n||null===n||Array.isArray(n))e[s]=n;else{const t=n;Object.assign(e,t)}}function zy(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;try{if(1===t.length&&"_self"===t[0])return e;for(let s=0;s<t.length;s++){if("object"!==typeof e||null===e)return n;const i=t[s];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in e){const i=e[r];return Array.isArray(i)?i.map(e=>zy(e,t.slice(s+1),n)):n}return n}e=e[i]}return e}catch(s){if(s instanceof TypeError)return n;throw s}}function Gy(e,t,n,s,i){if(s>=t.length)return;if("object"!==typeof e||null===e)return;const r=t[s];if(r.endsWith("[]")){const o=r.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const e of a[o])Gy(e,t,n,s+1,i)}else if("*"===r){if("object"===typeof e&&null!==e&&!Array.isArray(e)){const t=e,r=Object.keys(t).filter(e=>!e.startsWith("_")&&!i.has(e)),o={};for(const e of r)o[e]=t[e];for(const[e,i]of Object.entries(o)){const r=[];for(const t of n.slice(s))"*"===t?r.push(e):r.push(t);qy(t,r,i)}for(const e of r)delete t[e]}}else{r in e&&Gy(e[r],t,n,s+1,i)}}function Ky(e){if("string"!==typeof e)throw new Error("fromImageBytes must be a string");return e}function Jy(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response","generateVideoResponse"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["video"]);null!=n&&qy(t,["video"],function(e){const t={},n=zy(e,["uri"]);null!=n&&qy(t,["uri"],n);const s=zy(e,["encodedVideo"]);null!=s&&qy(t,["videoBytes"],Ky(s));const i=zy(e,["encoding"]);null!=i&&qy(t,["mimeType"],i);return t}(n));return t}(e))),qy(t,["generatedVideos"],e)}const s=zy(e,["raiMediaFilteredCount"]);null!=s&&qy(t,["raiMediaFilteredCount"],s);const i=zy(e,["raiMediaFilteredReasons"]);null!=i&&qy(t,["raiMediaFilteredReasons"],i);return t}(o)),t}function Yy(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["_self"]);null!=n&&qy(t,["video"],function(e){const t={},n=zy(e,["gcsUri"]);null!=n&&qy(t,["uri"],n);const s=zy(e,["bytesBase64Encoded"]);null!=s&&qy(t,["videoBytes"],Ky(s));const i=zy(e,["mimeType"]);null!=i&&qy(t,["mimeType"],i);return t}(n));return t}(e))),qy(t,["generatedVideos"],e)}const s=zy(e,["raiMediaFilteredCount"]);null!=s&&qy(t,["raiMediaFilteredCount"],s);const i=zy(e,["raiMediaFilteredReasons"]);null!=i&&qy(t,["raiMediaFilteredReasons"],i);return t}(o)),t}function $y(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["parent"]);null!=s&&qy(t,["parent"],s);const i=zy(e,["documentName"]);null!=i&&qy(t,["documentName"],i);return t}(o)),t}function Xy(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["parent"]);null!=s&&qy(t,["parent"],s);const i=zy(e,["documentName"]);null!=i&&qy(t,["documentName"],i);return t}(o)),t}var Qy,Zy,e_,t_,n_,s_,i_,r_,o_,a_,l_,c_,d_,u_,h_,p_,f_,m_,g_,v_,b_,y_,__,w_,x_,E_,S_,A_,C_,k_,T_,N_,I_,P_,R_,M_,O_,D_,j_,F_,L_,U_,B_,V_,W_,H_,q_,z_,G_,K_,J_,Y_,$_,X_,Q_,Z_,ew;!function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(Qy||(Qy={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(Zy||(Zy={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(e_||(e_={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(t_||(t_={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}(n_||(n_={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(s_||(s_={})),function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"}(i_||(i_={})),function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"}(r_||(r_={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(o_||(o_={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(a_||(a_={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"}(l_||(l_={})),function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"}(c_||(c_={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"}(d_||(d_={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(u_||(u_={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(h_||(h_={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"}(p_||(p_={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(f_||(f_={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(m_||(m_={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(g_||(g_={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"}(v_||(v_={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(b_||(b_={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(y_||(y_={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(__||(__={})),function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(w_||(w_={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(x_||(x_={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(E_||(E_={})),function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"}(S_||(S_={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"}(A_||(A_={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(C_||(C_={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(k_||(k_={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(T_||(T_={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(N_||(N_={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(I_||(I_={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(P_||(P_={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(R_||(R_={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(M_||(M_={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(O_||(O_={})),function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"}(D_||(D_={})),function(e){e.ASSET="ASSET",e.STYLE="STYLE"}(j_||(j_={})),function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"}(F_||(F_={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(L_||(L_={})),function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"}(U_||(U_={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"}(B_||(B_={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(V_||(V_={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"}(W_||(W_={})),function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"}(H_||(H_={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(q_||(q_={})),function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"}(z_||(z_={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"}(G_||(G_={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(K_||(K_={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(J_||(J_={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(Y_||(Y_={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}($_||($_={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(X_||(X_={})),function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"}(Q_||(Q_={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(Z_||(Z_={}));class tw{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class nw{get text(){var e,t,n,s,i,r,o,a;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",c=!1;const d=[];for(const u of null!==(a=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(const[e,t]of Object.entries(u))"text"===e||"thought"===e||"thoughtSignature"===e||null===t&&void 0===t||d.push(e);if("string"===typeof u.text){if("boolean"===typeof u.thought&&u.thought)continue;c=!0,l+=u.text}}return d.length>0&&console.warn("there are non-text parts ".concat(d," in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.")),c?l:void 0}get data(){var e,t,n,s,i,r,o,a;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="";const c=[];for(const d of null!==(a=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(const[e,t]of Object.entries(d))"inlineData"===e||null===t&&void 0===t||c.push(e);d.inlineData&&"string"===typeof d.inlineData.data&&(l+=atob(d.inlineData.data))}return c.length>0&&console.warn("there are non-data parts ".concat(c," in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.")),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,n,s,i,r,o,a;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const l=null===(a=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null===l||void 0===l?void 0:l.length)?l:void 0}get executableCode(){var e,t,n,s,i,r,o,a,l;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const c=null===(a=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null===c||void 0===c?void 0:c.length)?null===(l=null===c||void 0===c?void 0:c[0])||void 0===l?void 0:l.code:void 0}get codeExecutionResult(){var e,t,n,s,i,r,o,a,l;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const c=null===(a=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null===c||void 0===c?void 0:c.length)?null===(l=null===c||void 0===c?void 0:c[0])||void 0===l?void 0:l.output:void 0}}class sw{}class iw{}class rw{}class ow{}class aw{}class lw{}class cw{}class dw{}class uw{}class hw{}class pw{_fromAPIResponse(e){let{apiResponse:t,_isVertexAI:n}=e;const s=new pw;let i;const r=t;return i=n?Yy(r):Jy(r),Object.assign(s,i),s}}class fw{}class mw{}class gw{}class vw{}class bw{}class yw{}class _w{}class ww{_fromAPIResponse(e){let{apiResponse:t,_isVertexAI:n}=e;const s=new ww,i=$y(t);return Object.assign(s,i),s}}class xw{}class Ew{}class Sw{}class Aw{}class Cw{get text(){var e,t,n;let s="",i=!1;const r=[];for(const o of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&r.push(e);if("string"===typeof o.text){if("boolean"===typeof o.thought&&o.thought)continue;i=!0,s+=o.text}}return r.length>0&&console.warn("there are non-text parts ".concat(r," in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.")),i?s:void 0}get data(){var e,t,n;let s="";const i=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"inlineData"!==e&&null!==t&&i.push(e);r.inlineData&&"string"===typeof r.inlineData.data&&(s+=atob(r.inlineData.data))}return i.length>0&&console.warn("there are non-data parts ".concat(i," in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.")),s.length>0?btoa(s):void 0}}class kw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Tw{_fromAPIResponse(e){let{apiResponse:t,_isVertexAI:n}=e;const s=new Tw,i=Xy(t);return Object.assign(s,i),s}}function Nw(e,t){if(!t||"string"!==typeof t)throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return"publishers/".concat(e[0],"/models/").concat(e[1])}return"publishers/google/models/".concat(t)}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:"models/".concat(t)}function Iw(e,t){const n=Nw(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(n):n.startsWith("models/")&&e.isVertexAI()?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/publishers/google/").concat(n):n:""}function Pw(e){return Array.isArray(e)?e.map(e=>Rw(e)):[Rw(e)]}function Rw(e){if("object"===typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: ".concat(typeof e))}function Mw(e){const t=Rw(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error("Unsupported mime type: ".concat(t.mimeType))}function Ow(e){const t=Rw(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error("Unsupported mime type: ".concat(t.mimeType))}function Dw(e){if(null===e||void 0===e)throw new Error("PartUnion is required");if("object"===typeof e)return e;if("string"===typeof e)return{text:e};throw new Error("Unsupported part type: ".concat(typeof e))}function jw(e){if(null===e||void 0===e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>Dw(e)):[Dw(e)]}function Fw(e){return null!==e&&void 0!==e&&"object"===typeof e&&"parts"in e&&Array.isArray(e.parts)}function Lw(e){return null!==e&&void 0!==e&&"object"===typeof e&&"functionCall"in e}function Uw(e){return null!==e&&void 0!==e&&"object"===typeof e&&"functionResponse"in e}function Bw(e){if(null===e||void 0===e)throw new Error("ContentUnion is required");return Fw(e)?e:{role:"user",parts:jw(e)}}function Vw(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=Bw(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=Bw(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>Bw(e)):[Bw(t)]}function Ww(e){if(null===e||void 0===e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(Lw(e)||Uw(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Bw(e)]}const t=[],n=[],s=Fw(e[0]);for(const i of e){const e=Fw(i);if(e!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else{if(Lw(i)||Uw(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return s||t.push({role:"user",parts:jw(n)}),t}function Hw(e){const t={},n=["items"],s=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=e.anyOf;null!=r&&2==r.length&&("null"===r[0].type?(t.nullable=!0,e=r[1]):"null"===r[1].type&&(t.nullable=!0,e=r[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(t_).includes(n[0].toUpperCase())?n[0].toUpperCase():t_.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(t_).includes(e.toUpperCase())?e.toUpperCase():t_.TYPE_UNSPECIFIED})}}(e.type,t);for(const[o,a]of Object.entries(e))if(null!=a)if("type"==o){if("null"===a)throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(t_).includes(a.toUpperCase())?a.toUpperCase():t_.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=Hw(a);else if(s.includes(o)){const e=[];for(const n of a)"null"!=n.type?e.push(Hw(n)):t.nullable=!0;t[o]=e}else if(i.includes(o)){const e={};for(const[t,n]of Object.entries(a))e[t]=Hw(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}return t}function qw(e){return Hw(e)}function zw(e){if("object"===typeof e)return e;if("string"===typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: ".concat(typeof e))}function Gw(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Kw(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Hw(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Hw(t.response));return e}function Jw(e){if(void 0===e||null===e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Yw(e,t){if("string"!==typeof t)throw new Error("name must be a string");return function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=!t.startsWith("".concat(n,"/"))&&t.split("/").length===s;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?"projects/".concat(e.getProject(),"/").concat(t):t.startsWith("".concat(n,"/"))?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(t):i?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(n,"/").concat(t):t:i?"".concat(n,"/").concat(t):t}(e,t,"cachedContents")}function $w(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Xw(e){return Ky(e)}function Qw(e){var t;let n;var s;if(null!==(s=e)&&void 0!==s&&"object"===typeof s&&"name"in s&&(n=e.name),(!function(e){return null!==e&&void 0!==e&&"object"===typeof e&&"uri"in e}(e)||(n=e.uri,void 0!==n))&&(!function(e){return null!==e&&void 0!==e&&"object"===typeof e&&"video"in e}(e)||(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0!==n))){if("string"===typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error("Could not extract file name from URI ".concat(n));n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Zw(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function ex(e){for(const t of["models","tunedModels","publisherModels"])if(tx(e,t))return e[t];return[]}function tx(e,t){return null!==e&&"object"===typeof e&&t in e}function nx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e,s={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};n.outputSchema&&(s.responseJsonSchema=n.outputSchema),t.behavior&&(s.behavior=t.behavior);return{functionDeclarations:[s]}}function sx(e,t){let n;if("string"===typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else{if(!t.startsWith("bq://"))throw new Error("Unsupported string source for Vertex AI: ".concat(t));n={format:"bigquery",bigqueryUri:t}}else{if(!t.startsWith("files/"))throw new Error("Unsupported string source for Gemini API: ".concat(t));n={fileName:t}}else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const s=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||1!==s)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||1!==i)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function ix(e){if("object"!==typeof e||null===e)return{};const t=e,n=t.inlinedResponses;if("object"!==typeof n||null===n)return e;const s=n.inlinedResponses;if(!Array.isArray(s)||0===s.length)return e;let i=!1;for(const r of s){if("object"!==typeof r||null===r)continue;const e=r.response;if("object"!==typeof e||null===e)continue;if(void 0!==e.embedding){i=!0;break}}return i&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function rx(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error("Invalid batch job name: ".concat(n,"."))}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error("Invalid batch job name: ".concat(n,"."))}function ox(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_RUNNING"===e?"JOB_STATE_RUNNING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":"BATCH_STATE_EXPIRED"===e?"JOB_STATE_EXPIRED":e}function ax(e){const t={},n=zy(e,["responsesFile"]);null!=n&&qy(t,["fileName"],n);const s=zy(e,["inlinedResponses","inlinedResponses"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["response"]);null!=n&&qy(t,["response"],function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["candidates"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["content"]);null!=n&&qy(t,["content"],n);const s=zy(e,["citationMetadata"]);null!=s&&qy(t,["citationMetadata"],function(e){const t={},n=zy(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["citations"],e)}return t}(s));const i=zy(e,["tokenCount"]);null!=i&&qy(t,["tokenCount"],i);const r=zy(e,["finishReason"]);null!=r&&qy(t,["finishReason"],r);const o=zy(e,["avgLogprobs"]);null!=o&&qy(t,["avgLogprobs"],o);const a=zy(e,["groundingMetadata"]);null!=a&&qy(t,["groundingMetadata"],a);const l=zy(e,["index"]);null!=l&&qy(t,["index"],l);const c=zy(e,["logprobsResult"]);null!=c&&qy(t,["logprobsResult"],c);const d=zy(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["safetyRatings"],e)}const u=zy(e,["urlContextMetadata"]);null!=u&&qy(t,["urlContextMetadata"],u);return t}(e))),qy(t,["candidates"],e)}const i=zy(e,["modelVersion"]);null!=i&&qy(t,["modelVersion"],i);const r=zy(e,["promptFeedback"]);null!=r&&qy(t,["promptFeedback"],r);const o=zy(e,["responseId"]);null!=o&&qy(t,["responseId"],o);const a=zy(e,["usageMetadata"]);null!=a&&qy(t,["usageMetadata"],a);return t}(n));const s=zy(e,["error"]);null!=s&&qy(t,["error"],s);return t}(e))),qy(t,["inlinedResponses"],e)}const i=zy(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["inlinedEmbedContentResponses"],e)}return t}function lx(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata","displayName"]);null!=s&&qy(t,["displayName"],s);const i=zy(e,["metadata","state"]);null!=i&&qy(t,["state"],ox(i));const r=zy(e,["metadata","createTime"]);null!=r&&qy(t,["createTime"],r);const o=zy(e,["metadata","endTime"]);null!=o&&qy(t,["endTime"],o);const a=zy(e,["metadata","updateTime"]);null!=a&&qy(t,["updateTime"],a);const l=zy(e,["metadata","model"]);null!=l&&qy(t,["model"],l);const c=zy(e,["metadata","output"]);return null!=c&&qy(t,["dest"],ax(ix(c))),t}function cx(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["displayName"]);null!=s&&qy(t,["displayName"],s);const i=zy(e,["state"]);null!=i&&qy(t,["state"],ox(i));const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["createTime"]);null!=o&&qy(t,["createTime"],o);const a=zy(e,["startTime"]);null!=a&&qy(t,["startTime"],a);const l=zy(e,["endTime"]);null!=l&&qy(t,["endTime"],l);const c=zy(e,["updateTime"]);null!=c&&qy(t,["updateTime"],c);const d=zy(e,["model"]);null!=d&&qy(t,["model"],d);const u=zy(e,["inputConfig"]);null!=u&&qy(t,["src"],function(e){const t={},n=zy(e,["instancesFormat"]);null!=n&&qy(t,["format"],n);const s=zy(e,["gcsSource","uris"]);null!=s&&qy(t,["gcsUri"],s);const i=zy(e,["bigquerySource","inputUri"]);null!=i&&qy(t,["bigqueryUri"],i);return t}(u));const h=zy(e,["outputConfig"]);null!=h&&qy(t,["dest"],function(e){const t={},n=zy(e,["predictionsFormat"]);null!=n&&qy(t,["format"],n);const s=zy(e,["gcsDestination","outputUriPrefix"]);null!=s&&qy(t,["gcsUri"],s);const i=zy(e,["bigqueryDestination","outputUri"]);return null!=i&&qy(t,["bigqueryUri"],i),t}(ix(h)));const p=zy(e,["completionStats"]);return null!=p&&qy(t,["completionStats"],p),t}function dx(e,t){const n={};if(void 0!==zy(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==zy(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==zy(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=zy(t,["fileName"]);null!=s&&qy(n,["fileName"],s);const i=zy(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["request","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let e=Ww(i);Array.isArray(e)&&(e=e.map(e=>ux(e))),qy(n,["request","contents"],e)}const r=zy(t,["metadata"]);null!=r&&qy(n,["metadata"],r);const o=zy(t,["config"]);null!=o&&qy(n,["request","generationConfig"],function(e,t,n){const s={},i=zy(t,["systemInstruction"]);void 0!==n&&null!=i&&qy(n,["systemInstruction"],ux(Bw(i)));const r=zy(t,["temperature"]);null!=r&&qy(s,["temperature"],r);const o=zy(t,["topP"]);null!=o&&qy(s,["topP"],o);const a=zy(t,["topK"]);null!=a&&qy(s,["topK"],a);const l=zy(t,["candidateCount"]);null!=l&&qy(s,["candidateCount"],l);const c=zy(t,["maxOutputTokens"]);null!=c&&qy(s,["maxOutputTokens"],c);const d=zy(t,["stopSequences"]);null!=d&&qy(s,["stopSequences"],d);const u=zy(t,["responseLogprobs"]);null!=u&&qy(s,["responseLogprobs"],u);const h=zy(t,["logprobs"]);null!=h&&qy(s,["logprobs"],h);const p=zy(t,["presencePenalty"]);null!=p&&qy(s,["presencePenalty"],p);const f=zy(t,["frequencyPenalty"]);null!=f&&qy(s,["frequencyPenalty"],f);const m=zy(t,["seed"]);null!=m&&qy(s,["seed"],m);const g=zy(t,["responseMimeType"]);null!=g&&qy(s,["responseMimeType"],g);const v=zy(t,["responseSchema"]);null!=v&&qy(s,["responseSchema"],qw(v));const b=zy(t,["responseJsonSchema"]);null!=b&&qy(s,["responseJsonSchema"],b);if(void 0!==zy(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==zy(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=zy(t,["safetySettings"]);if(void 0!==n&&null!=y){let e=y;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["category"]);null!=n&&qy(t,["category"],n);if(void 0!==zy(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const s=zy(e,["threshold"]);null!=s&&qy(t,["threshold"],s);return t}(e))),qy(n,["safetySettings"],e)}const _=zy(t,["tools"]);if(void 0!==n&&null!=_){let e=Jw(_);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==zy(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=zy(e,["computerUse"]);null!=n&&qy(t,["computerUse"],n);const s=zy(e,["fileSearch"]);null!=s&&qy(t,["fileSearch"],s);const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);if(void 0!==zy(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=zy(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["functionDeclarations"],e)}const o=zy(e,["googleMaps"]);null!=o&&qy(t,["googleMaps"],function(e){const t={};if(void 0!==zy(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=zy(e,["enableWidget"]);null!=n&&qy(t,["enableWidget"],n);return t}(o));const a=zy(e,["googleSearch"]);null!=a&&qy(t,["googleSearch"],function(e){const t={};if(void 0!==zy(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==zy(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=zy(e,["timeRangeFilter"]);null!=n&&qy(t,["timeRangeFilter"],n);return t}(a));const l=zy(e,["googleSearchRetrieval"]);null!=l&&qy(t,["googleSearchRetrieval"],l);const c=zy(e,["urlContext"]);null!=c&&qy(t,["urlContext"],c);return t}(Kw(e)))),qy(n,["tools"],e)}const w=zy(t,["toolConfig"]);void 0!==n&&null!=w&&qy(n,["toolConfig"],function(e){const t={},n=zy(e,["retrievalConfig"]);null!=n&&qy(t,["retrievalConfig"],n);const s=zy(e,["functionCallingConfig"]);null!=s&&qy(t,["functionCallingConfig"],function(e){const t={},n=zy(e,["allowedFunctionNames"]);null!=n&&qy(t,["allowedFunctionNames"],n);const s=zy(e,["mode"]);null!=s&&qy(t,["mode"],s);if(void 0!==zy(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(s));return t}(w));if(void 0!==zy(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const x=zy(t,["cachedContent"]);void 0!==n&&null!=x&&qy(n,["cachedContent"],Yw(e,x));const E=zy(t,["responseModalities"]);null!=E&&qy(s,["responseModalities"],E);const S=zy(t,["mediaResolution"]);null!=S&&qy(s,["mediaResolution"],S);const A=zy(t,["speechConfig"]);null!=A&&qy(s,["speechConfig"],zw(A));if(void 0!==zy(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const C=zy(t,["thinkingConfig"]);null!=C&&qy(s,["thinkingConfig"],C);const k=zy(t,["imageConfig"]);null!=k&&qy(s,["imageConfig"],function(e){const t={},n=zy(e,["aspectRatio"]);null!=n&&qy(t,["aspectRatio"],n);const s=zy(e,["imageSize"]);null!=s&&qy(t,["imageSize"],s);if(void 0!==zy(e,["personGeneration"]))throw new Error("personGeneration parameter is not supported in Gemini API.");if(void 0!==zy(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==zy(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(k));const T=zy(t,["enableEnhancedCivicAnswers"]);null!=T&&qy(s,["enableEnhancedCivicAnswers"],T);return s}(e,o,zy(n,["request"],{})));return n}(e,t))),qy(n,["requests","requests"],t)}return n}function ux(e){const t={},n=zy(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["mediaResolution"]);null!=n&&qy(t,["mediaResolution"],n);const s=zy(e,["codeExecutionResult"]);null!=s&&qy(t,["codeExecutionResult"],s);const i=zy(e,["executableCode"]);null!=i&&qy(t,["executableCode"],i);const r=zy(e,["fileData"]);null!=r&&qy(t,["fileData"],function(e){const t={};if(void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=zy(e,["fileUri"]);null!=n&&qy(t,["fileUri"],n);const s=zy(e,["mimeType"]);null!=s&&qy(t,["mimeType"],s);return t}(r));const o=zy(e,["functionCall"]);null!=o&&qy(t,["functionCall"],function(e){const t={},n=zy(e,["id"]);null!=n&&qy(t,["id"],n);const s=zy(e,["args"]);null!=s&&qy(t,["args"],s);const i=zy(e,["name"]);null!=i&&qy(t,["name"],i);if(void 0!==zy(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==zy(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=zy(e,["functionResponse"]);null!=a&&qy(t,["functionResponse"],a);const l=zy(e,["inlineData"]);null!=l&&qy(t,["inlineData"],function(e){const t={},n=zy(e,["data"]);if(null!=n&&qy(t,["data"],n),void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=zy(e,["mimeType"]);return null!=s&&qy(t,["mimeType"],s),t}(l));const c=zy(e,["text"]);null!=c&&qy(t,["text"],c);const d=zy(e,["thought"]);null!=d&&qy(t,["thought"],d);const u=zy(e,["thoughtSignature"]);null!=u&&qy(t,["thoughtSignature"],u);const h=zy(e,["videoMetadata"]);null!=h&&qy(t,["videoMetadata"],h);return t}(e))),qy(t,["parts"],e)}const s=zy(e,["role"]);return null!=s&&qy(t,["role"],s),t}function hx(e,t){const n=zy(e,["displayName"]);void 0!==t&&null!=n&&qy(t,["displayName"],n);const s=zy(e,["dest"]);return void 0!==t&&null!=s&&qy(t,["outputConfig"],function(e){const t={},n=zy(e,["format"]);null!=n&&qy(t,["predictionsFormat"],n);const s=zy(e,["gcsUri"]);null!=s&&qy(t,["gcsDestination","outputUriPrefix"],s);const i=zy(e,["bigqueryUri"]);if(null!=i&&qy(t,["bigqueryDestination","outputUri"],i),void 0!==zy(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==zy(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==zy(e,["inlinedEmbedContentResponses"]))throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!==typeof e)return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error("Unsupported destination: ".concat(t))}(s))),{}}function px(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["src"]);null!=i&&qy(n,["batch","inputConfig"],dx(e,sx(e,i)));const r=zy(t,["config"]);return null!=r&&function(e,t){const n=zy(e,["displayName"]);if(void 0!==t&&null!=n&&qy(t,["batch","displayName"],n),void 0!==zy(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.")}(r,n),n}function fx(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["model"],Nw(e,s));const i=zy(t,["src"]);null!=i&&qy(n,["inputConfig"],function(e){const t={},n=zy(e,["format"]);null!=n&&qy(t,["instancesFormat"],n);const s=zy(e,["gcsUri"]);null!=s&&qy(t,["gcsSource","uris"],s);const i=zy(e,["bigqueryUri"]);if(null!=i&&qy(t,["bigquerySource","inputUri"],i),void 0!==zy(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==zy(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(sx(e,i)));const r=zy(t,["config"]);return null!=r&&hx(r,n),n}function mx(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["src"]);null!=i&&qy(n,["batch","inputConfig"],function(e,t){const n={},s=zy(t,["fileName"]);null!=s&&qy(n,["file_name"],s);const i=zy(t,["inlinedRequests"]);null!=i&&qy(n,["requests"],function(e,t){const n={},s=zy(t,["contents"]);if(null!=s){let t=Vw(e,s);Array.isArray(t)&&(t=t.map(e=>e)),qy(n,["requests[]","request","content"],t)}const i=zy(t,["config"]);null!=i&&(qy(n,["_self"],function(e,t){const n={},s=zy(e,["taskType"]);void 0!==t&&null!=s&&qy(t,["requests[]","taskType"],s);const i=zy(e,["title"]);void 0!==t&&null!=i&&qy(t,["requests[]","title"],i);const r=zy(e,["outputDimensionality"]);void 0!==t&&null!=r&&qy(t,["requests[]","outputDimensionality"],r);if(void 0!==zy(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==zy(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}(i,n)),function(e,t){for(const[n,s]of Object.entries(t)){const t=n.split("."),i=s.split("."),r=new Set;let o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&i.length>o)for(let e=o;e<i.length;e++){const t=i[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||r.add(t)}Gy(e,t,i,0,r)}}(n,{"requests[].*":"requests[].request.*"}));return n}(e,i));return n}(e,i));const r=zy(t,["config"]);return null!=r&&function(e,t){const n=zy(e,["displayName"]);void 0!==t&&null!=n&&qy(t,["batch","displayName"],n)}(r,n),n}function gx(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);if(void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s),void 0!==zy(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.")}(n,t),t}function vx(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s);const i=zy(e,["filter"]);void 0!==t&&null!=i&&qy(t,["_query","filter"],i)}(n,t),t}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"}(ew||(ew={}));class bx{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null===t||void 0===t?void 0:t.sdkHttpResponse,this.idxInternal=0;let r={config:{}};r=n&&0!==Object.keys(n).length?"object"===typeof n?Object.assign({},n):n:{config:{}},r.config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!==(i=null===(s=r.config)||void 0===s?void 0:s.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}class yx extends Wy{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new bx(ew.PAGED_ITEM_BATCH_JOBS,e=>t.listInternal(e),await t.listInternal(e),e)},this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){const t=px(this.apiClient,e),n=Hy("{model}:batchGenerateContent",t._url),s=t.batch.inputConfig.requests,i=s.requests,r=[];for(const o of i){const e=Object.assign({},o);if(e.systemInstruction){const t=e.systemInstruction;delete e.systemInstruction;const n=e.request;n.systemInstruction=t,e.request=n}r.push(e)}return s.requests=r,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"===typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"===typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName="genaiBatchJob_".concat(s)),void 0===n.dest){const t=this.getGcsUri(e),i=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest="".concat(t.slice(0,-6),"/dest"):n.dest="".concat(t,"_dest_").concat(s);else{if(!i)throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");n.dest="".concat(i,"_dest_").concat(s)}}return n}async createInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=fx(this.apiClient,e);return o=Hy("batchPredictionJobs",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>cx(e))}{const t=px(this.apiClient,e);return o=Hy("{model}:batchGenerateContent",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>lx(e))}}async createEmbeddingsInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=mx(this.apiClient,e);return i=Hy("{model}:asyncBatchEmbedContent",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>lx(e))}}async get(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],rx(e,s)),n}(this.apiClient,e);return o=Hy("batchPredictionJobs/{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>cx(e))}{const t=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],rx(e,s)),n}(this.apiClient,e);return o=Hy("batches/{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>lx(e))}}async cancel(e){var t,n,s,i;let r="",o={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],rx(e,s)),n}(this.apiClient,e);r=Hy("batchPredictionJobs/{name}:cancel",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],rx(e,s)),n}(this.apiClient,e);r=Hy("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}}async listInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=vx(e);return o=Hy("batchPredictionJobs",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["batchPredictionJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>cx(e))),qy(t,["batchJobs"],e)}return t}(e),n=new Aw;return Object.assign(n,t),n})}{const t=gx(e);return o=Hy("batches",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["operations"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>lx(e))),qy(t,["batchJobs"],e)}return t}(e),n=new Aw;return Object.assign(n,t),n})}}async delete(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],rx(e,s)),n}(this.apiClient,e);return o=Hy("batchPredictionJobs/{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["name"]);null!=s&&qy(t,["name"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);return null!=r&&qy(t,["error"],r),t}(e))}{const t=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],rx(e,s)),n}(this.apiClient,e);return o=Hy("batches/{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["name"]);null!=s&&qy(t,["name"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);return null!=r&&qy(t,["error"],r),t}(e))}}}function _x(e){const t={},n=zy(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["mediaResolution"]);null!=n&&qy(t,["mediaResolution"],n);const s=zy(e,["codeExecutionResult"]);null!=s&&qy(t,["codeExecutionResult"],s);const i=zy(e,["executableCode"]);null!=i&&qy(t,["executableCode"],i);const r=zy(e,["fileData"]);null!=r&&qy(t,["fileData"],function(e){const t={};if(void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=zy(e,["fileUri"]);null!=n&&qy(t,["fileUri"],n);const s=zy(e,["mimeType"]);null!=s&&qy(t,["mimeType"],s);return t}(r));const o=zy(e,["functionCall"]);null!=o&&qy(t,["functionCall"],function(e){const t={},n=zy(e,["id"]);null!=n&&qy(t,["id"],n);const s=zy(e,["args"]);null!=s&&qy(t,["args"],s);const i=zy(e,["name"]);null!=i&&qy(t,["name"],i);if(void 0!==zy(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==zy(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=zy(e,["functionResponse"]);null!=a&&qy(t,["functionResponse"],a);const l=zy(e,["inlineData"]);null!=l&&qy(t,["inlineData"],function(e){const t={},n=zy(e,["data"]);if(null!=n&&qy(t,["data"],n),void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=zy(e,["mimeType"]);return null!=s&&qy(t,["mimeType"],s),t}(l));const c=zy(e,["text"]);null!=c&&qy(t,["text"],c);const d=zy(e,["thought"]);null!=d&&qy(t,["thought"],d);const u=zy(e,["thoughtSignature"]);null!=u&&qy(t,["thoughtSignature"],u);const h=zy(e,["videoMetadata"]);null!=h&&qy(t,["videoMetadata"],h);return t}(e))),qy(t,["parts"],e)}const s=zy(e,["role"]);return null!=s&&qy(t,["role"],s),t}function wx(e,t){const n=zy(e,["ttl"]);void 0!==t&&null!=n&&qy(t,["ttl"],n);const s=zy(e,["expireTime"]);void 0!==t&&null!=s&&qy(t,["expireTime"],s);const i=zy(e,["displayName"]);void 0!==t&&null!=i&&qy(t,["displayName"],i);const r=zy(e,["contents"]);if(void 0!==t&&null!=r){let e=Ww(r);Array.isArray(e)&&(e=e.map(e=>_x(e))),qy(t,["contents"],e)}const o=zy(e,["systemInstruction"]);void 0!==t&&null!=o&&qy(t,["systemInstruction"],_x(Bw(o)));const a=zy(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==zy(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=zy(e,["computerUse"]);null!=n&&qy(t,["computerUse"],n);const s=zy(e,["fileSearch"]);null!=s&&qy(t,["fileSearch"],s);const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);if(void 0!==zy(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=zy(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["functionDeclarations"],e)}const o=zy(e,["googleMaps"]);null!=o&&qy(t,["googleMaps"],function(e){const t={};if(void 0!==zy(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=zy(e,["enableWidget"]);null!=n&&qy(t,["enableWidget"],n);return t}(o));const a=zy(e,["googleSearch"]);null!=a&&qy(t,["googleSearch"],function(e){const t={};if(void 0!==zy(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==zy(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=zy(e,["timeRangeFilter"]);null!=n&&qy(t,["timeRangeFilter"],n);return t}(a));const l=zy(e,["googleSearchRetrieval"]);null!=l&&qy(t,["googleSearchRetrieval"],l);const c=zy(e,["urlContext"]);null!=c&&qy(t,["urlContext"],c);return t}(e))),qy(t,["tools"],e)}const l=zy(e,["toolConfig"]);if(void 0!==t&&null!=l&&qy(t,["toolConfig"],function(e){const t={},n=zy(e,["retrievalConfig"]);null!=n&&qy(t,["retrievalConfig"],n);const s=zy(e,["functionCallingConfig"]);null!=s&&qy(t,["functionCallingConfig"],function(e){const t={},n=zy(e,["allowedFunctionNames"]);null!=n&&qy(t,["allowedFunctionNames"],n);const s=zy(e,["mode"]);null!=s&&qy(t,["mode"],s);if(void 0!==zy(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(s));return t}(l)),void 0!==zy(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}function xx(e,t){const n=zy(e,["ttl"]);void 0!==t&&null!=n&&qy(t,["ttl"],n);const s=zy(e,["expireTime"]);void 0!==t&&null!=s&&qy(t,["expireTime"],s);const i=zy(e,["displayName"]);void 0!==t&&null!=i&&qy(t,["displayName"],i);const r=zy(e,["contents"]);if(void 0!==t&&null!=r){let e=Ww(r);Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["contents"],e)}const o=zy(e,["systemInstruction"]);void 0!==t&&null!=o&&qy(t,["systemInstruction"],Bw(o));const a=zy(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["retrieval"]);null!=n&&qy(t,["retrieval"],n);const s=zy(e,["computerUse"]);null!=s&&qy(t,["computerUse"],s);if(void 0!==zy(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);const r=zy(e,["enterpriseWebSearch"]);null!=r&&qy(t,["enterpriseWebSearch"],r);const o=zy(e,["functionDeclarations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["description"]);null!=n&&qy(t,["description"],n);const s=zy(e,["name"]);null!=s&&qy(t,["name"],s);const i=zy(e,["parameters"]);null!=i&&qy(t,["parameters"],i);const r=zy(e,["parametersJsonSchema"]);null!=r&&qy(t,["parametersJsonSchema"],r);const o=zy(e,["response"]);null!=o&&qy(t,["response"],o);const a=zy(e,["responseJsonSchema"]);null!=a&&qy(t,["responseJsonSchema"],a);if(void 0!==zy(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return t}(e))),qy(t,["functionDeclarations"],e)}const a=zy(e,["googleMaps"]);null!=a&&qy(t,["googleMaps"],a);const l=zy(e,["googleSearch"]);null!=l&&qy(t,["googleSearch"],l);const c=zy(e,["googleSearchRetrieval"]);null!=c&&qy(t,["googleSearchRetrieval"],c);const d=zy(e,["urlContext"]);null!=d&&qy(t,["urlContext"],d);return t}(e))),qy(t,["tools"],e)}const l=zy(e,["toolConfig"]);void 0!==t&&null!=l&&qy(t,["toolConfig"],l);const c=zy(e,["kmsKeyName"]);return void 0!==t&&null!=c&&qy(t,["encryption_spec","kmsKeyName"],c),{}}function Ex(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s)}(n,t),t}function Sx(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s)}(n,t),t}function Ax(e,t){const n={},s=zy(t,["name"]);null!=s&&qy(n,["_url","name"],Yw(e,s));const i=zy(t,["config"]);return null!=i&&function(e,t){const n=zy(e,["ttl"]);void 0!==t&&null!=n&&qy(t,["ttl"],n);const s=zy(e,["expireTime"]);void 0!==t&&null!=s&&qy(t,["expireTime"],s)}(i,n),n}function Cx(e,t){const n={},s=zy(t,["name"]);null!=s&&qy(n,["_url","name"],Yw(e,s));const i=zy(t,["config"]);return null!=i&&function(e,t){const n=zy(e,["ttl"]);void 0!==t&&null!=n&&qy(t,["ttl"],n);const s=zy(e,["expireTime"]);void 0!==t&&null!=s&&qy(t,["expireTime"],s)}(i,n),n}class kx extends Wy{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new bx(ew.PAGED_ITEM_CACHED_CONTENTS,e=>t.listInternal(e),await t.listInternal(e),e)}}async create(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["model"],Iw(e,s));const i=zy(t,["config"]);return null!=i&&xx(i,n),n}(this.apiClient,e);return o=Hy("cachedContents",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}{const t=function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["model"],Iw(e,s));const i=zy(t,["config"]);return null!=i&&wx(i,n),n}(this.apiClient,e);return o=Hy("cachedContents",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async get(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],Yw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}{const t=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],Yw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async delete(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],Yw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new gw;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=zy(t,["name"]);return null!=s&&qy(n,["_url","name"],Yw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new gw;return Object.assign(n,t),n})}}async update(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=Cx(this.apiClient,e);return o=Hy("{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}{const t=Ax(this.apiClient,e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async listInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=Sx(e);return o=Hy("cachedContents",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["cachedContents"],e)}return t}(e),n=new vw;return Object.assign(n,t),n})}{const t=Ex(e);return o=Hy("cachedContents",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["cachedContents"],e)}return t}(e),n=new vw;return Object.assign(n,t),n})}}}function Tx(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}function Nx(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ix(e){return this instanceof Ix?(this.v=e,this):new Ix(e)}function Px(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=n.apply(e,t||[]),r=[];return s=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),s[Symbol.asyncIterator]=function(){return this},s;function o(e,t){i[e]&&(s[e]=function(t){return new Promise(function(n,s){r.push([e,t,n,s])>1||a(e,t)})},t&&(s[e]=t(s[e])))}function a(e,t){try{(n=i[e](t)).value instanceof Ix?Promise.resolve(n.value.v).then(l,c):d(r[0][2],n)}catch(s){d(r[0][3],s)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function Rx(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Nx(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(n){t[n]=e[n]&&function(t){return new Promise(function(s,i){(function(e,t,n,s){Promise.resolve(s).then(function(t){e({value:t,done:n})},t)})(s,i,(t=e[n](t)).done,t.value)})}}}function Mx(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&Ox(n)}function Ox(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function Dx(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let s=0;for(;s<n;)if("user"===e[s].role)t.push(e[s]),s++;else{const i=[];let r=!0;for(;s<n&&"model"===e[s].role;)i.push(e[s]),r&&!Ox(e[s])&&(r=!1),s++;r?t.push(...i):t.pop()}return t}"function"===typeof SuppressedError&&SuppressedError;class jx{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Fx(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Fx{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error("Role must be user or model, but got ".concat(t.role,"."))}(i)}async sendMessage(e){var t;await this.sendPromise;const n=Bw(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,i;const r=await s,o=null===(t=null===(e=r.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=r.automaticFunctionCallingHistory,l=this.getHistory(!0).length;let c=[];null!=a&&(c=null!==(i=a.slice(l))&&void 0!==i?i:[]);const d=o?[o]:[];this.recordHistory(n,d,c)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=Bw(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,n)}getHistory(){const e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Dx(this.history):this.history;return structuredClone(e)}processStreamResponse(e,t){return Px(this,arguments,function*(){var n,s,i,r,o,a;const l=[];try{for(var c,d=!0,u=Rx(e);!(n=(c=yield Ix(u.next())).done);d=!0){r=c.value,d=!1;const e=r;if(Mx(e)){const t=null===(a=null===(o=e.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content;void 0!==t&&l.push(t)}yield yield Ix(e)}}catch(h){s={error:h}}finally{try{d||n||!(i=u.return)||(yield Ix(i.call(u)))}finally{if(s)throw s.error}}this.recordHistory(t,l)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(e=>void 0!==e.role)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...Dx(n)):this.history.push(e),this.history.push(...s)}}class Lx extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Lx.prototype)}}function Ux(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s)}(n,t),t}class Bx extends Wy{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new bx(ew.PAGED_ITEM_FILES,e=>t.listInternal(e),await t.listInternal(e),e)}}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Ux(e);return i=Hy("files",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["files"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["files"],e)}return t}(e),n=new xw;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=zy(e,["file"]);return null!=n&&qy(t,["file"],n),t}(e);return i=Hy("upload/v1beta/files",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new Ew;return Object.assign(n,t),n})}}async get(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","file"],Qw(n)),t}(e);return i=Hy("files/{file}",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","file"],Qw(n)),t}(e);return i=Hy("files/{file}",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new Sw;return Object.assign(n,t),n})}}}function Vx(e){const t={},n=zy(e,["data"]);if(null!=n&&qy(t,["data"],n),void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=zy(e,["mimeType"]);return null!=s&&qy(t,["mimeType"],s),t}function Wx(e){const t={},n=zy(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["mediaResolution"]);null!=n&&qy(t,["mediaResolution"],n);const s=zy(e,["codeExecutionResult"]);null!=s&&qy(t,["codeExecutionResult"],s);const i=zy(e,["executableCode"]);null!=i&&qy(t,["executableCode"],i);const r=zy(e,["fileData"]);null!=r&&qy(t,["fileData"],function(e){const t={};if(void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=zy(e,["fileUri"]);null!=n&&qy(t,["fileUri"],n);const s=zy(e,["mimeType"]);null!=s&&qy(t,["mimeType"],s);return t}(r));const o=zy(e,["functionCall"]);null!=o&&qy(t,["functionCall"],function(e){const t={},n=zy(e,["id"]);null!=n&&qy(t,["id"],n);const s=zy(e,["args"]);null!=s&&qy(t,["args"],s);const i=zy(e,["name"]);null!=i&&qy(t,["name"],i);if(void 0!==zy(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==zy(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=zy(e,["functionResponse"]);null!=a&&qy(t,["functionResponse"],a);const l=zy(e,["inlineData"]);null!=l&&qy(t,["inlineData"],Vx(l));const c=zy(e,["text"]);null!=c&&qy(t,["text"],c);const d=zy(e,["thought"]);null!=d&&qy(t,["thought"],d);const u=zy(e,["thoughtSignature"]);null!=u&&qy(t,["thoughtSignature"],u);const h=zy(e,["videoMetadata"]);null!=h&&qy(t,["videoMetadata"],h);return t}(e))),qy(t,["parts"],e)}const s=zy(e,["role"]);return null!=s&&qy(t,["role"],s),t}function Hx(e,t){const n=zy(e,["generationConfig"]);void 0!==t&&null!=n&&qy(t,["setup","generationConfig"],n);const s=zy(e,["responseModalities"]);void 0!==t&&null!=s&&qy(t,["setup","generationConfig","responseModalities"],s);const i=zy(e,["temperature"]);void 0!==t&&null!=i&&qy(t,["setup","generationConfig","temperature"],i);const r=zy(e,["topP"]);void 0!==t&&null!=r&&qy(t,["setup","generationConfig","topP"],r);const o=zy(e,["topK"]);void 0!==t&&null!=o&&qy(t,["setup","generationConfig","topK"],o);const a=zy(e,["maxOutputTokens"]);void 0!==t&&null!=a&&qy(t,["setup","generationConfig","maxOutputTokens"],a);const l=zy(e,["mediaResolution"]);void 0!==t&&null!=l&&qy(t,["setup","generationConfig","mediaResolution"],l);const c=zy(e,["seed"]);void 0!==t&&null!=c&&qy(t,["setup","generationConfig","seed"],c);const d=zy(e,["speechConfig"]);void 0!==t&&null!=d&&qy(t,["setup","generationConfig","speechConfig"],Gw(d));const u=zy(e,["thinkingConfig"]);void 0!==t&&null!=u&&qy(t,["setup","generationConfig","thinkingConfig"],u);const h=zy(e,["enableAffectiveDialog"]);void 0!==t&&null!=h&&qy(t,["setup","generationConfig","enableAffectiveDialog"],h);const p=zy(e,["systemInstruction"]);void 0!==t&&null!=p&&qy(t,["setup","systemInstruction"],Wx(Bw(p)));const f=zy(e,["tools"]);if(void 0!==t&&null!=f){let e=Jw(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==zy(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=zy(e,["computerUse"]);null!=n&&qy(t,["computerUse"],n);const s=zy(e,["fileSearch"]);null!=s&&qy(t,["fileSearch"],s);const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);if(void 0!==zy(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=zy(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["functionDeclarations"],e)}const o=zy(e,["googleMaps"]);null!=o&&qy(t,["googleMaps"],function(e){const t={};if(void 0!==zy(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=zy(e,["enableWidget"]);return null!=n&&qy(t,["enableWidget"],n),t}(o));const a=zy(e,["googleSearch"]);null!=a&&qy(t,["googleSearch"],function(e){const t={};if(void 0!==zy(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==zy(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=zy(e,["timeRangeFilter"]);return null!=n&&qy(t,["timeRangeFilter"],n),t}(a));const l=zy(e,["googleSearchRetrieval"]);null!=l&&qy(t,["googleSearchRetrieval"],l);const c=zy(e,["urlContext"]);null!=c&&qy(t,["urlContext"],c);return t}(Kw(e)))),qy(t,["setup","tools"],e)}const m=zy(e,["sessionResumption"]);void 0!==t&&null!=m&&qy(t,["setup","sessionResumption"],function(e){const t={},n=zy(e,["handle"]);null!=n&&qy(t,["handle"],n);if(void 0!==zy(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(m));const g=zy(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&qy(t,["setup","inputAudioTranscription"],g);const v=zy(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&qy(t,["setup","outputAudioTranscription"],v);const b=zy(e,["realtimeInputConfig"]);void 0!==t&&null!=b&&qy(t,["setup","realtimeInputConfig"],b);const y=zy(e,["contextWindowCompression"]);void 0!==t&&null!=y&&qy(t,["setup","contextWindowCompression"],y);const _=zy(e,["proactivity"]);if(void 0!==t&&null!=_&&qy(t,["setup","proactivity"],_),void 0!==zy(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}function qx(e,t){const n=zy(e,["generationConfig"]);void 0!==t&&null!=n&&qy(t,["setup","generationConfig"],function(e){const t={},n=zy(e,["modelSelectionConfig"]);null!=n&&qy(t,["modelConfig"],n);const s=zy(e,["responseJsonSchema"]);null!=s&&qy(t,["responseJsonSchema"],s);const i=zy(e,["audioTimestamp"]);null!=i&&qy(t,["audioTimestamp"],i);const r=zy(e,["candidateCount"]);null!=r&&qy(t,["candidateCount"],r);const o=zy(e,["enableAffectiveDialog"]);null!=o&&qy(t,["enableAffectiveDialog"],o);const a=zy(e,["frequencyPenalty"]);null!=a&&qy(t,["frequencyPenalty"],a);const l=zy(e,["logprobs"]);null!=l&&qy(t,["logprobs"],l);const c=zy(e,["maxOutputTokens"]);null!=c&&qy(t,["maxOutputTokens"],c);const d=zy(e,["mediaResolution"]);null!=d&&qy(t,["mediaResolution"],d);const u=zy(e,["presencePenalty"]);null!=u&&qy(t,["presencePenalty"],u);const h=zy(e,["responseLogprobs"]);null!=h&&qy(t,["responseLogprobs"],h);const p=zy(e,["responseMimeType"]);null!=p&&qy(t,["responseMimeType"],p);const f=zy(e,["responseModalities"]);null!=f&&qy(t,["responseModalities"],f);const m=zy(e,["responseSchema"]);null!=m&&qy(t,["responseSchema"],m);const g=zy(e,["routingConfig"]);null!=g&&qy(t,["routingConfig"],g);const v=zy(e,["seed"]);null!=v&&qy(t,["seed"],v);const b=zy(e,["speechConfig"]);null!=b&&qy(t,["speechConfig"],b);const y=zy(e,["stopSequences"]);null!=y&&qy(t,["stopSequences"],y);const _=zy(e,["temperature"]);null!=_&&qy(t,["temperature"],_);const w=zy(e,["thinkingConfig"]);null!=w&&qy(t,["thinkingConfig"],w);const x=zy(e,["topK"]);null!=x&&qy(t,["topK"],x);const E=zy(e,["topP"]);if(null!=E&&qy(t,["topP"],E),void 0!==zy(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));const s=zy(e,["responseModalities"]);void 0!==t&&null!=s&&qy(t,["setup","generationConfig","responseModalities"],s);const i=zy(e,["temperature"]);void 0!==t&&null!=i&&qy(t,["setup","generationConfig","temperature"],i);const r=zy(e,["topP"]);void 0!==t&&null!=r&&qy(t,["setup","generationConfig","topP"],r);const o=zy(e,["topK"]);void 0!==t&&null!=o&&qy(t,["setup","generationConfig","topK"],o);const a=zy(e,["maxOutputTokens"]);void 0!==t&&null!=a&&qy(t,["setup","generationConfig","maxOutputTokens"],a);const l=zy(e,["mediaResolution"]);void 0!==t&&null!=l&&qy(t,["setup","generationConfig","mediaResolution"],l);const c=zy(e,["seed"]);void 0!==t&&null!=c&&qy(t,["setup","generationConfig","seed"],c);const d=zy(e,["speechConfig"]);void 0!==t&&null!=d&&qy(t,["setup","generationConfig","speechConfig"],Gw(d));const u=zy(e,["thinkingConfig"]);void 0!==t&&null!=u&&qy(t,["setup","generationConfig","thinkingConfig"],u);const h=zy(e,["enableAffectiveDialog"]);void 0!==t&&null!=h&&qy(t,["setup","generationConfig","enableAffectiveDialog"],h);const p=zy(e,["systemInstruction"]);void 0!==t&&null!=p&&qy(t,["setup","systemInstruction"],Bw(p));const f=zy(e,["tools"]);if(void 0!==t&&null!=f){let e=Jw(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["retrieval"]);null!=n&&qy(t,["retrieval"],n);const s=zy(e,["computerUse"]);null!=s&&qy(t,["computerUse"],s);if(void 0!==zy(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);const r=zy(e,["enterpriseWebSearch"]);null!=r&&qy(t,["enterpriseWebSearch"],r);const o=zy(e,["functionDeclarations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["description"]);null!=n&&qy(t,["description"],n);const s=zy(e,["name"]);null!=s&&qy(t,["name"],s);const i=zy(e,["parameters"]);null!=i&&qy(t,["parameters"],i);const r=zy(e,["parametersJsonSchema"]);null!=r&&qy(t,["parametersJsonSchema"],r);const o=zy(e,["response"]);null!=o&&qy(t,["response"],o);const a=zy(e,["responseJsonSchema"]);if(null!=a&&qy(t,["responseJsonSchema"],a),void 0!==zy(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return t}(e))),qy(t,["functionDeclarations"],e)}const a=zy(e,["googleMaps"]);null!=a&&qy(t,["googleMaps"],a);const l=zy(e,["googleSearch"]);null!=l&&qy(t,["googleSearch"],l);const c=zy(e,["googleSearchRetrieval"]);null!=c&&qy(t,["googleSearchRetrieval"],c);const d=zy(e,["urlContext"]);null!=d&&qy(t,["urlContext"],d);return t}(Kw(e)))),qy(t,["setup","tools"],e)}const m=zy(e,["sessionResumption"]);void 0!==t&&null!=m&&qy(t,["setup","sessionResumption"],m);const g=zy(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&qy(t,["setup","inputAudioTranscription"],g);const v=zy(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&qy(t,["setup","outputAudioTranscription"],v);const b=zy(e,["realtimeInputConfig"]);void 0!==t&&null!=b&&qy(t,["setup","realtimeInputConfig"],b);const y=zy(e,["contextWindowCompression"]);void 0!==t&&null!=y&&qy(t,["setup","contextWindowCompression"],y);const _=zy(e,["proactivity"]);void 0!==t&&null!=_&&qy(t,["setup","proactivity"],_);const w=zy(e,["explicitVadSignal"]);return void 0!==t&&null!=w&&qy(t,["setup","explicitVadSignal"],w),{}}function zx(e){const t={},n=zy(e,["media"]);if(null!=n){let e=Pw(n);Array.isArray(e)&&(e=e.map(e=>Vx(e))),qy(t,["mediaChunks"],e)}const s=zy(e,["audio"]);null!=s&&qy(t,["audio"],Vx(Ow(s)));const i=zy(e,["audioStreamEnd"]);null!=i&&qy(t,["audioStreamEnd"],i);const r=zy(e,["video"]);null!=r&&qy(t,["video"],Vx(Mw(r)));const o=zy(e,["text"]);null!=o&&qy(t,["text"],o);const a=zy(e,["activityStart"]);null!=a&&qy(t,["activityStart"],a);const l=zy(e,["activityEnd"]);return null!=l&&qy(t,["activityEnd"],l),t}function Gx(e){const t={},n=zy(e,["media"]);if(null!=n){let e=Pw(n);Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["mediaChunks"],e)}const s=zy(e,["audio"]);null!=s&&qy(t,["audio"],Ow(s));const i=zy(e,["audioStreamEnd"]);null!=i&&qy(t,["audioStreamEnd"],i);const r=zy(e,["video"]);null!=r&&qy(t,["video"],Mw(r));const o=zy(e,["text"]);null!=o&&qy(t,["text"],o);const a=zy(e,["activityStart"]);null!=a&&qy(t,["activityStart"],a);const l=zy(e,["activityEnd"]);return null!=l&&qy(t,["activityEnd"],l),t}function Kx(e){const t={},n=zy(e,["setupComplete"]);null!=n&&qy(t,["setupComplete"],n);const s=zy(e,["serverContent"]);null!=s&&qy(t,["serverContent"],s);const i=zy(e,["toolCall"]);null!=i&&qy(t,["toolCall"],i);const r=zy(e,["toolCallCancellation"]);null!=r&&qy(t,["toolCallCancellation"],r);const o=zy(e,["usageMetadata"]);null!=o&&qy(t,["usageMetadata"],function(e){const t={},n=zy(e,["promptTokenCount"]);null!=n&&qy(t,["promptTokenCount"],n);const s=zy(e,["cachedContentTokenCount"]);null!=s&&qy(t,["cachedContentTokenCount"],s);const i=zy(e,["candidatesTokenCount"]);null!=i&&qy(t,["responseTokenCount"],i);const r=zy(e,["toolUsePromptTokenCount"]);null!=r&&qy(t,["toolUsePromptTokenCount"],r);const o=zy(e,["thoughtsTokenCount"]);null!=o&&qy(t,["thoughtsTokenCount"],o);const a=zy(e,["totalTokenCount"]);null!=a&&qy(t,["totalTokenCount"],a);const l=zy(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["promptTokensDetails"],e)}const c=zy(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["cacheTokensDetails"],e)}const d=zy(e,["candidatesTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["responseTokensDetails"],e)}const u=zy(e,["toolUsePromptTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["toolUsePromptTokensDetails"],e)}const h=zy(e,["trafficType"]);null!=h&&qy(t,["trafficType"],h);return t}(o));const a=zy(e,["goAway"]);null!=a&&qy(t,["goAway"],a);const l=zy(e,["sessionResumptionUpdate"]);null!=l&&qy(t,["sessionResumptionUpdate"],l);const c=zy(e,["voiceActivityDetectionSignal"]);null!=c&&qy(t,["voiceActivityDetectionSignal"],c);const d=zy(e,["voiceActivity"]);return null!=d&&qy(t,["voiceActivity"],function(e){const t={},n=zy(e,["type"]);null!=n&&qy(t,["voiceActivityType"],n);return t}(d)),t}function Jx(e){const t={},n=zy(e,["content"]);null!=n&&qy(t,["content"],n);const s=zy(e,["citationMetadata"]);null!=s&&qy(t,["citationMetadata"],function(e){const t={},n=zy(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["citations"],e)}return t}(s));const i=zy(e,["tokenCount"]);null!=i&&qy(t,["tokenCount"],i);const r=zy(e,["finishReason"]);null!=r&&qy(t,["finishReason"],r);const o=zy(e,["avgLogprobs"]);null!=o&&qy(t,["avgLogprobs"],o);const a=zy(e,["groundingMetadata"]);null!=a&&qy(t,["groundingMetadata"],a);const l=zy(e,["index"]);null!=l&&qy(t,["index"],l);const c=zy(e,["logprobsResult"]);null!=c&&qy(t,["logprobsResult"],c);const d=zy(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["safetyRatings"],e)}const u=zy(e,["urlContextMetadata"]);return null!=u&&qy(t,["urlContextMetadata"],u),t}function Yx(e){const t={},n=zy(e,["values"]);null!=n&&qy(t,["values"],n);const s=zy(e,["statistics"]);return null!=s&&qy(t,["statistics"],function(e){const t={},n=zy(e,["truncated"]);null!=n&&qy(t,["truncated"],n);const s=zy(e,["token_count"]);null!=s&&qy(t,["tokenCount"],s);return t}(s)),t}function $x(e){const t={},n=zy(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["mediaResolution"]);null!=n&&qy(t,["mediaResolution"],n);const s=zy(e,["codeExecutionResult"]);null!=s&&qy(t,["codeExecutionResult"],s);const i=zy(e,["executableCode"]);null!=i&&qy(t,["executableCode"],i);const r=zy(e,["fileData"]);null!=r&&qy(t,["fileData"],function(e){const t={};if(void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=zy(e,["fileUri"]);null!=n&&qy(t,["fileUri"],n);const s=zy(e,["mimeType"]);null!=s&&qy(t,["mimeType"],s);return t}(r));const o=zy(e,["functionCall"]);null!=o&&qy(t,["functionCall"],function(e){const t={},n=zy(e,["id"]);null!=n&&qy(t,["id"],n);const s=zy(e,["args"]);null!=s&&qy(t,["args"],s);const i=zy(e,["name"]);null!=i&&qy(t,["name"],i);if(void 0!==zy(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==zy(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=zy(e,["functionResponse"]);null!=a&&qy(t,["functionResponse"],a);const l=zy(e,["inlineData"]);null!=l&&qy(t,["inlineData"],function(e){const t={},n=zy(e,["data"]);if(null!=n&&qy(t,["data"],n),void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=zy(e,["mimeType"]);return null!=s&&qy(t,["mimeType"],s),t}(l));const c=zy(e,["text"]);null!=c&&qy(t,["text"],c);const d=zy(e,["thought"]);null!=d&&qy(t,["thought"],d);const u=zy(e,["thoughtSignature"]);null!=u&&qy(t,["thoughtSignature"],u);const h=zy(e,["videoMetadata"]);null!=h&&qy(t,["videoMetadata"],h);return t}(e))),qy(t,["parts"],e)}const s=zy(e,["role"]);return null!=s&&qy(t,["role"],s),t}function Xx(e,t){const n=zy(e,["systemInstruction"]);void 0!==t&&null!=n&&qy(t,["systemInstruction"],Bw(n));const s=zy(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>IE(e))),qy(t,["tools"],e)}const i=zy(e,["generationConfig"]);return void 0!==t&&null!=i&&qy(t,["generationConfig"],function(e){const t={},n=zy(e,["modelSelectionConfig"]);null!=n&&qy(t,["modelConfig"],n);const s=zy(e,["responseJsonSchema"]);null!=s&&qy(t,["responseJsonSchema"],s);const i=zy(e,["audioTimestamp"]);null!=i&&qy(t,["audioTimestamp"],i);const r=zy(e,["candidateCount"]);null!=r&&qy(t,["candidateCount"],r);const o=zy(e,["enableAffectiveDialog"]);null!=o&&qy(t,["enableAffectiveDialog"],o);const a=zy(e,["frequencyPenalty"]);null!=a&&qy(t,["frequencyPenalty"],a);const l=zy(e,["logprobs"]);null!=l&&qy(t,["logprobs"],l);const c=zy(e,["maxOutputTokens"]);null!=c&&qy(t,["maxOutputTokens"],c);const d=zy(e,["mediaResolution"]);null!=d&&qy(t,["mediaResolution"],d);const u=zy(e,["presencePenalty"]);null!=u&&qy(t,["presencePenalty"],u);const h=zy(e,["responseLogprobs"]);null!=h&&qy(t,["responseLogprobs"],h);const p=zy(e,["responseMimeType"]);null!=p&&qy(t,["responseMimeType"],p);const f=zy(e,["responseModalities"]);null!=f&&qy(t,["responseModalities"],f);const m=zy(e,["responseSchema"]);null!=m&&qy(t,["responseSchema"],m);const g=zy(e,["routingConfig"]);null!=g&&qy(t,["routingConfig"],g);const v=zy(e,["seed"]);null!=v&&qy(t,["seed"],v);const b=zy(e,["speechConfig"]);null!=b&&qy(t,["speechConfig"],b);const y=zy(e,["stopSequences"]);null!=y&&qy(t,["stopSequences"],y);const _=zy(e,["temperature"]);null!=_&&qy(t,["temperature"],_);const w=zy(e,["thinkingConfig"]);null!=w&&qy(t,["thinkingConfig"],w);const x=zy(e,["topK"]);null!=x&&qy(t,["topK"],x);const E=zy(e,["topP"]);null!=E&&qy(t,["topP"],E);if(void 0!==zy(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(i)),{}}function Qx(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let e=Ww(i);Array.isArray(e)&&(e=e.map(e=>$x(e))),qy(n,["contents"],e)}const r=zy(t,["config"]);return null!=r&&function(e){if(void 0!==zy(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==zy(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==zy(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.")}(r),n}function Zx(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["prompt"]);null!=i&&qy(n,["instances[0]","prompt"],i);const r=zy(t,["referenceImages"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["referenceImage"]);null!=n&&qy(t,["referenceImage"],_E(n));const s=zy(e,["referenceId"]);null!=s&&qy(t,["referenceId"],s);const i=zy(e,["referenceType"]);null!=i&&qy(t,["referenceType"],i);const r=zy(e,["maskImageConfig"]);null!=r&&qy(t,["maskImageConfig"],function(e){const t={},n=zy(e,["maskMode"]);null!=n&&qy(t,["maskMode"],n);const s=zy(e,["segmentationClasses"]);null!=s&&qy(t,["maskClasses"],s);const i=zy(e,["maskDilation"]);null!=i&&qy(t,["dilation"],i);return t}(r));const o=zy(e,["controlImageConfig"]);null!=o&&qy(t,["controlImageConfig"],function(e){const t={},n=zy(e,["controlType"]);null!=n&&qy(t,["controlType"],n);const s=zy(e,["enableControlImageComputation"]);return null!=s&&qy(t,["computeControl"],s),t}(o));const a=zy(e,["styleImageConfig"]);null!=a&&qy(t,["styleImageConfig"],a);const l=zy(e,["subjectImageConfig"]);null!=l&&qy(t,["subjectImageConfig"],l);return t}(e))),qy(n,["instances[0]","referenceImages"],e)}const o=zy(t,["config"]);return null!=o&&function(e,t){const n=zy(e,["outputGcsUri"]);void 0!==t&&null!=n&&qy(t,["parameters","storageUri"],n);const s=zy(e,["negativePrompt"]);void 0!==t&&null!=s&&qy(t,["parameters","negativePrompt"],s);const i=zy(e,["numberOfImages"]);void 0!==t&&null!=i&&qy(t,["parameters","sampleCount"],i);const r=zy(e,["aspectRatio"]);void 0!==t&&null!=r&&qy(t,["parameters","aspectRatio"],r);const o=zy(e,["guidanceScale"]);void 0!==t&&null!=o&&qy(t,["parameters","guidanceScale"],o);const a=zy(e,["seed"]);void 0!==t&&null!=a&&qy(t,["parameters","seed"],a);const l=zy(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&qy(t,["parameters","safetySetting"],l);const c=zy(e,["personGeneration"]);void 0!==t&&null!=c&&qy(t,["parameters","personGeneration"],c);const d=zy(e,["includeSafetyAttributes"]);void 0!==t&&null!=d&&qy(t,["parameters","includeSafetyAttributes"],d);const u=zy(e,["includeRaiReason"]);void 0!==t&&null!=u&&qy(t,["parameters","includeRaiReason"],u);const h=zy(e,["language"]);void 0!==t&&null!=h&&qy(t,["parameters","language"],h);const p=zy(e,["outputMimeType"]);void 0!==t&&null!=p&&qy(t,["parameters","outputOptions","mimeType"],p);const f=zy(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&qy(t,["parameters","outputOptions","compressionQuality"],f);const m=zy(e,["addWatermark"]);void 0!==t&&null!=m&&qy(t,["parameters","addWatermark"],m);const g=zy(e,["labels"]);void 0!==t&&null!=g&&qy(t,["labels"],g);const v=zy(e,["editMode"]);void 0!==t&&null!=v&&qy(t,["parameters","editMode"],v);const b=zy(e,["baseSteps"]);void 0!==t&&null!=b&&qy(t,["parameters","editConfig","baseSteps"],b)}(o,n),n}function eE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let t=Vw(e,i);Array.isArray(t)&&(t=t.map(e=>e)),qy(n,["requests[]","content"],t)}const r=zy(t,["config"]);null!=r&&function(e,t){const n=zy(e,["taskType"]);void 0!==t&&null!=n&&qy(t,["requests[]","taskType"],n);const s=zy(e,["title"]);void 0!==t&&null!=s&&qy(t,["requests[]","title"],s);const i=zy(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&qy(t,["requests[]","outputDimensionality"],i),void 0!==zy(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==zy(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.")}(r,n);const o=zy(t,["model"]);return void 0!==o&&qy(n,["requests[]","model"],Nw(e,o)),n}function tE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let t=Vw(e,i);Array.isArray(t)&&(t=t.map(e=>e)),qy(n,["instances[]","content"],t)}const r=zy(t,["config"]);return null!=r&&function(e,t){const n=zy(e,["taskType"]);void 0!==t&&null!=n&&qy(t,["instances[]","task_type"],n);const s=zy(e,["title"]);void 0!==t&&null!=s&&qy(t,["instances[]","title"],s);const i=zy(e,["outputDimensionality"]);void 0!==t&&null!=i&&qy(t,["parameters","outputDimensionality"],i);const r=zy(e,["mimeType"]);void 0!==t&&null!=r&&qy(t,["instances[]","mimeType"],r);const o=zy(e,["autoTruncate"]);void 0!==t&&null!=o&&qy(t,["parameters","autoTruncate"],o)}(r,n),n}function nE(e,t,n){const s={},i=zy(t,["systemInstruction"]);void 0!==n&&null!=i&&qy(n,["systemInstruction"],$x(Bw(i)));const r=zy(t,["temperature"]);null!=r&&qy(s,["temperature"],r);const o=zy(t,["topP"]);null!=o&&qy(s,["topP"],o);const a=zy(t,["topK"]);null!=a&&qy(s,["topK"],a);const l=zy(t,["candidateCount"]);null!=l&&qy(s,["candidateCount"],l);const c=zy(t,["maxOutputTokens"]);null!=c&&qy(s,["maxOutputTokens"],c);const d=zy(t,["stopSequences"]);null!=d&&qy(s,["stopSequences"],d);const u=zy(t,["responseLogprobs"]);null!=u&&qy(s,["responseLogprobs"],u);const h=zy(t,["logprobs"]);null!=h&&qy(s,["logprobs"],h);const p=zy(t,["presencePenalty"]);null!=p&&qy(s,["presencePenalty"],p);const f=zy(t,["frequencyPenalty"]);null!=f&&qy(s,["frequencyPenalty"],f);const m=zy(t,["seed"]);null!=m&&qy(s,["seed"],m);const g=zy(t,["responseMimeType"]);null!=g&&qy(s,["responseMimeType"],g);const v=zy(t,["responseSchema"]);null!=v&&qy(s,["responseSchema"],qw(v));const b=zy(t,["responseJsonSchema"]);if(null!=b&&qy(s,["responseJsonSchema"],b),void 0!==zy(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==zy(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=zy(t,["safetySettings"]);if(void 0!==n&&null!=y){let e=y;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["category"]);null!=n&&qy(t,["category"],n);if(void 0!==zy(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const s=zy(e,["threshold"]);null!=s&&qy(t,["threshold"],s);return t}(e))),qy(n,["safetySettings"],e)}const _=zy(t,["tools"]);if(void 0!==n&&null!=_){let e=Jw(_);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==zy(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=zy(e,["computerUse"]);null!=n&&qy(t,["computerUse"],n);const s=zy(e,["fileSearch"]);null!=s&&qy(t,["fileSearch"],s);const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);if(void 0!==zy(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=zy(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["functionDeclarations"],e)}const o=zy(e,["googleMaps"]);null!=o&&qy(t,["googleMaps"],function(e){const t={};if(void 0!==zy(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=zy(e,["enableWidget"]);null!=n&&qy(t,["enableWidget"],n);return t}(o));const a=zy(e,["googleSearch"]);null!=a&&qy(t,["googleSearch"],function(e){const t={};if(void 0!==zy(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==zy(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=zy(e,["timeRangeFilter"]);null!=n&&qy(t,["timeRangeFilter"],n);return t}(a));const l=zy(e,["googleSearchRetrieval"]);null!=l&&qy(t,["googleSearchRetrieval"],l);const c=zy(e,["urlContext"]);null!=c&&qy(t,["urlContext"],c);return t}(Kw(e)))),qy(n,["tools"],e)}const w=zy(t,["toolConfig"]);if(void 0!==n&&null!=w&&qy(n,["toolConfig"],function(e){const t={},n=zy(e,["retrievalConfig"]);null!=n&&qy(t,["retrievalConfig"],n);const s=zy(e,["functionCallingConfig"]);null!=s&&qy(t,["functionCallingConfig"],function(e){const t={},n=zy(e,["allowedFunctionNames"]);null!=n&&qy(t,["allowedFunctionNames"],n);const s=zy(e,["mode"]);if(null!=s&&qy(t,["mode"],s),void 0!==zy(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(s));return t}(w)),void 0!==zy(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const x=zy(t,["cachedContent"]);void 0!==n&&null!=x&&qy(n,["cachedContent"],Yw(e,x));const E=zy(t,["responseModalities"]);null!=E&&qy(s,["responseModalities"],E);const S=zy(t,["mediaResolution"]);null!=S&&qy(s,["mediaResolution"],S);const A=zy(t,["speechConfig"]);if(null!=A&&qy(s,["speechConfig"],zw(A)),void 0!==zy(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const C=zy(t,["thinkingConfig"]);null!=C&&qy(s,["thinkingConfig"],C);const k=zy(t,["imageConfig"]);null!=k&&qy(s,["imageConfig"],function(e){const t={},n=zy(e,["aspectRatio"]);null!=n&&qy(t,["aspectRatio"],n);const s=zy(e,["imageSize"]);null!=s&&qy(t,["imageSize"],s);if(void 0!==zy(e,["personGeneration"]))throw new Error("personGeneration parameter is not supported in Gemini API.");if(void 0!==zy(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==zy(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(k));const T=zy(t,["enableEnhancedCivicAnswers"]);return null!=T&&qy(s,["enableEnhancedCivicAnswers"],T),s}function sE(e,t,n){const s={},i=zy(t,["systemInstruction"]);void 0!==n&&null!=i&&qy(n,["systemInstruction"],Bw(i));const r=zy(t,["temperature"]);null!=r&&qy(s,["temperature"],r);const o=zy(t,["topP"]);null!=o&&qy(s,["topP"],o);const a=zy(t,["topK"]);null!=a&&qy(s,["topK"],a);const l=zy(t,["candidateCount"]);null!=l&&qy(s,["candidateCount"],l);const c=zy(t,["maxOutputTokens"]);null!=c&&qy(s,["maxOutputTokens"],c);const d=zy(t,["stopSequences"]);null!=d&&qy(s,["stopSequences"],d);const u=zy(t,["responseLogprobs"]);null!=u&&qy(s,["responseLogprobs"],u);const h=zy(t,["logprobs"]);null!=h&&qy(s,["logprobs"],h);const p=zy(t,["presencePenalty"]);null!=p&&qy(s,["presencePenalty"],p);const f=zy(t,["frequencyPenalty"]);null!=f&&qy(s,["frequencyPenalty"],f);const m=zy(t,["seed"]);null!=m&&qy(s,["seed"],m);const g=zy(t,["responseMimeType"]);null!=g&&qy(s,["responseMimeType"],g);const v=zy(t,["responseSchema"]);null!=v&&qy(s,["responseSchema"],qw(v));const b=zy(t,["responseJsonSchema"]);null!=b&&qy(s,["responseJsonSchema"],b);const y=zy(t,["routingConfig"]);null!=y&&qy(s,["routingConfig"],y);const _=zy(t,["modelSelectionConfig"]);null!=_&&qy(s,["modelConfig"],_);const w=zy(t,["safetySettings"]);if(void 0!==n&&null!=w){let e=w;Array.isArray(e)&&(e=e.map(e=>e)),qy(n,["safetySettings"],e)}const x=zy(t,["tools"]);if(void 0!==n&&null!=x){let e=Jw(x);Array.isArray(e)&&(e=e.map(e=>IE(Kw(e)))),qy(n,["tools"],e)}const E=zy(t,["toolConfig"]);void 0!==n&&null!=E&&qy(n,["toolConfig"],E);const S=zy(t,["labels"]);void 0!==n&&null!=S&&qy(n,["labels"],S);const A=zy(t,["cachedContent"]);void 0!==n&&null!=A&&qy(n,["cachedContent"],Yw(e,A));const C=zy(t,["responseModalities"]);null!=C&&qy(s,["responseModalities"],C);const k=zy(t,["mediaResolution"]);null!=k&&qy(s,["mediaResolution"],k);const T=zy(t,["speechConfig"]);null!=T&&qy(s,["speechConfig"],zw(T));const N=zy(t,["audioTimestamp"]);null!=N&&qy(s,["audioTimestamp"],N);const I=zy(t,["thinkingConfig"]);null!=I&&qy(s,["thinkingConfig"],I);const P=zy(t,["imageConfig"]);if(null!=P&&qy(s,["imageConfig"],function(e){const t={},n=zy(e,["aspectRatio"]);null!=n&&qy(t,["aspectRatio"],n);const s=zy(e,["imageSize"]);null!=s&&qy(t,["imageSize"],s);const i=zy(e,["personGeneration"]);null!=i&&qy(t,["personGeneration"],i);const r=zy(e,["outputMimeType"]);null!=r&&qy(t,["imageOutputOptions","mimeType"],r);const o=zy(e,["outputCompressionQuality"]);null!=o&&qy(t,["imageOutputOptions","compressionQuality"],o);return t}(P)),void 0!==zy(t,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return s}function iE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let e=Ww(i);Array.isArray(e)&&(e=e.map(e=>$x(e))),qy(n,["contents"],e)}const r=zy(t,["config"]);return null!=r&&qy(n,["generationConfig"],nE(e,r,n)),n}function rE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let e=Ww(i);Array.isArray(e)&&(e=e.map(e=>e)),qy(n,["contents"],e)}const r=zy(t,["config"]);return null!=r&&qy(n,["generationConfig"],sE(e,r,n)),n}function oE(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["candidates"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>Jx(e))),qy(t,["candidates"],e)}const i=zy(e,["modelVersion"]);null!=i&&qy(t,["modelVersion"],i);const r=zy(e,["promptFeedback"]);null!=r&&qy(t,["promptFeedback"],r);const o=zy(e,["responseId"]);null!=o&&qy(t,["responseId"],o);const a=zy(e,["usageMetadata"]);return null!=a&&qy(t,["usageMetadata"],a),t}function aE(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["candidates"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["candidates"],e)}const i=zy(e,["createTime"]);null!=i&&qy(t,["createTime"],i);const r=zy(e,["modelVersion"]);null!=r&&qy(t,["modelVersion"],r);const o=zy(e,["promptFeedback"]);null!=o&&qy(t,["promptFeedback"],o);const a=zy(e,["responseId"]);null!=a&&qy(t,["responseId"],a);const l=zy(e,["usageMetadata"]);return null!=l&&qy(t,["usageMetadata"],l),t}function lE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["prompt"]);null!=i&&qy(n,["instances[0]","prompt"],i);const r=zy(t,["config"]);return null!=r&&function(e,t){if(void 0!==zy(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==zy(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=zy(e,["numberOfImages"]);void 0!==t&&null!=n&&qy(t,["parameters","sampleCount"],n);const s=zy(e,["aspectRatio"]);void 0!==t&&null!=s&&qy(t,["parameters","aspectRatio"],s);const i=zy(e,["guidanceScale"]);if(void 0!==t&&null!=i&&qy(t,["parameters","guidanceScale"],i),void 0!==zy(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const r=zy(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&qy(t,["parameters","safetySetting"],r);const o=zy(e,["personGeneration"]);void 0!==t&&null!=o&&qy(t,["parameters","personGeneration"],o);const a=zy(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&qy(t,["parameters","includeSafetyAttributes"],a);const l=zy(e,["includeRaiReason"]);void 0!==t&&null!=l&&qy(t,["parameters","includeRaiReason"],l);const c=zy(e,["language"]);void 0!==t&&null!=c&&qy(t,["parameters","language"],c);const d=zy(e,["outputMimeType"]);void 0!==t&&null!=d&&qy(t,["parameters","outputOptions","mimeType"],d);const u=zy(e,["outputCompressionQuality"]);if(void 0!==t&&null!=u&&qy(t,["parameters","outputOptions","compressionQuality"],u),void 0!==zy(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==zy(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const h=zy(e,["imageSize"]);if(void 0!==t&&null!=h&&qy(t,["parameters","sampleImageSize"],h),void 0!==zy(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.")}(r,n),n}function cE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["prompt"]);null!=i&&qy(n,["instances[0]","prompt"],i);const r=zy(t,["config"]);return null!=r&&function(e,t){const n=zy(e,["outputGcsUri"]);void 0!==t&&null!=n&&qy(t,["parameters","storageUri"],n);const s=zy(e,["negativePrompt"]);void 0!==t&&null!=s&&qy(t,["parameters","negativePrompt"],s);const i=zy(e,["numberOfImages"]);void 0!==t&&null!=i&&qy(t,["parameters","sampleCount"],i);const r=zy(e,["aspectRatio"]);void 0!==t&&null!=r&&qy(t,["parameters","aspectRatio"],r);const o=zy(e,["guidanceScale"]);void 0!==t&&null!=o&&qy(t,["parameters","guidanceScale"],o);const a=zy(e,["seed"]);void 0!==t&&null!=a&&qy(t,["parameters","seed"],a);const l=zy(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&qy(t,["parameters","safetySetting"],l);const c=zy(e,["personGeneration"]);void 0!==t&&null!=c&&qy(t,["parameters","personGeneration"],c);const d=zy(e,["includeSafetyAttributes"]);void 0!==t&&null!=d&&qy(t,["parameters","includeSafetyAttributes"],d);const u=zy(e,["includeRaiReason"]);void 0!==t&&null!=u&&qy(t,["parameters","includeRaiReason"],u);const h=zy(e,["language"]);void 0!==t&&null!=h&&qy(t,["parameters","language"],h);const p=zy(e,["outputMimeType"]);void 0!==t&&null!=p&&qy(t,["parameters","outputOptions","mimeType"],p);const f=zy(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&qy(t,["parameters","outputOptions","compressionQuality"],f);const m=zy(e,["addWatermark"]);void 0!==t&&null!=m&&qy(t,["parameters","addWatermark"],m);const g=zy(e,["labels"]);void 0!==t&&null!=g&&qy(t,["labels"],g);const v=zy(e,["imageSize"]);void 0!==t&&null!=v&&qy(t,["parameters","sampleImageSize"],v);const b=zy(e,["enhancePrompt"]);void 0!==t&&null!=b&&qy(t,["parameters","enhancePrompt"],b)}(r,n),n}function dE(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["_self"]);null!=n&&qy(t,["image"],function(e){const t={},n=zy(e,["bytesBase64Encoded"]);null!=n&&qy(t,["imageBytes"],Xw(n));const s=zy(e,["mimeType"]);null!=s&&qy(t,["mimeType"],s);return t}(n));const s=zy(e,["raiFilteredReason"]);null!=s&&qy(t,["raiFilteredReason"],s);const i=zy(e,["_self"]);null!=i&&qy(t,["safetyAttributes"],CE(i));return t}(e))),qy(t,["generatedImages"],e)}const i=zy(e,["positivePromptSafetyAttributes"]);return null!=i&&qy(t,["positivePromptSafetyAttributes"],CE(i)),t}function uE(e,t){const n=zy(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&qy(t,["parameters","sampleCount"],n),void 0!==zy(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==zy(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const s=zy(e,["durationSeconds"]);if(void 0!==t&&null!=s&&qy(t,["parameters","durationSeconds"],s),void 0!==zy(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const i=zy(e,["aspectRatio"]);void 0!==t&&null!=i&&qy(t,["parameters","aspectRatio"],i);const r=zy(e,["resolution"]);void 0!==t&&null!=r&&qy(t,["parameters","resolution"],r);const o=zy(e,["personGeneration"]);if(void 0!==t&&null!=o&&qy(t,["parameters","personGeneration"],o),void 0!==zy(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const a=zy(e,["negativePrompt"]);void 0!==t&&null!=a&&qy(t,["parameters","negativePrompt"],a);const l=zy(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&qy(t,["parameters","enhancePrompt"],l),void 0!==zy(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");const c=zy(e,["lastFrame"]);void 0!==t&&null!=c&&qy(t,["instances[0]","lastFrame"],yE(c));const d=zy(e,["referenceImages"]);if(void 0!==t&&null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["image"]);null!=n&&qy(t,["image"],yE(n));const s=zy(e,["referenceType"]);null!=s&&qy(t,["referenceType"],s);return t}(e))),qy(t,["instances[0]","referenceImages"],e)}if(void 0!==zy(e,["mask"]))throw new Error("mask parameter is not supported in Gemini API.");if(void 0!==zy(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}function hE(e,t){const n=zy(e,["numberOfVideos"]);void 0!==t&&null!=n&&qy(t,["parameters","sampleCount"],n);const s=zy(e,["outputGcsUri"]);void 0!==t&&null!=s&&qy(t,["parameters","storageUri"],s);const i=zy(e,["fps"]);void 0!==t&&null!=i&&qy(t,["parameters","fps"],i);const r=zy(e,["durationSeconds"]);void 0!==t&&null!=r&&qy(t,["parameters","durationSeconds"],r);const o=zy(e,["seed"]);void 0!==t&&null!=o&&qy(t,["parameters","seed"],o);const a=zy(e,["aspectRatio"]);void 0!==t&&null!=a&&qy(t,["parameters","aspectRatio"],a);const l=zy(e,["resolution"]);void 0!==t&&null!=l&&qy(t,["parameters","resolution"],l);const c=zy(e,["personGeneration"]);void 0!==t&&null!=c&&qy(t,["parameters","personGeneration"],c);const d=zy(e,["pubsubTopic"]);void 0!==t&&null!=d&&qy(t,["parameters","pubsubTopic"],d);const u=zy(e,["negativePrompt"]);void 0!==t&&null!=u&&qy(t,["parameters","negativePrompt"],u);const h=zy(e,["enhancePrompt"]);void 0!==t&&null!=h&&qy(t,["parameters","enhancePrompt"],h);const p=zy(e,["generateAudio"]);void 0!==t&&null!=p&&qy(t,["parameters","generateAudio"],p);const f=zy(e,["lastFrame"]);void 0!==t&&null!=f&&qy(t,["instances[0]","lastFrame"],_E(f));const m=zy(e,["referenceImages"]);if(void 0!==t&&null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["image"]);null!=n&&qy(t,["image"],_E(n));const s=zy(e,["referenceType"]);null!=s&&qy(t,["referenceType"],s);return t}(e))),qy(t,["instances[0]","referenceImages"],e)}const g=zy(e,["mask"]);void 0!==t&&null!=g&&qy(t,["instances[0]","mask"],function(e){const t={},n=zy(e,["image"]);null!=n&&qy(t,["_self"],_E(n));const s=zy(e,["maskMode"]);null!=s&&qy(t,["maskMode"],s);return t}(g));const v=zy(e,["compressionQuality"]);return void 0!==t&&null!=v&&qy(t,["parameters","compressionQuality"],v),{}}function pE(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response","generateVideoResponse"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["video"]);null!=n&&qy(t,["video"],function(e){const t={},n=zy(e,["uri"]);null!=n&&qy(t,["uri"],n);const s=zy(e,["encodedVideo"]);null!=s&&qy(t,["videoBytes"],Xw(s));const i=zy(e,["encoding"]);null!=i&&qy(t,["mimeType"],i);return t}(n));return t}(e))),qy(t,["generatedVideos"],e)}const s=zy(e,["raiMediaFilteredCount"]);null!=s&&qy(t,["raiMediaFilteredCount"],s);const i=zy(e,["raiMediaFilteredReasons"]);null!=i&&qy(t,["raiMediaFilteredReasons"],i);return t}(o)),t}function fE(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["_self"]);null!=n&&qy(t,["video"],function(e){const t={},n=zy(e,["gcsUri"]);null!=n&&qy(t,["uri"],n);const s=zy(e,["bytesBase64Encoded"]);null!=s&&qy(t,["videoBytes"],Xw(s));const i=zy(e,["mimeType"]);null!=i&&qy(t,["mimeType"],i);return t}(n));return t}(e))),qy(t,["generatedVideos"],e)}const s=zy(e,["raiMediaFilteredCount"]);null!=s&&qy(t,["raiMediaFilteredCount"],s);const i=zy(e,["raiMediaFilteredReasons"]);null!=i&&qy(t,["raiMediaFilteredReasons"],i);return t}(o)),t}function mE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["prompt"]);null!=i&&qy(n,["instances[0]","prompt"],i);const r=zy(t,["image"]);null!=r&&qy(n,["instances[0]","image"],yE(r));const o=zy(t,["video"]);null!=o&&qy(n,["instances[0]","video"],OE(o));const a=zy(t,["source"]);null!=a&&function(e,t){const n={},s=zy(e,["prompt"]);void 0!==t&&null!=s&&qy(t,["instances[0]","prompt"],s);const i=zy(e,["image"]);void 0!==t&&null!=i&&qy(t,["instances[0]","image"],yE(i));const r=zy(e,["video"]);void 0!==t&&null!=r&&qy(t,["instances[0]","video"],OE(r))}(a,n);const l=zy(t,["config"]);return null!=l&&uE(l,n),n}function gE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["prompt"]);null!=i&&qy(n,["instances[0]","prompt"],i);const r=zy(t,["image"]);null!=r&&qy(n,["instances[0]","image"],_E(r));const o=zy(t,["video"]);null!=o&&qy(n,["instances[0]","video"],DE(o));const a=zy(t,["source"]);null!=a&&function(e,t){const n={},s=zy(e,["prompt"]);void 0!==t&&null!=s&&qy(t,["instances[0]","prompt"],s);const i=zy(e,["image"]);void 0!==t&&null!=i&&qy(t,["instances[0]","image"],_E(i));const r=zy(e,["video"]);void 0!==t&&null!=r&&qy(t,["instances[0]","video"],DE(r))}(a,n);const l=zy(t,["config"]);return null!=l&&hE(l,n),n}function vE(e){const t={},n=zy(e,["_self"]);null!=n&&qy(t,["image"],bE(n));const s=zy(e,["raiFilteredReason"]);null!=s&&qy(t,["raiFilteredReason"],s);const i=zy(e,["_self"]);null!=i&&qy(t,["safetyAttributes"],kE(i));const r=zy(e,["prompt"]);return null!=r&&qy(t,["enhancedPrompt"],r),t}function bE(e){const t={},n=zy(e,["gcsUri"]);null!=n&&qy(t,["gcsUri"],n);const s=zy(e,["bytesBase64Encoded"]);null!=s&&qy(t,["imageBytes"],Xw(s));const i=zy(e,["mimeType"]);return null!=i&&qy(t,["mimeType"],i),t}function yE(e){const t={};if(void 0!==zy(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=zy(e,["imageBytes"]);null!=n&&qy(t,["bytesBase64Encoded"],Xw(n));const s=zy(e,["mimeType"]);return null!=s&&qy(t,["mimeType"],s),t}function _E(e){const t={},n=zy(e,["gcsUri"]);null!=n&&qy(t,["gcsUri"],n);const s=zy(e,["imageBytes"]);null!=s&&qy(t,["bytesBase64Encoded"],Xw(s));const i=zy(e,["mimeType"]);return null!=i&&qy(t,["mimeType"],i),t}function wE(e,t){const n={},s=zy(t,["config"]);return null!=s&&function(e,t,n){const s=zy(t,["pageSize"]);void 0!==n&&null!=s&&qy(n,["_query","pageSize"],s);const i=zy(t,["pageToken"]);void 0!==n&&null!=i&&qy(n,["_query","pageToken"],i);const r=zy(t,["filter"]);void 0!==n&&null!=r&&qy(n,["_query","filter"],r);const o=zy(t,["queryBase"]);void 0!==n&&null!=o&&qy(n,["_url","models_url"],Zw(e,o))}(e,s,n),n}function xE(e,t){const n={},s=zy(t,["config"]);return null!=s&&function(e,t,n){const s=zy(t,["pageSize"]);void 0!==n&&null!=s&&qy(n,["_query","pageSize"],s);const i=zy(t,["pageToken"]);void 0!==n&&null!=i&&qy(n,["_query","pageToken"],i);const r=zy(t,["filter"]);void 0!==n&&null!=r&&qy(n,["_query","filter"],r);const o=zy(t,["queryBase"]);void 0!==n&&null!=o&&qy(n,["_url","models_url"],Zw(e,o))}(e,s,n),n}function EE(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["displayName"]);null!=s&&qy(t,["displayName"],s);const i=zy(e,["description"]);null!=i&&qy(t,["description"],i);const r=zy(e,["version"]);null!=r&&qy(t,["version"],r);const o=zy(e,["_self"]);null!=o&&qy(t,["tunedModelInfo"],function(e){const t={},n=zy(e,["baseModel"]);null!=n&&qy(t,["baseModel"],n);const s=zy(e,["createTime"]);null!=s&&qy(t,["createTime"],s);const i=zy(e,["updateTime"]);null!=i&&qy(t,["updateTime"],i);return t}(o));const a=zy(e,["inputTokenLimit"]);null!=a&&qy(t,["inputTokenLimit"],a);const l=zy(e,["outputTokenLimit"]);null!=l&&qy(t,["outputTokenLimit"],l);const c=zy(e,["supportedGenerationMethods"]);null!=c&&qy(t,["supportedActions"],c);const d=zy(e,["temperature"]);null!=d&&qy(t,["temperature"],d);const u=zy(e,["maxTemperature"]);null!=u&&qy(t,["maxTemperature"],u);const h=zy(e,["topP"]);null!=h&&qy(t,["topP"],h);const p=zy(e,["topK"]);null!=p&&qy(t,["topK"],p);const f=zy(e,["thinking"]);return null!=f&&qy(t,["thinking"],f),t}function SE(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["displayName"]);null!=s&&qy(t,["displayName"],s);const i=zy(e,["description"]);null!=i&&qy(t,["description"],i);const r=zy(e,["versionId"]);null!=r&&qy(t,["version"],r);const o=zy(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["endpoint"]);null!=n&&qy(t,["name"],n);const s=zy(e,["deployedModelId"]);return null!=s&&qy(t,["deployedModelId"],s),t}(e))),qy(t,["endpoints"],e)}const a=zy(e,["labels"]);null!=a&&qy(t,["labels"],a);const l=zy(e,["_self"]);null!=l&&qy(t,["tunedModelInfo"],function(e){const t={},n=zy(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&qy(t,["baseModel"],n);const s=zy(e,["createTime"]);null!=s&&qy(t,["createTime"],s);const i=zy(e,["updateTime"]);null!=i&&qy(t,["updateTime"],i);return t}(l));const c=zy(e,["defaultCheckpointId"]);null!=c&&qy(t,["defaultCheckpointId"],c);const d=zy(e,["checkpoints"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["checkpoints"],e)}return t}function AE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["source"]);null!=i&&function(e,t){const n={},s=zy(e,["prompt"]);void 0!==t&&null!=s&&qy(t,["instances[0]","prompt"],s);const i=zy(e,["personImage"]);void 0!==t&&null!=i&&qy(t,["instances[0]","personImage","image"],_E(i));const r=zy(e,["productImages"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["productImage"]);return null!=n&&qy(t,["image"],_E(n)),t}(e))),qy(t,["instances[0]","productImages"],e)}}(i,n);const r=zy(t,["config"]);return null!=r&&function(e,t){const n=zy(e,["numberOfImages"]);void 0!==t&&null!=n&&qy(t,["parameters","sampleCount"],n);const s=zy(e,["baseSteps"]);void 0!==t&&null!=s&&qy(t,["parameters","baseSteps"],s);const i=zy(e,["outputGcsUri"]);void 0!==t&&null!=i&&qy(t,["parameters","storageUri"],i);const r=zy(e,["seed"]);void 0!==t&&null!=r&&qy(t,["parameters","seed"],r);const o=zy(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&qy(t,["parameters","safetySetting"],o);const a=zy(e,["personGeneration"]);void 0!==t&&null!=a&&qy(t,["parameters","personGeneration"],a);const l=zy(e,["addWatermark"]);void 0!==t&&null!=l&&qy(t,["parameters","addWatermark"],l);const c=zy(e,["outputMimeType"]);void 0!==t&&null!=c&&qy(t,["parameters","outputOptions","mimeType"],c);const d=zy(e,["outputCompressionQuality"]);void 0!==t&&null!=d&&qy(t,["parameters","outputOptions","compressionQuality"],d);const u=zy(e,["enhancePrompt"]);void 0!==t&&null!=u&&qy(t,["parameters","enhancePrompt"],u);const h=zy(e,["labels"]);void 0!==t&&null!=h&&qy(t,["labels"],h)}(r,n),n}function CE(e){const t={},n=zy(e,["safetyAttributes","categories"]);null!=n&&qy(t,["categories"],n);const s=zy(e,["safetyAttributes","scores"]);null!=s&&qy(t,["scores"],s);const i=zy(e,["contentType"]);return null!=i&&qy(t,["contentType"],i),t}function kE(e){const t={},n=zy(e,["safetyAttributes","categories"]);null!=n&&qy(t,["categories"],n);const s=zy(e,["safetyAttributes","scores"]);null!=s&&qy(t,["scores"],s);const i=zy(e,["contentType"]);return null!=i&&qy(t,["contentType"],i),t}function TE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["source"]);null!=i&&function(e,t){const n={},s=zy(e,["prompt"]);void 0!==t&&null!=s&&qy(t,["instances[0]","prompt"],s);const i=zy(e,["image"]);void 0!==t&&null!=i&&qy(t,["instances[0]","image"],_E(i));const r=zy(e,["scribbleImage"]);void 0!==t&&null!=r&&qy(t,["instances[0]","scribble"],function(e){const t={},n=zy(e,["image"]);return null!=n&&qy(t,["image"],_E(n)),t}(r))}(i,n);const r=zy(t,["config"]);return null!=r&&function(e,t){const n=zy(e,["mode"]);void 0!==t&&null!=n&&qy(t,["parameters","mode"],n);const s=zy(e,["maxPredictions"]);void 0!==t&&null!=s&&qy(t,["parameters","maxPredictions"],s);const i=zy(e,["confidenceThreshold"]);void 0!==t&&null!=i&&qy(t,["parameters","confidenceThreshold"],i);const r=zy(e,["maskDilation"]);void 0!==t&&null!=r&&qy(t,["parameters","maskDilation"],r);const o=zy(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&qy(t,["parameters","binaryColorThreshold"],o);const a=zy(e,["labels"]);void 0!==t&&null!=a&&qy(t,["labels"],a)}(r,n),n}function NE(e){const t={},n=zy(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["_self"]);null!=n&&qy(t,["mask"],bE(n));const s=zy(e,["labels"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["labels"],e)}return t}(e))),qy(t,["generatedMasks"],e)}return t}function IE(e){const t={},n=zy(e,["retrieval"]);null!=n&&qy(t,["retrieval"],n);const s=zy(e,["computerUse"]);if(null!=s&&qy(t,["computerUse"],s),void 0!==zy(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);const r=zy(e,["enterpriseWebSearch"]);null!=r&&qy(t,["enterpriseWebSearch"],r);const o=zy(e,["functionDeclarations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["description"]);null!=n&&qy(t,["description"],n);const s=zy(e,["name"]);null!=s&&qy(t,["name"],s);const i=zy(e,["parameters"]);null!=i&&qy(t,["parameters"],i);const r=zy(e,["parametersJsonSchema"]);null!=r&&qy(t,["parametersJsonSchema"],r);const o=zy(e,["response"]);null!=o&&qy(t,["response"],o);const a=zy(e,["responseJsonSchema"]);if(null!=a&&qy(t,["responseJsonSchema"],a),void 0!==zy(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return t}(e))),qy(t,["functionDeclarations"],e)}const a=zy(e,["googleMaps"]);null!=a&&qy(t,["googleMaps"],a);const l=zy(e,["googleSearch"]);null!=l&&qy(t,["googleSearch"],l);const c=zy(e,["googleSearchRetrieval"]);null!=c&&qy(t,["googleSearchRetrieval"],c);const d=zy(e,["urlContext"]);return null!=d&&qy(t,["urlContext"],d),t}function PE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","name"],Nw(e,s));const i=zy(t,["config"]);return null!=i&&function(e,t){const n=zy(e,["displayName"]);void 0!==t&&null!=n&&qy(t,["displayName"],n);const s=zy(e,["description"]);void 0!==t&&null!=s&&qy(t,["description"],s);const i=zy(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&qy(t,["defaultCheckpointId"],i)}(i,n),n}function RE(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["config"]);return null!=i&&function(e,t){const n=zy(e,["displayName"]);void 0!==t&&null!=n&&qy(t,["displayName"],n);const s=zy(e,["description"]);void 0!==t&&null!=s&&qy(t,["description"],s);const i=zy(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&qy(t,["defaultCheckpointId"],i)}(i,n),n}function ME(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["image"]);null!=i&&qy(n,["instances[0]","image"],_E(i));const r=zy(t,["upscaleFactor"]);null!=r&&qy(n,["parameters","upscaleConfig","upscaleFactor"],r);const o=zy(t,["config"]);return null!=o&&function(e,t){const n=zy(e,["outputGcsUri"]);void 0!==t&&null!=n&&qy(t,["parameters","storageUri"],n);const s=zy(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&qy(t,["parameters","safetySetting"],s);const i=zy(e,["personGeneration"]);void 0!==t&&null!=i&&qy(t,["parameters","personGeneration"],i);const r=zy(e,["includeRaiReason"]);void 0!==t&&null!=r&&qy(t,["parameters","includeRaiReason"],r);const o=zy(e,["outputMimeType"]);void 0!==t&&null!=o&&qy(t,["parameters","outputOptions","mimeType"],o);const a=zy(e,["outputCompressionQuality"]);void 0!==t&&null!=a&&qy(t,["parameters","outputOptions","compressionQuality"],a);const l=zy(e,["enhanceInputImage"]);void 0!==t&&null!=l&&qy(t,["parameters","upscaleConfig","enhanceInputImage"],l);const c=zy(e,["imagePreservationFactor"]);void 0!==t&&null!=c&&qy(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=zy(e,["labels"]);void 0!==t&&null!=d&&qy(t,["labels"],d);const u=zy(e,["numberOfImages"]);void 0!==t&&null!=u&&qy(t,["parameters","sampleCount"],u);const h=zy(e,["mode"]);void 0!==t&&null!=h&&qy(t,["parameters","mode"],h)}(o,n),n}function OE(e){const t={},n=zy(e,["uri"]);null!=n&&qy(t,["uri"],n);const s=zy(e,["videoBytes"]);null!=s&&qy(t,["encodedVideo"],Xw(s));const i=zy(e,["mimeType"]);return null!=i&&qy(t,["encoding"],i),t}function DE(e){const t={},n=zy(e,["uri"]);null!=n&&qy(t,["gcsUri"],n);const s=zy(e,["videoBytes"]);null!=s&&qy(t,["bytesBase64Encoded"],Xw(s));const i=zy(e,["mimeType"]);return null!=i&&qy(t,["mimeType"],i),t}function jE(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["displayName"]);void 0!==t&&null!=n&&qy(t,["displayName"],n)}(n,t),t}function FE(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["_url","name"],n);const s=zy(e,["config"]);return null!=s&&function(e,t){const n=zy(e,["force"]);void 0!==t&&null!=n&&qy(t,["_query","force"],n)}(s,t),t}function LE(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["name"],n);const s=zy(e,["metadata"]);null!=s&&qy(t,["metadata"],s);const i=zy(e,["done"]);null!=i&&qy(t,["done"],i);const r=zy(e,["error"]);null!=r&&qy(t,["error"],r);const o=zy(e,["response"]);return null!=o&&qy(t,["response"],function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["parent"]);null!=s&&qy(t,["parent"],s);const i=zy(e,["documentName"]);null!=i&&qy(t,["documentName"],i);return t}(o)),t}function UE(e){const t={},n=zy(e,["fileSearchStoreName"]);null!=n&&qy(t,["_url","file_search_store_name"],n);const s=zy(e,["fileName"]);null!=s&&qy(t,["fileName"],s);const i=zy(e,["config"]);return null!=i&&function(e,t){const n=zy(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["customMetadata"],e)}const s=zy(e,["chunkingConfig"]);void 0!==t&&null!=s&&qy(t,["chunkingConfig"],s)}(i,t),t}function BE(e){const t={},n=zy(e,["config"]);return null!=n&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s)}(n,t),t}function VE(e,t){const n=zy(e,["mimeType"]);void 0!==t&&null!=n&&qy(t,["mimeType"],n);const s=zy(e,["displayName"]);void 0!==t&&null!=s&&qy(t,["displayName"],s);const i=zy(e,["customMetadata"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["customMetadata"],e)}const r=zy(e,["chunkingConfig"]);return void 0!==t&&null!=r&&qy(t,["chunkingConfig"],r),{}}const WE="x-goog-api-client",HE="google-genai-sdk/".concat("1.36.0");class qE{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?"https://".concat(this.clientOptions.location,"-aiplatform.googleapis.com/"):"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return"projects/".concat(this.clientOptions.project,"/locations/").concat(this.clientOptions.location)}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];n&&s.push(this.getBaseResourcePath()),""!==e&&s.push(e);return new URL("".concat(s.join("/")))}shouldPrependVertexProjectPath(e){return!this.clientOptions.apiKey&&(!!this.clientOptions.vertexai&&(!e.path.startsWith("projects/")&&("GET"!==e.httpMethod||!e.path.startsWith("publishers/google/models"))))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[r,o]of Object.entries(e.queryParams))s.searchParams.append(r,String(o));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,s.toString(),e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(t))"object"===typeof i?n[s]=Object.assign(Object.assign({},n[s]),i):void 0!==i&&(n[s]=i);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);s.searchParams.has("alt")&&"sse"===s.searchParams.get("alt")||s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,s.toString(),e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const n=new AbortController,i=n.signal;if(t.timeout&&(null===t||void 0===t?void 0:t.timeout)>0){const e=setTimeout(()=>n.abort(),t.timeout);e&&"function"===typeof e.unref&&e.unref()}s&&s.addEventListener("abort",()=>{n.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return void console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"===typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!==typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(r){return void console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.")}function s(e,t){const n=Object.assign({},e);for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const e=t[i],r=n[i];e&&"object"===typeof e&&!Array.isArray(e)&&r&&"object"===typeof r&&!Array.isArray(r)?n[i]=s(r,e):(r&&e&&typeof r!==typeof e&&console.warn('includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "'.concat(i,'". Original type: ').concat(typeof r,", New type: ").concat(typeof e,". Overwriting.")),n[i]=e)}return n}const i=s(n,t);e.body=JSON.stringify(i)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await zE(e),new tw(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await zE(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){return Px(this,arguments,function*(){var t;const n=null===(t=null===e||void 0===e?void 0:e.body)||void 0===t?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";const r="data:",o=["\n\n","\r\r","\r\n\r\n"];for(;;){const{done:a,value:l}=yield Ix(n.read());if(a){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=s.decode(l,{stream:!0});try{const e=JSON.parse(c);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,s=t.code,i="got status: ".concat(n,". ").concat(JSON.stringify(e));if(s>=400&&s<600){throw new Lx({message:i,status:s})}}}catch(i){if("ApiError"===i.name)throw i}t+=c;let d=-1,u=0;for(;;){d=-1,u=0;for(const e of o){const n=t.indexOf(e);-1!==n&&(-1===d||n<d)&&(d=n,u=e.length)}if(-1===d)break;const n=t.substring(0,d);t=t.substring(d+u);const s=n.trim();if(s.startsWith(r)){const t=s.substring(r.length).trim();try{const n=new Response(t,{headers:null===e||void 0===e?void 0:e.headers,status:null===e||void 0===e?void 0:e.status,statusText:null===e||void 0===e?void 0:e.statusText});yield yield Ix(new tw(n))}catch(i){throw new Error("exception parsing stream chunk ".concat(t,". ").concat(i))}}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error("exception ".concat(e," sending request"))})}getDefaultHeaders(){const e={},t=HE+" "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[WE]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[t,s]of Object.entries(e.headers))n.append(t,s);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"===typeof e&&(n=e.replace(/[/\\]+$/,""),n=null!==(t=n.split(/[/\\]/).pop())&&void 0!==t?t:""),n}async uploadFile(e,t){var n;const s={};null!=t&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name="files/".concat(s.name));const i=this.clientOptions.uploader,r=await i.stat(e);s.sizeBytes=String(r.size);const o=null!==(n=null===t||void 0===t?void 0:t.mimeType)&&void 0!==n?n:r.type;if(void 0===o||""===o)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=o;const a={file:s},l=this.getFileName(e),c=Hy("upload/v1beta/files",a._url),d=await this.fetchUploadUrl(c,s.sizeBytes,s.mimeType,l,a,null===t||void 0===t?void 0:t.httpOptions);return i.upload(e,d,this)}async uploadFileToFileSearchStore(e,t,n){var s;const i=this.clientOptions.uploader,r=await i.stat(t),o=String(r.size),a=null!==(s=null===n||void 0===n?void 0:n.mimeType)&&void 0!==s?s:r.type;if(void 0===a||""===a)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const l="upload/v1beta/".concat(e,":uploadToFileSearchStore"),c=this.getFileName(t),d={};null!=n&&VE(n,d);const u=await this.fetchUploadUrl(l,o,a,c,d,null===n||void 0===n?void 0:n.httpOptions);return i.uploadToFileSearchStore(t,u,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,s,i,r){var o;let a={};a=r||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(t),"X-Goog-Upload-Header-Content-Type":"".concat(n)},s?{"X-Goog-Upload-File-Name":s}:{})};const l=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:a});if(!l||!(null===l||void 0===l?void 0:l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=null===(o=null===l||void 0===l?void 0:l.headers)||void 0===o?void 0:o["x-goog-upload-url"];if(void 0===c)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function zE(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let s;s=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(s);if(n>=400&&n<600){throw new Lx({message:i,status:n})}throw new Error(i)}}let GE=!1;function KE(e){for(const t of e){if(YE(t))return!0;if("object"===typeof t&&"inputSchema"in t)return!0}return GE}function JE(e){var t;const n=null!==(t=e[WE])&&void 0!==t?t:"";e[WE]=(n+" ".concat("mcp_used/unknown")).trimStart()}function YE(e){return null!==e&&"object"===typeof e&&e instanceof XE}function $E(e){return Px(this,arguments,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function*(){let n,s=0;for(;s<t;){const t=yield Ix(e.listTools({cursor:n}));for(const e of t.tools)yield yield Ix(e),s++;if(!t.nextCursor)break;n=t.nextCursor}}()})}class XE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new XE(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const i={},r=[];for(const d of this.mcpClients)try{for(var o,a=!0,l=(t=void 0,Rx($E(d)));!(e=(o=await l.next()).done);a=!0){s=o.value,a=!1;const e=s;r.push(e);const t=e.name;if(i[t])throw new Error("Duplicate function name ".concat(t," found in MCP tools. Please ensure function names are unique."));i[t]=d}}catch(c){t={error:c}}finally{try{a||e||!(n=l.return)||await n.call(l)}finally{if(t)throw t.error}}this.mcpTools=r,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[],s=new Set;for(const i of e){const e=i.name;if(s.has(e))throw new Error("Duplicate function name ".concat(e," found in MCP tools. Please ensure function names are unique."));s.add(e);const r=nx(i,t);r.functionDeclarations&&n.push(...r.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const i=await e.callTool({name:n.name,arguments:n.args},void 0,s);t.push({functionResponse:{name:n.name,response:i.isError?{error:i}:i}})}return t}}class QE{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),r=function(e){const t=new Headers;for(const[n,s]of Object.entries(e))t.append(n,s);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a="".concat(s,"/ws/google.ai.generativelanguage.").concat(i,".GenerativeService.BidiGenerateMusic?key=").concat(o);let l=()=>{};const c=new Promise(e=>{l=e}),d=e.callbacks,u=(this.apiClient,{onopen:function(){l({})},onmessage:e=>{!async function(e,t,n){const s=new kw;let i;i=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),Object.assign(s,i),t(s)}(0,d.onmessage,e)},onerror:null!==(t=null===d||void 0===d?void 0:d.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null===d||void 0===d?void 0:d.onclose)&&void 0!==n?n:function(e){}}),h=this.webSocketFactory.create(a,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(r),u);h.connect(),await c;const p={setup:{model:Nw(this.apiClient,e.model)}};return h.send(JSON.stringify(p)),new ZE(h,this.apiClient)}}class ZE{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=function(e){const t={},n=zy(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=function(e){const t={},n=zy(e,["musicGenerationConfig"]);return null!=n&&qy(t,["musicGenerationConfig"],n),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Z_.PLAY)}pause(){this.sendPlaybackControl(Z_.PAUSE)}stop(){this.sendPlaybackControl(Z_.STOP)}resetContext(){this.sendPlaybackControl(Z_.RESET_CONTEXT)}close(){this.conn.close()}}class eS{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new QE(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,i,r,o;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const d=this.apiClient.getHeaders();e.config&&e.config.tools&&KE(e.config.tools)&&JE(d);const u=function(e){const t=new Headers;for(const[n,s]of Object.entries(e))t.append(n,s);return t}(d);if(this.apiClient.isVertexAI())c="".concat(a,"/ws/google.cloud.aiplatform.").concat(l,".LlmBidiService/BidiGenerateContent"),await this.auth.addAuthHeaders(u,c);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null===e||void 0===e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==l&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),c="".concat(a,"/ws/google.ai.generativelanguage.").concat(l,".GenerativeService.").concat(t,"?").concat(n,"=").concat(e)}let h=()=>{};const p=new Promise(e=>{h=e}),f=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null===f||void 0===f?void 0:f.onopen)||void 0===e||e.call(f),h({})},onmessage:e=>{!async function(e,t,n){const s=new Cw;let i;i=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const r=JSON.parse(i);if(e.isVertexAI()){const e=Kx(r);Object.assign(s,e)}else{const e=r;Object.assign(s,e)}t(s)}(m,f.onmessage,e)},onerror:null!==(t=null===f||void 0===f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null===f||void 0===f?void 0:f.onclose)&&void 0!==n?n:function(e){}},v=this.webSocketFactory.create(c,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(u),g);v.connect(),await p;let b=Nw(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&b.startsWith("publishers/")){const e=this.apiClient.getProject(),t=this.apiClient.getLocation();b="projects/".concat(e,"/locations/").concat(t,"/")+b}let y={};this.apiClient.isVertexAI()&&void 0===(null===(s=e.config)||void 0===s?void 0:s.responseModalities)&&(void 0===e.config?e.config={responseModalities:[y_.AUDIO]}:e.config.responseModalities=[y_.AUDIO]),(null===(i=e.config)||void 0===i?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const _=null!==(o=null===(r=e.config)||void 0===r?void 0:r.tools)&&void 0!==o?o:[],w=[];for(const E of _)if(this.isCallableTool(E)){const e=E;w.push(await e.tool())}else w.push(E);w.length>0&&(e.config.tools=w);const x={model:b,config:e.config,callbacks:e.callbacks};return y=this.apiClient.isVertexAI()?function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["setup","model"],Nw(e,s));const i=zy(t,["config"]);return null!=i&&qy(n,["config"],qx(i,n)),n}(this.apiClient,x):function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["setup","model"],Nw(e,s));const i=zy(t,["config"]);return null!=i&&qy(n,["config"],Hx(i,n)),n}(this.apiClient,x),delete y.config,v.send(JSON.stringify(y)),new nS(v,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"===typeof e.callTool}}const tS={turnComplete:!0};class nS{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=Ww(t.turns),e.isVertexAI()||(n=n.map(e=>$x(e)))}catch(AA){throw new Error('Failed to parse client content "turns", type: \''.concat(typeof t.turns,"'"))}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const s of n){if("object"!==typeof s||null===s||!("name"in s)||!("response"in s))throw new Error("Could not parse function response, type '".concat(typeof s,"'."));if(!e.isVertexAI()&&!("id"in s))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},tS),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:Gx(e)}:{realtimeInput:zx(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function sS(e){var t,n,s;if(null===(t=null===e||void 0===e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(const o of null!==(n=null===e||void 0===e?void 0:e.tools)&&void 0!==n?n:[])if(iS(o)){i=!0;break}if(!i)return!0;const r=null===(s=null===e||void 0===e?void 0:e.automaticFunctionCalling)||void 0===s?void 0:s.maximumRemoteCalls;return!!(r&&(r<0||!Number.isInteger(r))||0==r)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0)}function iS(e){return"callTool"in e&&"function"===typeof e.callTool}function rS(e){var t;const n=[];return(null===(t=null===e||void 0===e?void 0:e.config)||void 0===t?void 0:t.tools)?(e.config.tools.forEach((e,t)=>{if(iS(e))return;const s=e;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(t)}),n):n}function oS(e){var t;return!(null===(t=null===e||void 0===e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}class aS extends Wy{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,s,i,r;const o=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,s;return null!==(s=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>iS(e)))&&void 0!==s&&s}(e)||sS(e.config))return await this.generateContentInternal(o);const a=rS(e);if(a.length>0){const e=a.map(e=>"tools[".concat(e,"]")).join(", ");throw new Error("Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ".concat(e,"."))}let l,c;const d=Ww(o.contents),u=null!==(s=null===(n=null===(t=o.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==s?s:10;let h=0;for(;h<u&&(l=await this.generateContentInternal(o),l.functionCalls&&0!==l.functionCalls.length);){const t=l.candidates[0].content,n=[];for(const s of null!==(r=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==r?r:[])if(iS(s)){const e=s,t=await e.callTool(l.functionCalls);n.push(...t)}h++,c={role:"user",parts:n},o.contents=Ww(o.contents),o.contents.push(t),o.contents.push(c),oS(o.config)&&(d.push(t),d.push(c))}return oS(o.config)&&(l.automaticFunctionCallingHistory=d),l},this.generateContentStream=async e=>{var t,n,s,i,r;if(this.maybeMoveToResponseJsonSchem(e),sS(e.config)){const t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}const o=rS(e);if(o.length>0){const e=o.map(e=>"tools[".concat(e,"]")).join(", ");throw new Error("Incompatible tools found at ".concat(e,'. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.'))}const a=null===(s=null===(n=null===(t=null===e||void 0===e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===n?void 0:n.functionCallingConfig)||void 0===s?void 0:s.streamFunctionCallArguments,l=null===(r=null===(i=null===e||void 0===e?void 0:e.config)||void 0===i?void 0:i.automaticFunctionCalling)||void 0===r?void 0:r.disable;if(a&&!l)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const s=[];if(null===e||void 0===e?void 0:e.generatedImages)for(const r of e.generatedImages)r&&(null===r||void 0===r?void 0:r.safetyAttributes)&&"Positive Prompt"===(null===(t=null===r||void 0===r?void 0:r.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null===r||void 0===r?void 0:r.safetyAttributes:s.push(r);let i;return i=n?{generatedImages:s,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:s,sdkHttpResponse:e.sdkHttpResponse},i}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null===e||void 0===e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new bx(ew.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,s,i,r,o;if((e.prompt||e.image||e.video)&&e.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(n=e.video)||void 0===n?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(i=null===(s=e.source)||void 0===s?void 0:s.video)||void 0===i?void 0:i.uri)&&(null===(o=null===(r=e.source)||void 0===r?void 0:r.video)||void 0===o?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const i=null===(t=e.config)||void 0===t?void 0:t.tools;if(!i)return e;const r=await Promise.all(i.map(async e=>{if(iS(e)){const t=e;return await t.tool()}return e})),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};if(o.config.tools=r,e.config&&e.config.tools&&KE(e.config.tools)){const t=null!==(s=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==s?s:{};let i=Object.assign({},t);0===Object.keys(i).length&&(i=this.apiClient.getDefaultHeaders()),JE(i),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:i})}return o}async initAfcToolsMap(e){var t,n,s;const i=new Map;for(const r of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(iS(r)){const e=r,t=await e.tool();for(const n of null!==(s=t.functionDeclarations)&&void 0!==s?s:[]){if(!n.name)throw new Error("Function declaration name is required.");if(i.has(n.name))throw new Error("Duplicate tool declaration name: ".concat(n.name));i.set(n.name,e)}}return i}async processAfcStream(e){var t,n,s;const i=null!==(s=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==s?s:10;let r=!1,o=0;return function(e,t,n){return Px(this,arguments,function*(){for(var s,a,l,c,d,u;o<i;){r&&(o++,r=!1);const g=yield Ix(e.processParamsMaybeAddMcpUsage(n)),v=yield Ix(e.generateContentStreamInternal(g)),b=[],y=[];try{for(var h,p=!0,f=(a=void 0,Rx(v));!(s=(h=yield Ix(f.next())).done);p=!0){c=h.value,p=!1;const e=c;if(yield yield Ix(e),e.candidates&&(null===(d=e.candidates[0])||void 0===d?void 0:d.content)){y.push(e.candidates[0].content);for(const n of null!==(u=e.candidates[0].content.parts)&&void 0!==u?u:[])if(o<i&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error("Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ".concat(t.keys(),", mising tool: ").concat(n.functionCall.name));{const e=yield Ix(t.get(n.functionCall.name).callTool([n.functionCall]));b.push(...e)}}}}}catch(m){a={error:m}}finally{try{p||s||!(l=f.return)||(yield Ix(l.call(f)))}finally{if(a)throw a.error}}if(!(b.length>0))break;{r=!0;const e=new nw;e.candidates=[{content:{role:"user",parts:b}}],yield yield Ix(e);const t=[];t.push(...y),t.push({role:"user",parts:b});const s=Ww(n.contents).concat(t);n.contents=s}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=rE(this.apiClient,e);return o=Hy("{model}:generateContent",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=aE(e),n=new nw;return Object.assign(n,t),n})}{const t=iE(this.apiClient,e);return o=Hy("{model}:generateContent",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=oE(e),n=new nw;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=rE(this.apiClient,e);o=Hy("{model}:streamGenerateContent?alt=sse",s._url),a=s._query,delete s._url,delete s._query;return r=this.apiClient.requestStream({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),r.then(function(e){return Px(this,arguments,function*(){var t,n,s,i;try{for(var r,o=!0,a=Rx(e);!(t=(r=yield Ix(a.next())).done);o=!0){i=r.value,o=!1;const e=i,t=aE(yield Ix(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new nw;Object.assign(n,t),yield yield Ix(n)}}catch(l){n={error:l}}finally{try{o||t||!(s=a.return)||(yield Ix(s.call(a)))}finally{if(n)throw n.error}}})})}{const t=iE(this.apiClient,e);o=Hy("{model}:streamGenerateContent?alt=sse",t._url),a=t._query,delete t._url,delete t._query;return r=this.apiClient.requestStream({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}),r.then(function(e){return Px(this,arguments,function*(){var t,n,s,i;try{for(var r,o=!0,a=Rx(e);!(t=(r=yield Ix(a.next())).done);o=!0){i=r.value,o=!1;const e=i,t=oE(yield Ix(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new nw;Object.assign(n,t),yield yield Ix(n)}}catch(l){n={error:l}}finally{try{o||t||!(s=a.return)||(yield Ix(s.call(a)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=tE(this.apiClient,e);return o=Hy("{model}:predict",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["predictions[]","embeddings"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>Yx(e))),qy(t,["embeddings"],e)}const i=zy(e,["metadata"]);return null!=i&&qy(t,["metadata"],i),t}(e),n=new sw;return Object.assign(n,t),n})}{const t=eE(this.apiClient,e);return o=Hy("{model}:batchEmbedContents",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["embeddings"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["embeddings"],e)}const i=zy(e,["metadata"]);return null!=i&&qy(t,["metadata"],i),t}(e),n=new sw;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=cE(this.apiClient,e);return o=Hy("{model}:predict",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>vE(e))),qy(t,["generatedImages"],e)}const i=zy(e,["positivePromptSafetyAttributes"]);return null!=i&&qy(t,["positivePromptSafetyAttributes"],kE(i)),t}(e),n=new iw;return Object.assign(n,t),n})}{const t=lE(this.apiClient,e);return o=Hy("{model}:predict",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=dE(e),n=new iw;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=Zx(this.apiClient,e);return i=Hy("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>vE(e))),qy(t,["generatedImages"],e)}return t}(e),n=new rw;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=ME(this.apiClient,e);return i=Hy("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>vE(e))),qy(t,["generatedImages"],e)}return t}(e),n=new ow;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=AE(this.apiClient,e);return i=Hy("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=zy(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>vE(e))),qy(t,["generatedImages"],e)}return t}(e),n=new aw;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=TE(this.apiClient,e);return i=Hy("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=NE(e),n=new lw;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["model"]);return null!=s&&qy(n,["_url","name"],Nw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>SE(e))}{const t=function(e,t){const n={},s=zy(t,["model"]);return null!=s&&qy(n,["_url","name"],Nw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>EE(e))}}async listInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=xE(this.apiClient,e);return o=Hy("{models_url}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["_self"]);if(null!=i){let e=ex(i);Array.isArray(e)&&(e=e.map(e=>SE(e))),qy(t,["models"],e)}return t}(e),n=new cw;return Object.assign(n,t),n})}{const t=wE(this.apiClient,e);return o=Hy("{models_url}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["_self"]);if(null!=i){let e=ex(i);Array.isArray(e)&&(e=e.map(e=>EE(e))),qy(t,["models"],e)}return t}(e),n=new cw;return Object.assign(n,t),n})}}async update(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=RE(this.apiClient,e);return o=Hy("{model}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>SE(e))}{const t=PE(this.apiClient,e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>EE(e))}}async delete(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["model"]);return null!=s&&qy(n,["_url","name"],Nw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new dw;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=zy(t,["model"]);return null!=s&&qy(n,["_url","name"],Nw(e,s)),n}(this.apiClient,e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new dw;return Object.assign(n,t),n})}}async countTokens(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let e=Ww(i);Array.isArray(e)&&(e=e.map(e=>e)),qy(n,["contents"],e)}const r=zy(t,["config"]);return null!=r&&Xx(r,n),n}(this.apiClient,e);return o=Hy("{model}:countTokens",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["totalTokens"]);return null!=s&&qy(t,["totalTokens"],s),t}(e),n=new uw;return Object.assign(n,t),n})}{const t=Qx(this.apiClient,e);return o=Hy("{model}:countTokens",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["totalTokens"]);null!=s&&qy(t,["totalTokens"],s);const i=zy(e,["cachedContentTokenCount"]);return null!=i&&qy(t,["cachedContentTokenCount"],i),t}(e),n=new uw;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["_url","model"],Nw(e,s));const i=zy(t,["contents"]);if(null!=i){let e=Ww(i);Array.isArray(e)&&(e=e.map(e=>e)),qy(n,["contents"],e)}return n}(this.apiClient,e);return i=Hy("{model}:computeTokens",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["tokensInfo"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["tokensInfo"],e)}return t}(e),n=new hw;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=gE(this.apiClient,e);return o=Hy("{model}:predictLongRunning",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=fE(e),n=new pw;return Object.assign(n,t),n})}{const t=mE(this.apiClient,e);return o=Hy("{model}:predictLongRunning",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r.then(e=>{const t=pE(e),n=new pw;return Object.assign(n,t),n})}}}class lS extends Wy{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=zy(e,["operationName"]);return null!=n&&qy(t,["_url","operationName"],n),t}(e);return o=Hy("{operationName}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r}{const t=function(e){const t={},n=zy(e,["operationName"]);return null!=n&&qy(t,["_url","operationName"],n),t}(e);return o=Hy("{operationName}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),r}}async fetchPredictVideosOperationInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=zy(e,["operationName"]);null!=n&&qy(t,["operationName"],n);const s=zy(e,["resourceName"]);return null!=s&&qy(t,["_url","resourceName"],s),t}(e);return i=Hy("{resourceName}:fetchPredictOperation",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s}throw new Error("This method is only supported by the Vertex AI.")}}function cS(e){const t={},n=zy(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=zy(e,["mediaResolution"]);null!=n&&qy(t,["mediaResolution"],n);const s=zy(e,["codeExecutionResult"]);null!=s&&qy(t,["codeExecutionResult"],s);const i=zy(e,["executableCode"]);null!=i&&qy(t,["executableCode"],i);const r=zy(e,["fileData"]);null!=r&&qy(t,["fileData"],function(e){const t={};if(void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=zy(e,["fileUri"]);null!=n&&qy(t,["fileUri"],n);const s=zy(e,["mimeType"]);null!=s&&qy(t,["mimeType"],s);return t}(r));const o=zy(e,["functionCall"]);null!=o&&qy(t,["functionCall"],function(e){const t={},n=zy(e,["id"]);null!=n&&qy(t,["id"],n);const s=zy(e,["args"]);null!=s&&qy(t,["args"],s);const i=zy(e,["name"]);null!=i&&qy(t,["name"],i);if(void 0!==zy(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==zy(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=zy(e,["functionResponse"]);null!=a&&qy(t,["functionResponse"],a);const l=zy(e,["inlineData"]);null!=l&&qy(t,["inlineData"],function(e){const t={},n=zy(e,["data"]);if(null!=n&&qy(t,["data"],n),void 0!==zy(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=zy(e,["mimeType"]);return null!=s&&qy(t,["mimeType"],s),t}(l));const c=zy(e,["text"]);null!=c&&qy(t,["text"],c);const d=zy(e,["thought"]);null!=d&&qy(t,["thought"],d);const u=zy(e,["thoughtSignature"]);null!=u&&qy(t,["thoughtSignature"],u);const h=zy(e,["videoMetadata"]);null!=h&&qy(t,["videoMetadata"],h);return t}(e))),qy(t,["parts"],e)}const s=zy(e,["role"]);return null!=s&&qy(t,["role"],s),t}function dS(e,t,n){const s=zy(t,["expireTime"]);void 0!==n&&null!=s&&qy(n,["expireTime"],s);const i=zy(t,["newSessionExpireTime"]);void 0!==n&&null!=i&&qy(n,["newSessionExpireTime"],i);const r=zy(t,["uses"]);void 0!==n&&null!=r&&qy(n,["uses"],r);const o=zy(t,["liveConnectConstraints"]);void 0!==n&&null!=o&&qy(n,["bidiGenerateContentSetup"],function(e,t){const n={},s=zy(t,["model"]);null!=s&&qy(n,["setup","model"],Nw(e,s));const i=zy(t,["config"]);null!=i&&qy(n,["config"],function(e,t){const n={},s=zy(e,["generationConfig"]);void 0!==t&&null!=s&&qy(t,["setup","generationConfig"],s);const i=zy(e,["responseModalities"]);void 0!==t&&null!=i&&qy(t,["setup","generationConfig","responseModalities"],i);const r=zy(e,["temperature"]);void 0!==t&&null!=r&&qy(t,["setup","generationConfig","temperature"],r);const o=zy(e,["topP"]);void 0!==t&&null!=o&&qy(t,["setup","generationConfig","topP"],o);const a=zy(e,["topK"]);void 0!==t&&null!=a&&qy(t,["setup","generationConfig","topK"],a);const l=zy(e,["maxOutputTokens"]);void 0!==t&&null!=l&&qy(t,["setup","generationConfig","maxOutputTokens"],l);const c=zy(e,["mediaResolution"]);void 0!==t&&null!=c&&qy(t,["setup","generationConfig","mediaResolution"],c);const d=zy(e,["seed"]);void 0!==t&&null!=d&&qy(t,["setup","generationConfig","seed"],d);const u=zy(e,["speechConfig"]);void 0!==t&&null!=u&&qy(t,["setup","generationConfig","speechConfig"],Gw(u));const h=zy(e,["thinkingConfig"]);void 0!==t&&null!=h&&qy(t,["setup","generationConfig","thinkingConfig"],h);const p=zy(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&qy(t,["setup","generationConfig","enableAffectiveDialog"],p);const f=zy(e,["systemInstruction"]);void 0!==t&&null!=f&&qy(t,["setup","systemInstruction"],cS(Bw(f)));const m=zy(e,["tools"]);if(void 0!==t&&null!=m){let e=Jw(m);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==zy(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=zy(e,["computerUse"]);null!=n&&qy(t,["computerUse"],n);const s=zy(e,["fileSearch"]);null!=s&&qy(t,["fileSearch"],s);const i=zy(e,["codeExecution"]);null!=i&&qy(t,["codeExecution"],i);if(void 0!==zy(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=zy(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["functionDeclarations"],e)}const o=zy(e,["googleMaps"]);null!=o&&qy(t,["googleMaps"],function(e){const t={};if(void 0!==zy(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=zy(e,["enableWidget"]);null!=n&&qy(t,["enableWidget"],n);return t}(o));const a=zy(e,["googleSearch"]);null!=a&&qy(t,["googleSearch"],function(e){const t={};if(void 0!==zy(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==zy(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=zy(e,["timeRangeFilter"]);null!=n&&qy(t,["timeRangeFilter"],n);return t}(a));const l=zy(e,["googleSearchRetrieval"]);null!=l&&qy(t,["googleSearchRetrieval"],l);const c=zy(e,["urlContext"]);null!=c&&qy(t,["urlContext"],c);return t}(Kw(e)))),qy(t,["setup","tools"],e)}const g=zy(e,["sessionResumption"]);void 0!==t&&null!=g&&qy(t,["setup","sessionResumption"],function(e){const t={},n=zy(e,["handle"]);null!=n&&qy(t,["handle"],n);if(void 0!==zy(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(g));const v=zy(e,["inputAudioTranscription"]);void 0!==t&&null!=v&&qy(t,["setup","inputAudioTranscription"],v);const b=zy(e,["outputAudioTranscription"]);void 0!==t&&null!=b&&qy(t,["setup","outputAudioTranscription"],b);const y=zy(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&qy(t,["setup","realtimeInputConfig"],y);const _=zy(e,["contextWindowCompression"]);void 0!==t&&null!=_&&qy(t,["setup","contextWindowCompression"],_);const w=zy(e,["proactivity"]);void 0!==t&&null!=w&&qy(t,["setup","proactivity"],w);if(void 0!==zy(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}(i,n));return n}(e,o));const a=zy(t,["lockAdditionalFields"]);return void 0!==n&&null!=a&&qy(n,["fieldMask"],a),{}}function uS(e,t){let n=null;const s=e.bidiGenerateContentSetup;if("object"===typeof s&&null!==s&&"setup"in s){const t=s.setup;"object"===typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==s&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=e[n];if("object"===typeof s&&null!=s&&Object.keys(s).length>0){const e=Object.keys(s).map(e=>"".concat(n,".").concat(e));t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null===t||void 0===t?void 0:t.lockAdditionalFields)&&0===(null===t||void 0===t?void 0:t.lockAdditionalFields.length))s?e.fieldMask=s:delete e.fieldMask;else if((null===t||void 0===t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];i.length>0&&(n=i.map(e=>t.includes(e)?"generationConfig.".concat(e):e));const r=[];s&&r.push(s),n.length>0&&r.push(...n),r.length>0?e.fieldMask=r.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class hS extends Wy{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=function(e,t){const n={},s=zy(t,["config"]);return null!=s&&qy(n,["config"],dS(e,s,n)),n}(this.apiClient,e);i=Hy("auth_tokens",o._url),r=o._query,delete o.config,delete o._url,delete o._query;const a=uS(o,e.config);return s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}}function pS(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["_url","name"],n);const s=zy(e,["config"]);return null!=s&&function(e,t){const n=zy(e,["force"]);void 0!==t&&null!=n&&qy(t,["_query","force"],n)}(s,t),t}function fS(e){const t={},n=zy(e,["parent"]);null!=n&&qy(t,["_url","parent"],n);const s=zy(e,["config"]);return null!=s&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s)}(s,t),t}class mS extends Wy{constructor(e){super(),this.apiClient=e,this.list=async e=>new bx(ew.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","name"],n),t}(e);return i=Hy("{name}",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n;let s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=pS(e);s=Hy("{name}",r._url),i=r._query,delete r._url,delete r._query,await this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=fS(e);return i=Hy("{parent}/documents",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["documents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["documents"],e)}return t}(e),n=new bw;return Object.assign(n,t),n})}}}class gS extends Wy{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new mS(e);super(),t=this,this.apiClient=e,this.documents=n,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new bx(ew.PAGED_ITEM_FILE_SEARCH_STORES,e=>t.listInternal(e),await t.listInternal(e),e)}}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=jE(e);return i=Hy("fileSearchStores",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async get(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","name"],n),t}(e);return i=Hy("{name}",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n;let s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=FE(e);s=Hy("{name}",r._url),i=r._query,delete r._url,delete r._query,await this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=BE(e);return i=Hy("fileSearchStores",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["fileSearchStores"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["fileSearchStores"],e)}return t}(e),n=new yw;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=zy(e,["fileSearchStoreName"]);null!=n&&qy(t,["_url","file_search_store_name"],n);const s=zy(e,["config"]);return null!=s&&VE(s,t),t}(e);return i=Hy("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new _w;return Object.assign(n,t),n})}}async importFile(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=UE(e);return i=Hy("{file_search_store_name}:importFile",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=LE(e),n=new ww;return Object.assign(n,t),n})}}}let vS=function(){const{crypto:e}=globalThis;if(null===e||void 0===e?void 0:e.randomUUID)return vS=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^n()&15>>+e/4).toString(16))};function bS(e){return"object"===typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const yS=e=>{if(e instanceof Error)return e;if("object"===typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch(AA){}try{return new Error(JSON.stringify(e))}catch(t){}}return new Error(e)};class _S extends Error{}class wS extends _S{constructor(e,t,n,s){super("".concat(wS.makeMessage(e,t,n))),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,n){const s=(null===t||void 0===t?void 0:t.message)?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?"".concat(e," ").concat(s):e?"".concat(e," status code (no body)"):s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new ES({message:n,cause:yS(t)});const i=t;return 400===e?new AS(e,i,n,s):401===e?new CS(e,i,n,s):403===e?new kS(e,i,n,s):404===e?new TS(e,i,n,s):409===e?new NS(e,i,n,s):422===e?new IS(e,i,n,s):429===e?new PS(e,i,n,s):e>=500?new RS(e,i,n,s):new wS(e,i,n,s)}}class xS extends wS{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(void 0,void 0,e||"Request was aborted.",void 0)}}class ES extends wS{constructor(e){let{message:t,cause:n}=e;super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class SS extends ES{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:null!==e&&void 0!==e?e:"Request timed out."})}}class AS extends wS{}class CS extends wS{}class kS extends wS{}class TS extends wS{}class NS extends wS{}class IS extends wS{}class PS extends wS{}class RS extends wS{}const MS=/^[a-z][a-z0-9+.-]*:/i;let OS=e=>(OS=Array.isArray,OS(e));const DS=OS;const jS="0.0.1";const FS=()=>{var e,t,n,s,i;const r="undefined"!==typeof Deno&&null!=Deno.build?"deno":"undefined"!==typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call("undefined"!==typeof globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===r)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jS,"X-Stainless-OS":US(Deno.build.os),"X-Stainless-Arch":LS(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:null!==(t=null===(e=Deno.version)||void 0===e?void 0:e.deno)&&void 0!==t?t:"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jS,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:".concat(EdgeRuntime),"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===r)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jS,"X-Stainless-OS":US(null!==(n=globalThis.process.platform)&&void 0!==n?n:"unknown"),"X-Stainless-Arch":LS(null!==(s=globalThis.process.arch)&&void 0!==s?s:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!==(i=globalThis.process.version)&&void 0!==i?i:"unknown"};const o=function(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0,s=e[2]||0,i=e[3]||0;return{browser:t,version:"".concat(n,".").concat(s,".").concat(i)}}}return null}();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jS,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:".concat(o.browser),"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jS,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const LS=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?"other:".concat(e):"unknown",US=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?"Other:".concat(e):"Unknown";let BS;function VS(){const e=globalThis.ReadableStream;if("undefined"===typeof e)throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return new e(...n)}function WS(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return VS({start(){},async pull(e){const{done:n,value:s}=await t.next();n?e.close():e.enqueue(s)},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}function HS(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null===e||void 0===e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const qS=e=>{let{headers:t,body:n}=e;return{bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(n)}},zS=()=>{var e;if("undefined"===typeof File){const{process:t}=globalThis,n="string"===typeof(null===(e=null===t||void 0===t?void 0:t.versions)||void 0===e?void 0:e.node)&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function GS(e,t,n){return zS(),new File(e,null!==t&&void 0!==t?t:"unknown_file",n)}const KS=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer;async function JS(e){var t,n,s,i,r;let o=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)o.push(e);else if(KS(e))o.push(e instanceof Blob?e:await e.arrayBuffer());else{if(!(e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator])(e)){const t=null===(r=null===e||void 0===e?void 0:e.constructor)||void 0===r?void 0:r.name;throw new Error("Unexpected data type: ".concat(typeof e).concat(t?"; constructor: ".concat(t):"").concat(function(e){if("object"!==typeof e||null===e)return"";const t=Object.getOwnPropertyNames(e);return"; props: [".concat(t.map(e=>'"'.concat(e,'"')).join(", "),"]")}(e)))}try{for(var a,l=!0,c=Rx(e);!(t=(a=await c.next()).done);l=!0){i=a.value,l=!1;const e=i;o.push(...await JS(e))}}catch(d){n={error:d}}finally{try{l||t||!(s=c.return)||await s.call(c)}finally{if(n)throw n.error}}}return o}class YS{constructor(e){this._client=e}}function $S(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}YS._key=[];const XS=Object.freeze(Object.create(null)),QS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$S;return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];if(1===t.length)return t[0];let r=!1;const o=[],a=t.reduce((t,n,i)=>{var a,l,c;/[?#]/.test(n)&&(r=!0);const d=s[i];let u=(r?encodeURIComponent:e)(""+d);return i!==s.length&&(null==d||"object"===typeof d&&d.toString===(null===(c=Object.getPrototypeOf(null!==(l=Object.getPrototypeOf(null!==(a=d.hasOwnProperty)&&void 0!==a?a:XS))&&void 0!==l?l:XS))||void 0===c?void 0:c.toString))&&(u=d+"",o.push({start:t.length+n.length,length:u.length,error:"Value of type ".concat(Object.prototype.toString.call(d).slice(8,-1)," is not a valid path parameter")})),t+n+(i===s.length?"":u)},""),l=a.split(/[?#]/,1)[0],c=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let d;for(;null!==(d=c.exec(l));)o.push({start:d.index,length:d[0].length,error:'Value "'.concat(d[0],"\" can't be safely passed as a path parameter")});if(o.sort((e,t)=>e.start-t.start),o.length>0){let e=0;const t=o.reduce((t,n)=>{const s=" ".repeat(n.start-e),i="^".repeat(n.length);return e=n.start+n.length,t+s+i},"");throw new _S("Path parameters result in path with invalid segments:\n".concat(o.map(e=>e.error).join("\n"),"\n").concat(a,"\n").concat(t))}return a}},ZS=QS($S);class eA extends YS{create(e,t){var n;const{api_version:s=this._client.apiVersion}=e,i=Tx(e,["api_version"]);if("model"in i&&"agent_config"in i)throw new _S("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in i&&"generation_config"in i)throw new _S("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(ZS(Dy||(Dy=Oy(["/","/interactions"])),s),Object.assign(Object.assign({body:i},t),{stream:null!==(n=e.stream)&&void 0!==n&&n}))}delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const{api_version:s=this._client.apiVersion}=null!==t&&void 0!==t?t:{};return this._client.delete(ZS(jy||(jy=Oy(["/","/interactions/",""])),s,e),n)}cancel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const{api_version:s=this._client.apiVersion}=null!==t&&void 0!==t?t:{};return this._client.post(ZS(Fy||(Fy=Oy(["/","/interactions/","/cancel"])),s,e),n)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;var s;const i=null!==t&&void 0!==t?t:{},{api_version:r=this._client.apiVersion}=i,o=Tx(i,["api_version"]);return this._client.get(ZS(Ly||(Ly=Oy(["/","/interactions/",""])),r,e),Object.assign(Object.assign({query:o},n),{stream:null!==(s=null===t||void 0===t?void 0:t.stream)&&void 0!==s&&s}))}}eA._key=Object.freeze(["interactions"]);class tA extends eA{}let nA,sA;function iA(e){let t;return(null!==nA&&void 0!==nA?nA:(t=new globalThis.TextEncoder,nA=t.encode.bind(t)))(e)}function rA(e){let t;return(null!==sA&&void 0!==sA?sA:(t=new globalThis.TextDecoder,sA=t.decode.bind(t)))(e)}class oA{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?iA(e):e;this.buffer=function(e){let t=0;for(const i of e)t+=i.length;const n=new Uint8Array(t);let s=0;for(const i of e)n.set(i,s),s+=i.length;return n}([this.buffer,t]);const n=[];let s;for(;null!=(s=aA(this.buffer,this.carriageReturnIndex));){if(s.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=s.index;continue}if(null!=this.carriageReturnIndex&&(s.index!==this.carriageReturnIndex+1||s.carriage)){n.push(rA(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const e=null!==this.carriageReturnIndex?s.preceding-1:s.preceding,t=rA(this.buffer.subarray(0,e));n.push(t),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode("\n"):[]}}function aA(e,t){for(let n=null!==t&&void 0!==t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function lA(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}oA.NEWLINE_CHARS=new Set(["\n","\r"]),oA.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const cA={off:0,error:200,warn:300,info:400,debug:500},dA=(e,t,n)=>{var s,i;if(e)return s=cA,i=e,Object.prototype.hasOwnProperty.call(s,i)?e:void mA(n).warn("".concat(t," was set to ").concat(JSON.stringify(e),", expected one of ").concat(JSON.stringify(Object.keys(cA))))};function uA(){}function hA(e,t,n){return!t||cA[e]>cA[n]?uA:t[e].bind(t)}const pA={error:uA,warn:uA,info:uA,debug:uA};let fA=new WeakMap;function mA(e){var t;const n=e.logger,s=null!==(t=e.logLevel)&&void 0!==t?t:"off";if(!n)return pA;const i=fA.get(n);if(i&&i[0]===s)return i[1];const r={error:hA("error",n,s),warn:hA("warn",n,s),info:hA("info",n,s),debug:hA("debug",n,s)};return fA.set(n,[s,r]),r}const gA=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(e=>{let[t,n]=e;return[t,"x-goog-api-key"===t.toLowerCase()||"authorization"===t.toLowerCase()||"cookie"===t.toLowerCase()||"set-cookie"===t.toLowerCase()?"***":n]}))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class vA{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let s=!1;const i=n?mA(n):console;return new vA(function(){return Px(this,arguments,function*(){var n,r,o,a;if(s)throw new _S("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let l=!1;try{try{for(var c,d=!0,u=Rx(function(e,t){return Px(this,arguments,function*(){var n,s,i,r;if(!e.body){if(t.abort(),"undefined"!==typeof globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new _S("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new _S("Attempted to iterate over a response with no body")}const o=new bA,a=new oA,l=HS(e.body);try{for(var c,d=!0,u=Rx(function(e){return Px(this,arguments,function*(){var t,n,s,i;let r=new Uint8Array;try{for(var o,a=!0,l=Rx(e);!(t=(o=yield Ix(l.next())).done);a=!0){i=o.value,a=!1;const e=i;if(null==e)continue;const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?iA(e):e;let n,s=new Uint8Array(r.length+t.length);for(s.set(r),s.set(t,r.length),r=s;-1!==(n=lA(r));)yield yield Ix(r.slice(0,n)),r=r.slice(n)}}catch(c){n={error:c}}finally{try{a||t||!(s=l.return)||(yield Ix(s.call(l)))}finally{if(n)throw n.error}}r.length>0&&(yield yield Ix(r))})}(l));!(n=(c=yield Ix(u.next())).done);d=!0){r=c.value,d=!1;const e=r;for(const t of a.decode(e)){const e=o.decode(t);e&&(yield yield Ix(e))}}}catch(h){s={error:h}}finally{try{d||n||!(i=u.return)||(yield Ix(i.call(u)))}finally{if(s)throw s.error}}for(const e of a.flush()){const t=o.decode(e);t&&(yield yield Ix(t))}})}(e,t));!(n=(c=yield Ix(u.next())).done);d=!0){a=c.value,d=!1;const e=a;if(!l)if(e.data.startsWith("[DONE]"))l=!0;else try{yield yield Ix(JSON.parse(e.data))}catch(h){throw i.error("Could not parse message into JSON:",e.data),i.error("From chunk:",e.raw),h}}}catch(p){r={error:p}}finally{try{d||n||!(o=u.return)||(yield Ix(o.call(u)))}finally{if(r)throw r.error}}l=!0}catch(h){if(bS(h))return yield Ix(void 0);throw h}finally{l||t.abort()}})},t,n)}static fromReadableStream(e,t,n){let s=!1;return new vA(function(){return Px(this,arguments,function*(){var n,i,r,o;if(s)throw new _S("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{try{for(var l,c=!0,d=Rx(function(){return Px(this,arguments,function*(){var t,n,s,i;const r=new oA,o=HS(e);try{for(var a,l=!0,c=Rx(o);!(t=(a=yield Ix(c.next())).done);l=!0){i=a.value,l=!1;const e=i;for(const t of r.decode(e))yield yield Ix(t)}}catch(d){n={error:d}}finally{try{l||t||!(s=c.return)||(yield Ix(s.call(c)))}finally{if(n)throw n.error}}for(const e of r.flush())yield yield Ix(e)})}());!(n=(l=yield Ix(d.next())).done);c=!0){o=l.value,c=!1;const e=o;a||e&&(yield yield Ix(JSON.parse(e)))}}catch(u){i={error:u}}finally{try{c||n||!(r=d.return)||(yield Ix(r.call(d)))}finally{if(i)throw i.error}}a=!0}catch(h){if(bS(h))return yield Ix(void 0);throw h}finally{a||t.abort()}})},t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=s=>({next:()=>{if(0===s.length){const s=n.next();e.push(s),t.push(s)}return s.shift()}});return[new vA(()=>s(e),this.controller,this.client),new vA(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return VS({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:n,done:s}=await t.next();if(s)return e.close();const i=iA(JSON.stringify(n)+"\n");e.enqueue(i)}catch(n){e.error(n)}},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}}class bA{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return s.startsWith(" ")&&(s=s.substring(1)),"event"===t?this.event=s:"data"===t&&this.data.push(s),null}}async function yA(e,t){const{response:n,requestLogID:s,retryOfRequestLogID:i,startTime:r}=t,o=await(async()=>{var s;if(t.options.stream)return mA(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):vA.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;const i=n.headers.get("content-type"),r=null===(s=null===i||void 0===i?void 0:i.split(";")[0])||void 0===s?void 0:s.trim();if((null===r||void 0===r?void 0:r.includes("application/json"))||(null===r||void 0===r?void 0:r.endsWith("+json"))){return await n.json()}return await n.text()})();return mA(e).debug("[".concat(s,"] response parsed"),gA({retryOfRequestLogID:i,url:n.url,status:n.status,body:o,durationMs:Date.now()-r})),o}class _A extends Promise{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yA;super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new _A(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const wA=Symbol("brand.privateNullableHeaders");function*xA(e){if(!e)return;if(wA in e){const{values:t,nulls:n}=e;yield*t.entries();for(const e of n)yield[e,null];return}let t,n=!1;e instanceof Headers?t=e.entries():DS(e)?t=e:(n=!0,t=Object.entries(null!==e&&void 0!==e?e:{}));for(let s of t){const e=s[0];if("string"!==typeof e)throw new TypeError("expected header name to be a string");const t=DS(s[1])?s[1]:[s[1]];let i=!1;for(const s of t)void 0!==s&&(n&&!i&&(i=!0,yield[e,null]),yield[e,s])}}const EA=e=>{const t=new Headers,n=new Set;for(const s of e){const e=new Set;for(const[i,r]of xA(s)){const s=i.toLowerCase();e.has(s)||(t.delete(i),e.add(s)),null===r?(t.delete(i),n.add(s)):(t.append(i,r),n.delete(s))}}return{[wA]:!0,values:t,nulls:n}},SA=e=>{var t,n,s,i,r,o;return"undefined"!==typeof globalThis.process?null!==(s=null===(n=null===(t=globalThis.process.env)||void 0===t?void 0:t[e])||void 0===n?void 0:n.trim())&&void 0!==s?s:void 0:"undefined"!==typeof globalThis.Deno?null===(o=null===(r=null===(i=globalThis.Deno.env)||void 0===i?void 0:i.get)||void 0===r?void 0:r.call(i,e))||void 0===o?void 0:o.trim():void 0};var AA;class CA{constructor(e){var t,n,s,i,r,o,a,{baseURL:l=SA("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:c=(null!==(t=SA("GEMINI_API_KEY"))&&void 0!==t?t:null),apiVersion:d="v1beta"}=e,u=Tx(e,["baseURL","apiKey","apiVersion"]);const h=Object.assign(Object.assign({apiKey:c,apiVersion:d},u),{baseURL:l||"https://generativelanguage.googleapis.com"});this.baseURL=h.baseURL,this.timeout=null!==(n=h.timeout)&&void 0!==n?n:CA.DEFAULT_TIMEOUT,this.logger=null!==(s=h.logger)&&void 0!==s?s:console;const p="warn";this.logLevel=p,this.logLevel=null!==(r=null!==(i=dA(h.logLevel,"ClientOptions.logLevel",this))&&void 0!==i?i:dA(SA("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))&&void 0!==r?r:p,this.fetchOptions=h.fetchOptions,this.maxRetries=null!==(o=h.maxRetries)&&void 0!==o?o:2,this.fetch=null!==(a=h.fetch)&&void 0!==a?a:function(){if("undefined"!==typeof fetch)return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=qS,this._options=h,this.apiKey=c,this.apiVersion=d,this.clientAdapter=h.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders(e){let{values:t,nulls:n}=e;if(!t.has("authorization")&&!t.has("x-goog-api-key")&&(!this.apiKey||!t.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=EA([e.headers]);if(!t.values.has("authorization")&&!t.values.has("x-goog-api-key"))return this.apiKey?EA([{"x-goog-api-key":this.apiKey}]):this.clientAdapter.isVertexAI()?EA([await this.clientAdapter.getAuthHeaders()]):void 0}stringifyQuery(e){return Object.entries(e).filter(e=>{let[t,n]=e;return"undefined"!==typeof n}).map(e=>{let[t,n]=e;if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n));if(null===n)return"".concat(encodeURIComponent(t),"=");throw new _S("Cannot stringify type ".concat(typeof n,"; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case."))}).join("&")}getUserAgent(){return"".concat(this.constructor.name,"/JS ").concat(jS)}defaultIdempotencyKey(){return"stainless-node-retry-".concat(vS())}makeStatusError(e,t,n,s){return wS.generate(e,t,n,s)}buildURL(e,t,n){const s=!this.baseURLOverridden()&&n||this.baseURL,i=(e=>MS.test(e))(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return function(e){if(!e)return!0;for(const t in e)return!1;return!0}(r)||(t=Object.assign(Object.assign({},r),t)),"object"===typeof t&&t&&!Array.isArray(t)&&(i.search=this.stringifyQuery(t)),i.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith("/".concat(this.apiVersion,"/projects/"))){const t=e.path.slice(this.apiVersion.length+1);e.path="/".concat(this.apiVersion,"/projects/").concat(this.clientAdapter.getProject(),"/locations/").concat(this.clientAdapter.getLocation()).concat(t)}}async prepareRequest(e,t){let{url:n,options:s}=t}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>Object.assign({method:e,path:t},n)))}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new _A(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var s,i,r;const o=await e,a=null!==(s=o.maxRetries)&&void 0!==s?s:this.maxRetries;null==t&&(t=a),await this.prepareOptions(o);const{req:l,url:c,timeout:d}=await this.buildRequest(o,{retryCount:a-t});await this.prepareRequest(l,{url:c,options:o});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),h=void 0===n?"":", retryOf: ".concat(n),p=Date.now();if(mA(this).debug("[".concat(u,"] sending request"),gA({retryOfRequestLogID:n,method:o.method,url:c,options:o,headers:l.headers})),null===(i=o.signal)||void 0===i?void 0:i.aborted)throw new xS;const f=new AbortController,m=await this.fetchWithTimeout(c,l,d,f).catch(yS),g=Date.now();if(m instanceof globalThis.Error){const e="retrying, ".concat(t," attempts remaining");if(null===(r=o.signal)||void 0===r?void 0:r.aborted)throw new xS;const s=bS(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return mA(this).info("[".concat(u,"] connection ").concat(s?"timed out":"failed"," - ").concat(e)),mA(this).debug("[".concat(u,"] connection ").concat(s?"timed out":"failed"," (").concat(e,")"),gA({retryOfRequestLogID:n,url:c,durationMs:g-p,message:m.message})),this.retryRequest(o,t,null!==n&&void 0!==n?n:u);if(mA(this).info("[".concat(u,"] connection ").concat(s?"timed out":"failed"," - error; no more retries left")),mA(this).debug("[".concat(u,"] connection ").concat(s?"timed out":"failed"," (error; no more retries left)"),gA({retryOfRequestLogID:n,url:c,durationMs:g-p,message:m.message})),s)throw new SS;throw new ES({cause:m})}const v="[".concat(u).concat(h,"] ").concat(l.method," ").concat(c," ").concat(m.ok?"succeeded":"failed"," with status ").concat(m.status," in ").concat(g-p,"ms");if(!m.ok){const e=await this.shouldRetry(m);if(t&&e){const e="retrying, ".concat(t," attempts remaining");return await async function(e){var t,n;if(null===e||"object"!==typeof e)return;if(e[Symbol.asyncIterator])return void await(null===(n=(t=e[Symbol.asyncIterator]()).return)||void 0===n?void 0:n.call(t));const s=e.getReader(),i=s.cancel();s.releaseLock(),await i}(m.body),mA(this).info("".concat(v," - ").concat(e)),mA(this).debug("[".concat(u,"] response error (").concat(e,")"),gA({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-p})),this.retryRequest(o,t,null!==n&&void 0!==n?n:u,m.headers)}const s=e?"error; no more retries left":"error; not retryable";mA(this).info("".concat(v," - ").concat(s));const i=await m.text().catch(e=>yS(e).message),r=(e=>{try{return JSON.parse(e)}catch(t){return}})(i),a=r?void 0:i;mA(this).debug("[".concat(u,"] response error (").concat(s,")"),gA({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:a,durationMs:Date.now()-p}));throw this.makeStatusError(m.status,r,a,m.headers)}return mA(this).info(v),mA(this).debug("[".concat(u,"] response start"),gA({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-p})),{response:m,options:o,controller:f,requestLogID:u,retryOfRequestLogID:n,startTime:p}}async fetchWithTimeout(e,t,n,s){const i=t||{},{signal:r,method:o}=i,a=Tx(i,["signal","method"]);r&&r.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),n),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||"object"===typeof a.body&&null!==a.body&&Symbol.asyncIterator in a.body,d=Object.assign(Object.assign(Object.assign({signal:s.signal},c?{duplex:"half"}:{}),{method:"GET"}),a);o&&(d.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,d)}finally{clearTimeout(l)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n,s){var i;let r;const o=null===s||void 0===s?void 0:s.get("retry-after-ms");if(o){const e=parseFloat(o);Number.isNaN(e)||(r=e)}const a=null===s||void 0===s?void 0:s.get("retry-after");if(a&&!r){const e=parseFloat(a);r=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=null!==(i=e.maxRetries)&&void 0!==i?i:this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}var l;return await(l=r,new Promise(e=>setTimeout(e,l))),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}async buildRequest(e){let{retryCount:t=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,s,i;const r=Object.assign({},e),{method:o,path:a,query:l,defaultBaseURL:c}=r,d=this.buildURL(a,l,c);"timeout"in r&&((e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new _S("".concat(e," must be an integer"));if(t<0)throw new _S("".concat(e," must be a positive integer"))})("timeout",r.timeout),r.timeout=null!==(n=r.timeout)&&void 0!==n?n:this.timeout;const{bodyHeaders:u,body:h}=this.buildBody({options:r}),p=await this.buildHeaders({options:e,method:o,bodyHeaders:u,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:p},r.signal&&{signal:r.signal}),globalThis.ReadableStream&&h instanceof globalThis.ReadableStream&&{duplex:"half"}),h&&{body:h}),null!==(s=this.fetchOptions)&&void 0!==s?s:{}),null!==(i=r.fetchOptions)&&void 0!==i?i:{}),url:d,timeout:r.timeout}}async buildHeaders(e){let{options:t,method:n,bodyHeaders:s,retryCount:i}=e,r={};this.idempotencyHeader&&"get"!==n&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=t.idempotencyKey);const o=await this.authHeaders(t);let a=EA([r,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),null!==BS&&void 0!==BS?BS:BS=FS()),this._options.defaultHeaders,s,t.headers,o]);return this.validateHeaders(a),a.values}buildBody(e){let{options:{body:t,headers:n}}=e;if(!t)return{bodyHeaders:void 0,body:void 0};const s=EA([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||"string"===typeof t&&s.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:"object"===typeof t&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&"function"===typeof t.next)?{bodyHeaders:void 0,body:WS(t)}:this.encoder({body:t,headers:s})}}CA.DEFAULT_TIMEOUT=6e4;class kA extends CA{constructor(){super(...arguments),this.interactions=new tA(this)}}function TA(e,t){const n={},s=zy(e,["baseModel"]);null!=s&&qy(n,["baseModel"],s);const i=zy(e,["preTunedModel"]);null!=i&&qy(n,["preTunedModel"],i);const r=zy(e,["trainingDataset"]);null!=r&&function(e){const t={};if(void 0!==zy(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==zy(e,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=zy(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),qy(t,["examples","examples"],e)}}(r);const o=zy(e,["config"]);return null!=o&&function(e,t){const n={};if(void 0!==zy(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const s=zy(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=s&&qy(t,["displayName"],s),void 0!==zy(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const i=zy(e,["epochCount"]);void 0!==t&&null!=i&&qy(t,["tuningTask","hyperparameters","epochCount"],i);const r=zy(e,["learningRateMultiplier"]);if(null!=r&&qy(n,["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==zy(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==zy(e,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==zy(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const o=zy(e,["batchSize"]);void 0!==t&&null!=o&&qy(t,["tuningTask","hyperparameters","batchSize"],o);const a=zy(e,["learningRate"]);if(void 0!==t&&null!=a&&qy(t,["tuningTask","hyperparameters","learningRate"],a),void 0!==zy(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");if(void 0!==zy(e,["beta"]))throw new Error("beta parameter is not supported in Gemini API.")}(o,n),n}function NA(e,t){const n={},s=zy(e,["baseModel"]);null!=s&&qy(n,["baseModel"],s);const i=zy(e,["preTunedModel"]);null!=i&&qy(n,["preTunedModel"],i);const r=zy(e,["trainingDataset"]);null!=r&&function(e,t,n){const s={};let i=zy(n,["config","method"]);void 0===i&&(i="SUPERVISED_FINE_TUNING");if("SUPERVISED_FINE_TUNING"===i){const n=zy(e,["gcsUri"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===i){const n=zy(e,["gcsUri"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let r=zy(n,["config","method"]);void 0===r&&(r="SUPERVISED_FINE_TUNING");if("SUPERVISED_FINE_TUNING"===r){const n=zy(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===r){const n=zy(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==zy(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.")}(r,n,t);const o=zy(e,["config"]);return null!=o&&function(e,t,n){let s=zy(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){const n=zy(e,["validationDataset"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec"],OA(n))}else if("PREFERENCE_TUNING"===s){const n=zy(e,["validationDataset"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec"],OA(n))}const i=zy(e,["tunedModelDisplayName"]);void 0!==t&&null!=i&&qy(t,["tunedModelDisplayName"],i);const r=zy(e,["description"]);void 0!==t&&null!=r&&qy(t,["description"],r);let o=zy(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){const n=zy(e,["epochCount"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===o){const n=zy(e,["epochCount"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let a=zy(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){const n=zy(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===a){const n=zy(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let l=zy(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){const n=zy(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===l){const n=zy(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let c=zy(n,["config","method"]);if(void 0===c&&(c="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===c){const n=zy(e,["adapterSize"]);void 0!==t&&null!=n&&qy(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===c){const n=zy(e,["adapterSize"]);void 0!==t&&null!=n&&qy(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==zy(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==zy(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");const d=zy(e,["labels"]);void 0!==t&&null!=d&&qy(t,["labels"],d);const u=zy(e,["beta"]);void 0!==t&&null!=u&&qy(t,["preferenceOptimizationSpec","hyperParameters","beta"],u)}(o,n,t),n}function IA(e,t){const n={},s=zy(e,["config"]);return null!=s&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s);const i=zy(e,["filter"]);void 0!==t&&null!=i&&qy(t,["_query","filter"],i)}(s,n),n}function PA(e,t){const n={},s=zy(e,["config"]);return null!=s&&function(e,t){const n=zy(e,["pageSize"]);void 0!==t&&null!=n&&qy(t,["_query","pageSize"],n);const s=zy(e,["pageToken"]);void 0!==t&&null!=s&&qy(t,["_query","pageToken"],s);const i=zy(e,["filter"]);void 0!==t&&null!=i&&qy(t,["_query","filter"],i)}(s,n),n}function RA(e,t){const n={},s=zy(e,["sdkHttpResponse"]);null!=s&&qy(n,["sdkHttpResponse"],s);const i=zy(e,["name"]);null!=i&&qy(n,["name"],i);const r=zy(e,["state"]);null!=r&&qy(n,["state"],$w(r));const o=zy(e,["createTime"]);null!=o&&qy(n,["createTime"],o);const a=zy(e,["tuningTask","startTime"]);null!=a&&qy(n,["startTime"],a);const l=zy(e,["tuningTask","completeTime"]);null!=l&&qy(n,["endTime"],l);const c=zy(e,["updateTime"]);null!=c&&qy(n,["updateTime"],c);const d=zy(e,["description"]);null!=d&&qy(n,["description"],d);const u=zy(e,["baseModel"]);null!=u&&qy(n,["baseModel"],u);const h=zy(e,["_self"]);return null!=h&&qy(n,["tunedModel"],function(e){const t={},n=zy(e,["name"]);null!=n&&qy(t,["model"],n);const s=zy(e,["name"]);return null!=s&&qy(t,["endpoint"],s),t}(h)),n}function MA(e,t){const n={},s=zy(e,["sdkHttpResponse"]);null!=s&&qy(n,["sdkHttpResponse"],s);const i=zy(e,["name"]);null!=i&&qy(n,["name"],i);const r=zy(e,["state"]);null!=r&&qy(n,["state"],$w(r));const o=zy(e,["createTime"]);null!=o&&qy(n,["createTime"],o);const a=zy(e,["startTime"]);null!=a&&qy(n,["startTime"],a);const l=zy(e,["endTime"]);null!=l&&qy(n,["endTime"],l);const c=zy(e,["updateTime"]);null!=c&&qy(n,["updateTime"],c);const d=zy(e,["error"]);null!=d&&qy(n,["error"],d);const u=zy(e,["description"]);null!=u&&qy(n,["description"],u);const h=zy(e,["baseModel"]);null!=h&&qy(n,["baseModel"],h);const p=zy(e,["tunedModel"]);null!=p&&qy(n,["tunedModel"],p);const f=zy(e,["preTunedModel"]);null!=f&&qy(n,["preTunedModel"],f);const m=zy(e,["supervisedTuningSpec"]);null!=m&&qy(n,["supervisedTuningSpec"],m);const g=zy(e,["preferenceOptimizationSpec"]);null!=g&&qy(n,["preferenceOptimizationSpec"],g);const v=zy(e,["tuningDataStats"]);null!=v&&qy(n,["tuningDataStats"],v);const b=zy(e,["encryptionSpec"]);null!=b&&qy(n,["encryptionSpec"],b);const y=zy(e,["partnerModelTuningSpec"]);null!=y&&qy(n,["partnerModelTuningSpec"],y);const _=zy(e,["customBaseModel"]);null!=_&&qy(n,["customBaseModel"],_);const w=zy(e,["experiment"]);null!=w&&qy(n,["experiment"],w);const x=zy(e,["labels"]);null!=x&&qy(n,["labels"],x);const E=zy(e,["outputUri"]);null!=E&&qy(n,["outputUri"],E);const S=zy(e,["pipelineJob"]);null!=S&&qy(n,["pipelineJob"],S);const A=zy(e,["serviceAccount"]);null!=A&&qy(n,["serviceAccount"],A);const C=zy(e,["tunedModelDisplayName"]);null!=C&&qy(n,["tunedModelDisplayName"],C);const k=zy(e,["veoTuningSpec"]);return null!=k&&qy(n,["veoTuningSpec"],k),n}function OA(e,t){const n={},s=zy(e,["gcsUri"]);null!=s&&qy(n,["validationDatasetUri"],s);const i=zy(e,["vertexDatasetResource"]);return null!=i&&qy(n,["validationDatasetUri"],i),n}AA=kA,kA.GeminiNextGenAPIClient=AA,kA.GeminiNextGenAPIClientError=_S,kA.APIError=wS,kA.APIConnectionError=ES,kA.APIConnectionTimeoutError=SS,kA.APIUserAbortError=xS,kA.NotFoundError=TS,kA.ConflictError=NS,kA.RateLimitError=PS,kA.BadRequestError=AS,kA.AuthenticationError=CS,kA.InternalServerError=RS,kA.PermissionDeniedError=kS,kA.UnprocessableEntityError=IS,kA.toFile=async function(e,t,n){if(zS(),(e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&KS(e))(e=await e))return e instanceof File?e:GS([await e.arrayBuffer()],e.name);if((e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob)(e)){const s=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),GS(await JS(s),t,n)}const s=await JS(e);if(t||(t=function(e){return("object"===typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}(e)),!(null===n||void 0===n?void 0:n.type)){const e=s.find(e=>"object"===typeof e&&"type"in e&&e.type);"string"===typeof e&&(n=Object.assign(Object.assign({},n),{type:e}))}return GS(s,t,n)},kA.Interactions=tA;class DA extends Wy{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new bx(ew.PAGED_ITEM_TUNING_JOBS,e=>t.listInternal(e),await t.listInternal(e),e)},this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){const n={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},e),{preTunedModel:n});return s.baseModel=void 0,await this.tuneInternal(s)}{const t=Object.assign({},e);return await this.tuneInternal(t)}}{const t=Object.assign({},e),n=await this.tuneMldevInternal(t);let s="";void 0!==n.metadata&&void 0!==n.metadata.tunedModel?s=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(s=n.name.split("/operations/")[0]);return{name:s,state:E_.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","name"],n),t}(e);return o=Hy("{name}",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>MA(e))}{const t=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","name"],n),t}(e);return o=Hy("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>RA(e))}}async listInternal(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=PA(e);return o=Hy("tuningJobs",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["tuningJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>MA(e))),qy(t,["tuningJobs"],e)}return t}(e),n=new fw;return Object.assign(n,t),n})}{const t=IA(e);return o=Hy("tunedModels",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["nextPageToken"]);null!=s&&qy(t,["nextPageToken"],s);const i=zy(e,["tunedModels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>RA(e))),qy(t,["tuningJobs"],e)}return t}(e),n=new fw;return Object.assign(n,t),n})}}async cancel(e){var t,n,s,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","name"],n),t}(e);return o=Hy("{name}:cancel",s._url),a=s._query,delete s._url,delete s._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new mw;return Object.assign(n,t),n})}{const t=function(e){const t={},n=zy(e,["name"]);return null!=n&&qy(t,["_url","name"],n),t}(e);return o=Hy("{name}:cancel",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=zy(e,["sdkHttpResponse"]);return null!=n&&qy(t,["sdkHttpResponse"],n),t}(e),n=new mw;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI()){const o=NA(e,e);return i=Hy("tuningJobs",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>MA(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=TA(e);return i=Hy("tunedModels",o._url),r=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>function(e){const t={},n=zy(e,["sdkHttpResponse"]);null!=n&&qy(t,["sdkHttpResponse"],n);const s=zy(e,["name"]);null!=s&&qy(t,["name"],s);const i=zy(e,["metadata"]);null!=i&&qy(t,["metadata"],i);const r=zy(e,["done"]);null!=r&&qy(t,["done"],r);const o=zy(e,["error"]);return null!=o&&qy(t,["error"],o),t}(e))}}}class jA{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const FA="x-goog-upload-status";async function LA(e,t,n){var s,i;let r=0,o=0,a=new tw(new Response),l="upload";for(r=e.size;o<r;){const c=Math.min(8388608,r-o),d=e.slice(o,o+c);o+c>=r&&(l+=", finalize");let u=0,h=1e3;for(;u<3&&(a=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(c)}}}),!(null===(s=null===a||void 0===a?void 0:a.headers)||void 0===s?void 0:s[FA]));)u++,await UA(h),h*=2;if(o+=c,"active"!==(null===(i=null===a||void 0===a?void 0:a.headers)||void 0===i?void 0:i[FA]))break;if(r<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}function UA(e){return new Promise(t=>setTimeout(t,e))}class BA{async upload(e,t,n){if("string"===typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var s;const i=await LA(e,t,n),r=await(null===i||void 0===i?void 0:i.json());if("final"!==(null===(s=null===i||void 0===i?void 0:i.headers)||void 0===s?void 0:s[FA]))throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"===typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var s;const i=await LA(e,t,n),r=await(null===i||void 0===i?void 0:i.json());if("final"!==(null===(s=null===i||void 0===i?void 0:i.headers)||void 0===s?void 0:s[FA]))throw new Error("Failed to upload file: Upload status is not finalized.");const o=Xy(r),a=new Tw;return Object.assign(a,o),a}(e,t,n)}async stat(e){if("string"===typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}class VA{create(e,t,n){return new WA(e,t,n)}}class WA{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const HA="x-goog-api-key";class qA{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(HA)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(HA,this.apiKey)}}}class zA{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;(null===e||void 0===e?void 0:e.extraBody)&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new kA({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null===e||void 0===e?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=Vy(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new qA(this.apiKey);this.apiClient=new qE({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new BA,downloader:new jA}),this.models=new aS(this.apiClient),this.live=new eS(this.apiClient,s,new VA),this.batches=new yx(this.apiClient),this.chats=new jx(this.models,this.apiClient),this.caches=new kx(this.apiClient),this.files=new Bx(this.apiClient),this.operations=new lS(this.apiClient),this.authTokens=new hS(this.apiClient),this.tunings=new DA(this.apiClient),this.fileSearchStores=new gS(this.apiClient)}}const GA=e=>{if(!e)return"";return String(e).replace(/\D/g,"")},KA=e=>{if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=e.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);if(t){const e=t[1].padStart(2,"0"),n=t[2].padStart(2,"0"),s=t[3];return"".concat(s,"-").concat(n,"-").concat(e)}return e},JA=e=>{if("number"===typeof e)return e;if(!e)return 0;let t=String(e);t.includes(",")&&!t.includes("US")&&(t=t.replace(/\./g,"").replace(",",".")),t=t.replace(/[^\d.-]/g,"");const n=parseFloat(t);return isNaN(n)?0:n};function YA(e){if(Array.isArray(e))return e.map(e=>YA(e));if("object"===typeof e&&null!==e){const t={};for(const n in e){const s=e[n];n.includes("cpf")||n.includes("cnpj")||n.includes("documento_numero")?t[n]=GA(s):n.includes("data")||"vigencia_data_inicial"===n||"vigencia_data_final"===n?t[n]=KA(s):n.includes("valor")||n.includes("saldo")||n.includes("remuneracao")||n.includes("montante")?t[n]=JA(s):t[n]="object"===typeof s?YA(s):s}return t}return e}let $A=null;"undefined"===typeof window&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"sua_chave_aqui",REACT_APP_OCR_API:"http://localhost:8000",REACT_APP_API_TIMEOUT:"60000"}.API_KEY&&($A=new zA({apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"sua_chave_aqui",REACT_APP_OCR_API:"http://localhost:8000",REACT_APP_API_TIMEOUT:"60000"}.API_KEY}));const XA={type:t_.OBJECT,properties:{documento_numero:{type:t_.STRING,description:"CNPJ or CPF numbers only"},nome:{type:t_.STRING},documento_tipo:{type:t_.NUMBER,description:"2 for CNPJ, 1 for CPF"}}},QA={type:t_.OBJECT,properties:{numero:{type:t_.STRING},data_emissao:{type:t_.STRING,description:"YYYY-MM-DD"},valor_bruto:{type:t_.NUMBER},credor:XA,descricao:{type:t_.STRING},categoria_despesas_tipo:{type:t_.NUMBER}}},ZA={type:t_.OBJECT,properties:{cpf:{type:t_.STRING},data_admissao:{type:t_.STRING},salario_contratual:{type:t_.NUMBER},cbo:{type:t_.STRING},periodos_remuneracao:{type:t_.ARRAY,items:{type:t_.OBJECT,properties:{mes:{type:t_.NUMBER},carga_horaria:{type:t_.NUMBER},remuneracao_bruta:{type:t_.NUMBER}}}}}},eC={type:t_.OBJECT,properties:{numero:{type:t_.STRING},objeto:{type:t_.STRING},data_assinatura:{type:t_.STRING},valor_montante:{type:t_.NUMBER},vigencia_data_inicial:{type:t_.STRING},credor:XA}},tC={type:t_.OBJECT,properties:{pagamento_data:{type:t_.STRING},pagamento_valor:{type:t_.NUMBER},numero_transacao:{type:t_.STRING},identificacao_documento_fiscal:{type:t_.OBJECT,properties:{numero:{type:t_.STRING}}},meio_pagamento_tipo:{type:t_.NUMBER}}};t_.OBJECT,t_.STRING,t_.STRING,t_.STRING,t_.NUMBER,t_.OBJECT,t_.NUMBER,t_.NUMBER,t_.STRING,t_.NUMBER,t_.NUMBER,t_.OBJECT,t_.STRING,t_.NUMBER,t_.STRING,t_.OBJECT,t_.STRING,t_.STRING,t_.STRING,t_.NUMBER;async function nC(e,t){const n={type:t_.OBJECT,properties:{descritor:{type:t_.OBJECT,properties:{ano:{type:t_.NUMBER},mes:{type:t_.NUMBER},entidade:{type:t_.NUMBER},municipio:{type:t_.NUMBER}}},relacao_empregados:{type:t_.ARRAY,items:ZA},contratos:{type:t_.ARRAY,items:eC},documentos_fiscais:{type:t_.ARRAY,items:QA},pagamentos:{type:t_.ARRAY,items:tC},empenhos:{type:t_.ARRAY,items:{type:t_.OBJECT,properties:{numero:{type:t_.STRING},data_emissao:{type:t_.STRING},valor:{type:t_.NUMBER},historico:{type:t_.STRING}}}},repasses:{type:t_.ARRAY,items:{type:t_.OBJECT,properties:{data_repasse:{type:t_.STRING},valor_repasse:{type:t_.NUMBER},numero_documento:{type:t_.STRING}}}}}};try{const s=await $A.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{inlineData:{mimeType:t,data:e}},{text:"\n    You are an expert accountant and auditor for TCESP Audesp Phase V.\n    Analyze this ENTIRE document (Accountability Report / Presta\xe7\xe3o de Contas).\n    \n    Your task is to identify and extract ALL relevant sections into a single JSON structure.\n    \n    1. Identify the 'Descritor' (Year, Month, Entity, City).\n    2. Identify 'Empregados' (Payroll).\n    3. Identify 'Contratos' (Contracts).\n    4. Identify 'Documentos Fiscais' (Invoices, Receipts).\n    5. Identify 'Pagamentos' (Bank transfers, checks).\n    6. Identify 'Empenhos' (Commitments).\n    7. Identify 'Repasses' (Transfers received).\n    \n    If a section is not found, return an empty array for it.\n    Normalize all dates to YYYY-MM-DD.\n    Normalize all values to float (e.g. 1250.50).\n    Clean CPF/CNPJ (numbers only).\n    "}]},config:{responseMimeType:"application/json",responseSchema:n}});if(s.text){return YA(JSON.parse(s.text))}return null}catch(s){throw console.error("Full Report Extraction Error:",s),s}}const sC=t=>{let{onDataMerge:n,onCancel:s}=t;const[i,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)(""),[l,c]=(0,e.useState)(null),d=()=>{l&&n(l)};var u,h,p,f;return l?(0,L.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"bg-white w-full max-w-4xl h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[(0,L.jsxs)("div",{className:"p-6 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Revis\xe3o da Importa\xe7\xe3o Inteligente"}),(0,L.jsx)("p",{className:"text-sm text-slate-500",children:"O OCR identificou os seguintes registros no seu documento."})]}),(0,L.jsxs)("div",{className:"flex gap-3",children:[(0,L.jsx)("button",{onClick:s,className:"text-slate-500 hover:text-slate-800 font-bold text-sm px-4",children:"Cancelar"}),(0,L.jsx)("button",{onClick:d,className:G,children:"Confirmar e Importar Tudo"})]})]}),(0,L.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-100 space-y-6",children:[(0,L.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,L.jsx)(iC,{label:"Empregados",count:(null===(u=l.relacao_empregados)||void 0===u?void 0:u.length)||0}),(0,L.jsx)(iC,{label:"Contratos",count:(null===(h=l.contratos)||void 0===h?void 0:h.length)||0}),(0,L.jsx)(iC,{label:"Notas Fiscais",count:(null===(p=l.documentos_fiscais)||void 0===p?void 0:p.length)||0}),(0,L.jsx)(iC,{label:"Pagamentos",count:(null===(f=l.pagamentos)||void 0===f?void 0:f.length)||0})]}),(0,L.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200",children:[(0,L.jsx)("h3",{className:"font-bold text-sm mb-2 text-slate-700",children:"Pr\xe9-visualiza\xe7\xe3o dos Dados Estruturados"}),(0,L.jsx)("pre",{className:"text-xs font-mono bg-slate-900 text-green-400 p-4 rounded overflow-auto max-h-96",children:JSON.stringify(l,null,2)})]})]})]})}):(0,L.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-lg shadow-2xl p-8 text-center",children:[(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 011.414.586l4.414 4.414a1 1 0 01.586 1.414V19a2 2 0 01-2 2z"})})}),(0,L.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Importar Presta\xe7\xe3o Completa"}),(0,L.jsx)("p",{className:"text-slate-500 mt-2 text-sm",children:"Fa\xe7a upload de um PDF contendo m\xfaltiplos documentos (Notas, Extratos, Folha). A IA ir\xe1 separar e classificar tudo automaticamente."})]}),(0,L.jsxs)("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-8 hover:bg-slate-50 transition-colors relative cursor-pointer",children:[(0,L.jsx)("input",{type:"file",accept:"application/pdf",onChange:async e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0];r(!0),a("Lendo arquivo (Isso pode levar alguns segundos)...");const n=new FileReader;n.onloadend=async()=>{try{const e=n.result.split(",")[1];a("Enviando para IA (Gemini 2.0)...");const s=await nC(e,t.type);s?(c(s),a("An\xe1lise conclu\xedda. Revise os dados abaixo.")):a("Falha: Nenhum dado estruturado encontrado.")}catch(e){a("Erro: ".concat(e.message))}finally{r(!1)}},n.readAsDataURL(t)}},disabled:i,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),i?(0,L.jsxs)("div",{className:"space-y-3",children:[(0,L.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),(0,L.jsx)("p",{className:"text-sm font-bold text-blue-600",children:o})]}):(0,L.jsxs)("div",{children:[(0,L.jsx)("p",{className:"font-bold text-slate-700",children:"Clique ou arraste o PDF aqui"}),(0,L.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Suporta arquivos PDF digitalizados (OCR via Gemini)"})]})]}),(0,L.jsx)("button",{onClick:s,className:"mt-6 text-slate-400 hover:text-slate-600 text-sm font-medium",children:"Cancelar"})]})})},iC=e=>{let{label:t,count:n}=e;return(0,L.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200 shadow-sm text-center",children:[(0,L.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:n}),(0,L.jsx)("div",{className:"text-xs text-slate-500 uppercase font-bold",children:t})]})},rC=e=>{let{data:t,onClose:n}=e;const s=function(e){var t,n,s,i;const r={totalMissing:0,categories:{},readyToTransmit:!0};null!==(t=e.descritor)&&void 0!==t&&t.municipio&&null!==(n=e.descritor)&&void 0!==n&&n.entidade&&null!==(s=e.descritor)&&void 0!==s&&s.ano&&null!==(i=e.descritor)&&void 0!==i&&i.mes||(r.categories["Informa\xe7\xf5es B\xe1sicas"]={description:"Dados de identifica\xe7\xe3o do documento (obrigat\xf3rios)",fields:[{fieldName:"Tipo de Documento",requirement:"Selecione o tipo",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"},{fieldName:"Munic\xedpio",requirement:"C\xf3digo IBGE do munic\xedpio",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"},{fieldName:"Entidade",requirement:"C\xf3digo da entidade no Audesp",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"},{fieldName:"Ano/M\xeas",requirement:"Per\xedodo da presta\xe7\xe3o (obrigatoriamente m\xeas 12 - dezembro)",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"}]},r.totalMissing+=4,r.readyToTransmit=!1),e.dados_gerais_entidade_beneficiaria||(r.categories["Dados da Entidade"]={description:"Informa\xe7\xf5es sobre a entidade benefici\xe1ria",fields:[{fieldName:"CNPJ",requirement:"CNPJ v\xe1lido (14 d\xedgitos)",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Raz\xe3o Social",requirement:"Nome da entidade",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Dados Gerais",requirement:"Preenchimento de dados gerais",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Corpo Diretivo",requirement:"Informa\xe7\xf5es do corpo diretivo",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Conselho",requirement:"Informa\xe7\xf5es do conselho",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Membros Comiss\xe3o",requirement:"Membros da comiss\xe3o de avalia\xe7\xe3o",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"}]},r.totalMissing+=6,r.readyToTransmit=!1),e.responsaveis_membros_orgao_concessor&&0!==Object.keys(e.responsaveis_membros_orgao_concessor).length||r.categories["Respons\xe1veis"]||(r.categories["Respons\xe1veis"]={description:"Pessoas respons\xe1veis pela presta\xe7\xe3o",fields:[{fieldName:"Respons\xe1vel",requirement:"Nome completo do respons\xe1vel",manualRef:"Manual v1.9 - Se\xe7\xe3o 3"},{fieldName:"CPF",requirement:"CPF v\xe1lido do respons\xe1vel",manualRef:"Manual v1.9 - Se\xe7\xe3o 3"},{fieldName:"Certid\xe3o - Membros",requirement:"Identifica\xe7\xe3o de membros do \xf3rg\xe3o",manualRef:"Manual v1.9 - Se\xe7\xe3o 3"}]},r.totalMissing+=3,r.readyToTransmit=!1),e.receitas&&0!==Object.keys(e.receitas).length||(r.categories.Receitas={description:"Movimento financeiro de entrada (repasses, arrecada\xe7\xf5es, etc)",fields:[{fieldName:"Repasses Recebidos",requirement:"Valores recebidos de \xf3rg\xe3o concedente",manualRef:"Manual v1.9 - Se\xe7\xe3o 4"},{fieldName:"Receitas de Aplica\xe7\xf5es Financeiras",requirement:"Juros e rendimentos",manualRef:"Manual v1.9 - Se\xe7\xe3o 4"},{fieldName:"Recursos Pr\xf3prios",requirement:"Receitas do pr\xf3prio \xf3rg\xe3o",manualRef:"Manual v1.9 - Se\xe7\xe3o 4"}]},r.totalMissing+=3,r.readyToTransmit=!1),e.documentos_fiscais&&0!==e.documentos_fiscais.length||(r.categories["Documentos Fiscais"]={description:"Notas fiscais, recibos e comprovantes de despesas",fields:[{fieldName:"Documentos Fiscais",requirement:"Pelo menos 1 documento ou deixar vazio se sem despesas",manualRef:"Manual v1.9 - Se\xe7\xe3o 5"}]},r.readyToTransmit=!1),e.relacao_bens&&0!==Object.keys(e.relacao_bens).length||(r.categories["Rela\xe7\xe3o de Bens"]={description:"Bens m\xf3veis e im\xf3veis adquiridos, cedidos ou baixados",fields:[{fieldName:"Bens M\xf3veis Adquiridos",requirement:"Lista de bens m\xf3veis adquiridos (pode ser vazio)",manualRef:"Manual v1.9 - Se\xe7\xe3o 6"},{fieldName:"Bens M\xf3veis Cedidos",requirement:"Bens cedidos para terceiros (pode ser vazio)",manualRef:"Manual v1.9 - Se\xe7\xe3o 6"},{fieldName:"Bens Im\xf3veis",requirement:"Propriedades (pode ser vazio)",manualRef:"Manual v1.9 - Se\xe7\xe3o 6"}]},r.readyToTransmit=!1),e.ajustes_saldo&&0!==Object.keys(e.ajustes_saldo).length||(r.categories["Ajustes Cont\xe1beis"]={description:"Retifica\xe7\xf5es e inclus\xf5es de transa\xe7\xf5es",fields:[{fieldName:"Retifica\xe7\xf5es de Repasses",requirement:"Ajustes em repasses anteriores",manualRef:"Manual v1.9 - Se\xe7\xe3o 7"},{fieldName:"Inclus\xf5es de Repasses",requirement:"Novos repasses descobertos",manualRef:"Manual v1.9 - Se\xe7\xe3o 7"},{fieldName:"Ajustes de Pagamentos",requirement:"Retifica\xe7\xf5es e inclus\xf5es de pagamentos",manualRef:"Manual v1.9 - Se\xe7\xe3o 7"}]},r.totalMissing+=3,r.readyToTransmit=!1),e.disponibilidades&&0!==Object.keys(e.disponibilidades).length||(r.categories.Disponibilidades={description:"Saldos banc\xe1rios e fundos de caixa",fields:[{fieldName:"Saldos Banc\xe1rios",requirement:"Saldo de contas banc\xe1rias",manualRef:"Manual v1.9 - Se\xe7\xe3o 8"},{fieldName:"Saldo de Fundo Fixo",requirement:"Dinheiro em caixa ou fundo fixo",manualRef:"Manual v1.9 - Se\xe7\xe3o 8"}]},r.totalMissing+=2,r.readyToTransmit=!1);const o={relatorio_atividades:"Relat\xf3rio de Atividades",demonstracoes_contabeis:"Demonstra\xe7\xf5es Cont\xe1beis",relatorio_governamental_analise_execucao:"An\xe1lise de Execu\xe7\xe3o Governamental",parecer_conclusivo:"Parecer Conclusivo"},a=[];for(const[l,c]of Object.entries(o))e[l]||a.push(c);return a.length>0&&(r.categories["Relat\xf3rios"]={description:"Documentos de an\xe1lise e parecer",fields:a.map(e=>({fieldName:e,requirement:"Descri\xe7\xe3o ou documento anexado",manualRef:"Manual v1.9 - Se\xe7\xf5es 9-12"}))},r.totalMissing+=a.length,r.readyToTransmit=!1),r}(t);return s.readyToTransmit&&0===s.totalMissing?(0,L.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:(0,L.jsxs)("div",{className:"flex items-start",children:[(0,L.jsx)("div",{className:"flex-shrink-0",children:(0,L.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,L.jsxs)("div",{className:"ml-4",children:[(0,L.jsx)("h3",{className:"text-lg font-medium text-green-800",children:"Pronto para Transmiss\xe3o!"}),(0,L.jsx)("p",{className:"mt-2 text-sm text-green-700",children:"Todos os campos obrigat\xf3rios foram preenchidos. Voc\xea pode enviar a presta\xe7\xe3o de contas para o Audesp Piloto."})]})]})}):(0,L.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,L.jsxs)("div",{className:"flex items-start justify-between",children:[(0,L.jsxs)("div",{className:"flex items-start flex-1",children:[(0,L.jsx)("div",{className:"flex-shrink-0",children:(0,L.jsx)("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4v2m0-12a9 9 0 110 18 9 9 0 010-18z"})})}),(0,L.jsxs)("div",{className:"ml-4 flex-1",children:[(0,L.jsxs)("h3",{className:"text-lg font-medium text-yellow-800",children:[s.totalMissing," Campo(s) Faltando"]}),(0,L.jsx)("p",{className:"mt-2 text-sm text-yellow-700",children:"Complete os campos abaixo para poder transmitir a presta\xe7\xe3o de contas. Siga as refer\xeancias do Manual v1.9."})]})]}),n&&(0,L.jsx)("button",{onClick:n,className:"ml-4 text-yellow-600 hover:text-yellow-700",children:(0,L.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,L.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,L.jsx)("div",{className:"mt-6 space-y-6",children:Object.entries(s.categories).map(e=>{let[t,n]=e;return(0,L.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-yellow-100",children:[(0,L.jsx)("h4",{className:"font-semibold text-yellow-900 mb-2",children:t}),(0,L.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:n.description}),(0,L.jsx)("ul",{className:"space-y-2",children:n.fields.map((e,t)=>(0,L.jsxs)("li",{className:"flex items-start text-sm",children:[(0,L.jsx)("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-red-100 text-red-700 mr-3 flex-shrink-0",children:"\u2715"}),(0,L.jsxs)("div",{className:"flex-1",children:[(0,L.jsx)("p",{className:"font-medium text-gray-800",children:e.fieldName}),(0,L.jsx)("p",{className:"text-gray-600",children:e.requirement}),e.manualRef&&(0,L.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["\ud83d\udcd6 ",e.manualRef]})]})]},t))})]},t)})}),(0,L.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,L.jsx)("h5",{className:"font-semibold text-blue-900 mb-2",children:"\ud83d\udca1 Dicas para Completar"}),(0,L.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[(0,L.jsx)("li",{children:"Preencha um campo por vez e verifique a valida\xe7\xe3o em tempo real"}),(0,L.jsx)("li",{children:"Consulte o Manual T\xe9cnico v1.9 para entender o formato esperado"}),(0,L.jsx)("li",{children:"Campos com asterisco (*) s\xe3o obrigat\xf3rios"}),(0,L.jsx)("li",{children:"Valores monet\xe1rios devem usar ponto (.) como separador decimal"}),(0,L.jsx)("li",{children:"Datas devem estar no formato YYYY-MM-DD (ISO 8601)"})]})]}),(0,L.jsx)("div",{className:"mt-6 pt-4 border-t border-yellow-200",children:(0,L.jsx)("p",{className:"text-sm text-gray-700",children:'Quando todos os campos forem preenchidos corretamente, o bot\xe3o "Transmitir" ficar\xe1 ativado.'})})]})},oC=e=>{let{result:t,onClose:n,formData:s}=e;const i="Recebido"===t.status,r="Armazenado"===t.status,o="Rejeitado"===t.status;return(0,L.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-[60] flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,L.jsxs)("div",{className:"p-6 border-b-4 ".concat(i?"border-green-500 bg-green-100":r?"border-yellow-500 bg-yellow-100":"border-red-500 bg-red-100"," flex items-start justify-between"),children:[(0,L.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,L.jsx)("span",{className:"text-3xl",children:i?"\u2705":r?"\u26a0\ufe0f":"\u26d4"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("h2",{className:"text-xl font-black text-slate-800 tracking-tight",children:i?"SUCESSO: DOCUMENTO RECEBIDO":r?"ATEN\xc7\xc3O: DOCUMENTO ARMAZENADO COM RESSALVAS":"ERRO: DOCUMENTO REJEITADO"}),(0,L.jsx)("p",{className:"text-sm font-bold text-slate-600 opacity-80",children:t.tipoDocumento})]})]}),(0,L.jsx)("button",{onClick:n,className:"text-slate-400 hover:text-slate-600 transition-colors p-2",title:"Fechar (Esc)",children:(0,L.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,L.jsxs)("div",{className:"p-6 overflow-y-auto bg-slate-50 flex-1 space-y-6",children:[(0,L.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm flex justify-between items-center",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Protocolo Audesp"}),(0,L.jsx)("div",{className:"text-2xl font-mono font-bold text-slate-800 select-all",children:t.protocolo})]}),(0,L.jsxs)("div",{className:"text-right",children:[(0,L.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Data/Hora"}),(0,L.jsx)("div",{className:"text-sm font-bold text-slate-600",children:t.dataHora})]})]}),t.erros&&t.erros.length>0&&(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:[(0,L.jsx)("div",{className:"bg-slate-100 p-2 border-b border-slate-200",children:(0,L.jsx)("h4",{className:"text-xs font-bold text-slate-600 uppercase",children:"Detalhamento da An\xe1lise"})}),(0,L.jsxs)("table",{className:"w-full text-xs text-left",children:[(0,L.jsx)("thead",{className:"bg-slate-50 text-slate-500 border-b border-slate-100",children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{className:"p-2",children:"Tipo"}),(0,L.jsx)("th",{className:"p-2",children:"C\xf3digo"}),(0,L.jsx)("th",{className:"p-2",children:"Campo"}),(0,L.jsx)("th",{className:"p-2",children:"Mensagem"})]})}),(0,L.jsx)("tbody",{className:"divide-y divide-slate-100",children:t.erros.map((e,t)=>(0,L.jsxs)("tr",{className:"Impedittivo"===e.classificacao?"bg-red-50/50":"",children:[(0,L.jsx)("td",{className:"p-2 font-bold",children:(0,L.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] ".concat("Impedittivo"===e.classificacao?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:e.classificacao})}),(0,L.jsx)("td",{className:"p-2 font-mono text-slate-500",children:e.codigoErro}),(0,L.jsx)("td",{className:"p-2 font-mono text-slate-600",children:e.campo}),(0,L.jsx)("td",{className:"p-2 text-slate-800",children:e.mensagem})]},t))})]})]}),s&&o&&(0,L.jsxs)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,L.jsx)("h4",{className:"font-bold text-blue-900 mb-3",children:"\ud83d\udccb Campos Faltando para Transmiss\xe3o"}),(0,L.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"Complete os campos listados abaixo conforme especificado no Manual v1.9:"}),(0,L.jsx)(rC,{data:s})]})]})]}),(0,L.jsxs)("div",{className:"p-4 border-t border-slate-200 bg-white flex justify-end gap-3",children:[(0,L.jsxs)("button",{onClick:n,className:"px-6 py-2 bg-slate-600 hover:bg-slate-700 text-white font-bold rounded shadow transition-colors flex items-center gap-2",title:"Fechar resultado (Esc)",children:[(0,L.jsx)("span",{children:"\u2715"})," Fechar"]}),i&&(0,L.jsxs)("button",{onClick:()=>window.print(),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded shadow transition-colors flex items-center gap-2",children:[(0,L.jsx)("span",{children:"\ud83d\udda8\ufe0f"})," Imprimir Recibo"]})]})]})})};class aC{static isValidCPF(e){const t=e.replace(/\D/g,"");if(11!==t.length)return!1;if(/^(\d)\1{10}$/.test(t))return!1;let n,s=0;for(let i=1;i<=9;i++)s+=parseInt(t.substring(i-1,i))*(11-i);if(n=10*s%11,10!==n&&11!==n||(n=0),n!==parseInt(t.substring(9,10)))return!1;s=0;for(let i=1;i<=10;i++)s+=parseInt(t.substring(i-1,i))*(12-i);return n=10*s%11,10!==n&&11!==n||(n=0),n===parseInt(t.substring(10,11))}static isValidCNPJ(e){const t=e.replace(/\D/g,"");if(14!==t.length)return!1;if(/^(\d)\1{13}$/.test(t))return!1;let n=t.length-2,s=t.substring(0,n),i=t.substring(n),r=0,o=n-7;for(let l=n;l>=1;l--)r+=s.charAt(n-l)*o--,o<2&&(o=9);let a=r%11<2?0:11-r%11;if(a!==parseInt(i.charAt(0)))return!1;n+=1,s=t.substring(0,n),r=0,o=n-7;for(let l=n;l>=1;l--)r+=s.charAt(n-l)*o--,o<2&&(o=9);return a=r%11<2?0:11-r%11,a===parseInt(i.charAt(1))}static isValidDate(e){if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const t=new Date(e+"T00:00:00Z");return!isNaN(t.getTime())}static isValidCurrency(e){return"number"===typeof e&&!isNaN(e)&&isFinite(e)}static isValidCBO(e){const t=e.replace("-","");return/^\d{4}$/.test(t)}static isValidCNS(e){const t=e.replace(/\D/g,"");return 15===t.length&&/^\d+$/.test(t)}static isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static isValidPhone(e){const t=e.replace(/\D/g,"");return t.length>=10&&t.length<=11}}class lC{static isValidFiscalMonth(e){return e>=1&&e<=12}static isDateInFiscalPeriod(e,t,n){try{const s=new Date(e),i=s.getMonth()+1;return s.getFullYear()===n&&i===t}catch(s){return!1}}static isVigencyWithinFiscalPeriod(e,t,n,s){try{const i=new Date(e),r=t?new Date(t):new Date(e),o=new Date("".concat(s,"-").concat(String(n).padStart(2,"0"),"-01"));return i<=new Date(s,n,0)&&r>=o}catch(i){return!1}}}class cC{static validateInvoiceReferences(e){var t,n;const s=[],i=new Set((null===(t=e.documentos_fiscais)||void 0===t?void 0:t.map(e=>e.numero))||[]);return null===(n=e.pagamentos)||void 0===n||n.forEach((e,t)=>{i.has(e.identificacao_documento_fiscal.numero)||s.push({field:"pagamentos[".concat(t,"].identificacao_documento_fiscal.numero"),message:'Documento fiscal "'.concat(e.identificacao_documento_fiscal.numero,'" n\xe3o encontrado na se\xe7\xe3o 7'),severity:"error",section:"8",value:e.identificacao_documento_fiscal.numero})}),s}static validateContractReferences(e){var t,n;const s=[],i=new Set((null===(t=e.contratos)||void 0===t?void 0:t.map(e=>e.numero))||[]);return null===(n=e.documentos_fiscais)||void 0===n||n.forEach((e,t)=>{var n;null!==(n=e.identificacao_contrato)&&void 0!==n&&n.numero&&!i.has(e.identificacao_contrato.numero)&&s.push({field:"documentos_fiscais[".concat(t,"].identificacao_contrato.numero"),message:'Contrato "'.concat(e.identificacao_contrato.numero,'" n\xe3o encontrado na se\xe7\xe3o 6'),severity:"error",section:"7",value:e.identificacao_contrato.numero})}),s}static validatePaymentConsistency(e){var t;const n=[],s=new Map((e.documentos_fiscais||[]).map(e=>[e.numero,e]));return null===(t=e.pagamentos)||void 0===t||t.forEach((e,t)=>{const i=s.get(e.identificacao_documento_fiscal.numero);if(i){if(e.pagamento_data&&i.data_emissao){new Date(e.pagamento_data)<new Date(i.data_emissao)&&n.push({field:"pagamentos[".concat(t,"].pagamento_data"),message:"Data do pagamento (".concat(e.pagamento_data,") anterior \xe0 emiss\xe3o do documento (").concat(i.data_emissao,")"),severity:"error",section:"8"})}e.pagamento_valor>1.05*i.valor_bruto&&n.push({field:"pagamentos[".concat(t,"].pagamento_valor"),message:"Valor do pagamento (R$ ".concat(e.pagamento_valor,") superior em mais de 5% ao documento (R$ ").concat(i.valor_bruto,")"),severity:"warning",section:"8"})}}),n}static validateBalanceConsistency(e){var t,n;const s=[];return null===(t=e.disponibilidades)||void 0===t||null===(n=t.saldos)||void 0===n||n.forEach((e,t)=>{e.saldo_contabil<0&&s.push({field:"disponibilidades.saldos[".concat(t,"].saldo_contabil"),message:"Saldo cont\xe1bil n\xe3o pode ser negativo (".concat(e.saldo_contabil,")"),severity:"error",section:"9"});const n=Math.abs(e.saldo_bancario-e.saldo_contabil);n>Math.max(100,.01*e.saldo_contabil)&&s.push({field:"disponibilidades.saldos[".concat(t,"]"),message:"Diferen\xe7a significativa entre saldo banc\xe1rio (R$ ".concat(e.saldo_bancario,") e cont\xe1bil (R$ ").concat(e.saldo_contabil,") - Diferen\xe7a: R$ ").concat(n),severity:"warning",section:"9"})}),s}}class dC{static validate(e){const t=[],n=[];this.validateBasicFormats(e,t),this.validateFiscalPeriod(e,t,n),t.push(...cC.validateInvoiceReferences(e)),t.push(...cC.validateContractReferences(e)),n.push(...cC.validatePaymentConsistency(e)),n.push(...cC.validateBalanceConsistency(e));const s=t.filter(e=>"error"===e.severity),i=[...n,...t.filter(e=>"warning"===e.severity)];return{isValid:0===s.length,errors:s,warnings:i,summary:this.generateSummary(s,i)}}static validateBasicFormats(e,t){var n,s,i;e.descritor.municipio||t.push({field:"descritor.municipio",message:"Munic\xedpio \xe9 obrigat\xf3rio",severity:"error",section:"1"}),null===(n=e.relacao_empregados)||void 0===n||n.forEach((e,n)=>{aC.isValidCPF(e.cpf)||t.push({field:"relacao_empregados[".concat(n,"].cpf"),message:"CPF inv\xe1lido: ".concat(e.cpf),severity:"error",section:"4",value:e.cpf}),aC.isValidDate(e.data_admissao)||t.push({field:"relacao_empregados[".concat(n,"].data_admissao"),message:"Data de admiss\xe3o em formato inv\xe1lido: ".concat(e.data_admissao),severity:"error",section:"4",value:e.data_admissao}),aC.isValidCBO(e.cbo)||t.push({field:"relacao_empregados[".concat(n,"].cbo"),message:"CBO inv\xe1lido: ".concat(e.cbo),severity:"error",section:"4",value:e.cbo})}),null===(s=e.contratos)||void 0===s||s.forEach((e,n)=>{aC.isValidCNPJ(e.credor.documento_numero)||aC.isValidCPF(e.credor.documento_numero)||t.push({field:"contratos[".concat(n,"].credor.documento_numero"),message:"CPF/CNPJ inv\xe1lido: ".concat(e.credor.documento_numero),severity:"error",section:"6",value:e.credor.documento_numero}),aC.isValidDate(e.data_assinatura)||t.push({field:"contratos[".concat(n,"].data_assinatura"),message:"Data de assinatura em formato inv\xe1lido: ".concat(e.data_assinatura),severity:"error",section:"6",value:e.data_assinatura})}),null===(i=e.documentos_fiscais)||void 0===i||i.forEach((e,n)=>{aC.isValidCNPJ(e.credor.documento_numero)||aC.isValidCPF(e.credor.documento_numero)||t.push({field:"documentos_fiscais[".concat(n,"].credor.documento_numero"),message:"CPF/CNPJ inv\xe1lido: ".concat(e.credor.documento_numero),severity:"error",section:"7",value:e.credor.documento_numero})})}static validateFiscalPeriod(e,t,n){var s,i;const{mes:r,ano:o}=e.descritor;lC.isValidFiscalMonth(r)||t.push({field:"descritor.mes",message:"M\xeas inv\xe1lido: ".concat(r),severity:"error",section:"1"}),null===(s=e.relacao_empregados)||void 0===s||s.forEach((e,t)=>{lC.isDateInFiscalPeriod(e.data_admissao,r,o)||n.push({field:"relacao_empregados[".concat(t,"].data_admissao"),message:"Data de admiss\xe3o (".concat(e.data_admissao,") fora do per\xedodo de refer\xeancia (").concat(r,"/").concat(o,")"),severity:"warning",section:"4"})}),null===(i=e.contratos)||void 0===i||i.forEach((e,t)=>{lC.isVigencyWithinFiscalPeriod(e.vigencia_data_inicial,e.vigencia_data_final,r,o)||n.push({field:"contratos[".concat(t,"].vigencia"),message:"Vig\xeancia do contrato n\xe3o se sobrep\xf5e com per\xedodo fiscal (".concat(r,"/").concat(o,")"),severity:"warning",section:"6"})})}static generateSummary(e,t){const n={};return e.forEach(e=>{e.section&&(n[e.section]||(n[e.section]={errors:0,warnings:0}),n[e.section].errors++)}),t.forEach(e=>{e.section&&(n[e.section]||(n[e.section]={errors:0,warnings:0}),n[e.section].warnings++)}),{totalErrors:e.length,totalWarnings:t.length,sections:n}}static generateConsistencyReport(e){var t,n,s,i;const r=new Set((null===(t=e.documentos_fiscais)||void 0===t?void 0:t.map(e=>e.numero))||[]),o=new Set((null===(n=e.contratos)||void 0===n?void 0:n.map(e=>e.numero))||[]);let a=0,l=0;null===(s=e.pagamentos)||void 0===s||s.forEach(e=>{r.has(e.identificacao_documento_fiscal.numero)?a++:l++});let c=0,d=0;return null===(i=e.documentos_fiscais)||void 0===i||i.forEach(e=>{var t,n;null!==(t=e.identificacao_contrato)&&void 0!==t&&t.numero&&o.has(e.identificacao_contrato.numero)?c++:null!==(n=e.identificacao_contrato)&&void 0!==n&&n.numero&&d++}),{hasConsistencyIssues:l>0||d>0,issues:[],crossReferences:{paymentToInvoice:{found:a,missing:l},contractToInvoice:{found:c,missing:d},employeeToPayment:{found:0,missing:0}}}}}const uC=e=>dC.validate(e);class hC{static generate(e,t,n){return{metadata:this.generateMetadata(e,n),overview:this.generateOverview(e,t),sections:this.generateSectionSummary(e),financialSummary:this.generateFinancialSummary(e)}}static generateMetadata(e,t){const{ano:n,mes:s}=e.descritor;return{title:"Presta\xe7\xe3o de Contas - ".concat(e.descritor.tipo_documento),generatedAt:(new Date).toISOString(),generatedBy:t,version:"2.0.0",period:{ano:n,mes:s,descricao:"".concat(["","Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][s],"/").concat(n)}}}static generateOverview(e,t){const n=this.countCompleteSections(e),s=Math.round(n/23*100);return{documentType:e.descritor.tipo_documento,entityCode:e.descritor.entidade,cityCode:e.descritor.municipio,completionPercentage:s,hasErrors:!t.isValid,errorCount:t.errors.length,warningCount:t.warnings.length}}static countCompleteSections(e){var t,n,s,i,r,o;let a=0;return e.descritor.municipio&&a++,e.codigo_ajuste&&a++,"boolean"===typeof e.retificacao&&a++,null!==(t=e.relacao_empregados)&&void 0!==t&&t.length&&a++,e.relacao_bens&&a++,null!==(n=e.contratos)&&void 0!==n&&n.length&&a++,null!==(s=e.documentos_fiscais)&&void 0!==s&&s.length&&a++,null!==(i=e.pagamentos)&&void 0!==i&&i.length&&a++,null!==(r=e.disponibilidades)&&void 0!==r&&null!==(o=r.saldos)&&void 0!==o&&o.length&&a++,e.receitas&&a++,Math.min(a,23)}static generateSectionSummary(e){var t,n,s,i,r,o,a,l,c,d,u,h,p,f,m,g,v,b;const y=[];return y.push({section:"1",title:"Descritor",recordCount:1,status:e.descritor.municipio?"complete":"incomplete"}),y.push({section:"4",title:"Empregados",recordCount:(null===(t=e.relacao_empregados)||void 0===t?void 0:t.length)||0,totalValue:null===(n=e.relacao_empregados)||void 0===n?void 0:n.reduce((e,t)=>e+(t.salario_contratual||0),0),status:null!==(s=e.relacao_empregados)&&void 0!==s&&s.length?"complete":"empty"}),y.push({section:"6",title:"Contratos",recordCount:(null===(i=e.contratos)||void 0===i?void 0:i.length)||0,totalValue:null===(r=e.contratos)||void 0===r?void 0:r.reduce((e,t)=>e+(t.valor_montante||0),0),status:null!==(o=e.contratos)&&void 0!==o&&o.length?"complete":"empty"}),y.push({section:"7",title:"Documentos Fiscais",recordCount:(null===(a=e.documentos_fiscais)||void 0===a?void 0:a.length)||0,totalValue:null===(l=e.documentos_fiscais)||void 0===l?void 0:l.reduce((e,t)=>e+(t.valor_bruto||0),0),status:null!==(c=e.documentos_fiscais)&&void 0!==c&&c.length?"complete":"empty"}),y.push({section:"8",title:"Pagamentos",recordCount:(null===(d=e.pagamentos)||void 0===d?void 0:d.length)||0,totalValue:null===(u=e.pagamentos)||void 0===u?void 0:u.reduce((e,t)=>e+(t.pagamento_valor||0),0),status:null!==(h=e.pagamentos)&&void 0!==h&&h.length?"complete":"empty"}),y.push({section:"9",title:"Disponibilidades",recordCount:(null===(p=e.disponibilidades)||void 0===p||null===(f=p.saldos)||void 0===f?void 0:f.length)||0,totalValue:null===(m=e.disponibilidades)||void 0===m||null===(g=m.saldos)||void 0===g?void 0:g.reduce((e,t)=>e+(t.saldo_contabil||0),0),status:null!==(v=e.disponibilidades)&&void 0!==v&&null!==(b=v.saldos)&&void 0!==b&&b.length?"complete":"empty"}),y}static generateFinancialSummary(e){var t,n,s,i,r,o;const a=((null===(t=e.receitas)||void 0===t?void 0:t.receitas_aplic_financ_repasses_publicos_municipais)||0)+((null===(n=e.receitas)||void 0===n?void 0:n.receitas_aplic_financ_repasses_publicos_estaduais)||0)+((null===(s=e.receitas)||void 0===s?void 0:s.receitas_aplic_financ_repasses_publicos_federais)||0),l=(null===(i=e.pagamentos)||void 0===i?void 0:i.reduce((e,t)=>e+(t.pagamento_valor||0),0))||0;return{totalReceived:a,totalSpent:l,balance:a-l,availableFunds:(null===(r=e.disponibilidades)||void 0===r||null===(o=r.saldos)||void 0===o?void 0:o.reduce((e,t)=>e+(t.saldo_contabil||0),0))||0}}static exportAsHTML(e){const{metadata:t,overview:n,sections:s,financialSummary:i}=e,r="".concat(t.period.descricao);return'<!DOCTYPE html>\n<html lang="pt-BR">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>'.concat(t.title,'</title>\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n    \n    body {\n      font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n      line-height: 1.6;\n      color: #333;\n      background-color: #f5f5f5;\n    }\n    \n    .container {\n      max-width: 1000px;\n      margin: 0 auto;\n      padding: 20px;\n      background-color: white;\n    }\n    \n    .header {\n      border-bottom: 3px solid #1e40af;\n      padding-bottom: 20px;\n      margin-bottom: 30px;\n      text-align: center;\n    }\n    \n    .header h1 {\n      color: #1e40af;\n      font-size: 28px;\n      margin-bottom: 5px;\n    }\n    \n    .header p {\n      color: #666;\n      font-size: 14px;\n    }\n    \n    .metadata {\n      display: grid;\n      grid-template-columns: repeat(2, 1fr);\n      gap: 15px;\n      margin-bottom: 30px;\n      background-color: #f9fafb;\n      padding: 15px;\n      border-radius: 5px;\n      font-size: 13px;\n    }\n    \n    .metadata-item {\n      border-left: 3px solid #1e40af;\n      padding-left: 10px;\n    }\n    \n    .metadata-item strong {\n      color: #1e40af;\n    }\n    \n    .overview {\n      background-color: #f3f4f6;\n      padding: 20px;\n      border-radius: 5px;\n      margin-bottom: 30px;\n    }\n    \n    .overview h2 {\n      color: #1e40af;\n      margin-bottom: 15px;\n      font-size: 18px;\n    }\n    \n    .overview-grid {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n      gap: 15px;\n    }\n    \n    .overview-item {\n      background-color: white;\n      padding: 15px;\n      border-radius: 5px;\n      border-left: 4px solid #3b82f6;\n    }\n    \n    .overview-item.error {\n      border-left-color: #ef4444;\n    }\n    \n    .overview-item.warning {\n      border-left-color: #f59e0b;\n    }\n    \n    .overview-item.success {\n      border-left-color: #10b981;\n    }\n    \n    .overview-item label {\n      display: block;\n      font-size: 12px;\n      color: #666;\n      margin-bottom: 5px;\n      text-transform: uppercase;\n      font-weight: 600;\n    }\n    \n    .overview-item value {\n      display: block;\n      font-size: 24px;\n      font-weight: bold;\n      color: #1e40af;\n    }\n    \n    .sections {\n      margin-bottom: 30px;\n    }\n    \n    .sections h2 {\n      color: #1e40af;\n      margin-bottom: 15px;\n      font-size: 18px;\n    }\n    \n    .section-table {\n      width: 100%;\n      border-collapse: collapse;\n      background-color: white;\n      border-radius: 5px;\n      overflow: hidden;\n      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n    }\n    \n    .section-table thead {\n      background-color: #1e40af;\n      color: white;\n    }\n    \n    .section-table th {\n      padding: 12px;\n      text-align: left;\n      font-weight: 600;\n    }\n    \n    .section-table td {\n      padding: 12px;\n      border-top: 1px solid #e5e7eb;\n    }\n    \n    .section-table tbody tr:hover {\n      background-color: #f9fafb;\n    }\n    \n    .status-badge {\n      display: inline-block;\n      padding: 4px 8px;\n      border-radius: 3px;\n      font-size: 12px;\n      font-weight: 600;\n      text-transform: uppercase;\n    }\n    \n    .status-badge.complete {\n      background-color: #d1fae5;\n      color: #065f46;\n    }\n    \n    .status-badge.incomplete {\n      background-color: #fef3c7;\n      color: #92400e;\n    }\n    \n    .status-badge.empty {\n      background-color: #f3f4f6;\n      color: #6b7280;\n    }\n    \n    .financial-summary {\n      background-color: #f0fdf4;\n      border: 1px solid #86efac;\n      border-radius: 5px;\n      padding: 20px;\n      margin-bottom: 30px;\n    }\n    \n    .financial-summary h2 {\n      color: #166534;\n      margin-bottom: 15px;\n      font-size: 18px;\n    }\n    \n    .financial-grid {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n      gap: 15px;\n    }\n    \n    .financial-item {\n      background-color: white;\n      padding: 15px;\n      border-radius: 5px;\n      border-left: 4px solid #10b981;\n    }\n    \n    .financial-item label {\n      display: block;\n      font-size: 12px;\n      color: #666;\n      margin-bottom: 5px;\n      text-transform: uppercase;\n      font-weight: 600;\n    }\n    \n    .financial-item .amount {\n      display: block;\n      font-size: 20px;\n      font-weight: bold;\n      color: #166534;\n    }\n    \n    .footer {\n      border-top: 1px solid #e5e7eb;\n      padding-top: 20px;\n      margin-top: 40px;\n      text-align: center;\n      color: #666;\n      font-size: 12px;\n    }\n    \n    @media print {\n      body {\n        background-color: white;\n      }\n      .container {\n        box-shadow: none;\n        padding: 0;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class="container">\n    <div class="header">\n      <h1>\ud83d\udcca ').concat(t.title,"</h1>\n      <p>Per\xedodo: ").concat(r,'</p>\n    </div>\n    \n    <div class="metadata">\n      <div class="metadata-item">\n        <strong>Tipo de Documento:</strong>\n        <p>').concat(n.documentType,'</p>\n      </div>\n      <div class="metadata-item">\n        <strong>C\xf3digo da Entidade:</strong>\n        <p>').concat(n.entityCode,'</p>\n      </div>\n      <div class="metadata-item">\n        <strong>C\xf3digo do Munic\xedpio:</strong>\n        <p>').concat(n.cityCode,'</p>\n      </div>\n      <div class="metadata-item">\n        <strong>Data de Gera\xe7\xe3o:</strong>\n        <p>').concat(new Date(t.generatedAt).toLocaleString("pt-BR"),'</p>\n      </div>\n    </div>\n    \n    <div class="overview">\n      <h2>Vis\xe3o Geral</h2>\n      <div class="overview-grid">\n        <div class="overview-item success">\n          <label>Completude</label>\n          <value>').concat(n.completionPercentage,'%</value>\n        </div>\n        <div class="overview-item ').concat(n.hasErrors?"error":"success",'">\n          <label>Status</label>\n          <value>').concat(n.hasErrors?"\u26a0\ufe0f Com Erros":"\u2705 V\xe1lido",'</value>\n        </div>\n        <div class="overview-item error">\n          <label>Erros Encontrados</label>\n          <value>').concat(n.errorCount,'</value>\n        </div>\n        <div class="overview-item warning">\n          <label>Avisos</label>\n          <value>').concat(n.warningCount,'</value>\n        </div>\n      </div>\n    </div>\n    \n    <div class="sections">\n      <h2>Resumo das Se\xe7\xf5es</h2>\n      <table class="section-table">\n        <thead>\n          <tr>\n            <th>Se\xe7\xe3o</th>\n            <th>T\xedtulo</th>\n            <th>Registros</th>\n            <th>Valor Total</th>\n            <th>Status</th>\n          </tr>\n        </thead>\n        <tbody>\n          ').concat(s.map(e=>"\n          <tr>\n            <td><strong>".concat(e.section,"</strong></td>\n            <td>").concat(e.title,"</td>\n            <td>").concat(e.recordCount,"</td>\n            <td>").concat(e.totalValue?"R$ ".concat(e.totalValue.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})):"-",'</td>\n            <td><span class="status-badge ').concat(e.status,'">').concat("complete"===e.status?"Completo":"incomplete"===e.status?"Incompleto":"Vazio","</span></td>\n          </tr>\n          ")).join(""),"\n        </tbody>\n      </table>\n    </div>\n    \n    ").concat(i?'\n    <div class="financial-summary">\n      <h2>\ud83d\udcb0 Sum\xe1rio Financeiro</h2>\n      <div class="financial-grid">\n        <div class="financial-item">\n          <label>Total Recebido</label>\n          <div class="amount">R$ '.concat(i.totalReceived.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),'</div>\n        </div>\n        <div class="financial-item">\n          <label>Total Gasto</label>\n          <div class="amount">R$ ').concat(i.totalSpent.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),'</div>\n        </div>\n        <div class="financial-item">\n          <label>Saldo</label>\n          <div class="amount" style="color: ').concat(i.balance>=0?"#166534":"#dc2626",'">\n            R$ ').concat(i.balance.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),'\n          </div>\n        </div>\n        <div class="financial-item">\n          <label>Fundos Dispon\xedveis</label>\n          <div class="amount">R$ ').concat(i.availableFunds.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),"</div>\n        </div>\n      </div>\n    </div>\n    "):"",'\n    \n    <div class="footer">\n      <p>Relat\xf3rio gerado automaticamente pelo Sistema AUDESP Connect v').concat(t.version,"</p>\n      <p>Este documento \xe9 confidencial e cont\xe9m informa\xe7\xf5es de presta\xe7\xe3o de contas.</p>\n    </div>\n  </div>\n</body>\n</html>")}static exportAsJSON(e){return JSON.stringify(e,null,2)}}class pC{static downloadHTML(e,t){const n=new Blob([e],{type:"text/html"}),s=window.URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=t.endsWith(".html")?t:"".concat(t,".html"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(s)}static downloadJSON(e,t){const n="string"===typeof e?e:JSON.stringify(e,null,2),s=new Blob([n],{type:"application/json"}),i=window.URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download=t.endsWith(".json")?t:"".concat(t,".json"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)}static downloadCSV(e,t){const n=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=t.endsWith(".csv")?t:"".concat(t,".csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(s)}static openInNewTab(e){const t=window.open("","_blank");t&&(t.document.write(e),t.document.close())}}class fC{static exportWithMetadata(e,t){return{metadata:{version:this.EXPORT_VERSION,createdAt:(new Date).toISOString(),lastModified:(new Date).toISOString(),format:"json",description:t,checksum:this.calculateChecksum(e)},data:e}}static exportAsJSON(e,t){const n=this.exportWithMetadata(e,t);return JSON.stringify(n,null,2)}static exportAsCSV(e){var t,n;let s="Se\xe7\xe3o,Tipo Documento,Entidade,Municipio,Ano,M\xeas,Descri\xe7\xe3o\n";const i=["1",e.descritor.tipo_documento,e.descritor.entidade,e.descritor.municipio,e.descritor.ano,e.descritor.mes,"Descritor"];return s+=i.map(e=>'"'.concat(e,'"')).join(",")+"\n",null!==(t=e.relacao_empregados)&&void 0!==t&&t.length&&(s+="\nSe\xe7\xe3o,CPF,Data Admiss\xe3o,Cargo,Sal\xe1rio\n",e.relacao_empregados.forEach(e=>{const t=["4",e.cpf,e.data_admissao,e.cbo,e.salario_contratual];s+=t.map(e=>'"'.concat(e,'"')).join(",")+"\n"})),null!==(n=e.contratos)&&void 0!==n&&n.length&&(s+="\nSe\xe7\xe3o,N\xfamero,Credor,Vig\xeancia Inicial,Vig\xeancia Final,Valor\n",e.contratos.forEach(e=>{const t=["6",e.numero,e.credor.documento_numero,e.vigencia_data_inicial,e.vigencia_data_final||"-",e.valor_montante];s+=t.map(e=>'"'.concat(e,'"')).join(",")+"\n"})),s}static download(e,t){const n=new Blob([e],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json"}),s=window.URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(s)}static calculateChecksum(e){const t=JSON.stringify(e);let n=0;for(let s=0;s<t.length;s++){n=(n<<5)-n+t.charCodeAt(s),n&=n}return Math.abs(n).toString(16)}}fC.EXPORT_VERSION="2.0.0";class mC{static async importJSON(e,t){try{const n=await this.readFile(e),s=JSON.parse(n);let i=s.data||s;const r=this.validateImportedData(i);if(!r.isValid)throw v.logImport("JSON",!1,r.errors.join("; "),t),new Error("Arquivo inv\xe1lido: ".concat(r.errors[0]));return v.logImport("JSON",!0,void 0,t),{data:i,validation:r}}catch(n){throw v.logImport("JSON",!1,n.message,t),new Error("Erro ao importar JSON: ".concat(n.message))}}static async importCSV(e,t){try{const n=await this.readFile(e);if(n.split("\n").map(e=>e.trim()).filter(e=>e).length<2)throw new Error("Arquivo CSV vazio ou malformado");const s=a({},l),i=this.validateImportedData(s);return v.logImport("CSV",i.isValid,void 0,t),{data:s,validation:i}}catch(n){throw v.logImport("CSV",!1,n.message,t),new Error("Erro ao importar CSV: ".concat(n.message))}}static validateImportedData(e){const t=[],n=[],s={};let i=0,r=0;if(!e||"object"!==typeof e)return t.push("Dados n\xe3o s\xe3o um objeto v\xe1lido"),{isValid:!1,errors:t,warnings:n,summary:{sections:s,totalFields:i,validFields:r}};e.descritor?s.descritor=!0:t.push('Se\xe7\xe3o "descritor" obrigat\xf3ria');try{const s=dC.validate(e);s.isValid||t.push(...s.errors.slice(0,5).map(e=>e.message)),n.push(...s.warnings.slice(0,5).map(e=>e.message)),r=Math.max(0,100-10*s.errors.length),i=100}catch(o){t.push("Erro ao validar dados")}return{isValid:0===t.length,errors:t,warnings:n,summary:{sections:s,totalFields:i,validFields:r}}}static readFile(e){return new Promise((t,n)=>{const s=new FileReader;s.onload=e=>{var s;const i=null===(s=e.target)||void 0===s?void 0:s.result;"string"===typeof i?t(i):n(new Error("Erro ao ler arquivo"))},s.onerror=()=>n(new Error("Erro ao ler arquivo")),s.readAsText(e)})}}class gC{static createBackup(e,t){const n={id:this.generateId(),timestamp:(new Date).toISOString(),version:"2.0.0",checksum:this.calculateChecksum(e),size:JSON.stringify(e).length},s=[n,...this.getBackups()].slice(0,this.MAX_BACKUPS);return localStorage.setItem(this.BACKUP_STORAGE_KEY,JSON.stringify(s)),localStorage.setItem("backup_".concat(n.id),JSON.stringify(e)),v.logOperation({action:"CREATE",section:"BACKUP",status:"SUCCESS",details:"Backup criado: ".concat(n.id),userId:t}),n}static restoreBackup(e,t){try{const n=localStorage.getItem("backup_".concat(e));if(!n)return v.logOperation({action:"UPDATE",section:"BACKUP",status:"FAILED",details:"Backup n\xe3o encontrado: ".concat(e),userId:t,errorMessage:"Backup not found"}),null;const s=JSON.parse(n);return v.logOperation({action:"UPDATE",section:"BACKUP",status:"SUCCESS",details:"Backup restaurado: ".concat(e),userId:t}),s}catch(n){return v.logOperation({action:"UPDATE",section:"BACKUP",status:"FAILED",details:"Erro ao restaurar backup: ".concat(e),userId:t,errorMessage:n.message}),null}}static getBackups(){try{const e=localStorage.getItem(this.BACKUP_STORAGE_KEY);return e?JSON.parse(e):[]}catch(e){return[]}}static removeBackup(e,t){const n=this.getBackups(),s=n.filter(t=>t.id!==e);return n.length===s.length?(v.logOperation({action:"DELETE",section:"BACKUP",status:"FAILED",details:"Backup n\xe3o encontrado: ".concat(e),userId:t}),!1):(localStorage.setItem(this.BACKUP_STORAGE_KEY,JSON.stringify(s)),localStorage.removeItem("backup_".concat(e)),v.logOperation({action:"DELETE",section:"BACKUP",status:"SUCCESS",details:"Backup removido: ".concat(e),userId:t}),!0)}static calculateChecksum(e){const t=JSON.stringify(e);let n=0;for(let s=0;s<t.length;s++){n=(n<<5)-n+t.charCodeAt(s),n&=n}return Math.abs(n).toString(16)}static generateId(){return"backup_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}}gC.BACKUP_STORAGE_KEY="audesp_backups",gC.MAX_BACKUPS=10;const vC=t=>{let{formData:n,setFormData:s,userId:i}=t;const[r,o]=(0,e.useState)("validation"),[a,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null),u=(0,e.useMemo)(()=>uC(n),[n]),h=(0,e.useCallback)(()=>{v.logValidation(!u.isValid,u.errors.length,i),d({type:u.isValid?"success":"error",text:"Valida\xe7\xe3o: ".concat(u.isValid?"Sem erros!":u.errors.length+" erros encontrados")})},[u,i]),p=(0,e.useCallback)(async()=>{l(!0);try{const e=hC.generate(n,u,i),t=hC.exportAsHTML(e);pC.openInNewTab(t),v.logExport("HTML",i),d({type:"success",text:"Relat\xf3rio gerado com sucesso!"})}catch(e){d({type:"error",text:"Erro ao gerar relat\xf3rio: ".concat(e.message)})}finally{l(!1)}},[n,u,i]),f=(0,e.useCallback)(()=>{const e=fC.exportAsJSON(n,"Presta\xe7\xe3o ".concat(n.descritor.ano,"/").concat(n.descritor.mes));fC.download(e,"prestacao_contas_".concat(n.descritor.entidade,"_").concat(n.descritor.mes,"_").concat(n.descritor.ano,".json")),v.logExport("JSON",i),d({type:"success",text:"Arquivo JSON baixado com sucesso!"})},[n,i]),m=(0,e.useCallback)(()=>{const e=fC.exportAsCSV(n);fC.download(e,"prestacao_contas_".concat(n.descritor.entidade,"_").concat(n.descritor.mes,"_").concat(n.descritor.ano,".csv"),"text/csv;charset=utf-8"),v.logExport("CSV",i),d({type:"success",text:"Arquivo CSV baixado com sucesso!"})},[n,i]),g=(0,e.useMemo)(()=>y.generateReport(),[]),_=(0,e.useCallback)(()=>{const e=y.exportReportJSON();fC.download(e,"audit_report_".concat((new Date).toISOString().split("T")[0],".json")),d({type:"success",text:"Relat\xf3rio de auditoria baixado!"})},[]),w=(0,e.useCallback)(()=>{const e=y.exportReportCSV();fC.download(e,"audit_report_".concat((new Date).toISOString().split("T")[0],".csv"),"text/csv;charset=utf-8"),d({type:"success",text:"Relat\xf3rio de auditoria (CSV) baixado!"})},[]),x=(0,e.useMemo)(()=>gC.getBackups(),[]),E=(0,e.useCallback)(()=>{const e=gC.createBackup(n,i);d({type:"success",text:"Backup criado: ".concat(e.id.substring(0,20),"...")})},[n,i]),S=(0,e.useCallback)(e=>{const t=gC.restoreBackup(e,i);t?(s(t),d({type:"success",text:"Backup restaurado com sucesso!"})):d({type:"error",text:"Erro ao restaurar backup"})},[s,i]),A=(0,e.useCallback)(e=>{const t=gC.removeBackup(e,i);d(t?{type:"success",text:"Backup removido"}:{type:"error",text:"Erro ao remover backup"})},[i]),C=(0,e.useCallback)(async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){l(!0);try{const{data:e,validation:t}=await mC.importJSON(n,i);t.isValid?(s(e),d({type:"success",text:"Arquivo importado com sucesso!"})):d({type:"error",text:"Erros encontrados: ".concat(t.errors.slice(0,3).join("; "))})}catch(r){d({type:"error",text:"Erro ao importar: ".concat(r.message)})}finally{l(!1),e.target.value=""}}},[s,i]),k=(0,e.useCallback)(async()=>{l(!0);try{const e=await b.verifyIntegrity(n),t=await b.detectUnregisteredChanges(n);d({type:e&&!t?"success":"info",text:"Integridade: ".concat(e?"\u2705 V\xe1lida":"\u274c Alterada"," | Mudan\xe7as: ").concat(t?"Sim":"N\xe3o")})}catch(e){d({type:"error",text:"Erro: ".concat(e.message)})}finally{l(!1)}},[n]),T=(0,e.useCallback)(async()=>{l(!0);try{const e=await b.registerIntegrityCheck(n,i);d({type:"success",text:"Checksum registrado: ".concat(e.dataHash.substring(0,16),"...")})}catch(e){d({type:"error",text:"Erro: ".concat(e.message)})}finally{l(!1)}},[n,i]);return(0,L.jsxs)("div",{className:"reports-dashboard",children:[(0,L.jsx)("style",{children:"\n        .reports-dashboard {\n          padding: 20px;\n          background-color: #f5f5f5;\n          border-radius: 8px;\n          margin: 20px 0;\n        }\n\n        .tabs {\n          display: flex;\n          gap: 10px;\n          margin-bottom: 20px;\n          border-bottom: 2px solid #e5e5e5;\n        }\n\n        .tab-button {\n          padding: 10px 20px;\n          background: none;\n          border: none;\n          border-bottom: 3px solid transparent;\n          cursor: pointer;\n          font-size: 14px;\n          font-weight: 600;\n          color: #666;\n          transition: all 0.3s;\n        }\n\n        .tab-button.active {\n          color: #1e40af;\n          border-bottom-color: #1e40af;\n        }\n\n        .tab-button:hover {\n          color: #1e40af;\n        }\n\n        .tab-content {\n          background: white;\n          padding: 20px;\n          border-radius: 6px;\n          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .section {\n          margin-bottom: 20px;\n        }\n\n        .section-title {\n          font-size: 16px;\n          font-weight: 600;\n          color: #1e40af;\n          margin-bottom: 10px;\n          border-left: 4px solid #1e40af;\n          padding-left: 10px;\n        }\n\n        .button-group {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 10px;\n          margin-bottom: 20px;\n        }\n\n        .btn {\n          padding: 10px 15px;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n          font-weight: 600;\n          transition: all 0.3s;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          justify-content: center;\n        }\n\n        .btn-primary {\n          background-color: #1e40af;\n          color: white;\n        }\n\n        .btn-primary:hover {\n          background-color: #1e3a8a;\n        }\n\n        .btn-secondary {\n          background-color: #e5e7eb;\n          color: #333;\n        }\n\n        .btn-secondary:hover {\n          background-color: #d1d5db;\n        }\n\n        .btn-success {\n          background-color: #10b981;\n          color: white;\n        }\n\n        .btn-success:hover {\n          background-color: #059669;\n        }\n\n        .btn-danger {\n          background-color: #ef4444;\n          color: white;\n        }\n\n        .btn-danger:hover {\n          background-color: #dc2626;\n        }\n\n        .btn:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n        }\n\n        .message {\n          padding: 12px 15px;\n          border-radius: 4px;\n          margin-bottom: 15px;\n          border-left: 4px solid;\n        }\n\n        .message.success {\n          background-color: #d1fae5;\n          color: #065f46;\n          border-left-color: #10b981;\n        }\n\n        .message.error {\n          background-color: #fee2e2;\n          color: #991b1b;\n          border-left-color: #ef4444;\n        }\n\n        .message.info {\n          background-color: #dbeafe;\n          color: #0c4a6e;\n          border-left-color: #3b82f6;\n        }\n\n        .stats-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n          gap: 15px;\n          margin-bottom: 20px;\n        }\n\n        .stat-card {\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          color: white;\n          padding: 15px;\n          border-radius: 6px;\n          text-align: center;\n        }\n\n        .stat-value {\n          font-size: 28px;\n          font-weight: bold;\n          margin-bottom: 5px;\n        }\n\n        .stat-label {\n          font-size: 12px;\n          opacity: 0.9;\n          text-transform: uppercase;\n        }\n\n        .stat-card.error {\n          background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n        }\n\n        .stat-card.warning {\n          background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\n        }\n\n        .stat-card.success {\n          background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\n        }\n\n        .table {\n          width: 100%;\n          border-collapse: collapse;\n          font-size: 13px;\n        }\n\n        .table th {\n          background-color: #f3f4f6;\n          padding: 10px;\n          text-align: left;\n          border-bottom: 1px solid #e5e7eb;\n          font-weight: 600;\n          color: #1f2937;\n        }\n\n        .table td {\n          padding: 10px;\n          border-bottom: 1px solid #e5e7eb;\n        }\n\n        .table tbody tr:hover {\n          background-color: #f9fafb;\n        }\n\n        .file-input {\n          padding: 8px 12px;\n          border: 1px solid #d1d5db;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n\n        .input-group {\n          display: flex;\n          gap: 10px;\n          align-items: center;\n        }\n\n        .loading {\n          display: inline-block;\n          width: 16px;\n          height: 16px;\n          border: 2px solid #f3f4f6;\n          border-top: 2px solid #1e40af;\n          border-radius: 50%;\n          animation: spin 1s linear infinite;\n        }\n\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "}),(0,L.jsx)("h2",{children:"\ud83d\udcca Dashboard de Relat\xf3rios e Auditoria"}),c&&(0,L.jsx)("div",{className:"message ".concat(c.type),children:c.text}),(0,L.jsxs)("div",{className:"tabs",children:[(0,L.jsx)("button",{className:"tab-button ".concat("validation"===r?"active":""),onClick:()=>o("validation"),children:"\u2713 Valida\xe7\xe3o"}),(0,L.jsx)("button",{className:"tab-button ".concat("reports"===r?"active":""),onClick:()=>o("reports"),children:"\ud83d\udcc4 Relat\xf3rios"}),(0,L.jsx)("button",{className:"tab-button ".concat("audit"===r?"active":""),onClick:()=>o("audit"),children:"\ud83d\udd0d Auditoria"}),(0,L.jsx)("button",{className:"tab-button ".concat("backup"===r?"active":""),onClick:()=>o("backup"),children:"\ud83d\udcbe Backup"})]}),(0,L.jsxs)("div",{className:"tab-content",children:["validation"===r&&(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{className:"stats-grid",children:[(0,L.jsxs)("div",{className:"stat-card ".concat(u.isValid?"success":"error"),children:[(0,L.jsx)("div",{className:"stat-value",children:u.isValid?"\u2705":"\u274c"}),(0,L.jsx)("div",{className:"stat-label",children:"Status"})]}),(0,L.jsxs)("div",{className:"stat-card error",children:[(0,L.jsx)("div",{className:"stat-value",children:u.errors.length}),(0,L.jsx)("div",{className:"stat-label",children:"Erros"})]}),(0,L.jsxs)("div",{className:"stat-card warning",children:[(0,L.jsx)("div",{className:"stat-value",children:u.warnings.length}),(0,L.jsx)("div",{className:"stat-label",children:"Avisos"})]}),(0,L.jsxs)("div",{className:"stat-card success",children:[(0,L.jsx)("div",{className:"stat-value",children:Object.keys(u.summary.sections).length}),(0,L.jsx)("div",{className:"stat-label",children:"Se\xe7\xf5es"})]})]}),(0,L.jsxs)("div",{className:"section",children:[(0,L.jsx)("div",{className:"section-title",children:"A\xe7\xf5es"}),(0,L.jsxs)("div",{className:"button-group",children:[(0,L.jsxs)("button",{className:"btn btn-primary",onClick:h,disabled:a,children:[a&&(0,L.jsx)("span",{className:"loading"}),"Executar Valida\xe7\xe3o"]}),(0,L.jsxs)("button",{className:"btn btn-success",onClick:k,disabled:a,children:[a&&(0,L.jsx)("span",{className:"loading"}),"Verificar Integridade"]}),(0,L.jsxs)("button",{className:"btn btn-success",onClick:T,disabled:a,children:[a&&(0,L.jsx)("span",{className:"loading"}),"Registrar Checksum"]})]})]}),u.errors.length>0&&(0,L.jsxs)("div",{className:"section",children:[(0,L.jsxs)("div",{className:"section-title",children:["Erros Encontrados (",u.errors.length,")"]}),(0,L.jsxs)("table",{className:"table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Campo"}),(0,L.jsx)("th",{children:"Mensagem"}),(0,L.jsx)("th",{children:"Se\xe7\xe3o"})]})}),(0,L.jsx)("tbody",{children:u.errors.slice(0,10).map((e,t)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:(0,L.jsx)("strong",{children:e.field})}),(0,L.jsx)("td",{children:e.message}),(0,L.jsx)("td",{children:e.section||"-"})]},t))})]})]}),u.warnings.length>0&&(0,L.jsxs)("div",{className:"section",children:[(0,L.jsxs)("div",{className:"section-title",children:["Avisos (",u.warnings.length,")"]}),(0,L.jsxs)("table",{className:"table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Campo"}),(0,L.jsx)("th",{children:"Mensagem"})]})}),(0,L.jsx)("tbody",{children:u.warnings.slice(0,5).map((e,t)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:(0,L.jsx)("strong",{children:e.field})}),(0,L.jsx)("td",{children:e.message})]},t))})]})]})]}),"reports"===r&&(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{className:"section",children:[(0,L.jsx)("div",{className:"section-title",children:"Gerar Relat\xf3rios"}),(0,L.jsxs)("div",{className:"button-group",children:[(0,L.jsxs)("button",{className:"btn btn-primary",onClick:p,disabled:a,children:[a&&(0,L.jsx)("span",{className:"loading"}),"\ud83d\udcca Relat\xf3rio Executivo (HTML)"]}),(0,L.jsx)("button",{className:"btn btn-secondary",onClick:f,disabled:a,children:"\ud83d\udce5 Exportar JSON"}),(0,L.jsx)("button",{className:"btn btn-secondary",onClick:m,disabled:a,children:"\ud83d\udce5 Exportar CSV"})]})]}),(0,L.jsxs)("div",{className:"section",children:[(0,L.jsx)("div",{className:"section-title",children:"Importar Dados"}),(0,L.jsxs)("div",{className:"input-group",children:[(0,L.jsx)("input",{type:"file",accept:".json",onChange:C,disabled:a,className:"file-input"}),(0,L.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:"Aceita JSON"})]})]})]}),"audit"===r&&(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{className:"stats-grid",children:[(0,L.jsxs)("div",{className:"stat-card",children:[(0,L.jsx)("div",{className:"stat-value",children:g.totalOperations}),(0,L.jsx)("div",{className:"stat-label",children:"Opera\xe7\xf5es"})]}),(0,L.jsxs)("div",{className:"stat-card",children:[(0,L.jsx)("div",{className:"stat-value",children:g.summary.createsCount}),(0,L.jsx)("div",{className:"stat-label",children:"Cria\xe7\xf5es"})]}),(0,L.jsxs)("div",{className:"stat-card",children:[(0,L.jsx)("div",{className:"stat-value",children:g.summary.updatesCount}),(0,L.jsx)("div",{className:"stat-label",children:"Altera\xe7\xf5es"})]}),(0,L.jsxs)("div",{className:"stat-card error",children:[(0,L.jsx)("div",{className:"stat-value",children:g.summary.failuresCount}),(0,L.jsx)("div",{className:"stat-label",children:"Falhas"})]})]}),(0,L.jsxs)("div",{className:"section",children:[(0,L.jsx)("div",{className:"section-title",children:"Opera\xe7\xf5es por Tipo"}),(0,L.jsxs)("table",{className:"table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Tipo"}),(0,L.jsx)("th",{children:"Quantidade"})]})}),(0,L.jsx)("tbody",{children:Object.entries(g.operationsByType).map(e=>{let[t,n]=e;return(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:(0,L.jsx)("strong",{children:t})}),(0,L.jsx)("td",{children:n})]},t)})})]})]}),(0,L.jsxs)("div",{className:"section",children:[(0,L.jsx)("div",{className:"section-title",children:"Downloads"}),(0,L.jsxs)("div",{className:"button-group",children:[(0,L.jsx)("button",{className:"btn btn-secondary",onClick:_,disabled:a,children:"\ud83d\udce5 Relat\xf3rio JSON"}),(0,L.jsx)("button",{className:"btn btn-secondary",onClick:w,disabled:a,children:"\ud83d\udce5 Relat\xf3rio CSV"})]})]})]}),"backup"===r&&(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{className:"section",children:[(0,L.jsxs)("div",{className:"section-title",children:["Backups Dispon\xedveis (",x.length,")"]}),(0,L.jsx)("div",{className:"button-group",children:(0,L.jsxs)("button",{className:"btn btn-success",onClick:E,disabled:a,children:[a&&(0,L.jsx)("span",{className:"loading"}),"\u2795 Novo Backup"]})})]}),x.length>0&&(0,L.jsx)("div",{className:"section",children:(0,L.jsxs)("table",{className:"table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Data/Hora"}),(0,L.jsx)("th",{children:"Checksum"}),(0,L.jsx)("th",{children:"Tamanho"}),(0,L.jsx)("th",{children:"A\xe7\xf5es"})]})}),(0,L.jsx)("tbody",{children:x.map(e=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:new Date(e.timestamp).toLocaleString("pt-BR")}),(0,L.jsx)("td",{children:(0,L.jsxs)("code",{style:{fontSize:"11px"},children:[e.checksum.substring(0,12),"..."]})}),(0,L.jsxs)("td",{children:[(e.size/1024).toFixed(1)," KB"]}),(0,L.jsxs)("td",{children:[(0,L.jsx)("button",{className:"btn btn-secondary",onClick:()=>S(e.id),disabled:a,style:{marginRight:"5px",fontSize:"12px",padding:"5px 10px"},children:"Restaurar"}),(0,L.jsx)("button",{className:"btn btn-danger",onClick:()=>A(e.id),disabled:a,style:{fontSize:"12px",padding:"5px 10px"},children:"Deletar"})]})]},e.id))})]})})]})]})]})},bC={piloto:"https://audesp-piloto.tce.sp.gov.br",producao:"https://audesp.tce.sp.gov.br"},yC="audesp_auth_token",_C="audesp_environment";class wC{static setEnvironment(e){this.currentEnvironment=e,localStorage.setItem(_C,e)}static getEnvironment(){return localStorage.getItem(_C)||"piloto"}static getBaseUrl(){const e=this.getEnvironment();return"undefined"!==typeof window&&"localhost"===window.location.hostname?"/proxy-login":bC[e]}static async login(e){const t="undefined"!==typeof window&&"localhost"===window.location.hostname?"/proxy-login":this.getBaseUrl(),n="".concat(t,"/login");try{console.log("[Auth] Tentando login em ".concat(this.getEnvironment()," (").concat(n,")")),console.log("[Auth] CPF: ".concat(e.cpf));const t="".concat(e.cpf,":").concat(e.password),s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","x-authorization":t},credentials:"include"});console.log("[Auth] Response status: ".concat(s.status));const i=await s.text();if(console.log("[Auth] Response body: ".concat(i.substring(0,100))),!s.ok){if(401===s.status)throw new Error("\u274c Usu\xe1rio ou senha inv\xe1lidos. Verifique suas credenciais TCESP.");if(403===s.status)throw new Error("\u274c Acesso proibido. Seu usu\xe1rio pode n\xe3o ter permiss\xe3o neste ambiente.");throw new Error("\u274c Erro de autentica\xe7\xe3o: ".concat(s.status))}const r=JSON.parse(i),o=r.access_token||r.token,a=r.expire_in||r.expires_in||0,l={token:o,expire_in:a>0?Math.floor((a-Date.now())/1e3):3600,token_type:r.token_type||"bearer",environment:this.getEnvironment(),timestamp:Date.now()};return localStorage.setItem(yC,JSON.stringify(l)),this.currentToken=l,console.log("[Auth] \u2705 Login bem-sucedido em ".concat(this.getEnvironment())),l}catch(s){throw console.error("[Auth] Erro no login:",s),new Error("Erro ao autenticar: ".concat(s.message))}}static logout(){localStorage.removeItem(yC),this.currentToken=null,console.log("[Auth] Logout realizado")}static getToken(){if(this.currentToken){const e=this.currentToken.timestamp+1e3*this.currentToken.expires_in;return Date.now()>e?(this.logout(),null):this.currentToken}const e=localStorage.getItem(yC);if(e)try{this.currentToken=JSON.parse(e);const t=this.currentToken.timestamp+1e3*this.currentToken.expires_in;return Date.now()>t?(this.logout(),null):this.currentToken}catch(t){return null}return null}static isAuthenticated(){return null!==this.getToken()}static getAuthHeader(){const e=this.getToken();return e?{Authorization:"".concat(e.token_type," ").concat(e.token)}:{}}}wC.currentEnvironment="piloto",wC.currentToken=null;const xC=wC,EC=t=>{let{onLoginSuccess:n,onError:s}=t;const[i,r]=(0,e.useState)("piloto"),[o,a]=(0,e.useState)("22586034805"),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)(!1),[h,p]=(0,e.useState)(!1),[f,m]=(0,e.useState)(!1),g=e=>{r(e),xC.setEnvironment(e)},v=xC.getBaseUrl();return(0,L.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"w-full max-w-md",children:[(0,L.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 border border-slate-100",children:[(0,L.jsxs)("div",{className:"text-center mb-8",children:[(0,L.jsx)("div",{className:"flex justify-center mb-4",children:(0,L.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:(0,L.jsx)("span",{className:"text-white text-2xl font-bold",children:"\ud83c\udfdb\ufe0f"})})}),(0,L.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Audesp Connect"}),(0,L.jsx)("p",{className:"text-sm text-slate-500",children:"Presta\xe7\xe3o de Contas v2.0"})]}),(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("label",{className:"block text-xs font-bold uppercase text-slate-600 mb-3",children:"Ambiente"}),(0,L.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,L.jsxs)("button",{onClick:()=>g("piloto"),className:"p-3 rounded-lg border-2 font-bold text-sm transition-all ".concat("piloto"===i?"border-blue-600 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"),children:[(0,L.jsx)("span",{className:"block mb-1",children:"\ud83e\uddea"}),(0,L.jsx)("span",{className:"text-xs",children:"Piloto (Teste)"})]}),(0,L.jsxs)("button",{onClick:()=>g("producao"),className:"p-3 rounded-lg border-2 font-bold text-sm transition-all ".concat("producao"===i?"border-red-600 bg-red-50 text-red-700":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"),children:[(0,L.jsx)("span",{className:"block mb-1",children:"\ud83d\ude80"}),(0,L.jsx)("span",{className:"text-xs",children:"Produ\xe7\xe3o"})]})]}),"producao"===i&&(0,L.jsxs)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,L.jsx)("p",{className:"text-xs text-red-700 font-bold",children:"\u26a0\ufe0f Voc\xea est\xe1 conectando ao ambiente de PRODU\xc7\xc3O."}),(0,L.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Certifique-se de estar enviando dados reais."})]}),(0,L.jsxs)("div",{className:"mt-3 p-2 bg-slate-50 rounded text-xs text-slate-600",children:[(0,L.jsx)("strong",{children:"Endpoint:"})," ",(0,L.jsx)("span",{className:"font-mono text-[10px]",children:v})]})]}),(0,L.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o&&l){u(!0);try{const e=await xC.login({cpf:o,password:l});f&&(localStorage.setItem("audesp_last_environment",i),localStorage.setItem("audesp_last_cpf",o)),n(e.token,i,o)}catch(t){s(t.message||"Erro ao fazer login")}finally{u(!1)}}else s("CPF e senha s\xe3o obrigat\xf3rios")},className:"space-y-4",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-xs font-bold uppercase text-slate-600 mb-2",children:"CPF"}),(0,L.jsx)("input",{type:"text",value:o,onChange:e=>a(e.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"123.456.789-00",className:"w-full h-11 px-4 border border-slate-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition text-slate-700 placeholder:text-slate-400",disabled:d,required:!0})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-xs font-bold uppercase text-slate-600 mb-2",children:"Senha"}),(0,L.jsxs)("div",{className:"relative",children:[(0,L.jsx)("input",{type:h?"text":"password",value:l,onChange:e=>c(e.target.value),placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",className:"w-full h-11 px-4 border border-slate-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition text-slate-700 placeholder:text-slate-400",disabled:d,required:!0}),(0,L.jsx)("button",{type:"button",onClick:()=>p(!h),className:"absolute right-3 top-3 text-slate-500 hover:text-slate-700",children:h?"\ud83d\udc41\ufe0f":"\ud83d\ude48"})]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"checkbox",id:"rememberMe",checked:f,onChange:e=>m(e.target.checked),className:"w-4 h-4 border-slate-300 rounded text-blue-600 focus:ring-blue-500 cursor-pointer",disabled:d}),(0,L.jsx)("label",{htmlFor:"rememberMe",className:"text-sm text-slate-600 cursor-pointer",children:"Lembrar ambiente e CPF"})]}),(0,L.jsx)("button",{type:"submit",disabled:d,className:"w-full h-11 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-lg hover:from-blue-700 hover:to-blue-800 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{className:"animate-spin",children:"\u23f3"}),"Autenticando..."]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{children:"\ud83d\udd10"}),"Acessar Audesp"]})})]}),(0,L.jsxs)("div",{className:"mt-6 pt-4 border-t border-slate-200 text-center",children:[(0,L.jsx)("p",{className:"text-xs text-slate-500 mb-2",children:"Sistema de Presta\xe7\xe3o de Contas Eletr\xf4nica"}),(0,L.jsxs)("p",{className:"text-xs text-slate-600",children:[(0,L.jsx)("strong",{children:"Ambiente:"})," ","piloto"===i?"\ud83e\uddea Teste (dados n\xe3o-reais)":"\ud83d\ude80 Produ\xe7\xe3o (dados reais)"]})]})]}),(0,L.jsxs)("div",{className:"mt-6 bg-white bg-opacity-10 rounded-lg p-4 text-white text-sm",children:[(0,L.jsxs)("p",{className:"mb-2",children:[(0,L.jsx)("strong",{children:"\ud83d\udca1 Dica:"})," Use o ambiente Piloto para testar antes de enviar em Produ\xe7\xe3o."]}),(0,L.jsx)("p",{className:"text-xs opacity-90",children:"\xa9 2024 Tribunal de Contas do Estado de S\xe3o Paulo"})]})]})})};class SC{static async processBatchPDFs(e){console.log("[AI] Iniciando processamento em lote de ".concat(e.length," PDFs"));const t=[];for(let s=0;s<e.length;s++)try{console.log("[AI] Processando arquivo ".concat(s+1,"/").concat(e.length,": ").concat(e[s].name));const n=await this.processDocument(e[s]);t.push(n)}catch(n){console.error("[AI] Erro ao processar ".concat(e[s].name,":"),n),t.push({filename:e[s].name,type:"outro",confidence:0,extractedData:{},suggestedFields:[],rawText:""})}return this.generateBatchSummary(t)}static async processDocument(e){const t=await this.extractTextFromPDF(e),n=await this.classifyDocument(t),s=await this.extractStructuredData(t,n),i=await this.generateSuggestions(t,s,n);return{filename:e.name,type:n,confidence:this.calculateConfidence(s),extractedData:s,suggestedFields:i,rawText:t}}static async extractTextFromPDF(e){try{const t=window.pdfjsLib;if(!t)throw new Error("PDFjs n\xe3o carregado");const n=await e.arrayBuffer(),s=await t.getDocument(n).promise;let i="";for(let e=1;e<=s.numPages;e++){const t=await s.getPage(e),n=await t.getTextContent();i+=n.items.map(e=>e.str).join(" ")+"\n"}return i}catch(t){return console.warn("[PDF] PDFjs n\xe3o dispon\xedvel, usando fallback"),"N\xe3o foi poss\xedvel extrair texto de ".concat(e.name)}}static async classifyDocument(e){if(!this.anthropicApiKey)return this.classifyDocumentLocally(e);try{const t=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.anthropicApiKey,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-3-5-sonnet-20241022",max_tokens:200,messages:[{role:"user",content:"Classifique este documento em uma destas categorias: edital, licitacao, ata, contrato, empenho, pagamento, outro.\n\nTexto do documento (primeiros 2000 caracteres):\n".concat(e.substring(0,2e3),"\n\nResponda apenas com uma palavra da lista acima, sem explica\xe7\xe3o.")}]})}),n=(await t.json()).content[0].text.toLowerCase().trim();return["edital","licitacao","ata","contrato","empenho","pagamento","outro"].includes(n)?n:this.classifyDocumentLocally(e)}catch(t){return console.error("[AI] Erro ao classificar com Claude:",t),this.classifyDocumentLocally(e)}}static classifyDocumentLocally(e){const t=e.toLowerCase();return t.includes("edital")?"edital":t.includes("licita\xe7\xe3o")||t.includes("licitacao")?"licitacao":t.includes("ata")?"ata":t.includes("contrato")?"contrato":t.includes("empenho")?"empenho":t.includes("pagamento")?"pagamento":"outro"}static async extractStructuredData(e,t){if(!this.anthropicApiKey)return this.extractDataLocally(e,t);try{const s=this.buildExtractionPrompt(e,t),i=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.anthropicApiKey,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-3-5-sonnet-20241022",max_tokens:2e3,messages:[{role:"user",content:s}]})}),r=(await i.json()).content[0].text;try{return JSON.parse(r)}catch(n){return this.extractDataLocally(e,t)}}catch(s){return console.error("[AI] Erro ao extrair dados:",s),this.extractDataLocally(e,t)}}static buildExtractionPrompt(e,t){const n={edital:["numero_edital","data_publicacao","modalidade","objeto","valor_estimado","data_abertura"],licitacao:["numero_processo","data","vencedor","valor_contratado","modalidade"],ata:["data_assinatura","signatarios","objeto","valor"],contrato:["numero_contrato","data_assinatura","partes","vigencia","valor","objeto"],empenho:["numero_empenho","data","valor","favorecido","descricao"],pagamento:["data_pagamento","valor","beneficiario","numero_nota","referencia"],outro:["informacoes_principais","valores","datas"]},s=n[t]||n.outro;return"Extraia os seguintes campos deste documento ".concat(t,":\n").concat(s.map(e=>"- ".concat(e)).join("\n"),"\n\nDocumento:\n").concat(e.substring(0,3e3),'\n\nResponda em JSON v\xe1lido com os campos extra\xeddos. Se um campo n\xe3o for encontrado, use null.\nExemplo: {"numero_contrato": "123/2024", "valor": 50000.00}')}static extractDataLocally(e,t){const n={},s={cpf:/\d{3}\.\d{3}\.\d{3}-\d{2}/g,cnpj:/\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}/g,valores:/R\$\s*[\d.,]+/g,datas:/\d{2}\/\d{2}\/\d{4}/g,numeros:/[N\xba#]\s*(\d+)/g};for(const[i,r]of Object.entries(s)){const t=e.match(r);t&&(n[i]=t.slice(0,5))}return n}static async generateSuggestions(e,t,n){const s=[];for(const[i,r]of Object.entries(t))r&&Array.isArray(r)&&r.length>0?s.push({field:i,value:String(r[0]),confidence:.85}):r&&null!==r&&s.push({field:i,value:String(r),confidence:.8});return s.slice(0,10)}static calculateConfidence(e){const t=Object.keys(e).length,n=Object.values(e).filter(e=>null!==e).length;return t>0?n/t:0}static generateBatchSummary(e){const t=e.reduce((e,t)=>e+t.confidence,0)/Math.max(e.length,1),n=e.reduce((e,t)=>e+t.suggestedFields.length,0);return{totalFiles:e.length,processedFiles:e.filter(e=>e.confidence>0).length,extractedDocuments:e,summary:{estimatedCompleteness:t,suggestedNextSteps:["Revisar campos extra\xeddos automaticamente",n>0?"".concat(n," campos sugeridos para preenchimento"):"Nenhuma sugest\xe3o autom\xe1tica dispon\xedvel","Validar dados cr\xedticos antes de enviar"],warnings:t<.5?["Baixa confian\xe7a na extra\xe7\xe3o. Revise manualmente os dados extra\xeddos."]:[]}}}}SC.anthropicApiKey={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"sua_chave_aqui",REACT_APP_OCR_API:"http://localhost:8000",REACT_APP_API_TIMEOUT:"60000"}.REACT_APP_ANTHROPIC_API_KEY,SC.openaiApiKey={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"sua_chave_aqui",REACT_APP_OCR_API:"http://localhost:8000",REACT_APP_API_TIMEOUT:"60000"}.REACT_APP_OPENAI_API_KEY;const AC=SC,CC=t=>{let{onDocumentsProcessed:n,onApplySuggestions:s,formData:i}=t;const[r,o]=(0,e.useState)([]),[a,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)(null),p=(0,e.useRef)(null);return(0,L.jsxs)("div",{className:"w-full bg-white rounded-lg shadow-lg border border-slate-200 p-6",children:[(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"\ud83d\udcc4 Importar M\xfaltiplos PDFs"}),(0,L.jsx)("p",{className:"text-sm text-slate-500",children:"Envie v\xe1rios PDFs e deixe a IA ajudar no preenchimento autom\xe1tico"})]}),c?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,L.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,L.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[c.processedFiles,"/",c.totalFiles]}),(0,L.jsx)("div",{className:"text-xs text-blue-700 font-bold",children:"Arquivos Processados"})]}),(0,L.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[(0,L.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(100*c.summary.estimatedCompleteness),"%"]}),(0,L.jsx)("div",{className:"text-xs text-green-700 font-bold",children:"Completude Estimada"})]}),(0,L.jsxs)("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[(0,L.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:c.extractedDocuments.reduce((e,t)=>e+t.suggestedFields.length,0)}),(0,L.jsx)("div",{className:"text-xs text-purple-700 font-bold",children:"Sugest\xf5es Dispon\xedveis"})]})]}),c.summary.warnings.length>0&&(0,L.jsxs)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg mb-6",children:[(0,L.jsx)("h4",{className:"font-bold text-yellow-700 mb-2",children:"\u26a0\ufe0f Avisos:"}),(0,L.jsx)("ul",{className:"space-y-1",children:c.summary.warnings.map((e,t)=>(0,L.jsxs)("li",{className:"text-sm text-yellow-800",children:["\u2022 ",e]},t))})]}),(0,L.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg mb-6",children:[(0,L.jsx)("h4",{className:"font-bold text-green-700 mb-2",children:"\u2713 Pr\xf3ximos Passos:"}),(0,L.jsx)("ol",{className:"space-y-1 list-decimal list-inside",children:c.summary.suggestedNextSteps.map((e,t)=>(0,L.jsx)("li",{className:"text-sm text-green-800",children:e},t))})]})]}),(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("h3",{className:"font-bold text-slate-700 mb-3",children:"\ud83d\udccb Documentos Extra\xeddos:"}),(0,L.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:c.extractedDocuments.map((e,t)=>(0,L.jsxs)("button",{onClick:()=>h(e),className:"p-3 rounded-lg border-2 text-left transition ".concat((null===u||void 0===u?void 0:u.filename)===e.filename?"border-blue-600 bg-blue-50":"border-slate-200 bg-white hover:border-slate-300"),children:[(0,L.jsx)("div",{className:"font-bold text-slate-700 text-sm truncate",children:e.filename}),(0,L.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:[(0,L.jsx)("span",{className:"inline-block px-2 py-0.5 bg-slate-100 rounded mr-2",children:e.type}),(0,L.jsxs)("span",{children:[Math.round(100*e.confidence),"% confian\xe7a"]})]})]},t))})]}),u&&(0,L.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[(0,L.jsxs)("h4",{className:"font-bold text-slate-700 mb-3",children:["Sugest\xf5es para: ",u.filename]}),u.suggestedFields.length>0?(0,L.jsx)("div",{className:"space-y-2",children:u.suggestedFields.map((e,t)=>(0,L.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded border border-slate-200 hover:border-blue-300 transition",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:"font-bold text-slate-700 text-sm",children:e.field}),(0,L.jsx)("div",{className:"text-sm text-slate-600 font-mono",children:e.value}),(0,L.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:["Confian\xe7a: ",Math.round(100*e.confidence),"%"]})]}),(0,L.jsx)("button",{onClick:()=>{return t=e.field,n=e.value,s(t,n),void alert("Campo '".concat(t,"' preenchido com: ").concat(n));var t,n},className:"px-3 py-1 bg-blue-600 text-white rounded text-xs font-bold hover:bg-blue-700 transition whitespace-nowrap ml-2",children:"\u2713 Usar"})]},t))}):(0,L.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhuma sugest\xe3o dispon\xedvel para este documento."})]}),(0,L.jsx)("div",{className:"mt-6",children:(0,L.jsx)("button",{onClick:()=>{d(null),o([]),h(null),p.current&&(p.current.value="")},className:"w-full px-4 py-2 bg-slate-200 text-slate-700 rounded-lg font-bold hover:bg-slate-300 transition",children:"\u2190 Voltar e Importar Novos PDFs"})})]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files).filter(e=>"application/pdf"===e.type);o(t)},className:"border-2 border-dashed border-blue-300 rounded-lg p-8 text-center bg-blue-50 mb-4 hover:bg-blue-100 transition cursor-pointer",children:[(0,L.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udcc1"}),(0,L.jsx)("p",{className:"font-bold text-slate-700 mb-1",children:"Arraste PDFs aqui"}),(0,L.jsx)("p",{className:"text-sm text-slate-500",children:"ou clique para selecionar"}),(0,L.jsx)("input",{ref:p,type:"file",multiple:!0,accept:".pdf",onChange:e=>{const t=Array.from(e.target.files||[]).filter(e=>"application/pdf"===e.type);0!==t.length?o(t):alert("Por favor, selecione apenas arquivos PDF")},className:"hidden"}),(0,L.jsx)("button",{onClick:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.click()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition",children:"Selecionar PDFs"})]}),r.length>0&&(0,L.jsxs)("div",{className:"mb-4",children:[(0,L.jsxs)("h3",{className:"font-bold text-slate-700 mb-2",children:["Arquivos Selecionados (",r.length,"):"]}),(0,L.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,L.jsxs)("div",{className:"flex items-center gap-3 p-2 bg-slate-50 rounded border border-slate-200",children:[(0,L.jsx)("span",{className:"text-lg",children:"\ud83d\udcc4"}),(0,L.jsx)("span",{className:"flex-1 text-sm text-slate-700 font-medium",children:e.name}),(0,L.jsxs)("span",{className:"text-xs text-slate-500",children:[(e.size/1024).toFixed(1)," KB"]}),(0,L.jsx)("button",{onClick:()=>o(r.filter((e,n)=>n!==t)),className:"text-red-600 hover:text-red-700 font-bold",children:"\u2715"})]},t))})]}),(0,L.jsx)("button",{onClick:async()=>{if(0!==r.length){l(!0);try{const e=await AC.processBatchPDFs(r);d(e),n(e),e.extractedDocuments.length>0&&h(e.extractedDocuments[0])}catch(e){alert("Erro ao processar PDFs: ".concat(e.message))}finally{l(!1)}}else alert("Selecione pelo menos um arquivo PDF")},disabled:0===r.length||a,className:"w-full h-11 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{className:"animate-spin",children:"\u23f3"}),"Processando com IA..."]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{children:"\ud83d\ude80"}),"Processar ",r.length," PDF(s) com IA"]})})]})]})},kC=t=>{let{formData:n,userId:s="anonymous"}=t;const[i,r]=(0,e.useState)(!1),o=(0,e.useMemo)(()=>uC(n),[n]),a={totalErrors:o.errors.length,totalWarnings:o.warnings.length,isValid:o.isValid,completeness:Object.keys(o.summary.sections).length},l=o.errors.reduce((e,t)=>{const n=t.section||"Geral";return e[n]||(e[n]=[]),e[n].push(t),e},{});return(0,L.jsxs)("div",{className:"w-full bg-white rounded-lg shadow-lg border border-slate-200 p-6",children:[(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"\u2713 Valida\xe7\xe3o da Presta\xe7\xe3o de Contas"}),(0,L.jsx)("p",{className:"text-sm text-slate-500",children:"Sistema autom\xe1tico de valida\xe7\xe3o com sugest\xf5es de corre\xe7\xe3o"})]}),(0,L.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,L.jsxs)("div",{className:"p-4 rounded-lg border-l-4 ".concat(a.isValid?"bg-green-50 border-green-500":"bg-red-50 border-red-500"),children:[(0,L.jsx)("div",{className:"text-xs font-bold uppercase text-slate-600 mb-1",children:"Status"}),(0,L.jsx)("div",{className:"text-2xl font-bold ".concat(a.isValid?"text-green-600":"text-red-600"),children:a.isValid?"\u2705 OK":"\u274c Erros"})]}),(0,L.jsxs)("div",{className:"p-4 rounded-lg bg-red-50 border-l-4 border-red-500",children:[(0,L.jsx)("div",{className:"text-xs font-bold uppercase text-slate-600 mb-1",children:"Erros"}),(0,L.jsx)("div",{className:"text-2xl font-bold text-red-600",children:a.totalErrors})]}),(0,L.jsxs)("div",{className:"p-4 rounded-lg bg-yellow-50 border-l-4 border-yellow-500",children:[(0,L.jsx)("div",{className:"text-xs font-bold uppercase text-slate-600 mb-1",children:"Avisos"}),(0,L.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:a.totalWarnings})]}),(0,L.jsxs)("div",{className:"p-4 rounded-lg bg-blue-50 border-l-4 border-blue-500",children:[(0,L.jsx)("div",{className:"text-xs font-bold uppercase text-slate-600 mb-1",children:"Se\xe7\xf5es"}),(0,L.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:a.completeness})]})]}),!a.isValid&&(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,L.jsx)("span",{className:"text-sm font-bold text-slate-700",children:"Corre\xe7\xe3o necess\xe1ria"}),(0,L.jsxs)("span",{className:"text-sm font-bold text-slate-600",children:[Math.round((a.completeness-a.totalErrors)/a.completeness*100),"%"]})]}),(0,L.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-3 overflow-hidden",children:(0,L.jsx)("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 h-full transition-all",style:{width:"".concat(Math.max(5,(a.completeness-a.totalErrors)/a.completeness*100),"%")}})})]}),a.totalErrors>0&&(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsxs)("button",{onClick:()=>r(!i),className:"w-full flex items-center justify-between p-4 bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{className:"text-xl",children:"\ud83d\udd34"}),(0,L.jsxs)("span",{className:"font-bold text-red-700",children:[a.totalErrors," Erro(s) Encontrado(s)"]})]}),(0,L.jsx)("span",{className:"text-slate-500",children:i?"\u25bc":"\u25b6"})]}),i&&(0,L.jsx)("div",{className:"mt-4 space-y-4",children:Object.entries(l).map(e=>{let[t,n]=e;return(0,L.jsxs)("div",{className:"border-l-4 border-red-500 pl-4",children:[(0,L.jsxs)("h4",{className:"font-bold text-slate-700 mb-2",children:["\ud83d\udccb ",t]}),(0,L.jsx)("ul",{className:"space-y-1",children:n.map((e,t)=>(0,L.jsxs)("li",{className:"text-sm text-slate-600 bg-red-50 p-2 rounded",children:[(0,L.jsxs)("strong",{children:[e.field,":"]})," ",e.message]},t))})]},t)})})]}),a.totalWarnings>0&&(0,L.jsxs)("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,L.jsx)("span",{className:"text-xl",children:"\u26a0\ufe0f"}),(0,L.jsxs)("span",{className:"font-bold text-yellow-700",children:[a.totalWarnings," Aviso(s)"]})]}),(0,L.jsx)("ul",{className:"space-y-1",children:o.warnings.slice(0,5).map((e,t)=>(0,L.jsxs)("li",{className:"text-sm text-yellow-800",children:["\u2022 ",e.message]},t))})]}),a.isValid&&(0,L.jsx)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{className:"text-2xl",children:"\u2705"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("h4",{className:"font-bold text-green-700",children:"Valida\xe7\xe3o Conclu\xedda!"}),(0,L.jsx)("p",{className:"text-sm text-green-600",children:"Nenhum erro encontrado. Sistema pronto para transmiss\xe3o."})]})]})}),(0,L.jsxs)("div",{className:"flex gap-3",children:[(0,L.jsxs)("button",{onClick:()=>{v.logValidation(!a.isValid,a.totalErrors,s)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition flex items-center justify-center gap-2",children:[(0,L.jsx)("span",{children:"\ud83d\udcca"})," Registrar Valida\xe7\xe3o"]}),(0,L.jsx)("button",{onClick:()=>r(!i),className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg font-bold hover:bg-slate-300 transition",children:i?"Ocultar Detalhes":"Ver Detalhes"})]}),(0,L.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-200",children:(0,L.jsx)("p",{className:"text-xs text-slate-500",children:"\u2139\ufe0f Valida\xe7\xe3o autom\xe1tica baseada em 20+ regras de neg\xf3cio. Para altera\xe7\xf5es, revise os campos indicados acima."})})]})},TC=()=>{const[t,n]=(0,e.useState)("dashboard"),[s,i]=(0,e.useState)(l),[r,o]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[m,v]=(0,e.useState)(null),[b,y]=(0,e.useState)(null),_=(0,e.useMemo)(()=>N(s),[s]),[S,A]=(0,e.useState)(!1),[C,k]=(0,e.useState)(null),[T,I]=(0,e.useState)("piloto"),[P,R]=(0,e.useState)(""),[M,O]=(0,e.useState)("form"),D=(0,e.useRef)(C);(0,e.useEffect)(()=>{D.current=C},[C]),(0,e.useEffect)(()=>{try{if(f()){A(!0),k(p());const t=localStorage.getItem("audesp_draft");if(t)try{i(JSON.parse(t))}catch(e){}}else{if("undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||window.location.hostname.includes("10.0"))||localStorage.getItem("audesp_demo_mode")){A(!0),k("demo-token-dev"),I("piloto"),setAuthEmail("usuario.demo@example.com"),localStorage.setItem("audesp_demo_mode","true");const e=localStorage.getItem("audesp_draft");if(e)try{i(JSON.parse(e))}catch(t){}}else F()}}catch(n){console.error("Auth initialization error:",n),A(!0),k("demo-token-recovery"),I("piloto"),setAuthEmail("usuario.demo@example.com")}},[]);const j=function(e){v({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"}),setTimeout(()=>v(null),5e3)},F=()=>{sessionStorage.clear(),k(null),A(!1),R(""),I("piloto"),O("form")},B=(e,t,s)=>{k(e),I(t),R(s),A(!0),n("dashboard"),O("form"),j("Login no ambiente ".concat(t," realizado com sucesso!"),"success");const r=localStorage.getItem("audesp_draft");if(r)try{i(JSON.parse(r))}catch(o){}},V=e=>{j(e,"error")},W=()=>{try{((e,t)=>{const n=JSON.stringify(e,null,2),s=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(s),r="prestacao_".concat(e.descritor.entidade,"_").concat(e.descritor.mes,"_").concat(e.descritor.ano,".json"),o=document.createElement("a");o.href=i,o.download=t||r,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)})(s),j("Arquivo JSON baixado com sucesso!","success")}catch(e){j("Erro ao gerar arquivo.","error")}},H=(e,t)=>{"string"===typeof e?i(n=>{const s=JSON.parse(JSON.stringify(n)),i=e.split(".");let r=s;for(let e=0;e<i.length-1;e++)r=r[i[e]]=r[i[e]]||{};return r[i[i.length-1]]=t,s}):console.error("CRITICAL: updateField received invalid path. Ignoring.",e,t)},q=(e,t)=>{"string"===typeof e?i(n=>{const s=JSON.parse(JSON.stringify(n)),i=e.split(".");let r=s;for(let e=0;e<i.length-1;e++)r=r[i[e]]=r[i[e]]||{};const o=i[i.length-1];return Array.isArray(r[o])||(r[o]=[]),r[o].push(t),s}):console.error("CRITICAL: addItem received invalid path.",e)},z=(e,t,n,s)=>{"string"===typeof e?i(i=>{const r=JSON.parse(JSON.stringify(i)),o=e.split(".");let a=r;for(let e=0;e<o.length;e++)a=a[o[e]];if(Array.isArray(a)&&a[t]){const e=n.split(".");let i=a[t];for(let t=0;t<e.length-1;t++)i=i[e[t]]=i[e[t]]||{};i[e[e.length-1]]=s}return r}):console.error("CRITICAL: updateItem received invalid path.",e)},G=(e,t)=>{"string"===typeof e&&i(n=>{const s=JSON.parse(JSON.stringify(n)),i=e.split(".");let r=s;for(let e=0;e<i.length-1;e++)r=r[i[e]];const o=i[i.length-1];return Array.isArray(r[o])&&r[o].splice(t,1),s})};if(!S)return(0,L.jsx)("div",{className:"flex items-center justify-center h-screen bg-slate-100",children:(0,L.jsx)(EC,{onLoginSuccess:B,onError:V})});console.log("[App] Renderizando com isLoggedIn:",S,"activeSection:",t);const K=()=>(0,L.jsxs)("div",{className:"flex gap-2 border-b border-slate-200 mb-6 bg-white rounded-t-lg p-4",children:[(0,L.jsx)("button",{onClick:()=>O("form"),className:"px-6 py-3 font-semibold rounded-t-lg transition-all ".concat("form"===M?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:text-slate-900 border-b-2 border-transparent hover:border-blue-400"),children:"\ud83d\udccb Formul\xe1rio"}),(0,L.jsx)("button",{onClick:()=>O("pdf"),className:"px-6 py-3 font-semibold rounded-t-lg transition-all ".concat("pdf"===M?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:text-slate-900 border-b-2 border-transparent hover:border-blue-400"),children:"\ud83d\udcc4 PDFs (IA)"}),(0,L.jsx)("button",{onClick:()=>O("validation"),className:"px-6 py-3 font-semibold rounded-t-lg transition-all ".concat("validation"===M?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:text-slate-900 border-b-2 border-transparent hover:border-blue-400"),children:"\u2713 Valida\xe7\xe3o"})]});return(0,L.jsxs)("div",{className:"flex bg-slate-50 min-h-screen font-sans text-slate-900",children:[(0,L.jsx)(U,{activeSection:t,setActiveSection:n,onTransmit:()=>{d(!0),setTransmissionStatus("processing"),o(["Iniciando processo de transmiss\xe3o..."]),y(null),setTimeout(async()=>{try{if(!f()||!D.current)throw new Error("Sess\xe3o expirada. Fa\xe7a login novamente.");o(e=>[...e,"Validando estrutura de dados..."]);const e=function(e){const t=N(e),n=[];return Object.values(t).forEach(e=>{"invalid"===e.status&&e.errors.forEach(t=>n.push("[Se\xe7\xe3o ".concat(e.id,"] ").concat(t)))}),[].forEach(e=>n.push("[Consist\xeancia] ".concat(e))),n}(s);o(e=>[...e,"Verificando consist\xeancia cont\xe1bil (cross-check)..."]);const t=[];if(e.length>0||t.length>0)return setTransmissionStatus("error"),void o(["ERRO DE VALIDA\xc7\xc3O LOCAL:",...e,...t]);o(e=>[...e,"Valida\xe7\xe3o OK. Enviando JSON para API Piloto Audesp..."]);const n=await async function(e,t,n){const s=t.descritor.tipo_documento,i=E[s];if(!i)throw new Error("Tipo de documento n\xe3o mapeado: ".concat(s));const r="".concat(w).concat(i);console.log("[Transmission] Enviando para: ".concat(r)),console.log("[Transmission] Token prefix: ".concat(e.substring(0,20),"..."));const o=t,l=new FormData,c=new Blob([JSON.stringify(o)],{type:"application/json"});l.append("documentoJSON",c,"prestacao_".concat(t.descritor.entidade,"_").concat(t.descritor.mes,"_").concat(t.descritor.ano,".json"));try{const t=new AbortController,i=setTimeout(()=>t.abort(),3e4),o={method:"POST",headers:a({Authorization:"Bearer ".concat(e),Accept:"application/json"},n&&{"X-User-CPF":n}),body:l,credentials:"include",signal:t.signal};let c;console.log("[Transmission] Request headers:",{Authorization:"Bearer ".concat(e.substring(0,20),"..."),Accept:"application/json","Content-Type":"multipart/form-data (auto)"}),console.log("[Transmission] Endpoint: ".concat(r)),console.log("[Transmission] Method: POST"),console.log("[Transmission] Environment: ".concat("production"));try{c=await fetch(r,o)}finally{clearTimeout(i)}const d=await c.text();let u;console.log("[Transmission] Status: ".concat(c.status)),console.log("[Transmission] Response headers:",{"content-type":c.headers.get("content-type"),"access-control-allow-origin":c.headers.get("access-control-allow-origin")});try{u=JSON.parse(d)}catch(f){throw new Error("Erro n\xe3o-JSON do servidor (".concat(c.status,"): ").concat(d.substring(0,100)))}if(!c.ok){const t=JSON.stringify(u,null,2);throw 403===c.status&&console.error("[Transmission] 403 Forbidden - Verificar:\n1. Token de autentica\xe7\xe3o v\xe1lido: ".concat(e?"SIM":"N\xc3O","\n2. Permiss\xf5es do usu\xe1rio no Audesp Piloto\n3. Endpoint correto: ").concat(r,"\n4. CORS configurado no servidor")),new Error(t)}return u.protocolo&&(g({protocolo:u.protocolo,dataHora:u.dataHora,status:u.status,tipoDocumento:u.tipoDocumento}),x.logTransmission({protocolo:u.protocolo,status:"success",tipoDocumento:s,timestamp:(new Date).toISOString(),endpoint:r})),u}catch(m){var d,u,h,p;console.error("[Transmission Error]",m),x.logTransmission({status:"error",tipoDocumento:s,timestamp:(new Date).toISOString(),endpoint:r,errorMessage:m.message});let t="";const n=r.includes("/proxy-"),i=r.includes("https://");throw t="AbortError"===m.name?"\u274c TIMEOUT (30s): Servidor n\xe3o respondeu em tempo h\xe1bil\n\u2022 Verifique se https://audesp-piloto.tce.sp.gov.br est\xe1 online\n\u2022 Tente novamente em alguns segundos":null!==(d=m.message)&&void 0!==d&&d.includes("Failed to fetch")?"\u274c ERRO DE CONEX\xc3O (CORS/Network) ".concat(n?"(via proxy - localhost)":i?"(CORS/direct HTTPS)":"(unknown URL)",":\n\u2022 Servidor pode estar indispon\xedvel\n\u2022 Verificar se dom\xednio est\xe1 acess\xedvel: https://audesp-piloto.tce.sp.gov.br\n\u2022 Pode ser bloqueio de CORS do navegador\n\u2022 Tente em produ\xe7\xe3o (n\xe3o localhost)"):null!==(u=m.message)&&void 0!==u&&u.includes("NetworkError")?"\u274c ERRO DE REDE:\n\u2022 Verifique sua conex\xe3o de internet\n\u2022 Tente novamente em alguns segundos\n\u2022 Se persistir, contate o administrador da rede":null!==(h=m.message)&&void 0!==h&&h.includes("TypeError")?"\u274c ERRO DE TIPO/CONFIGURA\xc7\xc3O:\n\u2022 Problema na constru\xe7\xe3o da requisi\xe7\xe3o\n\u2022 Verifique token e formato de dados":"\u274c ERRO DESCONHECIDO: ".concat(m.message),console.error("[Transmission Diagnostic]\n".concat(t)),console.error("[Transmission Debug Info]",{url:r,isProxyURL:n,isDirectURL:i,method:"POST",tokenPrefix:(null===e||void 0===e?void 0:e.substring(0,10))+"...",windowHostname:"undefined"!==typeof window?window.location.hostname:"N/A",environment:"production",errorName:m.name,errorMessage:m.message,errorStack:null===(p=m.stack)||void 0===p?void 0:p.split("\n").slice(0,3).join("\n")}),new Error(t)}}(D.current,s,P);"Rejeitado"===n.status?(setTransmissionStatus("error"),o(e=>[...e,"FALHA: Documento Rejeitado pelo Audesp.","Protocolo: ".concat(n.protocolo)])):"Armazenado"===n.status?(setTransmissionStatus("success"),o(e=>[...e,"ALERTA: Documento Armazenado com Ressalvas.","Protocolo: ".concat(n.protocolo)])):(setTransmissionStatus("success"),o(e=>[...e,"SUCESSO: Documento Recebido.","Protocolo: ".concat(n.protocolo)])),y(n),d(!1)}catch(e){setTransmissionStatus("error");let n=e.message;try{const e=JSON.parse(n);n=JSON.stringify(e,null,2)}catch(t){}o(e=>[...e,"ERRO T\xc9CNICO NA TRANSMISS\xc3O:",n]),(n.includes("401")||n.includes("Unauthorized"))&&setTimeout(()=>F(),3e3)}},500)},onDownload:W,onLoadJson:async e=>{try{const t=await(e=>new Promise((t,n)=>{const s=new FileReader;s.onload=e=>{try{var s;if(null!==(s=e.target)&&void 0!==s&&s.result){const n=JSON.parse(e.target.result);if(!n.descritor)throw new Error("Arquivo inv\xe1lido: Objeto 'descritor' n\xe3o encontrado.");t(n)}else n(new Error("Arquivo vazio ou ileg\xedvel."))}catch(i){n(i)}},s.onerror=()=>{n(new Error("Erro ao ler o arquivo."))},s.readAsText(e)}))(e);i(t),j("Dados carregados com sucesso!","success")}catch(t){j("Erro ao ler arquivo: ".concat(t.message),"error")}},onNew:()=>{window.confirm("Tem certeza? Isso apagar\xe1 todos os dados atuais.")&&(i(l),localStorage.removeItem("audesp_draft"),j("Formul\xe1rio reiniciado.","info"))},onSaveDraft:()=>{localStorage.setItem("audesp_draft",JSON.stringify(s)),j("Rascunho salvo no navegador.","success")},onImportFullPdf:()=>h(!0),sectionStatus:_}),(0,L.jsxs)("main",{className:"flex-1 ml-64 p-8",children:[(0,L.jsxs)("header",{className:"flex justify-between items-center mb-8 bg-white rounded-lg p-6 shadow-sm border border-slate-200",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Presta\xe7\xe3o de Contas"}),(0,L.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:["Audesp Fase V - ","piloto"===T?"\ud83e\uddea Ambiente Piloto":"\ud83d\ude80 Ambiente Produ\xe7\xe3o"," | CPF: ",P]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-4",children:[(0,L.jsx)("div",{className:"text-right",children:(0,L.jsx)("span",{className:"text-xs font-bold px-3 py-1 rounded-full border ".concat("piloto"===T?"bg-blue-50 text-blue-600 border-blue-200":"bg-red-50 text-red-600 border-red-200"),children:"piloto"===T?"\u25cf Piloto (Teste)":"\u25cf Produ\xe7\xe3o (Real)"})}),(0,L.jsx)("button",{onClick:F,className:"text-red-600 font-bold text-sm bg-red-50 hover:bg-red-100 px-4 py-2 rounded transition-colors border border-red-100",children:"SAIR"})]})]}),(0,L.jsxs)("div",{className:"max-w-7xl mx-auto pb-20",children:["dashboard"===t&&(0,L.jsx)(K,{}),"dashboard"===t?(0,L.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200",children:["form"===M&&(0,L.jsx)("div",{className:"p-6",children:(0,L.jsx)(My,{activeSection:t,formData:s,updateField:H,updateItem:z,addItem:q,removeItem:G,handleExtraction:()=>{},handleDownload:W})}),"pdf"===M&&(0,L.jsxs)("div",{className:"p-6",children:[(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"\ud83e\udd16 Processamento de PDFs com IA Avan\xe7ada"}),(0,L.jsx)("p",{className:"text-slate-600",children:"Envie m\xfaltiplos PDFs e deixe o Claude 3.5 Sonnet classificar e extrair dados automaticamente"})]}),(0,L.jsx)(CC,{formData:s,onDocumentsProcessed:e=>{console.log("PDFs processados:",e),j("".concat(e.totalFiles," arquivos processados com sucesso!"),"success")},onApplySuggestions:(e,t)=>{H(e,t),j("Campo ".concat(e," preenchido automaticamente!"),"success")}})]}),"validation"===M&&(0,L.jsx)("div",{className:"p-6",children:(0,L.jsx)(kC,{formData:s,userId:authEmail})})]}):"reports"===t?(0,L.jsx)(vC,{formData:s,setFormData:i,userId:authEmail}):(0,L.jsx)(My,{activeSection:t,formData:s,updateField:H,updateItem:z,addItem:q,removeItem:G,handleExtraction:()=>{},handleDownload:W})]})]}),m&&(0,L.jsx)("div",{className:"fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-xl border-l-4 animate-in fade-in slide-in-from-right ".concat("error"===m.type?"bg-white border-red-500 text-red-700":"success"===m.type?"bg-white border-green-500 text-green-700":"bg-white border-blue-500 text-blue-700"),children:(0,L.jsx)("p",{className:"font-semibold",children:m.message})}),u&&(0,L.jsx)(sC,{onDataMerge:e=>{i(t=>{const n=a({},t);return e.relacao_empregados&&(n.relacao_empregados=[...t.relacao_empregados||[],...e.relacao_empregados]),e.contratos&&(n.contratos=[...t.contratos||[],...e.contratos]),e.documentos_fiscais&&(n.documentos_fiscais=[...t.documentos_fiscais||[],...e.documentos_fiscais]),e.pagamentos&&(n.pagamentos=[...t.pagamentos||[],...e.pagamentos]),e.empenhos&&(n.empenhos=[...t.empenhos||[],...e.empenhos]),e.descritor&&e.descritor.ano&&(n.descritor=a(a({},t.descritor),e.descritor)),n}),h(!1),j("Dados importados e mesclados com sucesso!","success")},onCancel:()=>h(!1)}),c&&!b&&(0,L.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl overflow-hidden",children:[(0,L.jsx)("div",{className:"p-4 border-b flex justify-between bg-slate-50",children:(0,L.jsx)("h3",{className:"font-bold text-slate-800",children:"Processando Transmiss\xe3o..."})}),(0,L.jsx)("div",{className:"p-6 bg-slate-900 text-green-400 font-mono text-xs h-80 overflow-y-auto whitespace-pre-wrap",children:r.join("\n")})]})}),b&&(0,L.jsx)(oC,{result:b,onClose:()=>y(null)})]})},NC=document.getElementById("root");if(!NC)throw new Error("Could not find root element to mount to");t.createRoot(NC).render((0,L.jsx)(e.StrictMode,{children:(0,L.jsx)(TC,{})}))})()})();
//# sourceMappingURL=main.af82da80.js.map