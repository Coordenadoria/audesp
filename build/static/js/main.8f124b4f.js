/*! For license information please see main.8f124b4f.js.LICENSE.txt */
(()=>{var e={122(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,s,r;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(s=i;0!==s--;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(s=i;0!==s--;)if(!Object.prototype.hasOwnProperty.call(n,r[s]))return!1;for(s=i;0!==s--;){var o=r[s];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},138(e,t,n){"use strict";var i,s,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const l=n(8584),c=n(9207),u=n(1762),d=n(9550),h=n(8396),p={keyword:"discriminator",type:"object",schemaType:"object",error:{message:e=>{let{params:{discrError:t,tagName:n}}=e;return t===c.DiscrError.Tag?'tag "'.concat(n,'" must be string'):'value of tag "'.concat(n,'" must be in oneOf')},params:e=>{let{params:{discrError:t,tag:n,tagName:s}}=e;return(0,l._)(i||(i=a(["{error: ",", tag: ",", tagValue: ","}"])),t,s,n)}},code(e){const{gen:t,data:n,schema:i,parentSchema:p,it:f}=e,{oneOf:m}=p;if(!f.opts.discriminator)throw new Error("discriminator: requires discriminator option");const g=i.propertyName;if("string"!=typeof g)throw new Error("discriminator: requires propertyName");if(i.mapping)throw new Error("discriminator: mapping is not supported");if(!m)throw new Error("discriminator: requires oneOf keyword");const v=t.let("valid",!1),y=t.const("tag",(0,l._)(s||(s=a(["","",""])),n,(0,l.getProperty)(g)));function b(n){const i=t.name("valid"),s=e.subschema({keyword:"oneOf",schemaProp:n},i);return e.mergeEvaluated(s,l.Name),i}t.if((0,l._)(r||(r=a(["typeof ",' == "string"'])),y),()=>function(){const n=function(){var e;const t={},n=s(p);let i=!0;for(let a=0;a<m.length;a++){let t=m[a];if((null===t||void 0===t?void 0:t.$ref)&&!(0,h.schemaHasRulesButRef)(t,f.self.RULES)){const e=t.$ref;if(t=u.resolveRef.call(f.self,f.schemaEnv.root,f.baseId,e),t instanceof u.SchemaEnv&&(t=t.schema),void 0===t)throw new d.default(f.opts.uriResolver,f.baseId,e)}const o=null===(e=null===t||void 0===t?void 0:t.properties)||void 0===e?void 0:e[g];if("object"!=typeof o)throw new Error('discriminator: oneOf subschemas (or referenced schemas) must have "properties/'.concat(g,'"'));i=i&&(n||s(t)),r(o,a)}if(!i)throw new Error('discriminator: "'.concat(g,'" must be required'));return t;function s(e){let{required:t}=e;return Array.isArray(t)&&t.includes(g)}function r(e,t){if(e.const)o(e.const,t);else{if(!e.enum)throw new Error('discriminator: "properties/'.concat(g,'" must have "const" or "enum"'));for(const n of e.enum)o(n,t)}}function o(e,n){if("string"!=typeof e||e in t)throw new Error('discriminator: "'.concat(g,'" values must be unique strings'));t[e]=n}}();t.if(!1);for(const e in n)t.elseIf((0,l._)(o||(o=a([""," === ",""])),y,e)),t.assign(v,b(n[e]));t.else(),e.error(!1,{discrError:c.DiscrError.Mapping,tag:y,tagName:g}),t.endIf()}(),()=>e.error(!1,{discrError:c.DiscrError.Tag,tag:y,tagName:g})),e.ok(v)}};t.default=p},166(e){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.__esModule=!0,e.exports.default=e.exports},266(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8584),s={data:new i.Name("data"),valCxt:new i.Name("valCxt"),instancePath:new i.Name("instancePath"),parentData:new i.Name("parentData"),parentDataProperty:new i.Name("parentDataProperty"),rootData:new i.Name("rootData"),dynamicAnchors:new i.Name("dynamicAnchors"),vErrors:new i.Name("vErrors"),errors:new i.Name("errors"),this:new i.Name("this"),self:new i.Name("self"),scope:new i.Name("scope"),json:new i.Name("json"),jsonPos:new i.Name("jsonPos"),jsonLen:new i.Name("jsonLen"),jsonPart:new i.Name("jsonPart")};t.default=s},463(e,t,n){"use strict";var i,s,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const l=n(8584),c=n(8396);function u(e,t,n){const{gen:u,compositeRule:d,data:h,opts:p}=e;if(void 0===n)return;const f=(0,l._)(i||(i=a(["","",""])),h,(0,l.getProperty)(t));if(d)return void(0,c.checkStrictMode)(e,"default is ignored for: ".concat(f));let m=(0,l._)(s||(s=a([""," === undefined"])),f);"empty"===p.useDefaults&&(m=(0,l._)(r||(r=a([""," || "," === null || ",' === ""'])),m,f,f)),u.if(m,(0,l._)(o||(o=a([""," = ",""])),f,(0,l.stringify)(n)))}t.assignDefaults=function(e,t){const{properties:n,items:i}=e.schema;if("object"===t&&n)for(const s in n)u(e,s,n[s].default);else"array"===t&&Array.isArray(i)&&i.forEach((t,n)=>u(e,n,t.default))}},483(e,t,n){"use strict";var i,s=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const r=n(2215),o=n(7864),a=n(8584),l=new a.Name("fullFormats"),c=new a.Name("fastFormats"),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keywords:!0};if(Array.isArray(t))return d(e,t,r.fullFormats,l),e;const[n,i]="fast"===t.mode?[r.fastFormats,c]:[r.fullFormats,l];return d(e,t.formats||r.formatNames,n,i),t.keywords&&o.default(e),e};function d(e,t,n,r){var o,l;null!==(o=(l=e.opts.code).formats)&&void 0!==o||(l.formats=a._(i||(i=s(['require("ajv-formats/dist/formats").',""])),r));for(const i of t)e.addFormat(i,n[i])}u.get=function(e){const t=("fast"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full")?r.fastFormats:r.fullFormats)[e];if(!t)throw new Error('Unknown format "'.concat(e,'"'));return t},e.exports=t=u,Object.defineProperty(t,"__esModule",{value:!0}),t.default=u},579(e,t,n){"use strict";e.exports=n(1153)},656(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const b=n(8584),w=n(8396),_=n(266),x=n(8396);function E(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,b._)(r||(r=y(["Object.prototype.hasOwnProperty"])))})}function S(e,t,n){return(0,b._)(o||(o=y(["",".call(",", ",")"])),E(e),t,n)}function A(e,t,n,i){const s=(0,b._)(c||(c=y(["",""," === undefined"])),t,(0,b.getProperty)(n));return i?(0,b.or)(s,(0,b.not)(S(e,t,n))):s}function C(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}t.checkReportMissingProp=function(e,t){const{gen:n,data:s,it:r}=e;n.if(A(n,s,t,r.opts.ownProperties),()=>{e.setParams({missingProperty:(0,b._)(i||(i=y(["",""])),t)},!0),e.error()})},t.checkMissingProp=function(e,t,n){let{gen:i,data:r,it:{opts:o}}=e;return(0,b.or)(...t.map(e=>(0,b.and)(A(i,r,e,o.ownProperties),(0,b._)(s||(s=y([""," = ",""])),n,e))))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.hasPropFunc=E,t.isOwnProperty=S,t.propertyInData=function(e,t,n,i){const s=(0,b._)(a||(a=y(["",""," !== undefined"])),t,(0,b.getProperty)(n));return i?(0,b._)(l||(l=y([""," && ",""])),s,S(e,t,n)):s},t.noPropertyInData=A,t.allSchemaProperties=C,t.schemaProperties=function(e,t){return C(t).filter(n=>!(0,w.alwaysValidSchema)(e,t[n]))},t.callValidateCode=function(e,t,n,i){let{schemaCode:s,data:r,it:{gen:o,topSchemaRef:a,schemaPath:l,errorPath:c},it:f}=e;const m=i?(0,b._)(u||(u=y(["",", ",", ","",""])),s,r,a,l):r,g=[[_.default.instancePath,(0,b.strConcat)(_.default.instancePath,c)],[_.default.parentData,f.parentData],[_.default.parentDataProperty,f.parentDataProperty],[_.default.rootData,_.default.rootData]];f.opts.dynamicRef&&g.push([_.default.dynamicAnchors,_.default.dynamicAnchors]);const v=(0,b._)(d||(d=y(["",", ",""])),m,o.object(...g));return n!==b.nil?(0,b._)(h||(h=y(["",".call(",", ",")"])),t,n,v):(0,b._)(p||(p=y(["","(",")"])),t,v)};const T=(0,b._)(f||(f=y(["new RegExp"])));t.usePattern=function(e,t){let{gen:n,it:{opts:i}}=e;const s=i.unicodeRegExp?"u":"",{regExp:r}=i.code,o=r(t,s);return n.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,b._)(m||(m=y(["","(",", ",")"])),"new RegExp"===r.code?T:(0,x.useFunc)(n,r),t,s)})},t.validateArray=function(e){const{gen:t,data:n,keyword:i,it:s}=e,r=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return o(()=>t.assign(e,!1)),e}return t.var(r,!0),o(()=>t.break()),r;function o(s){const o=t.const("len",(0,b._)(g||(g=y(["",".length"])),n));t.forRange("i",0,o,n=>{e.subschema({keyword:i,dataProp:n,dataPropType:w.Type.Num},r),t.if((0,b.not)(r),s)})}},t.validateUnion=function(e){const{gen:t,schema:n,keyword:i,it:s}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(e=>(0,w.alwaysValidSchema)(s,e))&&!s.opts.unevaluated)return;const r=t.let("valid",!1),o=t.name("_valid");t.block(()=>n.forEach((n,s)=>{const a=e.subschema({keyword:i,schemaProp:s,compositeRule:!0},o);t.assign(r,(0,b._)(v||(v=y([""," || ",""])),r,o));e.mergeValidEvaluated(a,o)||t.if((0,b.not)(r))})),e.result(r,()=>e.reset(),()=>e.error(!0))}},667(e){"use strict";var t=e.exports=function(e,t,i){"function"==typeof t&&(i=t,t={}),n(t,"function"==typeof(i=t.cb||i)?i:i.pre||function(){},i.post||function(){},e,"",e)};function n(e,s,r,o,a,l,c,u,d,h){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var p in s(o,a,l,c,u,d,h),o){var f=o[p];if(Array.isArray(f)){if(p in t.arrayKeywords)for(var m=0;m<f.length;m++)n(e,s,r,f[m],a+"/"+p+"/"+m,l,a,p,o,m)}else if(p in t.propsKeywords){if(f&&"object"==typeof f)for(var g in f)n(e,s,r,f[g],a+"/"+p+"/"+i(g),l,a,p,o,g)}else(p in t.keywords||e.allKeys&&!(p in t.skipKeywords))&&n(e,s,r,f,a+"/"+p,l,a,p,o)}r(o,a,l,c,u,d,h)}}function i(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},1011(e,t,n){"use strict";var i,s,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const l=n(656),c=n(8584),u={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:e=>{let{schemaCode:t}=e;return(0,c.str)(i||(i=a(['must match pattern "','"'])),t)},params:e=>{let{schemaCode:t}=e;return(0,c._)(s||(s=a(["{pattern: ","}"])),t)}},code(e){const{data:t,$data:n,schema:i,schemaCode:s,it:u}=e,d=u.opts.unicodeRegExp?"u":"",h=n?(0,c._)(r||(r=a(["(new RegExp(",", ","))"])),s,d):(0,l.usePattern)(e,i);e.fail$data((0,c._)(o||(o=a(["!",".test(",")"])),h,t))}};t.default=u},1153(e,t,n){"use strict";var i=n(5043),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,r={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:s,type:e,key:c,ref:u,props:r,_owner:a.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},1156(e,t,n){"use strict";var i,s,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;const c=n(8584),u=n(8396),d={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:e=>{let{params:{len:t}}=e;return(0,c.str)(i||(i=l(["must NOT have more than "," items"])),t)},params:e=>{let{params:{len:t}}=e;return(0,c._)(s||(s=l(["{limit: ","}"])),t)}},code(e){const{parentSchema:t,it:n}=e,{items:i}=t;Array.isArray(i)?h(e,i):(0,u.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas')}};function h(e,t){const{gen:n,schema:i,data:s,keyword:d,it:h}=e;h.items=!0;const p=n.const("len",(0,c._)(r||(r=l(["",".length"])),s));if(!1===i)e.setParams({len:t.length}),e.pass((0,c._)(o||(o=l([""," <= ",""])),p,t.length));else if("object"==typeof i&&!(0,u.alwaysValidSchema)(h,i)){const i=n.var("valid",(0,c._)(a||(a=l([""," <= ",""])),p,t.length));n.if((0,c.not)(i),()=>function(i){n.forRange("i",t.length,p,t=>{e.subschema({keyword:d,dataProp:t,dataPropType:u.Type.Num},i),h.allErrors||n.if((0,c.not)(i),()=>n.break())})}(i)),e.ok(i)}}t.validateAdditionalItems=h,t.default=d},1289(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=n(8396),c={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:e=>{let{params:t}=e;return(0,a._)(i||(i=o(["{passingSchemas: ","}"])),t.passing)}},code(e){const{gen:t,schema:n,parentSchema:i,it:c}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(c.opts.discriminator&&i.discriminator)return;const u=n,d=t.let("valid",!1),h=t.let("passing",null),p=t.name("_valid");e.setParams({passing:h}),t.block(function(){u.forEach((n,i)=>{let u;(0,l.alwaysValidSchema)(c,n)?t.var(p,!0):u=e.subschema({keyword:"oneOf",schemaProp:i,compositeRule:!0},p),i>0&&t.if((0,a._)(s||(s=o([""," && ",""])),p,d)).assign(d,!1).assign(h,(0,a._)(r||(r=o(["[",", ","]"])),h,i)).else(),t.if(p,()=>{t.assign(d,!0),t.assign(h,i),u&&e.mergeEvaluated(u,a.Name)})})}),e.result(d,()=>e.reset(),()=>e.error(!0))}};t.default=c},1518(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=n(8396),c=n(2979),u={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:e=>{let{schemaCode:t}=e;return(0,a._)(i||(i=o(["{allowedValue: ","}"])),t)}},code(e){const{gen:t,data:n,$data:i,schemaCode:u,schema:d}=e;i||d&&"object"==typeof d?e.fail$data((0,a._)(s||(s=o(["!","(",", ",")"])),(0,l.useFunc)(t,c.default),n,u)):e.fail((0,a._)(r||(r=o([""," !== ",""])),d,n))}};t.default=u},1578(e,t,n){"use strict";const{isUUID:i}=n(6099),s=/([0-9a-z\u017F\u212A][\x2D0-9a-z\u017F\u212A]{0,31}):((?:[!\$'-\.0-;=@-Z_a-z\u017F\u212A]|%[0-9a-f]{2})+)/i,r=["http","https","ws","wss","urn","urn:uuid"];function o(e){return!0===e.secure||!1!==e.secure&&(!!e.scheme&&(3===e.scheme.length&&("w"===e.scheme[0]||"W"===e.scheme[0])&&("s"===e.scheme[1]||"S"===e.scheme[1])&&("s"===e.scheme[2]||"S"===e.scheme[2])))}function a(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function l(e){const t="https"===String(e.scheme).toLowerCase();return e.port!==(t?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}const c={scheme:"http",domainHost:!0,parse:a,serialize:l},u={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=o(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if(e.port!==(o(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"===typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){const[t,n]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=n,e.resourceName=void 0}return e.fragment=void 0,e}},d={http:c,https:{scheme:"https",domainHost:c.domainHost,parse:a,serialize:l},ws:u,wss:{scheme:"wss",domainHost:u.domainHost,parse:u.parse,serialize:u.serialize},urn:{scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;const n=e.path.match(s);if(n){const i=t.scheme||e.scheme||"urn";e.nid=n[1].toLowerCase(),e.nss=n[2];const s=h("".concat(i,":").concat(t.nid||e.nid));e.path=void 0,s&&(e=s.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){if(void 0===e.nid)throw new Error("URN without nid cannot be serialized");const n=t.scheme||e.scheme||"urn",i=e.nid.toLowerCase(),s=h("".concat(n,":").concat(t.nid||i));s&&(e=s.serialize(e,t));const r=e,o=e.nss;return r.path="".concat(i||t.nid,":").concat(o),t.skipEscape=!0,r},skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:function(e,t){const n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&i(n.uuid)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e){const t=e;return t.nss=(e.uuid||"").toLowerCase(),t},skipNormalize:!0}};function h(e){return e&&(d[e]||d[e.toLowerCase()])||void 0}Object.setPrototypeOf(d,null),e.exports={wsIsSecure:o,SCHEMES:d,isValidSchemeName:function(e){return-1!==r.indexOf(e)},getSchemeHandler:h}},1598(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const a=n(8584),l=n(8396),c=n(656);t.error={message:e=>{let{params:{property:t,depsCount:n,deps:s}}=e;const r=1===n?"property":"properties";return(0,a.str)(i||(i=o(["must have "," "," when property "," is present"])),r,s,t)},params:e=>{let{params:{property:t,depsCount:n,deps:i,missingProperty:r}}=e;return(0,a._)(s||(s=o(["{property: ",",\n    missingProperty: ",",\n    depsCount: ",",\n    deps: ","}"])),t,r,n,i)}};const u={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(e){const[t,n]=function(e){let{schema:t}=e;const n={},i={};for(const s in t){if("__proto__"===s)continue;(Array.isArray(t[s])?n:i)[s]=t[s]}return[n,i]}(e);d(e,t),h(e,n)}};function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema;const{gen:n,data:i,it:s}=e;if(0===Object.keys(t).length)return;const l=n.let("missing");for(const u in t){const d=t[u];if(0===d.length)continue;const h=(0,c.propertyInData)(n,i,u,s.opts.ownProperties);e.setParams({property:u,depsCount:d.length,deps:d.join(", ")}),s.allErrors?n.if(h,()=>{for(const t of d)(0,c.checkReportMissingProp)(e,t)}):(n.if((0,a._)(r||(r=o([""," && (",")"])),h,(0,c.checkMissingProp)(e,d,l))),(0,c.reportMissingProp)(e,l),n.else())}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema;const{gen:n,data:i,keyword:s,it:r}=e,o=n.name("valid");for(const a in t)(0,l.alwaysValidSchema)(r,t[a])||(n.if((0,c.propertyInData)(n,i,a,r.opts.ownProperties),()=>{const t=e.subschema({keyword:s,schemaProp:a},o);e.mergeValidEvaluated(t,o)},()=>n.var(o,!0)),e.ok(o))}t.validatePropertyDeps=d,t.validateSchemaDeps=h,t.default=u},1762(e,t,n){"use strict";var i,s,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;const o=n(8584),a=n(6817),l=n(266),c=n(2302),u=n(8396),d=n(5413);class h{constructor(e){var t;let n;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,c.normalizeId)(null===n||void 0===n?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null===n||void 0===n?void 0:n.$async,this.refs={}}}function p(e){const t=m.call(this,e);if(t)return t;const n=(0,c.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:u,lines:h}=this.opts.code,{ownProperties:p}=this.opts,f=new o.CodeGen(this.scope,{es5:u,lines:h,ownProperties:p});let g;e.$async&&(g=f.scopeValue("Error",{ref:a.default,code:(0,o._)(i||(i=r(['require("ajv/dist/runtime/validation_error").default'])))}));const v=f.scopeName("validate");e.validateName=v;const y={gen:f,allErrors:this.opts.allErrors,data:l.default.data,parentData:l.default.parentData,parentDataProperty:l.default.parentDataProperty,dataNames:[l.default.data],dataPathArr:[o.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:f.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,o.stringify)(e.schema)}:{ref:e.schema}),validateName:v,ValidationError:g,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:o.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,o._)(s||(s=r(['""']))),opts:this.opts,self:this};let b;try{this._compilations.add(e),(0,d.validateFunctionCode)(y),f.optimize(this.opts.code.optimize);const t=f.toString();b="".concat(f.scopeRefs(l.default.scope),"return ").concat(t),this.opts.code.process&&(b=this.opts.code.process(b,e));const n=new Function("".concat(l.default.self),"".concat(l.default.scope),b)(this,this.scope.get());if(this.scope.value(v,{ref:n}),n.errors=null,n.schema=e.schema,n.schemaEnv=e,e.$async&&(n.$async=!0),!0===this.opts.code.source&&(n.source={validateName:v,validateCode:t,scopeValues:f._values}),this.opts.unevaluated){const{props:e,items:t}=y;n.evaluated={props:e instanceof o.Name?void 0:e,items:t instanceof o.Name?void 0:t,dynamicProps:e instanceof o.Name,dynamicItems:t instanceof o.Name},n.source&&(n.source.evaluated=(0,o.stringify)(n.evaluated))}return e.validate=n,e}catch(w){throw delete e.validate,delete e.validateName,b&&this.logger.error("Error compiling schema, function code:",b),w}finally{this._compilations.delete(e)}}function f(e){return(0,c.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:p.call(this,e)}function m(e){for(const t of this._compilations)if(g(t,e))return t}function g(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function v(e,t){let n;for(;"string"==typeof(n=this.refs[t]);)t=n;return n||this.schemas[t]||y.call(this,e,t)}function y(e,t){const n=this.opts.uriResolver.parse(t),i=(0,c._getFullPath)(this.opts.uriResolver,n);let s=(0,c.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&i===s)return w.call(this,n,e);const r=(0,c.normalizeId)(i),o=this.refs[r]||this.schemas[r];if("string"==typeof o){const t=y.call(this,e,o);if("object"!==typeof(null===t||void 0===t?void 0:t.schema))return;return w.call(this,n,t)}if("object"===typeof(null===o||void 0===o?void 0:o.schema)){if(o.validate||p.call(this,o),r===(0,c.normalizeId)(t)){const{schema:t}=o,{schemaId:n}=this.opts,i=t[n];return i&&(s=(0,c.resolveUrl)(this.opts.uriResolver,s,i)),new h({schema:t,schemaId:n,root:e,baseId:s})}return w.call(this,n,o)}}t.SchemaEnv=h,t.compileSchema=p,t.resolveRef=function(e,t,n){var i;n=(0,c.resolveUrl)(this.opts.uriResolver,t,n);const s=e.refs[n];if(s)return s;let r=v.call(this,e,n);if(void 0===r){const s=null===(i=e.localRefs)||void 0===i?void 0:i[n],{schemaId:o}=this.opts;s&&(r=new h({schema:s,schemaId:o,root:e,baseId:t}))}return void 0!==r?e.refs[n]=f.call(this,r):void 0},t.getCompilingSchema=m,t.resolveSchema=y;const b=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function w(e,t){let{baseId:n,schema:i,root:s}=t;var r;if("/"!==(null===(r=e.fragment)||void 0===r?void 0:r[0]))return;for(const l of e.fragment.slice(1).split("/")){if("boolean"===typeof i)return;const e=i[(0,u.unescapeFragment)(l)];if(void 0===e)return;i=e;const t="object"===typeof i&&i[this.opts.schemaId];!b.has(l)&&t&&(n=(0,c.resolveUrl)(this.opts.uriResolver,n,t))}let o;if("boolean"!=typeof i&&i.$ref&&!(0,u.schemaHasRulesButRef)(i,this.RULES)){const e=(0,c.resolveUrl)(this.opts.uriResolver,n,i.$ref);o=y.call(this,s,e)}const{schemaId:a}=this.opts;return o=o||new h({schema:i,schemaId:a,root:s,baseId:n}),o.schema!==o.root.schema?o:void 0}},2075(e,t,n){"use strict";var i,s,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const c=n(656),u=n(8584),d=n(266),h=n(8396),p={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:e=>{let{params:t}=e;return(0,u._)(i||(i=l(["{additionalProperty: ","}"])),t.additionalProperty)}},code(e){const{gen:t,schema:n,parentSchema:i,data:p,errsCount:f,it:m}=e;if(!f)throw new Error("ajv implementation error");const{allErrors:g,opts:v}=m;if(m.props=!0,"all"!==v.removeAdditional&&(0,h.alwaysValidSchema)(m,n))return;const y=(0,c.allSchemaProperties)(i.properties),b=(0,c.allSchemaProperties)(i.patternProperties);function w(e){t.code((0,u._)(a||(a=l(["delete ","[","]"])),p,e))}function _(i){if("all"===v.removeAdditional||v.removeAdditional&&!1===n)w(i);else{if(!1===n)return e.setParams({additionalProperty:i}),e.error(),void(g||t.break());if("object"==typeof n&&!(0,h.alwaysValidSchema)(m,n)){const n=t.name("valid");"failing"===v.removeAdditional?(x(i,n,!1),t.if((0,u.not)(n),()=>{e.reset(),w(i)})):(x(i,n),g||t.if((0,u.not)(n),()=>t.break()))}}}function x(t,n,i){const s={keyword:"additionalProperties",dataProp:t,dataPropType:h.Type.Str};!1===i&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,n)}t.forIn("key",p,n=>{y.length||b.length?t.if(function(n){let s;if(y.length>8){const e=(0,h.schemaRefOrVal)(m,i.properties,"properties");s=(0,c.isOwnProperty)(t,e,n)}else s=y.length?(0,u.or)(...y.map(e=>(0,u._)(r||(r=l([""," === ",""])),n,e))):u.nil;return b.length&&(s=(0,u.or)(s,...b.map(t=>(0,u._)(o||(o=l(["",".test(",")"])),(0,c.usePattern)(e,t),n)))),(0,u.not)(s)}(n),()=>_(n)):_(n)}),e.ok((0,u._)(s||(s=l([""," === ",""])),f,d.default.errors))}};t.default=p},2079(e){"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},2141(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6623),s=n(7352),r=n(9294),o=n(1011),a=n(8211),l=n(4796),c=n(4700),u=n(6480),d=n(1518),h=n(6740),p=[i.default,s.default,r.default,o.default,a.default,l.default,c.default,u.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},d.default,h.default];t.default=p},2215(e,t,n){"use strict";var i=n(2897).default;function s(e,t){return{validate:e,compare:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0,t.fullFormats={date:s(a,l),time:s(u,d),"date-time":s(function(e){const t=e.split(h);return 2===t.length&&a(t[0])&&u(t[1],!0)},p),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return f.test(e)&&m.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:http[s\u017F]?|ftp):\/\/(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!(?:10|127)(?:\.[0-9]{1,3}){3})(?!(?:169\.254|192\.168)(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:[0-9KSa-z\xA1-\uFFFF]+-)*[0-9KSa-z\xA1-\uFFFF]+)(?:\.(?:[0-9KSa-z\xA1-\uFFFF]+-)*[0-9KSa-z\xA1-\uFFFF]+)*(?:\.(?:[KSa-z\xA1-\uFFFF]{2,})))(?::[0-9]{2,5})?(?:\/(?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*)?$/i,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(y.test(e))return!1;try{return new RegExp(e),!0}catch(t){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return g.lastIndex=0,g.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=2147483647&&e>=-2147483648}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:v},double:{type:"number",validate:v},password:!0,binary:!0},t.fastFormats=i(i({},t.fullFormats),{},{date:s(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,l),time:s(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,d),"date-time":s(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,p),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i}),t.formatNames=Object.keys(t.fullFormats);const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a(e){const t=r.exec(e);if(!t)return!1;const n=+t[1],i=+t[2],s=+t[3];return i>=1&&i<=12&&s>=1&&s<=(2===i&&function(e){return e%4===0&&(e%100!==0||e%400===0)}(n)?29:o[i])}function l(e,t){if(e&&t)return e>t?1:e<t?-1:0}const c=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function u(e,t){const n=c.exec(e);if(!n)return!1;const i=+n[1],s=+n[2],r=+n[3],o=n[5];return(i<=23&&s<=59&&r<=59||23===i&&59===s&&60===r)&&(!t||""!==o)}function d(e,t){if(!e||!t)return;const n=c.exec(e),i=c.exec(t);return n&&i?(e=n[1]+n[2]+n[3]+(n[4]||""))>(t=i[1]+i[2]+i[3]+(i[4]||""))?1:e<t?-1:0:void 0}const h=/t|\s/i;function p(e,t){if(!e||!t)return;const[n,i]=e.split(h),[s,r]=t.split(h),o=l(n,s);return void 0!==o?o||d(i,r):void 0}const f=/\/|:/,m=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;const g=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function v(){return!0}const y=/[^\\]\\Z/},2262(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y,b,w=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const _=n(8584),x={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:e=>{let{schemaCode:t}=e;return(0,_.str)(i||(i=w(['must match format "','"'])),t)},params:e=>{let{schemaCode:t}=e;return(0,_._)(s||(s=w(["{format: ","}"])),t)}},code(e,t){const{gen:n,data:i,$data:s,schema:x,schemaCode:E,it:S}=e,{opts:A,errSchemaPath:C,schemaEnv:T,self:k}=S;A.validateFormats&&(s?function(){const s=n.scopeValue("formats",{ref:k.formats,code:A.code.formats}),m=n.const("fDef",(0,_._)(r||(r=w(["","[","]"])),s,E)),g=n.let("fType"),v=n.let("format");n.if((0,_._)(o||(o=w(["typeof ",' == "object" && !('," instanceof RegExp)"])),m,m),()=>n.assign(g,(0,_._)(a||(a=w(["",'.type || "string"'])),m)).assign(v,(0,_._)(l||(l=w(["",".validate"])),m)),()=>n.assign(g,(0,_._)(c||(c=w(['"string"'])))).assign(v,m)),e.fail$data((0,_.or)(!1===A.strictSchema?_.nil:(0,_._)(u||(u=w([""," && !",""])),E,v),function(){const e=T.$async?(0,_._)(d||(d=w(["(",".async ? await ","(",") : ","(","))"])),m,v,i,v,i):(0,_._)(h||(h=w(["","(",")"])),v,i),n=(0,_._)(p||(p=w(["(typeof ",' == "function" ? '," : ",".test(","))"])),v,e,v,i);return(0,_._)(f||(f=w([""," && "," !== true && "," === "," && !",""])),v,v,g,t,n)}()))}():function(){const s=k.formats[x];if(!s)return void function(){if(!1===A.strictSchema)return void k.logger.warn(e());throw new Error(e());function e(){return'unknown format "'.concat(x,'" ignored in schema at path "').concat(C,'"')}}();if(!0===s)return;const[r,o,a]=function(e){const t=e instanceof RegExp?(0,_.regexpCode)(e):A.code.formats?(0,_._)(m||(m=w(["","",""])),A.code.formats,(0,_.getProperty)(x)):void 0,i=n.scopeValue("formats",{key:x,ref:e,code:t});if("object"==typeof e&&!(e instanceof RegExp))return[e.type||"string",e.validate,(0,_._)(g||(g=w(["",".validate"])),i)];return["string",e,i]}(s);r===t&&e.pass(function(){if("object"==typeof s&&!(s instanceof RegExp)&&s.async){if(!T.$async)throw new Error("async format in sync schema");return(0,_._)(v||(v=w(["await ","(",")"])),a,i)}return"function"==typeof o?(0,_._)(y||(y=w(["","(",")"])),a,i):(0,_._)(b||(b=w(["",".test(",")"])),a,i)}())}())}};t.default=x},2302(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const i=n(8396),s=n(122),r=n(667),o=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return"boolean"==typeof e||(!0===t?!l(e):!!t&&c(e)<=t)};const a=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(e){for(const t in e){if(a.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(l))return!0;if("object"==typeof n&&l(n))return!0}return!1}function c(e){let t=0;for(const n in e){if("$ref"===n)return 1/0;if(t++,!o.has(n)&&("object"==typeof e[n]&&(0,i.eachItem)(e[n],e=>t+=c(e)),t===1/0))return 1/0}return t}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!1!==(arguments.length>2?arguments[2]:void 0)&&(t=p(t));const n=e.parse(t);return d(e,n)}function d(e,t){return e.serialize(t).split("#")[0]+"#"}t.getFullPath=u,t._getFullPath=d;const h=/#\/?$/;function p(e){return e?e.replace(h,""):""}t.normalizeId=p,t.resolveUrl=function(e,t,n){return n=p(n),e.resolve(t,n)};const f=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:n,uriResolver:i}=this.opts,o=p(e[n]||t),a={"":o},l=u(i,o,!1),c={},d=new Set;return r(e,{allKeys:!0},(e,t,i,s)=>{if(void 0===s)return;const r=l+t;let o=a[s];function u(t){const n=this.opts.uriResolver.resolve;if(t=p(o?n(o,t):t),d.has(t))throw m(t);d.add(t);let i=this.refs[t];return"string"==typeof i&&(i=this.refs[i]),"object"==typeof i?h(e,i.schema,t):t!==p(r)&&("#"===t[0]?(h(e,c[t],t),c[t]=e):this.refs[t]=r),t}function g(e){if("string"==typeof e){if(!f.test(e))throw new Error('invalid anchor "'.concat(e,'"'));u.call(this,"#".concat(e))}}"string"==typeof e[n]&&(o=u.call(this,e[n])),g.call(this,e.$anchor),g.call(this,e.$dynamicAnchor),a[t]=o}),c;function h(e,t,n){if(void 0!==t&&!s(e,t))throw m(n)}function m(e){return new Error('reference "'.concat(e,'" resolves to more than one schema'))}}},2392(e,t){"use strict";function n(e,t){return t.rules.some(t=>i(e,t))}function i(e,t){var n;return void 0!==e[t.keyword]||(null===(n=t.definition.implements)||void 0===n?void 0:n.some(t=>void 0!==e[t]))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=function(e,t){let{schema:i,self:s}=e;const r=s.RULES.types[t];return r&&!0!==r&&n(i,r)},t.shouldUseGroup=n,t.shouldUseRule=i},2730(e,t,n){"use strict";var i=n(5043),s=n(8853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,s,r,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,i)&&(n=null),i||null===s?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,i=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),T=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var F,L=Object.assign;function j(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),r=i.stack.split("\n"),o=s.length-1,a=r.length-1;1<=o&&0<=a&&s[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==r[a]){if(1!==o||1!==a)do{if(o--,0>--a||s[o]!==r[a]){var l="\n"+s[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function W(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case x:return"Portal";case A:return"Profiler";case S:return"StrictMode";case I:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function z(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=z(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){i=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=z(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){X(e,t);var n=q(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(i&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function re(e,t){var n=q(t.value),i=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),s=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,s):e[n]=s}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Ee=null,Se=null;function Ae(e){if(e=bs(e)){if("function"!==typeof xe)throw Error(r(280));var t=e.stateNode;t&&(t=_s(t),xe(e.stateNode,e.type,t))}}function Ce(e){Ee?Se?Se.push(e):Se=[e]:Ee=e}function Te(){if(Ee){var e=Ee,t=Se;if(Se=Ee=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function ke(e,t){return e(t)}function Ie(){}var Ne=!1;function Pe(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return ke(e,t,n)}finally{Ne=!1,(null!==Ee||null!==Se)&&(Ie(),Te())}}function Me(e,t){var n=e.stateNode;if(null===n)return null;var i=_s(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(r(231,t,typeof n));return n}var Re=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Re=!1}function De(e,t,n,i,s,r,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Fe=!1,Le=null,je=!1,Ue=null,Be={onError:function(e){Fe=!0,Le=e}};function We(e,t,n,i,s,r,o,a,l){Fe=!1,Le=null,De.apply(Be,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(He(e)!==e)throw Error(r(188))}function ze(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(null===s)break;var o=s.alternate;if(null===o){if(null!==(i=s.return)){n=i;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return qe(s),e;if(o===i)return qe(s),t;o=o.sibling}throw Error(r(188))}if(n.return!==i.return)n=s,i=o;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,i=o;break}if(l===i){a=!0,i=s,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=s;break}if(l===i){a=!0,i=o,n=s;break}l=l.sibling}if(!a)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Je=s.unstable_scheduleCallback,Ke=s.unstable_cancelCallback,Ye=s.unstable_shouldYield,$e=s.unstable_requestPaint,Xe=s.unstable_now,Qe=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,it=s.unstable_IdlePriority,st=null,rt=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,s=e.suspendedLanes,r=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~s;0!==a?i=dt(a):0!==(r&=o)&&(i=dt(r))}else 0!==(o=n&~s)?i=dt(o):0!==r&&(i=dt(r));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&s)&&((s=i&-i)>=(r=t&-t)||16===s&&0!==(4194240&r)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)s=1<<(n=31-ot(t)),i|=e[n],t&=~s;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,xt,Et,St,At,Ct=!1,Tt=[],kt=null,It=null,Nt=null,Pt=new Map,Mt=new Map,Rt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mt.delete(t.pointerId)}}function Ft(e,t,n,i,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},null!==t&&(null!==(t=bs(t))&&xt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Lt(e){var t=ys(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void At(e.priority,function(){Et(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bs(n))&&xt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);we=i,n.target.dispatchEvent(i),we=null,t.shift()}return!0}function Ut(e,t,n){jt(e)&&n.delete(t)}function Bt(){Ct=!1,null!==kt&&jt(kt)&&(kt=null),null!==It&&jt(It)&&(It=null),null!==Nt&&jt(Nt)&&(Nt=null),Pt.forEach(Ut),Mt.forEach(Ut)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Bt)))}function Ht(e){function t(t){return Wt(t,e)}if(0<Tt.length){Wt(Tt[0],e);for(var n=1;n<Tt.length;n++){var i=Tt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==kt&&Wt(kt,e),null!==It&&Wt(It,e),null!==Nt&&Wt(Nt,e),Pt.forEach(t),Mt.forEach(t),n=0;n<Rt.length;n++)(i=Rt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Rt.shift()}var Vt=w.ReactCurrentBatchConfig,qt=!0;function zt(e,t,n,i){var s=bt,r=Vt.transition;Vt.transition=null;try{bt=1,Jt(e,t,n,i)}finally{bt=s,Vt.transition=r}}function Gt(e,t,n,i){var s=bt,r=Vt.transition;Vt.transition=null;try{bt=4,Jt(e,t,n,i)}finally{bt=s,Vt.transition=r}}function Jt(e,t,n,i){if(qt){var s=Yt(e,t,n,i);if(null===s)qi(e,t,i,Kt,n),Dt(e,i);else if(function(e,t,n,i,s){switch(t){case"focusin":return kt=Ft(kt,e,t,n,i,s),!0;case"dragenter":return It=Ft(It,e,t,n,i,s),!0;case"mouseover":return Nt=Ft(Nt,e,t,n,i,s),!0;case"pointerover":var r=s.pointerId;return Pt.set(r,Ft(Pt.get(r)||null,e,t,n,i,s)),!0;case"gotpointercapture":return r=s.pointerId,Mt.set(r,Ft(Mt.get(r)||null,e,t,n,i,s)),!0}return!1}(s,e,t,n,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<Ot.indexOf(e)){for(;null!==s;){var r=bs(s);if(null!==r&&_t(r),null===(r=Yt(e,t,n,i))&&qi(e,t,i,Kt,n),r===s)break;s=r}null!==s&&i.stopPropagation()}else qi(e,t,i,null,n)}}var Kt=null;function Yt(e,t,n,i){if(Kt=null,null!==(e=ys(e=_e(i))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Xt=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,i=n.length,s="value"in Xt?Xt.value:Xt.textContent,r=s.length;for(e=0;e<i&&n[e]===s[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===s[r-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function sn(){return!1}function rn(e){function t(t,n,i,s,r){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:sn,this.isPropagationStopped=sn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(cn),dn=L({},cn,{view:0,detail:0}),hn=rn(dn),pn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=rn(pn),mn=rn(L({},pn,{dataTransfer:0})),gn=rn(L({},dn,{relatedTarget:0})),vn=rn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=rn(yn),wn=rn(L({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function An(){return Sn}var Cn=L({},dn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=rn(Cn),kn=rn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=rn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Nn=rn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mn=rn(Pn),Rn=[9,13,27,32],On=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Fn=u&&"TextEvent"in window&&!Dn,Ln=u&&(!On||Dn&&8<Dn&&11>=Dn),jn=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function zn(e,t,n,i){Ce(i),0<(t=Gi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Gn=null,Jn=null;function Kn(e){ji(e,0)}function Yn(e){if(J(ws(e)))return e}function $n(e,t){if("change"===e)return t}var Xn=!1;if(u){var Qn;if(u){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Qn=Zn}else Qn=!1;Xn=Qn&&(!document.documentMode||9<document.documentMode)}function ti(){Gn&&(Gn.detachEvent("onpropertychange",ni),Jn=Gn=null)}function ni(e){if("value"===e.propertyName&&Yn(Jn)){var t=[];zn(t,Jn,e,_e(e)),Pe(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Jn=n,(Gn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function si(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Jn)}function ri(e,t){if("click"===e)return Yn(t)}function oi(e,t){if("input"===e||"change"===e)return Yn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!d.call(t,s)||!ai(e[s],t[s]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,r=Math.min(i.start,s);i=void 0===i.end?r:Math.min(i.end,s),!e.extend&&r>i&&(s=i,i=r,r=s),s=ui(n,r);var o=ui(n,i);s&&o&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),r>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,bi=!1;function wi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==gi||gi!==K(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Gi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function _i(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xi={animationend:_i("Animation","AnimationEnd"),animationiteration:_i("Animation","AnimationIteration"),animationstart:_i("Animation","AnimationStart"),transitionend:_i("Transition","TransitionEnd")},Ei={},Si={};function Ai(e){if(Ei[e])return Ei[e];if(!xi[e])return e;var t,n=xi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Si)return Ei[e]=n[t];return e}u&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);var Ci=Ai("animationend"),Ti=Ai("animationiteration"),ki=Ai("animationstart"),Ii=Ai("transitionend"),Ni=new Map,Pi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mi(e,t){Ni.set(e,t),l(t,[e])}for(var Ri=0;Ri<Pi.length;Ri++){var Oi=Pi[Ri];Mi(Oi.toLowerCase(),"on"+(Oi[0].toUpperCase()+Oi.slice(1)))}Mi(Ci,"onAnimationEnd"),Mi(Ti,"onAnimationIteration"),Mi(ki,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(Ii,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function Li(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,s,o,a,l,c){if(We.apply(this,arguments),Fe){if(!Fe)throw Error(r(198));var u=Le;Fe=!1,Le=null,je||(je=!0,Ue=u)}}(i,t,void 0,e),e.currentTarget=null}function ji(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;Li(s,a,c),r=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;Li(s,a,c),r=l}}}if(je)throw e=Ue,je=!1,Ue=null,e}function Ui(e,t){var n=t[ms];void 0===n&&(n=t[ms]=new Set);var i=e+"__bubble";n.has(i)||(Vi(t,e,2,!1),n.add(i))}function Bi(e,t,n){var i=0;t&&(i|=4),Vi(n,e,i,t)}var Wi="_reactListening"+Math.random().toString(36).slice(2);function Hi(e){if(!e[Wi]){e[Wi]=!0,o.forEach(function(t){"selectionchange"!==t&&(Fi.has(t)||Bi(t,!1,e),Bi(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wi]||(t[Wi]=!0,Bi("selectionchange",!1,t))}}function Vi(e,t,n,i){switch($t(t)){case 1:var s=zt;break;case 4:s=Gt;break;default:s=Jt}n=s.bind(null,t,n,e),s=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),i?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function qi(e,t,n,i,s){var r=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===s||8===a.nodeType&&a.parentNode===s)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;o=o.return}for(;null!==a;){if(null===(o=ys(a)))return;if(5===(l=o.tag)||6===l){i=r=o;continue e}a=a.parentNode}}i=i.return}Pe(function(){var i=r,s=_e(n),o=[];e:{var a=Ni.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Ci:case Ti:case ki:l=vn;break;case Ii:l=Nn;break;case"scroll":l=hn;break;case"wheel":l=Mn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Me(f,h))&&u.push(zi(f,m,p)))),d)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,s),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!ys(c)&&!c[fs])&&(l||a)&&(a=s.window===s?s:(a=s.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?ys(c):null)&&(c!==(d=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=kn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?a:ws(l),p=null==c?a:ws(c),(a=new u(m,f+"leave",l,n,s)).target=d,a.relatedTarget=p,m=null,ys(s)===i&&((u=new u(h,f+"enter",c,n,s)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Ji(p))f++;for(p=0,m=h;m;m=Ji(m))p++;for(;0<f-p;)u=Ji(u),f--;for(;0<p-f;)h=Ji(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Ji(u),h=Ji(h)}u=null}else u=null;null!==l&&Ki(o,a,l,u,!1),null!==c&&null!==d&&Ki(o,d,c,u,!0)}if("select"===(l=(a=i?ws(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=$n;else if(qn(a))if(Xn)g=oi;else{g=si;var v=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=ri);switch(g&&(g=g(e,i))?zn(o,g,n,s):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?ws(i):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,wi(o,n,s);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":wi(o,n,s)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(y=en()):(Qt="value"in(Xt=s)?Xt.value:Xt.textContent,Hn=!0)),0<(v=Gi(i,b)).length&&(b=new wn(b,e,null,n,s),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Wn(n))&&(b.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Un=!0,jn);case"textInput":return(e=t.data)===jn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!On&&Bn(e,t)?(e=en(),Zt=Qt=Xt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Gi(i,"onBeforeInput")).length&&(s=new wn("onBeforeInput","beforeinput",null,n,s),o.push({event:s,listeners:i}),s.data=y))}ji(o,t)})}function zi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gi(e,t){for(var n=t+"Capture",i=[];null!==e;){var s=e,r=s.stateNode;5===s.tag&&null!==r&&(s=r,null!=(r=Me(e,n))&&i.unshift(zi(e,r,s)),null!=(r=Me(e,t))&&i.push(zi(e,r,s))),e=e.return}return i}function Ji(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,s){for(var r=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,s?null!=(l=Me(n,r))&&o.unshift(zi(n,l,a)):s||null!=(l=Me(n,r))&&o.push(zi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yi=/\r\n?/g,$i=/\u0000|\uFFFD/g;function Xi(e){return("string"===typeof e?e:""+e).replace(Yi,"\n").replace($i,"")}function Qi(e,t,n){if(t=Xi(t),Xi(e)!==t&&n)throw Error(r(425))}function Zi(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var is="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,rs="function"===typeof Promise?Promise:void 0,os="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rs?function(e){return rs.resolve(null).then(e).catch(as)}:is;function as(e){setTimeout(function(){throw e})}function ls(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===i)return e.removeChild(s),void Ht(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=s}while(n);Ht(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,ps="__reactProps$"+ds,fs="__reactContainer$"+ds,ms="__reactEvents$"+ds,gs="__reactListeners$"+ds,vs="__reactHandles$"+ds;function ys(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fs]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=us(e);null!==e;){if(n=e[hs])return n;e=us(e)}return t}n=(e=n).parentNode}return null}function bs(e){return!(e=e[hs]||e[fs])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ws(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function _s(e){return e[ps]||null}var xs=[],Es=-1;function Ss(e){return{current:e}}function As(e){0>Es||(e.current=xs[Es],xs[Es]=null,Es--)}function Cs(e,t){Es++,xs[Es]=e.current,e.current=t}var Ts={},ks=Ss(Ts),Is=Ss(!1),Ns=Ts;function Ps(e,t){var n=e.type.contextTypes;if(!n)return Ts;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var s,r={};for(s in n)r[s]=t[s];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ms(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rs(){As(Is),As(ks)}function Os(e,t,n){if(ks.current!==Ts)throw Error(r(168));Cs(ks,t),Cs(Is,n)}function Ds(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var s in i=i.getChildContext())if(!(s in t))throw Error(r(108,V(e)||"Unknown",s));return L({},n,i)}function Fs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ts,Ns=ks.current,Cs(ks,e),Cs(Is,Is.current),!0}function Ls(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Ds(e,t,Ns),i.__reactInternalMemoizedMergedChildContext=e,As(Is),As(ks),Cs(ks,e)):As(Is),Cs(Is,n)}var js=null,Us=!1,Bs=!1;function Ws(e){null===js?js=[e]:js.push(e)}function Hs(){if(!Bs&&null!==js){Bs=!0;var e=0,t=bt;try{var n=js;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}js=null,Us=!1}catch(s){throw null!==js&&(js=js.slice(e+1)),Je(Ze,Hs),s}finally{bt=t,Bs=!1}}return null}var Vs=[],qs=0,zs=null,Gs=0,Js=[],Ks=0,Ys=null,$s=1,Xs="";function Qs(e,t){Vs[qs++]=Gs,Vs[qs++]=zs,zs=e,Gs=t}function Zs(e,t,n){Js[Ks++]=$s,Js[Ks++]=Xs,Js[Ks++]=Ys,Ys=e;var i=$s;e=Xs;var s=32-ot(i)-1;i&=~(1<<s),n+=1;var r=32-ot(t)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,$s=1<<32-ot(t)+s|n<<s|i,Xs=r+e}else $s=1<<r|n<<s|i,Xs=e}function er(e){null!==e.return&&(Qs(e,1),Zs(e,1,0))}function tr(e){for(;e===zs;)zs=Vs[--qs],Vs[qs]=null,Gs=Vs[--qs],Vs[qs]=null;for(;e===Ys;)Ys=Js[--Ks],Js[Ks]=null,Xs=Js[--Ks],Js[Ks]=null,$s=Js[--Ks],Js[Ks]=null}var nr=null,ir=null,sr=!1,rr=null;function or(e,t){var n=Nc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ar(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,ir=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,ir=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ys?{id:$s,overflow:Xs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,nr=e,ir=null,!0);default:return!1}}function lr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(sr){var t=ir;if(t){var n=t;if(!ar(e,t)){if(lr(e))throw Error(r(418));t=cs(n.nextSibling);var i=nr;t&&ar(e,t)?or(i,n):(e.flags=-4097&e.flags|2,sr=!1,nr=e)}}else{if(lr(e))throw Error(r(418));e.flags=-4097&e.flags|2,sr=!1,nr=e}}}function ur(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function dr(e){if(e!==nr)return!1;if(!sr)return ur(e),sr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ir)){if(lr(e))throw hr(),Error(r(418));for(;t;)or(e,t),t=cs(t.nextSibling)}if(ur(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ir=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ir=null}}else ir=nr?cs(e.stateNode.nextSibling):null;return!0}function hr(){for(var e=ir;e;)e=cs(e.nextSibling)}function pr(){ir=nr=null,sr=!1}function fr(e){null===rr?rr=[e]:rr.push(e)}var mr=w.ReactCurrentBatchConfig;function gr(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var s=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=s.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yr(e){return(0,e._init)(e._payload)}function br(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Fc(n,e.mode,i)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,i){var r=n.type;return r===E?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===M&&yr(r)===t.type)?((i=s(t,n.props)).ref=gr(e,t,n),i.return=e,i):((i=Rc(n.type,n.key,n.props,null,e.mode,i)).ref=gr(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,i)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,i,r){return null===t||7!==t.tag?((t=Oc(n,e.mode,i,r)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=gr(e,null,t),n.return=e,n;case x:return(t=Lc(t,e.mode,n)).return=e,t;case M:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Oc(t,e.mode,n,null)).return=e,t;vr(e,t)}return null}function p(e,t,n,i){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===s?c(e,t,n,i):null;case x:return n.key===s?u(e,t,n,i):null;case M:return p(e,t,(s=n._init)(n._payload),i)}if(te(n)||D(n))return null!==s?null:d(e,t,n,i,null);vr(e,n)}return null}function f(e,t,n,i,s){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,s);if("object"===typeof i&&null!==i){switch(i.$$typeof){case _:return c(t,e=e.get(null===i.key?n:i.key)||null,i,s);case x:return u(t,e=e.get(null===i.key?n:i.key)||null,i,s);case M:return f(e,t,n,(0,i._init)(i._payload),s)}if(te(i)||D(i))return d(t,e=e.get(n)||null,i,s,null);vr(t,i)}return null}function m(s,r,a,l){for(var c=null,u=null,d=r,m=r=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(s,d,a[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(s,d),r=o(v,r,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(s,d),sr&&Qs(s,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(s,a[m],l))&&(r=o(d,r,m),null===u?c=d:u.sibling=d,u=d);return sr&&Qs(s,m),c}for(d=i(s,d);m<a.length;m++)null!==(g=f(d,s,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),r=o(g,r,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(s,e)}),sr&&Qs(s,m),c}function g(s,a,l,c){var u=D(l);if("function"!==typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var d=u=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(s,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(s,m),a=o(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(s,m),sr&&Qs(s,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(s,y.value,c))&&(a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return sr&&Qs(s,g),u}for(m=i(s,m);!y.done;g++,y=l.next())null!==(y=f(m,s,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(s,e)}),sr&&Qs(s,g),u}return function e(i,r,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,u=r;null!==u;){if(u.key===c){if((c=o.type)===E){if(7===u.tag){n(i,u.sibling),(r=s(u,o.props.children)).return=i,i=r;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===M&&yr(c)===u.type){n(i,u.sibling),(r=s(u,o.props)).ref=gr(i,u,o),r.return=i,i=r;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===E?((r=Oc(o.props.children,i.mode,l,o.key)).return=i,i=r):((l=Rc(o.type,o.key,o.props,null,i.mode,l)).ref=gr(i,r,o),l.return=i,i=l)}return a(i);case x:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(i,r.sibling),(r=s(r,o.children||[])).return=i,i=r;break e}n(i,r);break}t(i,r),r=r.sibling}(r=Lc(o,i.mode,l)).return=i,i=r}return a(i);case M:return e(i,r,(u=o._init)(o._payload),l)}if(te(o))return m(i,r,o,l);if(D(o))return g(i,r,o,l);vr(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==r&&6===r.tag?(n(i,r.sibling),(r=s(r,o)).return=i,i=r):(n(i,r),(r=Fc(o,i.mode,l)).return=i,i=r),a(i)):n(i,r)}}var wr=br(!0),_r=br(!1),xr=Ss(null),Er=null,Sr=null,Ar=null;function Cr(){Ar=Sr=Er=null}function Tr(e){var t=xr.current;As(xr),e._currentValue=t}function kr(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ir(e,t){Er=e,Ar=Sr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function Nr(e){var t=e._currentValue;if(Ar!==e)if(e={context:e,memoizedValue:t,next:null},null===Sr){if(null===Er)throw Error(r(308));Sr=e,Er.dependencies={lanes:0,firstContext:e}}else Sr=Sr.next=e;return t}var Pr=null;function Mr(e){null===Pr?Pr=[e]:Pr.push(e)}function Rr(e,t,n,i){var s=t.interleaved;return null===s?(n.next=n,Mr(t)):(n.next=s.next,s.next=n),t.interleaved=n,Or(e,i)}function Or(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Dr=!1;function Fr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function jr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ur(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Tl)){var s=i.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),i.pending=t,Or(e,n)}return null===(s=i.interleaved)?(t.next=t,Mr(i)):(t.next=s.next,s.next=t),i.interleaved=t,Or(e,n)}function Br(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Wr(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?s=r=o:r=r.next=o,n=n.next}while(null!==n);null===r?s=r=t:r=r.next=t}else s=r=t;return n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Hr(e,t,n,i){var s=e.updateQueue;Dr=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?r=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==r){var d=s.baseState;for(o=0,u=c=l=null,a=r;;){var h=a.lane,p=a.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=L({},d,h);break e;case 2:Dr=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,o|=h;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(h=a).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{o|=s.lane,s=s.next}while(s!==t)}else null===r&&(s.shared.lanes=0);Dl|=o,e.lanes=o,e.memoizedState=d}}function Vr(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],s=i.callback;if(null!==s){if(i.callback=null,i=n,"function"!==typeof s)throw Error(r(191,s));s.call(i)}}}var qr={},zr=Ss(qr),Gr=Ss(qr),Jr=Ss(qr);function Kr(e){if(e===qr)throw Error(r(174));return e}function Yr(e,t){switch(Cs(Jr,t),Cs(Gr,e),Cs(zr,qr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}As(zr),Cs(zr,t)}function $r(){As(zr),As(Gr),As(Jr)}function Xr(e){Kr(Jr.current);var t=Kr(zr.current),n=le(t,e.type);t!==n&&(Cs(Gr,e),Cs(zr,n))}function Qr(e){Gr.current===e&&(As(zr),As(Gr))}var Zr=Ss(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var io=w.ReactCurrentDispatcher,so=w.ReactCurrentBatchConfig,ro=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,po=0;function fo(){throw Error(r(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function go(e,t,n,i,s,o){if(ro=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?Zo:ea,e=n(i,s),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(r(301));o+=1,lo=ao=null,t.updateQueue=null,io.current=ta,e=n(i,s)}while(uo)}if(io.current=Qo,t=null!==ao&&null!==ao.next,ro=0,lo=ao=oo=null,co=!1,t)throw Error(r(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(r(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=bo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=ao,s=i.baseQueue,o=n.pending;if(null!==o){if(null!==s){var a=s.next;s.next=o.next,o.next=a}i.baseQueue=s=o,n.pending=null}if(null!==s){o=s.next,i=i.baseState;var l=a=null,c=null,u=o;do{var d=u.lane;if((ro&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=i):c=c.next=h,oo.lanes|=d,Dl|=d}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(ba=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){s=e;do{o=s.lane,oo.lanes|=o,Dl|=o,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xo(e){var t=bo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,o=t.memoizedState;if(null!==s){n.pending=null;var a=s=s.next;do{o=e(o,a.action),a=a.next}while(a!==s);ai(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Eo(){}function So(e,t){var n=oo,i=bo(),s=t(),o=!ai(i.memoizedState,s);if(o&&(i.memoizedState=s,ba=!0),i=i.queue,Fo(To.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Po(9,Co.bind(null,n,i,s,t),void 0,null),null===kl)throw Error(r(349));0!==(30&ro)||Ao(n,t,s)}return s}function Ao(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Co(e,t,n,i){t.value=n,t.getSnapshot=i,ko(t)&&Io(e)}function To(e,t,n){return n(function(){ko(t)&&Io(e)})}function ko(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function Io(e){var t=Or(e,1);null!==t&&tc(t,e,1,-1)}function No(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[t.memoizedState,e]}function Po(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Mo(){return bo().memoizedState}function Ro(e,t,n,i){var s=yo();oo.flags|=e,s.memoizedState=Po(1|t,n,void 0,void 0===i?null:i)}function Oo(e,t,n,i){var s=bo();i=void 0===i?null:i;var r=void 0;if(null!==ao){var o=ao.memoizedState;if(r=o.destroy,null!==i&&mo(i,o.deps))return void(s.memoizedState=Po(t,n,r,i))}oo.flags|=e,s.memoizedState=Po(1|t,n,r,i)}function Do(e,t){return Ro(8390656,8,e,t)}function Fo(e,t){return Oo(2048,8,e,t)}function Lo(e,t){return Oo(4,2,e,t)}function jo(e,t){return Oo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Uo.bind(null,t,e),n)}function Wo(){}function Ho(e,t){var n=bo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Vo(e,t){var n=bo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&ro)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ai(n,t)||(n=mt(),oo.lanes|=n,Dl|=n,e.baseState=!0),t)}function zo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=so.transition;so.transition={};try{e(!1),t()}finally{bt=n,so.transition=i}}function Go(){return bo().memoizedState}function Jo(e,t,n){var i=ec(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(e))$o(t,n);else if(null!==(n=Rr(e,t,n,i))){tc(n,e,i,Zl()),Xo(n,t,i)}}function Ko(e,t,n){var i=ec(e),s={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))$o(t,s);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=r(o,n);if(s.hasEagerState=!0,s.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(s.next=s,Mr(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Rr(e,t,s,i))&&(tc(n,e,i,s=Zl()),Xo(n,t,i))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function $o(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qo={readContext:Nr,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Zo={readContext:Nr,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Nr,useEffect:Do,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ro(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ro(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=yo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Jo.bind(null,oo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:No,useDebugValue:Wo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=No(!1),t=e[0];return e=zo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=oo,s=yo();if(sr){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===kl)throw Error(r(349));0!==(30&ro)||Ao(i,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Do(To.bind(null,i,o,e),[e]),i.flags|=2048,Po(9,Co.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=kl.identifierPrefix;if(sr){var n=Xs;t=":"+t+"R"+(n=($s&~(1<<32-ot($s)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Nr,useCallback:Ho,useContext:Nr,useEffect:Fo,useImperativeHandle:Bo,useInsertionEffect:Lo,useLayoutEffect:jo,useMemo:Vo,useReducer:_o,useRef:Mo,useState:function(){return _o(wo)},useDebugValue:Wo,useDeferredValue:function(e){return qo(bo(),ao.memoizedState,e)},useTransition:function(){return[_o(wo)[0],bo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:So,useId:Go,unstable_isNewReconciler:!1},ta={readContext:Nr,useCallback:Ho,useContext:Nr,useEffect:Fo,useImperativeHandle:Bo,useInsertionEffect:Lo,useLayoutEffect:jo,useMemo:Vo,useReducer:xo,useRef:Mo,useState:function(){return xo(wo)},useDebugValue:Wo,useDeferredValue:function(e){var t=bo();return null===ao?t.memoizedState=e:qo(t,ao.memoizedState,e)},useTransition:function(){return[xo(wo)[0],bo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:So,useId:Go,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ia(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var sa={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Zl(),s=ec(e),r=jr(i,s);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Ur(e,r,s))&&(tc(t,e,s,i),Br(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Zl(),s=ec(e),r=jr(i,s);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Ur(e,r,s))&&(tc(t,e,s,i),Br(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zl(),i=ec(e),s=jr(n,i);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Ur(e,s,i))&&(tc(t,e,i,n),Br(t,e,i))}};function ra(e,t,n,i,s,r,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,r,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(s,r))}function oa(e,t,n){var i=!1,s=Ts,r=t.contextType;return"object"===typeof r&&null!==r?r=Nr(r):(s=Ms(t)?Ns:ks.current,r=(i=null!==(i=t.contextTypes)&&void 0!==i)?Ps(e,s):Ts),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=sa,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=r),t}function aa(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&sa.enqueueReplaceState(t,t.state,null)}function la(e,t,n,i){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Fr(e);var r=t.contextType;"object"===typeof r&&null!==r?s.context=Nr(r):(r=Ms(t)?Ns:ks.current,s.context=Ps(e,r)),s.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(ia(e,t,r,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&sa.enqueueReplaceState(s,s.state,null),Hr(e,n,s,i),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",i=t;do{n+=W(i),i=i.return}while(i);var s=n}catch(r){s="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:s,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ha="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=jr(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Vl||(Vl=!0,ql=i),da(0,t)},n}function fa(e,t,n){(n=jr(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var s=t.value;n.payload=function(){return i(s)},n.callback=function(){da(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof i&&(null===zl?zl=new Set([this]):zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ha;var s=new Set;i.set(t,s)}else void 0===(s=i.get(t))&&(s=new Set,i.set(t,s));s.has(n)||(s.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,i,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=jr(-1,1)).tag=2,Ur(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var ya=w.ReactCurrentOwner,ba=!1;function wa(e,t,n,i){t.child=null===e?_r(t,null,n,i):wr(t,e.child,n,i)}function _a(e,t,n,i,s){n=n.render;var r=t.ref;return Ir(t,s),i=go(e,t,n,i,r,s),n=vo(),null===e||ba?(sr&&n&&er(t),t.flags|=1,wa(e,t,i,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Va(e,t,s))}function xa(e,t,n,i,s){if(null===e){var r=n.type;return"function"!==typeof r||Pc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,i,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Ea(e,t,r,i,s))}if(r=e.child,0===(e.lanes&s)){var o=r.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Va(e,t,s)}return t.flags|=1,(e=Mc(r,i)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,i,s){if(null!==e){var r=e.memoizedProps;if(li(r,i)&&e.ref===t.ref){if(ba=!1,t.pendingProps=i=r,0===(e.lanes&s))return t.lanes=e.lanes,Va(e,t,s);0!==(131072&e.flags)&&(ba=!0)}}return Ca(e,t,n,i,s)}function Sa(e,t,n){var i=t.pendingProps,s=i.children,r=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Ml,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cs(Ml,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==r?r.baseLanes:n,Cs(Ml,Pl),Pl|=i}else null!==r?(i=r.baseLanes|n,t.memoizedState=null):i=n,Cs(Ml,Pl),Pl|=i;return wa(e,t,s,n),t.child}function Aa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ca(e,t,n,i,s){var r=Ms(n)?Ns:ks.current;return r=Ps(t,r),Ir(t,s),n=go(e,t,n,i,r,s),i=vo(),null===e||ba?(sr&&i&&er(t),t.flags|=1,wa(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Va(e,t,s))}function Ta(e,t,n,i,s){if(Ms(n)){var r=!0;Fs(t)}else r=!1;if(Ir(t,s),null===t.stateNode)Ha(e,t),oa(t,n,i),la(t,n,i,s),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Nr(c):c=Ps(t,c=Ms(n)?Ns:ks.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&aa(t,o,i,c),Dr=!1;var h=t.memoizedState;o.state=h,Hr(t,i,o,s),l=t.memoizedState,a!==i||h!==l||Is.current||Dr?("function"===typeof u&&(ia(t,n,u,i),l=t.memoizedState),(a=Dr||ra(t,n,a,i,h,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Lr(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Nr(l):l=Ps(t,l=Ms(n)?Ns:ks.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==l)&&aa(t,o,i,l),Dr=!1,h=t.memoizedState,o.state=h,Hr(t,i,o,s);var f=t.memoizedState;a!==d||h!==f||Is.current||Dr?("function"===typeof p&&(ia(t,n,p,i),f=t.memoizedState),(c=Dr||ra(t,n,c,i,h,f,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return ka(e,t,n,i,r,s)}function ka(e,t,n,i,s,r){Aa(e,t);var o=0!==(128&t.flags);if(!i&&!o)return s&&Ls(t,n,!1),Va(e,t,r);i=t.stateNode,ya.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=wr(t,e.child,null,r),t.child=wr(t,null,a,r)):wa(e,t,a,r),t.memoizedState=i.state,s&&Ls(t,n,!0),t.child}function Ia(e){var t=e.stateNode;t.pendingContext?Os(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Os(0,t.context,!1),Yr(e,t.containerInfo)}function Na(e,t,n,i,s){return pr(),fr(s),t.flags|=256,wa(e,t,n,i),t.child}var Pa,Ma,Ra,Oa={dehydrated:null,treeContext:null,retryLane:0};function Da(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var i,s=t.pendingProps,o=Zr.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Cs(Zr,1&o),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Dc(l,s,0,null),e=Oc(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Da(n),t.memoizedState=Oa,e):La(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,s,o,a){if(n)return 256&t.flags?(t.flags&=-257,ja(e,t,a,i=ua(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,s=t.mode,i=Dc({mode:"visible",children:i.children},s,0,null),(o=Oc(o,s,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&wr(t,e.child,null,a),t.child.memoizedState=Da(a),t.memoizedState=Oa,o);if(0===(1&t.mode))return ja(e,t,a,null);if("$!"===s.data){if(i=s.nextSibling&&s.nextSibling.dataset)var l=i.dgst;return i=l,ja(e,t,a,i=ua(o=Error(r(419)),i,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(i=kl)){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(i.suspendedLanes|a))?0:s)&&s!==o.retryLane&&(o.retryLane=s,Or(e,s),tc(i,e,s,-1))}return fc(),ja(e,t,a,i=ua(Error(r(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,ir=cs(s.nextSibling),nr=t,sr=!0,rr=null,null!==e&&(Js[Ks++]=$s,Js[Ks++]=Xs,Js[Ks++]=Ys,$s=e.id,Xs=e.overflow,Ys=t),t=La(t,i.children),t.flags|=4096,t)}(e,t,l,s,i,o,n);if(a){a=s.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==o?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Mc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Mc(i,a):(a=Oc(a,l,n,null)).flags|=2,a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=null===(l=e.child.memoizedState)?Da(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Oa,s}return e=(a=e.child).sibling,s=Mc(a,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function La(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ja(e,t,n,i){return null!==i&&fr(i),wr(t,e.child,null,n),(e=La(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),kr(e.return,t,n)}function Ba(e,t,n,i,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=s)}function Wa(e,t,n){var i=t.pendingProps,s=i.revealOrder,r=i.tail;if(wa(e,t,i.children,n),0!==(2&(i=Zr.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Cs(Zr,i),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Ba(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===eo(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Ba(t,!0,n,null,r);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ha(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Va(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!sr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function za(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,i|=14680064&s.subtreeFlags,i|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ga(e,t,n){var i=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return za(t),null;case 1:case 17:return Ms(t.type)&&Rs(),za(t),null;case 3:return i=t.stateNode,$r(),As(Is),As(ks),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(dr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(rc(rr),rr=null))),za(t),null;case 5:Qr(t);var s=Kr(Jr.current);if(n=t.type,null!==e&&null!=t.stateNode)Ma(e,t,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(r(166));return za(t),null}if(e=Kr(zr.current),dr(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[hs]=t,i[ps]=o,e=0!==(1&t.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(s=0;s<Di.length;s++)Ui(Di[s],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":$(i,o),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ui("invalid",i);break;case"textarea":se(i,o),Ui("invalid",i)}for(var l in ye(n,o),s=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qi(i.textContent,c,e),s=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qi(i.textContent,c,e),s=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ui("scroll",i)}switch(n){case"input":G(i),Z(i,o,!0);break;case"textarea":G(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Zi)}i=s,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[hs]=t,e[ps]=i,Pa(e,t),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Ui("cancel",e),Ui("close",e),s=i;break;case"iframe":case"object":case"embed":Ui("load",e),s=i;break;case"video":case"audio":for(s=0;s<Di.length;s++)Ui(Di[s],e);s=i;break;case"source":Ui("error",e),s=i;break;case"img":case"image":case"link":Ui("error",e),Ui("load",e),s=i;break;case"details":Ui("toggle",e),s=i;break;case"input":$(e,i),s=Y(e,i),Ui("invalid",e);break;case"option":default:s=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},s=L({},i,{value:void 0}),Ui("invalid",e);break;case"textarea":se(e,i),s=ie(e,i),Ui("invalid",e)}for(o in ye(n,s),c=s)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ui("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":G(e),Z(e,i,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+q(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return za(t),null;case 6:if(e&&null!=t.stateNode)Ra(0,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(r(166));if(n=Kr(Jr.current),Kr(zr.current),dr(t)){if(i=t.stateNode,n=t.memoizedProps,i[hs]=t,(o=i.nodeValue!==n)&&null!==(e=nr))switch(e.tag){case 3:Qi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hs]=t,t.stateNode=i}return za(t),null;case 13:if(As(Zr),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sr&&null!==ir&&0!==(1&t.mode)&&0===(128&t.flags))hr(),pr(),t.flags|=98560,o=!1;else if(o=dr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(r(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(r(317));o[hs]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;za(t),o=!1}else null!==rr&&(rc(rr),rr=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zr.current)?0===Rl&&(Rl=3):fc())),null!==t.updateQueue&&(t.flags|=4),za(t),null);case 4:return $r(),null===e&&Hi(t.stateNode.containerInfo),za(t),null;case 10:return Tr(t.type._context),za(t),null;case 19:if(As(Zr),null===(o=t.memoizedState))return za(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)qa(o,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,qa(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cs(Zr,1&Zr.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>Wl&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=eo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!sr)return za(t),null}else 2*Xe()-o.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=Zr.current,Cs(Zr,i?1&n|2:1&n),t):(za(t),null);case 22:case 23:return uc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(za(t),6&t.subtreeFlags&&(t.flags|=8192)):za(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Ja(e,t){switch(tr(t),t.tag){case 1:return Ms(t.type)&&Rs(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $r(),As(Is),As(ks),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qr(t),null;case 13:if(As(Zr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return As(Zr),null;case 4:return $r(),null;case 10:return Tr(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Pa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ma=function(e,t,n,i){var s=e.memoizedProps;if(s!==i){e=t.stateNode,Kr(zr.current);var r,o=null;switch(n){case"input":s=Y(e,s),i=Y(e,i),o=[];break;case"select":s=L({},s,{value:void 0}),i=L({},i,{value:void 0}),o=[];break;case"textarea":s=ie(e,s),i=ie(e,i),o=[];break;default:"function"!==typeof s.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(u in ye(n,i),n=null,s)if(!i.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=s?s[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ui("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Ra=function(e,t,n,i){n!==i&&(t.flags|=4)};var Ka=!1,Ya=!1,$a="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Qa(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Ec(e,t,i)}else n.current=null}function Za(e,t,n){try{n()}catch(i){Ec(e,t,i)}}var el=!1;function tl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var s=i=i.next;do{if((s.tag&e)===e){var r=s.destroy;s.destroy=void 0,void 0!==r&&Za(t,n,r)}s=s.next}while(s!==i)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[ps],delete t[ms],delete t[gs],delete t[vs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function al(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(al(e,t,n),e=e.sibling;null!==e;)al(e,t,n),e=e.sibling}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,ul=!1;function dl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(st,n)}catch(a){}switch(n.tag){case 5:Ya||Qa(n,t);case 6:var i=cl,s=ul;cl=null,dl(e,t,n),ul=s,null!==(cl=i)&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Ht(e)):ls(cl,n.stateNode));break;case 4:i=cl,s=ul,cl=n.stateNode.containerInfo,ul=!0,dl(e,t,n),cl=i,ul=s;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){s=i=i.next;do{var r=s,o=r.destroy;r=r.tag,void 0!==o&&(0!==(2&r)||0!==(4&r))&&Za(n,t,o),s=s.next}while(s!==i)}dl(e,t,n);break;case 1:if(!Ya&&(Qa(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ec(n,t,a)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ya=(i=Ya)||null!==n.memoizedState,dl(e,t,n),Ya=i):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $a),t.forEach(function(t){var i=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var s=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,ul=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===cl)throw Error(r(160));hl(o,a,s),cl=null,ul=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){Ec(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),gl(e),4&i){try{tl(3,e,e.return),nl(3,e)}catch(g){Ec(e,e.return,g)}try{tl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:fl(t,e),gl(e),512&i&&null!==n&&Qa(n,n.return);break;case 5:if(fl(t,e),gl(e),512&i&&null!==n&&Qa(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){Ec(e,e.return,g)}}if(4&i&&null!=(s=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&X(s,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?ge(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):b(s,d,h,u)}switch(l){case"input":Q(s,o);break;case"textarea":re(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(s,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(s,!!o.multiple,o.defaultValue,!0):ne(s,!!o.multiple,o.multiple?[]:"",!1))}s[ps]=o}catch(g){Ec(e,e.return,g)}}break;case 6:if(fl(t,e),gl(e),4&i){if(null===e.stateNode)throw Error(r(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(g){Ec(e,e.return,g)}}break;case 3:if(fl(t,e),gl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:fl(t,e),gl(e);break;case 13:fl(t,e),gl(e),8192&(s=e.child).flags&&(o=null!==s.memoizedState,s.stateNode.isHidden=o,!o||null!==s.alternate&&null!==s.alternate.memoizedState||(Bl=Xe())),4&i&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||d,fl(t,e),Ya=u):fl(t,e),gl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Qa(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(i,n,g)}}break;case 5:Qa(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==f?(f.return=p,Xa=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Ec(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),gl(e),4&i&&pl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rl(n)){var i=n;break e}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var s=i.stateNode;32&i.flags&&(he(s,""),i.flags&=-33),ll(e,ol(e),s);break;case 3:case 4:var o=i.stateNode.containerInfo;al(e,ol(e),o);break;default:throw Error(r(161))}}catch(a){Ec(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xa=e,yl(e,t,n)}function yl(e,t,n){for(var i=0!==(1&e.mode);null!==Xa;){var s=Xa,r=s.child;if(22===s.tag&&i){var o=null!==s.memoizedState||Ka;if(!o){var a=s.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Ka;var c=Ya;if(Ka=o,(Ya=l)&&!c)for(Xa=s;null!==Xa;)l=(o=Xa).child,22===o.tag&&null!==o.memoizedState?_l(s):null!==l?(l.return=o,Xa=l):_l(s);for(;null!==r;)Xa=r,yl(r,t,n),r=r.sibling;Xa=s,Ka=a,Ya=c}bl(e)}else 0!==(8772&s.subtreeFlags)&&null!==r?(r.return=s,Xa=r):bl(e)}}function bl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||nl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ya)if(null===n)i.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);i.componentDidUpdate(s,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Vr(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vr(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(r(163))}Ya||512&t.flags&&il(t)}catch(p){Ec(t,t.return,p)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function wl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function _l(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var s=t.return;try{i.componentDidMount()}catch(l){Ec(t,s,l)}}var r=t.return;try{il(t)}catch(l){Ec(t,r,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Ec(t,o,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var xl,El=Math.ceil,Sl=w.ReactCurrentDispatcher,Al=w.ReactCurrentOwner,Cl=w.ReactCurrentBatchConfig,Tl=0,kl=null,Il=null,Nl=0,Pl=0,Ml=Ss(0),Rl=0,Ol=null,Dl=0,Fl=0,Ll=0,jl=null,Ul=null,Bl=0,Wl=1/0,Hl=null,Vl=!1,ql=null,zl=null,Gl=!1,Jl=null,Kl=0,Yl=0,$l=null,Xl=-1,Ql=0;function Zl(){return 0!==(6&Tl)?Xe():-1!==Xl?Xl:Xl=Xe()}function ec(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Nl?Nl&-Nl:null!==mr.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=bt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function tc(e,t,n,i){if(50<Yl)throw Yl=0,$l=null,Error(r(185));vt(e,n,i),0!==(2&Tl)&&e===kl||(e===kl&&(0===(2&Tl)&&(Fl|=n),4===Rl&&oc(e,Nl)),nc(e,i),1===n&&0===Tl&&0===(1&t.mode)&&(Wl=Xe()+500,Us&&Hs()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var o=31-ot(r),a=1<<o,l=s[o];-1===l?0!==(a&n)&&0===(a&i)||(s[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}}(e,t);var i=ht(e,e===kl?Nl:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Us=!0,Ws(e)}(ac.bind(null,e)):Ws(ac.bind(null,e)),os(function(){0===(6&Tl)&&Hs()}),n=null;else{switch(wt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=kc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Xl=-1,Ql=0,0!==(6&Tl))throw Error(r(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var i=ht(e,e===kl?Nl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=mc(e,i);else{t=i;var s=Tl;Tl|=2;var o=pc();for(kl===e&&Nl===t||(Hl=null,Wl=Xe()+500,dc(e,t));;)try{vc();break}catch(l){hc(e,l)}Cr(),Sl.current=o,Tl=s,null!==Il?t=0:(kl=null,Nl=0,t=Rl)}if(0!==t){if(2===t&&(0!==(s=ft(e))&&(i=s,t=sc(e,s))),1===t)throw n=Ol,dc(e,0),oc(e,i),nc(e,Xe()),n;if(6===t)oc(e,i);else{if(s=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var s=n[i],r=s.getSnapshot;s=s.value;try{if(!ai(r(),s))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=mc(e,i))&&(0!==(o=ft(e))&&(i=o,t=sc(e,o))),1===t))throw n=Ol,dc(e,0),oc(e,i),nc(e,Xe()),n;switch(e.finishedWork=s,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:case 5:wc(e,Ul,Hl);break;case 3:if(oc(e,i),(130023424&i)===i&&10<(t=Bl+500-Xe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&i)!==i){Zl(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=is(wc.bind(null,e,Ul,Hl),t);break}wc(e,Ul,Hl);break;case 4:if(oc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,s=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>s&&(s=a),i&=~o}if(i=s,10<(i=(120>(i=Xe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*El(i/1960))-i)){e.timeoutHandle=is(wc.bind(null,e,Ul,Hl),i);break}wc(e,Ul,Hl);break;default:throw Error(r(329))}}}return nc(e,Xe()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=jl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Ul,Ul=n,null!==t&&rc(t)),e}function rc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~Ll,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function ac(e){if(0!==(6&Tl))throw Error(r(327));_c();var t=ht(e,0);if(0===(1&t))return nc(e,Xe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Ol,dc(e,0),oc(e,t),nc(e,Xe()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,Hl),nc(e,Xe()),null}function lc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(Wl=Xe()+500,Us&&Hs())}}function cc(e){null!==Jl&&0===Jl.tag&&0===(6&Tl)&&_c();var t=Tl;Tl|=1;var n=Cl.transition,i=bt;try{if(Cl.transition=null,bt=1,e)return e()}finally{bt=i,Cl.transition=n,0===(6&(Tl=t))&&Hs()}}function uc(){Pl=Ml.current,As(Ml)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Il)for(n=Il.return;null!==n;){var i=n;switch(tr(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Rs();break;case 3:$r(),As(Is),As(ks),no();break;case 5:Qr(i);break;case 4:$r();break;case 13:case 19:As(Zr);break;case 10:Tr(i.type._context);break;case 22:case 23:uc()}n=n.return}if(kl=e,Il=e=Mc(e.current,null),Nl=Pl=t,Rl=0,Ol=null,Ll=Fl=Dl=0,Ul=jl=null,null!==Pr){for(t=0;t<Pr.length;t++)if(null!==(i=(n=Pr[t]).interleaved)){n.interleaved=null;var s=i.next,r=n.pending;if(null!==r){var o=r.next;r.next=s,i.next=o}n.pending=i}Pr=null}return e}function hc(e,t){for(;;){var n=Il;try{if(Cr(),io.current=Qo,co){for(var i=oo.memoizedState;null!==i;){var s=i.queue;null!==s&&(s.pending=null),i=i.next}co=!1}if(ro=0,lo=ao=oo=null,uo=!1,ho=0,Al.current=null,null===n||null===n.return){Rl=1,Ol=t,Il=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Nl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,va(f,a,l,0,t),1&f.mode&&ma(o,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(o,u,t),fc();break e}c=Error(r(426))}else if(sr&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),fr(ca(c,l));break e}}o=c=ca(c,l),4!==Rl&&(Rl=2),null===jl?jl=[o]:jl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Wr(o,pa(0,c,t));break e;case 1:l=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===zl||!zl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Wr(o,fa(o,l,t));break e}}o=o.return}while(null!==o)}bc(n)}catch(w){t=w,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function pc(){var e=Sl.current;return Sl.current=Qo,null===e?Qo:e}function fc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===kl||0===(268435455&Dl)&&0===(268435455&Fl)||oc(kl,Nl)}function mc(e,t){var n=Tl;Tl|=2;var i=pc();for(kl===e&&Nl===t||(Hl=null,dc(e,t));;)try{gc();break}catch(s){hc(e,s)}if(Cr(),Tl=n,Sl.current=i,null!==Il)throw Error(r(261));return kl=null,Nl=0,Rl}function gc(){for(;null!==Il;)yc(Il)}function vc(){for(;null!==Il&&!Ye();)yc(Il)}function yc(e){var t=xl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?bc(e):Il=t,Al.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ga(n,t,Pl)))return void(Il=n)}else{if(null!==(n=Ja(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Rl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,n){var i=bt,s=Cl.transition;try{Cl.transition=null,bt=1,function(e,t,n,i){do{_c()}while(null!==Jl);if(0!==(6&Tl))throw Error(r(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-ot(n),r=1<<s;t[s]=0,i[s]=-1,e[s]=-1,n&=~r}}(e,o),e===kl&&(Il=kl=null,Nl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,kc(tt,function(){return _c(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var a=bt;bt=1;var l=Tl;Tl|=4,Al.current=null,function(e,t){if(es=qt,pi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var s=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(_){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==s&&3!==h.nodeType||(l=a+s),h!==o||0!==i&&3!==h.nodeType||(c=a+i),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===s&&(l=a),p===o&&++d===i&&(c=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},qt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(r(163))}}catch(_){Ec(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=el,el=!1}(e,n),ml(n,e),fi(ts),qt=!!es,ts=es=null,e.current=n,vl(n,e,s),$e(),Tl=l,bt=a,Cl.transition=o}else e.current=n;if(Gl&&(Gl=!1,Jl=e,Kl=s),o=e.pendingLanes,0===o&&(zl=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Xe()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],i(s.value,{componentStack:s.stack,digest:s.digest});if(Vl)throw Vl=!1,e=ql,ql=null,e;0!==(1&Kl)&&0!==e.tag&&_c(),o=e.pendingLanes,0!==(1&o)?e===$l?Yl++:(Yl=0,$l=e):Yl=0,Hs()}(e,t,n,i)}finally{Cl.transition=s,bt=i}return null}function _c(){if(null!==Jl){var e=wt(Kl),t=Cl.transition,n=bt;try{if(Cl.transition=null,bt=16>e?16:e,null===Jl)var i=!1;else{if(e=Jl,Jl=null,Kl=0,0!==(6&Tl))throw Error(r(331));var s=Tl;for(Tl|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:tl(8,d,o)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var p=(d=Xa).sibling,f=d.return;if(sl(d),d===u){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:tl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Xa=y;break e}Xa=o.return}}var b=e.current;for(Xa=b;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=b;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(x){Ec(l,l.return,x)}if(l===a){Xa=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Xa=_;break e}Xa=l.return}}if(Tl=s,Hs(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(st,e)}catch(x){}i=!0}return i}finally{bt=n,Cl.transition=t}}return!1}function xc(e,t,n){e=Ur(e,t=pa(0,t=ca(n,t),1),1),t=Zl(),null!==e&&(vt(e,1,t),nc(e,t))}function Ec(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===zl||!zl.has(i))){t=Ur(t,e=fa(t,e=ca(n,e),1),1),e=Zl(),null!==t&&(vt(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=Zl(),e.pingedLanes|=e.suspendedLanes&n,kl===e&&(Nl&n)===n&&(4===Rl||3===Rl&&(130023424&Nl)===Nl&&500>Xe()-Bl?dc(e,0):Ll|=n),nc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=Zl();null!==(e=Or(e,t))&&(vt(e,t,n),nc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(t),Ac(e,n)}function kc(e,t){return Je(e,t)}function Ic(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nc(e,t,n,i){return new Ic(e,t,n,i)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Nc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,i,s,o){var a=2;if(i=e,"function"===typeof e)Pc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Oc(n.children,s,o,t);case S:a=8,s|=8;break;case A:return(e=Nc(12,n,t,2|s)).elementType=A,e.lanes=o,e;case I:return(e=Nc(13,n,t,s)).elementType=I,e.lanes=o,e;case N:return(e=Nc(19,n,t,s)).elementType=N,e.lanes=o,e;case R:return Dc(n,s,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case T:a=9;break e;case k:a=11;break e;case P:a=14;break e;case M:a=16,i=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Nc(a,n,t,s)).elementType=e,t.type=i,t.lanes=o,t}function Oc(e,t,n,i){return(e=Nc(7,e,i,t)).lanes=n,e}function Dc(e,t,n,i){return(e=Nc(22,e,i,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Nc(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=Nc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jc(e,t,n,i,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,i,s,r,o,a,l){return e=new jc(e,t,n,a,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Nc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fr(r),e}function Bc(e){if(!e)return Ts;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ms(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ms(n))return Ds(e,n,t)}return t}function Wc(e,t,n,i,s,r,o,a,l){return(e=Uc(n,i,!0,e,0,r,0,a,l)).context=Bc(null),n=e.current,(r=jr(i=Zl(),s=ec(n))).callback=void 0!==t&&null!==t?t:null,Ur(n,r,s),e.current.lanes=s,vt(e,s,i),nc(e,i),e}function Hc(e,t,n,i){var s=t.current,r=Zl(),o=ec(s);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=jr(r,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ur(s,t,o))&&(tc(e,s,o,r),Br(e,s,o)),o}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}xl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Is.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Ia(t),pr();break;case 5:Xr(t);break;case 1:Ms(t.type)&&Fs(t);break;case 4:Yr(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,s=t.memoizedProps.value;Cs(xr,i._currentValue),i._currentValue=s;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Cs(Zr,1&Zr.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fa(e,t,n):(Cs(Zr,1&Zr.current),null!==(e=Va(e,t,n))?e.sibling:null);Cs(Zr,1&Zr.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Wa(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs(Zr,Zr.current),i)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Va(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,sr&&0!==(1048576&t.flags)&&Zs(t,Gs,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ha(e,t),e=t.pendingProps;var s=Ps(t,ks.current);Ir(t,n),s=go(null,t,i,e,s,n);var o=vo();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ms(i)?(o=!0,Fs(t)):o=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Fr(t),s.updater=sa,t.stateNode=s,s._reactInternals=t,la(t,i,e,n),t=ka(null,t,i,!0,o,n)):(t.tag=0,sr&&o&&er(t),wa(null,t,s,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,i=(s=i._init)(i._payload),t.type=i,s=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===P)return 14}return 2}(i),e=na(i,e),s){case 0:t=Ca(null,t,i,e,n);break e;case 1:t=Ta(null,t,i,e,n);break e;case 11:t=_a(null,t,i,e,n);break e;case 14:t=xa(null,t,i,na(i.type,e),n);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,s=t.pendingProps,Ca(e,t,i,s=t.elementType===i?s:na(i,s),n);case 1:return i=t.type,s=t.pendingProps,Ta(e,t,i,s=t.elementType===i?s:na(i,s),n);case 3:e:{if(Ia(t),null===e)throw Error(r(387));i=t.pendingProps,s=(o=t.memoizedState).element,Lr(e,t),Hr(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Na(e,t,i,n,s=ca(Error(r(423)),t));break e}if(i!==s){t=Na(e,t,i,n,s=ca(Error(r(424)),t));break e}for(ir=cs(t.stateNode.containerInfo.firstChild),nr=t,sr=!0,rr=null,n=_r(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pr(),i===s){t=Va(e,t,n);break e}wa(e,t,i,n)}t=t.child}return t;case 5:return Xr(t),null===e&&cr(t),i=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,a=s.children,ns(i,s)?a=null:null!==o&&ns(i,o)&&(t.flags|=32),Aa(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&cr(t),null;case 13:return Fa(e,t,n);case 4:return Yr(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=wr(t,null,i,n):wa(e,t,i,n),t.child;case 11:return i=t.type,s=t.pendingProps,_a(e,t,i,s=t.elementType===i?s:na(i,s),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,Cs(xr,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===s.children&&!Is.current){t=Va(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=jr(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),kr(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(r(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),kr(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,i=t.pendingProps.children,Ir(t,n),i=i(s=Nr(s)),t.flags|=1,wa(e,t,i,n),t.child;case 14:return s=na(i=t.type,t.pendingProps),xa(e,t,i,s=na(i.type,s),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:na(i,s),Ha(e,t),t.tag=1,Ms(i)?(e=!0,Fs(t)):e=!1,Ir(t,n),oa(t,i,s),la(t,i,s,n),ka(null,t,i,!0,e,n);case 19:return Wa(e,t,n);case 22:return Sa(e,t,n)}throw Error(r(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Qc(e,t,n,i,s){var r=n._reactRootContainer;if(r){var o=r;if("function"===typeof s){var a=s;s=function(){var e=Vc(o);a.call(e)}}Hc(t,o,e,s)}else o=function(e,t,n,i,s){if(s){if("function"===typeof i){var r=i;i=function(){var e=Vc(o);r.call(e)}}var o=Wc(t,i,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[fs]=o.current,Hi(8===e.nodeType?e.parentNode:e),cc(),o}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof i){var a=i;i=function(){var e=Vc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[fs]=l.current,Hi(8===e.nodeType?e.parentNode:e),cc(function(){Hc(t,l,n,i)}),l}(n,t,e,s,i);return Vc(o)}Kc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Hc(e,t,null,null)},Kc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc(function(){Hc(null,e,null,null)}),t[fs]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),nc(t,Xe()),0===(6&Tl)&&(Wl=Xe()+500,Hs()))}break;case 13:cc(function(){var t=Or(e,1);if(null!==t){var n=Zl();tc(t,e,1,n)}}),zc(e,1)}},xt=function(e){if(13===e.tag){var t=Or(e,134217728);if(null!==t)tc(t,e,134217728,Zl());zc(e,134217728)}},Et=function(e){if(13===e.tag){var t=ec(e),n=Or(e,t);if(null!==n)tc(n,e,t,Zl());zc(e,t)}},St=function(){return bt},At=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},xe=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=_s(i);if(!s)throw Error(r(90));J(i),Q(i,s)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ke=lc,Ie=cc;var Zc={usingClientEntryPoint:!1,Events:[bs,ws,_s,Ce,Te,lc]},eu={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=ze(e))?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{st=nu.inject(tu),rt=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(r(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(r(299));var n=!1,i="",s=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,i,s),e[fs]=t.current,Hi(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=ze(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(r(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,s=!1,o="",a=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,s,0,o,a),e[fs]=t.current,Hi(e),i)for(e=0;e<i.length;e++)s=(s=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Kc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(r(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(r(40));return!!e._reactRootContainer&&(cc(function(){Qc(null,null,e,!1,function(){e._reactRootContainer=null,e[fs]=null})}),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!$c(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Qc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},2875(e,t,n){"use strict";var i,s,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;const o=n(8584),a=n(8396),l=n(656),c={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return u(e,"additionalItems",t);n.items=!0,(0,a.alwaysValidSchema)(n,t)||e.ok((0,l.validateArray)(e))}};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.schema;const{gen:l,parentSchema:c,data:u,keyword:d,it:h}=e;!function(e){const{opts:i,errSchemaPath:s}=h,r=n.length,o=r===e.minItems&&(r===e.maxItems||!1===e[t]);if(i.strictTuples&&!o){const e='"'.concat(d,'" is ').concat(r,"-tuple, but minItems or maxItems/").concat(t,' are not specified or different at path "').concat(s,'"');(0,a.checkStrictMode)(h,e,i.strictTuples)}}(c),h.opts.unevaluated&&n.length&&!0!==h.items&&(h.items=a.mergeEvaluated.items(l,n.length,h.items));const p=l.name("valid"),f=l.const("len",(0,o._)(i||(i=r(["",".length"])),u));n.forEach((t,n)=>{(0,a.alwaysValidSchema)(h,t)||(l.if((0,o._)(s||(s=r([""," > ",""])),f,n),()=>e.subschema({keyword:d,schemaProp:n,dataProp:n},p)),e.ok(p))})}t.validateTuple=u,t.default=c},2897(e,t,n){var i=n(3693);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},2943(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2875),s={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,i.validateTuple)(e,"items")};t.default=s},2979(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(122);i.code='require("ajv/dist/runtime/equal").default',t.default=i},2985(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8396),s={keyword:["then","else"],schemaType:["object","boolean"],code(e){let{keyword:t,parentSchema:n,it:s}=e;void 0===n.if&&(0,i.checkStrictMode)(s,'"'.concat(t,'" without "if" is ignored'))}};t.default=s},2992(e,t,n){"use strict";var i,s=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const r=n(8584),o=n(8396),a={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:e=>{let{params:t}=e;return(0,r._)(i||(i=s(["{propertyName: ","}"])),t.propertyName)}},code(e){const{gen:t,schema:n,data:i,it:s}=e;if((0,o.alwaysValidSchema)(s,n))return;const a=t.name("valid");t.forIn("key",i,n=>{e.setParams({propertyName:n}),e.subschema({keyword:"propertyNames",data:n,dataTypes:["string"],propertyName:n,compositeRule:!0},a),t.if((0,r.not)(a),()=>{e.error(!0),s.allErrors||t.break()})}),e.ok(a)}};t.default=a},3324(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=n(8396),c={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:e=>{let{params:t}=e;return(0,a.str)(i||(i=o(['must match "','" schema'])),t.ifClause)},params:e=>{let{params:t}=e;return(0,a._)(s||(s=o(["{failingKeyword: ","}"])),t.ifClause)}},code(e){const{gen:t,parentSchema:n,it:i}=e;void 0===n.then&&void 0===n.else&&(0,l.checkStrictMode)(i,'"if" without "then" and "else" is ignored');const s=u(i,"then"),c=u(i,"else");if(!s&&!c)return;const d=t.let("valid",!0),h=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},h);e.mergeEvaluated(t)}(),e.reset(),s&&c){const n=t.let("ifClause");e.setParams({ifClause:n}),t.if(h,p("then",n),p("else",n))}else s?t.if(h,p("then")):t.if((0,a.not)(h),p("else"));function p(n,i){return()=>{const s=e.subschema({keyword:n},h);t.assign(d,h),e.mergeValidEvaluated(s,d),i?t.assign(i,(0,a._)(r||(r=o(["",""])),n)):e.setParams({ifClause:n})}}e.pass(d,()=>e.error(!0))}};function u(e,t){const n=e.schema[t];return void 0!==n&&!(0,l.alwaysValidSchema)(e,n)}t.default=c},3670(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5413),s=n(656),r=n(8396),o=n(2075),a={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:a,data:l,it:c}=e;"all"===c.opts.removeAdditional&&void 0===a.additionalProperties&&o.default.code(new i.KeywordCxt(c,o.default,"additionalProperties"));const u=(0,s.allSchemaProperties)(n);for(const i of u)c.definedProperties.add(i);c.opts.unevaluated&&u.length&&!0!==c.props&&(c.props=r.mergeEvaluated.props(t,(0,r.toHash)(u),c.props));const d=u.filter(e=>!(0,r.alwaysValidSchema)(c,n[e]));if(0===d.length)return;const h=t.name("valid");for(const i of d)p(i)?f(i):(t.if((0,s.propertyInData)(t,l,i,c.opts.ownProperties)),f(i),c.allErrors||t.else().var(h,!0),t.endIf()),e.it.definedProperties.add(i),e.ok(h);function p(e){return c.opts.useDefaults&&!c.compositeRule&&void 0!==n[e].default}function f(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},h)}}};t.default=a},3693(e,t,n){var i=n(7736);e.exports=function(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3709(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=[n(2262).default];t.default=i},3738(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3740(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=n},3837(e){"use strict";e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},3939(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1156),s=n(2943),r=n(2875),o=n(4859),a=n(6386),l=n(1598),c=n(2992),u=n(2075),d=n(3670),h=n(5532),p=n(8218),f=n(3952),m=n(1289),g=n(5801),v=n(3324),y=n(2985);t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[p.default,f.default,m.default,g.default,v.default,y.default,c.default,u.default,l.default,d.default,h.default];return e?t.push(s.default,o.default):t.push(i.default,r.default),t.push(a.default),t}},3952(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:n(656).validateUnion,error:{message:"must match a schema in anyOf"}};t.default=i},4202(e,t){"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var _=Array.isArray,x=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,i){var s,r={},o=null,a=null;if(null!=t)for(s in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)x.call(t,s)&&!S.hasOwnProperty(s)&&(r[s]=t[s]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===r[s]&&(r[s]=l[s]);return{$$typeof:n,type:e,key:o,ref:a,props:r,_owner:E.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,s,r,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===r?"."+k(l,0):r,_(o)?(s="",null!=e&&(s=e.replace(T,"$&/")+"/"),I(o,t,s,"",function(e){return e})):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,s+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(l=0,r=""===r?".":r+":",_(e))for(var c=0;c<e.length;c++){var u=r+k(a=e[c],c);l+=I(a,t,s,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=I(a=a.value,t,s,u=r+k(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var i=[],s=0;return I(e,i,"","",function(e){return t.call(n,e,s++)}),i}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},R={transition:null},O={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:R,ReactCurrentOwner:E};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=o,t.PureComponent=b,t.StrictMode=r,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=D,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=m({},e.props),r=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!S.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:e.type,key:r,ref:o,props:s,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,n){return M.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,n){return M.current.useReducer(e,t,n)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return M.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return M.current.useTransition()},t.version="18.3.1"},4366(e,t,n){"use strict";var i=n(2897).default;const{normalizeIPv6:s,removeDotSegments:r,recomposeAuthority:o,normalizeComponentEncoding:a,isIPv4:l,nonSimpleDomain:c}=n(6099),{SCHEMES:u,getSchemeHandler:d}=n(1578);function h(e,t,n,i){const s={};return i||(e=m(p(e,n),n),t=m(p(t,n),n)),!(n=n||{}).tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=r(t.path||""),s.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=r(t.path||""),s.query=t.query):(t.path?("/"===t.path[0]?s.path=r(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?s.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:s.path=t.path:s.path="/"+t.path,s.path=r(s.path)),s.query=t.query):(s.path=e.path,void 0!==t.query?s.query=t.query:s.query=e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s}function p(e,t){const n={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},i=Object.assign({},t),s=[],a=d(i.scheme||n.scheme);a&&a.serialize&&a.serialize(n,i),void 0!==n.path&&(i.skipEscape?n.path=unescape(n.path):(n.path=escape(n.path),void 0!==n.scheme&&(n.path=n.path.split("%3A").join(":")))),"suffix"!==i.reference&&n.scheme&&s.push(n.scheme,":");const l=o(n);if(void 0!==l&&("suffix"!==i.reference&&s.push("//"),s.push(l),n.path&&"/"!==n.path[0]&&s.push("/")),void 0!==n.path){let e=n.path;i.absolutePath||a&&a.absolutePath||(e=r(e)),void 0===l&&"/"===e[0]&&"/"===e[1]&&(e="/%2F"+e.slice(2)),s.push(e)}return void 0!==n.query&&s.push("?",n.query),void 0!==n.fragment&&s.push("#",n.fragment),s.join("")}const f=/^(?:((?:[\0-"\$-\.0-9;->@-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+):)?(?:\/\/((?:((?:[\0-"\$-\.0->A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)@)?(\[(?:[\0-"\$-\.0->@-\\\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\]|(?:[\0-"\$-\.0-9;->@-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)(?::([0-9]*))?))?((?:[\0-"\$->@-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)(?:\?((?:[\0-"\$-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?(?:#((?:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|[\n\r])*))?/;function m(e,t){const n=Object.assign({},t),i={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let r=!1;"suffix"===n.reference&&(e=n.scheme?n.scheme+":"+e:"//"+e);const o=e.match(f);if(o){if(i.scheme=o[1],i.userinfo=o[3],i.host=o[4],i.port=parseInt(o[5],10),i.path=o[6]||"",i.query=o[7],i.fragment=o[8],isNaN(i.port)&&(i.port=o[5]),i.host){if(!1===l(i.host)){const e=s(i.host);i.host=e.host.toLowerCase(),r=e.isIPV6}else r=!0}void 0!==i.scheme||void 0!==i.userinfo||void 0!==i.host||void 0!==i.port||void 0!==i.query||i.path?void 0===i.scheme?i.reference="relative":void 0===i.fragment?i.reference="absolute":i.reference="uri":i.reference="same-document",n.reference&&"suffix"!==n.reference&&n.reference!==i.reference&&(i.error=i.error||"URI is not a "+n.reference+" reference.");const t=d(n.scheme||i.scheme);if(!n.unicodeSupport&&(!t||!t.unicodeSupport)&&i.host&&(n.domainHost||t&&t.domainHost)&&!1===r&&c(i.host))try{i.host=URL.domainToASCII(i.host.toLowerCase())}catch(a){i.error=i.error||"Host's domain name can not be converted to ASCII: "+a}(!t||t&&!t.skipNormalize)&&(-1!==e.indexOf("%")&&(void 0!==i.scheme&&(i.scheme=unescape(i.scheme)),void 0!==i.host&&(i.host=unescape(i.host))),i.path&&(i.path=escape(unescape(i.path))),i.fragment&&(i.fragment=encodeURI(decodeURIComponent(i.fragment)))),t&&t.parse&&t.parse(i,n)}else i.error=i.error||"URI can not be parsed.";return i}const g={SCHEMES:u,normalize:function(e,t){return"string"===typeof e?e=p(m(e,t),t):"object"===typeof e&&(e=m(p(e,t),t)),e},resolve:function(e,t,n){const i=n?Object.assign({scheme:"null"},n):{scheme:"null"},s=h(m(e,i),m(t,i),i,!0);return i.skipEscape=!0,p(s,i)},resolveComponent:h,equal:function(e,t,n){return"string"===typeof e?(e=unescape(e),e=p(a(m(e,n),!0),i(i({},n),{},{skipEscape:!0}))):"object"===typeof e&&(e=p(a(e,!0),i(i({},n),{},{skipEscape:!0}))),"string"===typeof t?(t=unescape(t),t=p(a(m(t,n),!0),i(i({},n),{},{skipEscape:!0}))):"object"===typeof t&&(t=p(a(t,!0),i(i({},n),{},{skipEscape:!0}))),e.toLowerCase()===t.toLowerCase()},serialize:p,parse:m};e.exports=g,e.exports.default=g,e.exports.fastUri=g},4391(e,t,n){"use strict";var i=n(7950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},4445(e,t,n){"use strict";var i=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;const s=new Set(["string","number","integer","boolean","null","object","array"]);t.isJSONType=function(e){return"string"==typeof e&&s.has(e)},t.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:i(i({},e),{},{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}},4601(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4366);i.code='require("ajv/dist/runtime/uri").default',t.default=i},4700(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message(e){let{keyword:t,schemaCode:n}=e;const s="maxItems"===t?"more":"fewer";return(0,a.str)(i||(i=o(["must NOT have "," than "," items"])),s,n)},params:e=>{let{schemaCode:t}=e;return(0,a._)(s||(s=o(["{limit: ","}"])),t)}},code(e){const{keyword:t,data:n,schemaCode:i}=e,s="maxItems"===t?a.operators.GT:a.operators.LT;e.fail$data((0,a._)(r||(r=o(["",".length "," ",""])),n,s,i))}};t.default=l},4796(e,t,n){"use strict";var i,s,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const o=n(656),a=n(8584),l=n(8396),c={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:e=>{let{params:{missingProperty:t}}=e;return(0,a.str)(i||(i=r(["must have required property '","'"])),t)},params:e=>{let{params:{missingProperty:t}}=e;return(0,a._)(s||(s=r(["{missingProperty: ","}"])),t)}},code(e){const{gen:t,schema:n,schemaCode:i,data:s,$data:r,it:c}=e,{opts:u}=c;if(!r&&0===n.length)return;const d=n.length>=u.loopRequired;if(c.allErrors?function(){if(d||r)e.block$data(a.nil,h);else for(const t of n)(0,o.checkReportMissingProp)(e,t)}():function(){const l=t.let("missing");if(d||r){const n=t.let("valid",!0);e.block$data(n,()=>function(n,r){e.setParams({missingProperty:n}),t.forOf(n,i,()=>{t.assign(r,(0,o.propertyInData)(t,s,n,u.ownProperties)),t.if((0,a.not)(r),()=>{e.error(),t.break()})},a.nil)}(l,n)),e.ok(n)}else t.if((0,o.checkMissingProp)(e,n,l)),(0,o.reportMissingProp)(e,l),t.else()}(),u.strictRequired){const t=e.parentSchema.properties,{definedProperties:i}=e.it;for(const e of n)if(void 0===(null===t||void 0===t?void 0:t[e])&&!i.has(e)){const t=c.schemaEnv.baseId+c.errSchemaPath,n='required property "'.concat(e,'" is not defined at "').concat(t,'" (strictRequired)');(0,l.checkStrictMode)(c,n,c.opts.strictRequired)}}function h(){t.forOf("prop",i,n=>{e.setParams({missingProperty:n}),t.if((0,o.noPropertyInData)(t,s,n,u.ownProperties),()=>e.error())})}}};t.default=c},4859(e,t,n){"use strict";var i,s,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const o=n(8584),a=n(8396),l=n(656),c=n(1156),u={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:e=>{let{params:{len:t}}=e;return(0,o.str)(i||(i=r(["must NOT have more than "," items"])),t)},params:e=>{let{params:{len:t}}=e;return(0,o._)(s||(s=r(["{limit: ","}"])),t)}},code(e){const{schema:t,parentSchema:n,it:i}=e,{prefixItems:s}=n;i.items=!0,(0,a.alwaysValidSchema)(i,t)||(s?(0,c.validateAdditionalItems)(e,s):e.ok((0,l.validateArray)(e)))}};t.default=u},5043(e,t,n){"use strict";e.exports=n(4202)},5280(e,t,n){"use strict";var i,s,r,o,a,l=n(2897).default,c=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const u=n(5467);class d extends Error{constructor(e){super('CodeGen: "code" for '.concat(e," not defined")),this.value=e.value}}var h;!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"}(h||(t.UsedValueState=h={})),t.varKinds={const:new u.Name("const"),let:new u.Name("let"),var:new u.Name("var")};class p{constructor(){let{prefixes:e,parent:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof u.Name?e:this.name(e)}name(e){return new u.Name(this._newName(e))}_newName(e){const t=this._names[e]||this._nameGroup(e);return"".concat(e).concat(t.index++)}_nameGroup(e){var t,n;if((null===(n=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===n?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error('CodeGen: prefix "'.concat(e,'" is not allowed in this scope'));return this._names[e]={prefix:e,index:0}}}t.Scope=p;class f extends u.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,t){let{property:n,itemIndex:s}=t;this.value=e,this.scopePath=(0,u._)(i||(i=c([".","[","]"])),new u.Name(n),s)}}t.ValueScopeName=f;const m=(0,u._)(s||(s=c(["\n"],["\\n"])));t.ValueScope=class extends p{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts=l(l({},e),{},{_n:e.lines?m:u.nil})}get(){return this._scope}name(e){return new f(e,this._newName(e))}value(e,t){var n;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const i=this.toName(e),{prefix:s}=i,r=null!==(n=t.key)&&void 0!==n?n:t.ref;let o=this._values[s];if(o){const e=o.get(r);if(e)return e}else o=this._values[s]=new Map;o.set(r,i);const a=this._scope[s]||(this._scope[s]=[]),l=a.length;return a[l]=t.ref,i.setValue(t,{property:s,itemIndex:l}),i}getValue(e,t){const n=this._values[e];if(n)return n.get(t)}scopeRefs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._values;return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error('CodeGen: name "'.concat(t,'" has no value'));return(0,u._)(r||(r=c(["","",""])),e,t.scopePath)})}scopeCode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._values,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error('CodeGen: name "'.concat(e,'" has no value'));return e.value.code},t,n)}_reduceValues(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,r=u.nil;for(const l in e){const p=e[l];if(!p)continue;const f=i[l]=i[l]||new Map;p.forEach(e=>{if(f.has(e))return;f.set(e,h.Started);let i=n(e);if(i){const n=this.opts.es5?t.varKinds.var:t.varKinds.const;r=(0,u._)(o||(o=c(["",""," "," = ",";",""])),r,n,e,i,this.opts._n)}else{if(!(i=null===s||void 0===s?void 0:s(e)))throw new d(e);r=(0,u._)(a||(a=c(["","","",""])),r,i,this.opts._n)}f.set(e,h.Completed)})}return r}}},5413(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y,b,w,_,x,E,S,A,C,T,k,I,N,P,M,R,O,D,F,L,j,U,B,W,H=n(2897).default,V=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;const q=n(6470),z=n(9273),G=n(2392),J=n(9273),K=n(463),Y=n(9142),$=n(6340),X=n(8584),Q=n(266),Z=n(2302),ee=n(8396),te=n(6772);function ne(e,t){let{gen:n,validateName:v,schema:y,schemaEnv:b,opts:w}=e;w.code.es5?n.func(v,(0,X._)(i||(i=V(["",", ",""])),Q.default.data,Q.default.valCxt),b.$async,()=>{n.code((0,X._)(s||(s=V(['"use strict"; ',""])),ie(y,w))),function(e,t){e.if(Q.default.valCxt,()=>{e.var(Q.default.instancePath,(0,X._)(l||(l=V(["",".",""])),Q.default.valCxt,Q.default.instancePath)),e.var(Q.default.parentData,(0,X._)(c||(c=V(["",".",""])),Q.default.valCxt,Q.default.parentData)),e.var(Q.default.parentDataProperty,(0,X._)(u||(u=V(["",".",""])),Q.default.valCxt,Q.default.parentDataProperty)),e.var(Q.default.rootData,(0,X._)(d||(d=V(["",".",""])),Q.default.valCxt,Q.default.rootData)),t.dynamicRef&&e.var(Q.default.dynamicAnchors,(0,X._)(h||(h=V(["",".",""])),Q.default.valCxt,Q.default.dynamicAnchors))},()=>{e.var(Q.default.instancePath,(0,X._)(p||(p=V(['""'])))),e.var(Q.default.parentData,(0,X._)(f||(f=V(["undefined"])))),e.var(Q.default.parentDataProperty,(0,X._)(m||(m=V(["undefined"])))),e.var(Q.default.rootData,Q.default.data),t.dynamicRef&&e.var(Q.default.dynamicAnchors,(0,X._)(g||(g=V(["{}"]))))})}(n,w),n.code(t)}):n.func(v,(0,X._)(r||(r=V(["",", ",""])),Q.default.data,function(e){return(0,X._)(o||(o=V(["{",'="", ',", ",", ","=","","}={}"])),Q.default.instancePath,Q.default.parentData,Q.default.parentDataProperty,Q.default.rootData,Q.default.data,e.dynamicRef?(0,X._)(a||(a=V([", ","={}"])),Q.default.dynamicAnchors):X.nil)}(w)),b.$async,()=>n.code(ie(y,w)).code(t))}function ie(e,t){const n="object"==typeof e&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,X._)(S||(S=V(["/*# sourceURL="," */"])),n):X.nil}function se(e,t){oe(e)&&(ae(e),re(e))?function(e,t){const{schema:n,gen:i,opts:s}=e;s.$comment&&n.$comment&&ce(e);(function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,Z.resolveUrl)(e.opts.uriResolver,e.baseId,t))})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const r=i.const("_errs",Q.default.errors);le(e,r),i.var(t,(0,X._)(A||(A=V([""," === ",""])),r,Q.default.errors))}(e,t):(0,q.boolOrEmptySchema)(e,t)}function re(e){let{schema:t,self:n}=e;if("boolean"==typeof t)return!t;for(const i in t)if(n.RULES.all[i])return!0;return!1}function oe(e){return"boolean"!=typeof e.schema}function ae(e){(0,ee.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:n,opts:i,self:s}=e;t.$ref&&i.ignoreKeywordsWithRef&&(0,ee.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn('$ref: keywords ignored in schema at path "'.concat(n,'"'))}(e)}function le(e,t){if(e.opts.jtd)return ue(e,[],!1,t);const n=(0,z.getSchemaTypes)(e.schema);ue(e,n,!(0,z.coerceAndCheckDataType)(e,n),t)}function ce(e){let{gen:t,schemaEnv:n,schema:i,errSchemaPath:s,opts:r}=e;const o=i.$comment;if(!0===r.$comment)t.code((0,X._)(C||(C=V(["",".logger.log(",")"])),Q.default.self,o));else if("function"==typeof r.$comment){const e=(0,X.str)(T||(T=V(["","/$comment"])),s),i=t.scopeValue("root",{ref:n.root});t.code((0,X._)(k||(k=V(["",".opts.$comment(",", ",", ",".schema)"])),Q.default.self,o,e,i))}}function ue(e,t,n,i){const{gen:s,schema:r,data:o,allErrors:a,opts:l,self:c}=e,{RULES:u}=c;function d(c){(0,G.shouldUseGroup)(r,c)&&(c.type?(s.if((0,J.checkDataType)(c.type,o,l.strictNumbers)),de(e,c),1===t.length&&t[0]===c.type&&n&&(s.else(),(0,J.reportTypeError)(e)),s.endIf()):de(e,c),a||s.if((0,X._)(D||(D=V([""," === ",""])),Q.default.errors,i||0)))}!r.$ref||!l.ignoreKeywordsWithRef&&(0,ee.schemaHasRulesButRef)(r,u)?(l.jtd||function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(t=>{pe(e.dataTypes,t)||fe(e,'type "'.concat(t,'" not allowed by context "').concat(e.dataTypes.join(","),'"'))}),function(e,t){const n=[];for(const i of e.dataTypes)pe(t,i)?n.push(i):t.includes("integer")&&"number"===i&&n.push("integer");e.dataTypes=n}(e,t)})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&fe(e,"use allowUnionTypes to allow union type keyword")}(e,t);!function(e,t){const n=e.self.RULES.all;for(const i in n){const s=n[i];if("object"==typeof s&&(0,G.shouldUseRule)(e.schema,s)){const{type:n}=s.definition;n.length&&!n.some(e=>he(t,e))&&fe(e,'missing type "'.concat(n.join(","),'" for keyword "').concat(i,'"'))}}}(e,e.dataTypes)}(e,t),s.block(()=>{for(const e of u.rules)d(e);d(u.post)})):s.block(()=>ge(e,"$ref",u.all.$ref.definition))}function de(e,t){const{gen:n,schema:i,opts:{useDefaults:s}}=e;s&&(0,K.assignDefaults)(e,t.type),n.block(()=>{for(const n of t.rules)(0,G.shouldUseRule)(i,n)&&ge(e,n.keyword,n.definition,t.type)})}function he(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function pe(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function fe(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=' at "'.concat(n,'" (strictTypes)'),(0,ee.checkStrictMode)(e,t,e.opts.strictTypes)}t.validateFunctionCode=function(e){oe(e)&&(ae(e),re(e))?function(e){const{schema:t,opts:n,gen:i}=e;ne(e,()=>{n.$comment&&t.$comment&&ce(e),function(e){const{schema:t,opts:n}=e;void 0!==t.default&&n.useDefaults&&n.strictSchema&&(0,ee.checkStrictMode)(e,"default is ignored in the schema root")}(e),i.let(Q.default.vErrors,null),i.let(Q.default.errors,0),n.unevaluated&&function(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",(0,X._)(v||(v=V(["",".evaluated"])),n)),t.if((0,X._)(y||(y=V(["",".dynamicProps"])),e.evaluated),()=>t.assign((0,X._)(b||(b=V(["",".props"])),e.evaluated),(0,X._)(w||(w=V(["undefined"]))))),t.if((0,X._)(_||(_=V(["",".dynamicItems"])),e.evaluated),()=>t.assign((0,X._)(x||(x=V(["",".items"])),e.evaluated),(0,X._)(E||(E=V(["undefined"])))))}(e),le(e),function(e){const{gen:t,schemaEnv:n,validateName:i,ValidationError:s,opts:r}=e;n.$async?t.if((0,X._)(I||(I=V([""," === 0"])),Q.default.errors),()=>t.return(Q.default.data),()=>t.throw((0,X._)(N||(N=V(["new ","(",")"])),s,Q.default.vErrors))):(t.assign((0,X._)(P||(P=V(["",".errors"])),i),Q.default.vErrors),r.unevaluated&&function(e){let{gen:t,evaluated:n,props:i,items:s}=e;i instanceof X.Name&&t.assign((0,X._)(R||(R=V(["",".props"])),n),i);s instanceof X.Name&&t.assign((0,X._)(O||(O=V(["",".items"])),n),s)}(e),t.return((0,X._)(M||(M=V([""," === 0"])),Q.default.errors)))}(e)})}(e):ne(e,()=>(0,q.topBoolOrEmptySchema)(e))};class me{constructor(e,t,n){if((0,Y.validateKeywordUsage)(e,t,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,ee.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",be(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Y.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error("".concat(n," value must be ").concat(JSON.stringify(t.schemaType)));("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",Q.default.errors))}result(e,t,n){this.failResult((0,X.not)(e),t,n)}failResult(e,t,n){this.gen.if(e),n?n():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,X.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail((0,X._)(F||(F=V([""," !== undefined && (",")"])),t,(0,X.or)(this.invalid$data(),e)))}error(e,t,n){if(t)return this.setParams(t),this._error(e,n),void this.setParams({});this._error(e,n)}_error(e,t){(e?te.reportExtraError:te.reportError)(this,this.def.error,t)}$dataError(){(0,te.reportError)(this,this.def.$dataError||te.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,te.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X.nil;this.gen.block(()=>{this.check$data(e,n),t()})}check$data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X.nil,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.nil;if(!this.$data)return;const{gen:n,schemaCode:i,schemaType:s,def:r}=this;n.if((0,X.or)((0,X._)(L||(L=V([""," === undefined"])),i),t)),e!==X.nil&&n.assign(e,!0),(s.length||r.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==X.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:n,def:i,it:s}=this;return(0,X.or)(function(){if(n.length){if(!(t instanceof X.Name))throw new Error("ajv implementation error");const e=Array.isArray(n)?n:[n];return(0,X._)(j||(j=V(["",""])),(0,J.checkDataTypes)(e,t,s.opts.strictNumbers,J.DataType.Wrong))}return X.nil}(),function(){if(i.validateSchema){const n=e.scopeValue("validate$data",{ref:i.validateSchema});return(0,X._)(U||(U=V(["!","(",")"])),n,t)}return X.nil}())}subschema(e,t){const n=(0,$.getSubschema)(this.it,e);(0,$.extendSubschemaData)(n,this.it,e),(0,$.extendSubschemaMode)(n,e);const i=H(H(H({},this.it),n),{},{items:void 0,props:void 0});return se(i,t),i}mergeEvaluated(e,t){const{it:n,gen:i}=this;n.opts.unevaluated&&(!0!==n.props&&void 0!==e.props&&(n.props=ee.mergeEvaluated.props(i,e.props,n.props,t)),!0!==n.items&&void 0!==e.items&&(n.items=ee.mergeEvaluated.items(i,e.items,n.items,t)))}mergeValidEvaluated(e,t){const{it:n,gen:i}=this;if(n.opts.unevaluated&&(!0!==n.props||!0!==n.items))return i.if(t,()=>this.mergeEvaluated(e,X.Name)),!0}}function ge(e,t,n,i){const s=new me(e,n,t);"code"in n?n.code(s,i):s.$data&&n.validate?(0,Y.funcKeywordCode)(s,n):"macro"in n?(0,Y.macroKeywordCode)(s,n):(n.compile||n.validate)&&(0,Y.funcKeywordCode)(s,n)}t.KeywordCxt=me;const ve=/^\/(?:[^~]|~0|~1)*$/,ye=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function be(e,t){let n,i,{dataLevel:s,dataNames:r,dataPathArr:o}=t;if(""===e)return Q.default.rootData;if("/"===e[0]){if(!ve.test(e))throw new Error("Invalid JSON-pointer: ".concat(e));n=e,i=Q.default.rootData}else{const t=ye.exec(e);if(!t)throw new Error("Invalid JSON-pointer: ".concat(e));const a=+t[1];if(n=t[2],"#"===n){if(a>=s)throw new Error(c("property/index",a));return o[s-a]}if(a>s)throw new Error(c("data",a));if(i=r[s-a],!n)return i}let a=i;const l=n.split("/");for(const u of l)u&&(i=(0,X._)(B||(B=V(["","",""])),i,(0,X.getProperty)((0,ee.unescapeJsonPointer)(u))),a=(0,X._)(W||(W=V([""," && ",""])),a,i));return a;function c(e,t){return"Cannot access ".concat(e," ").concat(t," levels up, current level is ").concat(s)}}t.getData=be},5467(e,t,n){"use strict";var i,s,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class o{}t._CodeOrName=o,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class a extends o{constructor(e){if(super(),!t.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=a;class l extends o{constructor(e){super(),this._items="string"===typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>"".concat(e).concat(t),"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof a&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function c(e){const t=[e[0]];let n=0;for(var i=arguments.length,s=new Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];for(;n<s.length;)h(t,s[n]),t.push(e[++n]);return new l(t)}t._Code=l,t.nil=new l(""),t._=c;const u=new l("+");function d(e){const t=[f(e[0])];let n=0;for(var i=arguments.length,s=new Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];for(;n<s.length;)t.push(u),h(t,s[n]),t.push(u,f(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===u){const n=p(e[t-1],e[t+1]);if(void 0!==n){e.splice(t-1,3,n);continue}e[t++]="+"}t++}}(t),new l(t)}function h(e,t){var n;t instanceof l?e.push(...t._items):t instanceof a?e.push(t):e.push("number"==typeof(n=t)||"boolean"==typeof n||null===n?n:f(Array.isArray(n)?n.join(","):n))}function p(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof a||'"'!==e[e.length-1])return;return"string"!=typeof t?"".concat(e.slice(0,-1)).concat(t,'"'):'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof a?void 0:'"'.concat(e).concat(t.slice(1))}function f(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.str=d,t.addCodeArg=h,t.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:d(i||(i=r(["","",""])),e,t)},t.stringify=function(e){return new l(f(e))},t.safeStringify=f,t.getProperty=function(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new l(".".concat(e)):c(s||(s=r(["[","]"])),e)},t.getEsmExportName=function(e){if("string"==typeof e&&t.IDENTIFIER.test(e))return new l("".concat(e));throw new Error("CodeGen: invalid export name: ".concat(e,", use explicit $id name mapping"))},t.regexpCode=function(e){return new l(e.toString())}},5532(e,t,n){"use strict";var i,s,r=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const o=n(656),a=n(8584),l=n(8396),c=n(8396),u={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:u,parentSchema:d,it:h}=e,{opts:p}=h,f=(0,o.allSchemaProperties)(n),m=f.filter(e=>(0,l.alwaysValidSchema)(h,n[e]));if(0===f.length||m.length===f.length&&(!h.opts.unevaluated||!0===h.props))return;const g=p.strictSchema&&!p.allowMatchingProperties&&d.properties,v=t.name("valid");!0===h.props||h.props instanceof a.Name||(h.props=(0,c.evaluatedPropsToName)(t,h.props));const{props:y}=h;function b(e){for(const t in g)new RegExp(e).test(t)&&(0,l.checkStrictMode)(h,"property ".concat(t," matches pattern ").concat(e," (use allowMatchingProperties)"))}function w(n){t.forIn("key",u,l=>{t.if((0,a._)(i||(i=r(["",".test(",")"])),(0,o.usePattern)(e,n),l),()=>{const i=m.includes(n);i||e.subschema({keyword:"patternProperties",schemaProp:n,dataProp:l,dataPropType:c.Type.Str},v),h.opts.unevaluated&&!0!==y?t.assign((0,a._)(s||(s=r(["","[","]"])),y,l),!0):i||h.allErrors||t.if((0,a.not)(v),()=>t.break())})})}!function(){for(const e of f)g&&b(e),h.allErrors?w(e):(t.var(v,!0),w(e),t.if(v))}()}};t.default=u},5801(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8396),s={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:s}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const r=t.name("valid");n.forEach((t,n)=>{if((0,i.alwaysValidSchema)(s,t))return;const o=e.subschema({keyword:"allOf",schemaProp:n},r);e.ok(r),e.mergeEvaluated(o)})}};t.default=s},6099(e){"use strict";const t=RegExp.prototype.test.bind(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),n=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])$/);function i(e){let t="",n=0,i=0;for(i=0;i<e.length;i++)if(n=e[i].charCodeAt(0),48!==n){if(!(n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102))return"";t+=e[i];break}for(i+=1;i<e.length;i++){if(n=e[i].charCodeAt(0),!(n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102))return"";t+=e[i]}return t}const s=RegExp.prototype.test.bind(/(?:[\0- #%\/-:<>-\^\|\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/);function r(e){return e.length=0,!0}function o(e,t,n){if(e.length){const s=i(e);if(""===s)return n.error=!0,!1;t.push(s),e.length=0}return!0}function a(e){if(function(e,t){let n=0;for(let i=0;i<e.length;i++)e[i]===t&&n++;return n}(e,":")<2)return{host:e,isIPV6:!1};const t=function(e){let t=0;const n={error:!1,address:"",zone:""},s=[],a=[];let l=!1,c=!1,u=o;for(let i=0;i<e.length;i++){const o=e[i];if("["!==o&&"]"!==o)if(":"!==o)if("%"===o){if(!u(a,s,n))break;u=r}else a.push(o);else{if(!0===l&&(c=!0),!u(a,s,n))break;if(++t>7){n.error=!0;break}i>0&&":"===e[i-1]&&(l=!0),s.push(":")}}return a.length&&(u===r?n.zone=a.join(""):c?s.push(a.join("")):s.push(i(a))),n.address=s.join(""),n}(e);if(t.error)return{host:e,isIPV6:!1};{let e=t.address,n=t.address;return t.zone&&(e+="%"+t.zone,n+="%25"+t.zone),{host:e,isIPV6:!0,escapedHost:n}}}e.exports={nonSimpleDomain:s,recomposeAuthority:function(e){const t=[];if(void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host){let i=unescape(e.host);if(!n(i)){const t=a(i);i=!0===t.isIPV6?"[".concat(t.escapedHost,"]"):e.host}t.push(i)}return"number"!==typeof e.port&&"string"!==typeof e.port||(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0},normalizeComponentEncoding:function(e,t){const n=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=n(e.scheme)),void 0!==e.userinfo&&(e.userinfo=n(e.userinfo)),void 0!==e.host&&(e.host=n(e.host)),void 0!==e.path&&(e.path=n(e.path)),void 0!==e.query&&(e.query=n(e.query)),void 0!==e.fragment&&(e.fragment=n(e.fragment)),e},removeDotSegments:function(e){let t=e;const n=[];let i=-1,s=0;for(;s=t.length;){if(1===s){if("."===t)break;if("/"===t){n.push("/");break}n.push(t);break}if(2===s){if("."===t[0]){if("."===t[1])break;if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&("."===t[1]||"/"===t[1])){n.push("/");break}}else if(3===s&&"/.."===t){0!==n.length&&n.pop(),n.push("/");break}if("."===t[0]){if("."===t[1]){if("/"===t[2]){t=t.slice(3);continue}}else if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&"."===t[1]){if("/"===t[2]){t=t.slice(2);continue}if("."===t[2]&&"/"===t[3]){t=t.slice(3),0!==n.length&&n.pop();continue}}if(-1===(i=t.indexOf("/",1))){n.push(t);break}n.push(t.slice(0,i)),t=t.slice(i)}return n.join("")},isIPv4:n,isUUID:t,normalizeIPv6:a,stringArrayToHexStripped:i}},6280(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},6340(e,t,n){"use strict";var i,s,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;const c=n(8584),u=n(8396);t.getSubschema=function(e,t){let{keyword:n,schemaProp:r,schema:o,schemaPath:a,errSchemaPath:d,topSchemaRef:h}=t;if(void 0!==n&&void 0!==o)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==n){const t=e.schema[n];return void 0===r?{schema:t,schemaPath:(0,c._)(i||(i=l(["","",""])),e.schemaPath,(0,c.getProperty)(n)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(n)}:{schema:t[r],schemaPath:(0,c._)(s||(s=l(["","","",""])),e.schemaPath,(0,c.getProperty)(n),(0,c.getProperty)(r)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(n,"/").concat((0,u.escapeFragment)(r))}}if(void 0!==o){if(void 0===a||void 0===d||void 0===h)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:o,schemaPath:a,topSchemaRef:h,errSchemaPath:d}}throw new Error('either "keyword" or "schema" must be passed')},t.extendSubschemaData=function(e,t,n){let{dataProp:i,dataPropType:s,data:d,dataTypes:h,propertyName:p}=n;if(void 0!==d&&void 0!==i)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:f}=t;if(void 0!==i){const{errorPath:n,dataPathArr:d,opts:h}=t;m(f.let("data",(0,c._)(r||(r=l(["","",""])),t.data,(0,c.getProperty)(i)),!0)),e.errorPath=(0,c.str)(o||(o=l(["","",""])),n,(0,u.getErrorPath)(i,s,h.jsPropertySyntax)),e.parentDataProperty=(0,c._)(a||(a=l(["",""])),i),e.dataPathArr=[...d,e.parentDataProperty]}if(void 0!==d){m(d instanceof c.Name?d:f.let("data",d,!0)),void 0!==p&&(e.propertyName=p)}function m(n){e.data=n,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,n]}h&&(e.dataTypes=h)},t.extendSubschemaMode=function(e,t){let{jtdDiscriminator:n,jtdMetadata:i,compositeRule:s,createErrors:r,allErrors:o}=t;void 0!==s&&(e.compositeRule=s),void 0!==r&&(e.createErrors=r),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=n,e.jtdMetadata=i}},6386(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const g=n(8584),v=n(8396),y={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:e=>{let{params:{min:t,max:n}}=e;return void 0===n?(0,g.str)(i||(i=m(["must contain at least "," valid item(s)"])),t):(0,g.str)(s||(s=m(["must contain at least "," and no more than "," valid item(s)"])),t,n)},params:e=>{let{params:{min:t,max:n}}=e;return void 0===n?(0,g._)(r||(r=m(["{minContains: ","}"])),t):(0,g._)(o||(o=m(["{minContains: ",", maxContains: ","}"])),t,n)}},code(e){const{gen:t,schema:n,parentSchema:i,data:s,it:r}=e;let o,y;const{minContains:b,maxContains:w}=i;r.opts.next?(o=void 0===b?1:b,y=w):o=1;const _=t.const("len",(0,g._)(a||(a=m(["",".length"])),s));if(e.setParams({min:o,max:y}),void 0===y&&0===o)return void(0,v.checkStrictMode)(r,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==y&&o>y)return(0,v.checkStrictMode)(r,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,v.alwaysValidSchema)(r,n)){let t=(0,g._)(l||(l=m([""," >= ",""])),_,o);return void 0!==y&&(t=(0,g._)(c||(c=m([""," && "," <= ",""])),t,_,y)),void e.pass(t)}r.items=!0;const x=t.name("valid");function E(){const e=t.name("_valid"),n=t.let("count",0);S(e,()=>t.if(e,()=>function(e){t.code((0,g._)(d||(d=m(["","++"])),e)),void 0===y?t.if((0,g._)(h||(h=m([""," >= ",""])),e,o),()=>t.assign(x,!0).break()):(t.if((0,g._)(p||(p=m([""," > ",""])),e,y),()=>t.assign(x,!1).break()),1===o?t.assign(x,!0):t.if((0,g._)(f||(f=m([""," >= ",""])),e,o),()=>t.assign(x,!0)))}(n)))}function S(n,i){t.forRange("i",0,_,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:v.Type.Num,compositeRule:!0},n),i()})}void 0===y&&1===o?S(x,()=>t.if(x,()=>t.break())):0===o?(t.let(x,!0),void 0!==y&&t.if((0,g._)(u||(u=m(["",".length > 0"])),s),E)):(t.let(x,!1),E()),e.result(x,()=>e.reset())}};t.default=y},6470(e,t,n){"use strict";var i,s=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;const r=n(6772),o=n(8584),a=n(266),l={message:"boolean schema is false"};function c(e,t){const{gen:n,data:i}=e,s={gen:n,keyword:"false schema",data:i,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,r.reportError)(s,l,void 0,t)}t.topBoolOrEmptySchema=function(e){const{gen:t,schema:n,validateName:r}=e;!1===n?c(e,!1):"object"==typeof n&&!0===n.$async?t.return(a.default.data):(t.assign((0,o._)(i||(i=s(["",".errors"])),r),null),t.return(!0))},t.boolOrEmptySchema=function(e,t){const{gen:n,schema:i}=e;!1===i?(n.var(t,!1),c(e)):n.var(t,!0)}},6480(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y,b,w=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const _=n(9273),x=n(8584),E=n(8396),S=n(2979),A={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:e=>{let{params:{i:t,j:n}}=e;return(0,x.str)(i||(i=w(["must NOT have duplicate items (items ## "," and "," are identical)"])),n,t)},params:e=>{let{params:{i:t,j:n}}=e;return(0,x._)(s||(s=w(["{i: ",", j: ","}"])),t,n)}},code(e){const{gen:t,data:n,$data:i,schema:s,parentSchema:A,schemaCode:C,it:T}=e;if(!i&&!s)return;const k=t.let("valid"),I=A.items?(0,_.getSchemaTypes)(A.items):[];function N(i,s){const r=t.name("item"),o=(0,_.checkDataTypes)(I,r,T.opts.strictNumbers,_.DataType.Wrong),a=t.const("indices",(0,x._)(l||(l=w(["{}"]))));t.for((0,x._)(c||(c=w([";","--;"])),i),()=>{t.let(r,(0,x._)(u||(u=w(["","[","]"])),n,i)),t.if(o,(0,x._)(d||(d=w(["continue"])))),I.length>1&&t.if((0,x._)(h||(h=w(["typeof ",' == "string"'])),r),(0,x._)(p||(p=w(["",' += "_"'])),r)),t.if((0,x._)(f||(f=w(["typeof ","[",'] == "number"'])),a,r),()=>{t.assign(s,(0,x._)(m||(m=w(["","[","]"])),a,r)),e.error(),t.assign(k,!1).break()}).code((0,x._)(g||(g=w(["","[","] = ",""])),a,r,i))})}function P(i,s){const r=(0,E.useFunc)(t,S.default),o=t.name("outer");t.label(o).for((0,x._)(v||(v=w([";","--;"])),i),()=>t.for((0,x._)(y||(y=w([""," = ","; ","--;"])),s,i,s),()=>t.if((0,x._)(b||(b=w(["","(","[","], ","[","])"])),r,n,i,n,s),()=>{e.error(),t.assign(k,!1).break(o)})))}e.block$data(k,function(){const i=t.let("i",(0,x._)(o||(o=w(["",".length"])),n)),s=t.let("j");e.setParams({i:i,j:s}),t.assign(k,!0),t.if((0,x._)(a||(a=w([""," > 1"])),i),()=>(I.length>0&&!I.some(e=>"object"===e||"array"===e)?N:P)(i,s))},(0,x._)(r||(r=w([""," === false"])),C)),e.ok(k)}};t.default=A},6623(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l=a.operators,c={maximum:{okStr:"<=",ok:l.LTE,fail:l.GT},minimum:{okStr:">=",ok:l.GTE,fail:l.LT},exclusiveMaximum:{okStr:"<",ok:l.LT,fail:l.GTE},exclusiveMinimum:{okStr:">",ok:l.GT,fail:l.LTE}},u={message:e=>{let{keyword:t,schemaCode:n}=e;return(0,a.str)(i||(i=o(["must be "," ",""])),c[t].okStr,n)},params:e=>{let{keyword:t,schemaCode:n}=e;return(0,a._)(s||(s=o(["{comparison: ",", limit: ","}"])),c[t].okStr,n)}},d={keyword:Object.keys(c),type:"number",schemaType:"number",$data:!0,error:u,code(e){const{keyword:t,data:n,schemaCode:i}=e;e.fail$data((0,a._)(r||(r=o([""," "," "," || isNaN(",")"])),n,c[t].fail,i,n))}};t.default=d},6740(e,t,n){"use strict";var i,s,r,o,a=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const l=n(8584),c=n(8396),u=n(2979),d={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:e=>{let{schemaCode:t}=e;return(0,l._)(i||(i=a(["{allowedValues: ","}"])),t)}},code(e){const{gen:t,data:n,$data:i,schema:d,schemaCode:h,it:p}=e;if(!i&&0===d.length)throw new Error("enum must have non-empty array");const f=d.length>=p.opts.loopEnum;let m;const g=()=>null!==m&&void 0!==m?m:m=(0,c.useFunc)(t,u.default);let v;if(f||i)v=t.let("valid"),e.block$data(v,function(){t.assign(v,!1),t.forOf("v",h,e=>t.if((0,l._)(s||(s=a(["","(",", ",")"])),g(),n,e),()=>t.assign(v,!0).break()))});else{if(!Array.isArray(d))throw new Error("ajv implementation error");const e=t.const("vSchema",h);v=(0,l.or)(...d.map((t,i)=>function(e,t){const i=d[t];return"object"===typeof i&&null!==i?(0,l._)(r||(r=a(["","(",", ","[","])"])),g(),n,e,t):(0,l._)(o||(o=a([""," === ",""])),n,i)}(e,i)))}e.pass(v)}};t.default=d},6754(e,t){"use strict";function n(e){const t=e.length;let n,i=0,s=0;for(;s<t;)i++,n=e.charCodeAt(s++),n>=55296&&n<=56319&&s<t&&(n=e.charCodeAt(s),56320===(64512&n)&&s++);return i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,n.code='require("ajv/dist/runtime/ucs2length").default'},6772(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y,b,w,_,x,E,S,A,C,T,k=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const I=n(8584),N=n(8396),P=n(266);function M(e,t){const n=e.const("err",t);e.if((0,I._)(g||(g=k([""," === null"])),P.default.vErrors),()=>e.assign(P.default.vErrors,(0,I._)(v||(v=k(["[","]"])),n)),(0,I._)(y||(y=k(["",".push(",")"])),P.default.vErrors,n)),e.code((0,I._)(b||(b=k(["","++"])),P.default.errors))}function R(e,t){const{gen:n,validateName:i,schemaEnv:s}=e;s.$async?n.throw((0,I._)(w||(w=k(["new ","(",")"])),e.ValidationError,t)):(n.assign((0,I._)(_||(_=k(["",".errors"])),i),t),n.return(!1))}t.keywordError={message:e=>{let{keyword:t}=e;return(0,I.str)(i||(i=k(['must pass "','" keyword validation'])),t)}},t.keyword$DataError={message:e=>{let{keyword:t,schemaType:n}=e;return n?(0,I.str)(s||(s=k(['"','" keyword must be '," ($data)"])),t,n):(0,I.str)(r||(r=k(['"','" keyword is invalid ($data)'])),t)}},t.reportError=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.keywordError,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;const{it:r}=e,{gen:a,compositeRule:l,allErrors:c}=r,u=D(e,n,i);(null!==s&&void 0!==s?s:l||c)?M(a,u):R(r,(0,I._)(o||(o=k(["[","]"])),u))},t.reportExtraError=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.keywordError,i=arguments.length>2?arguments[2]:void 0;const{it:s}=e,{gen:r,compositeRule:o,allErrors:a}=s;M(r,D(e,n,i)),o||a||R(s,P.default.vErrors)},t.resetErrorsCount=function(e,t){e.assign(P.default.errors,t),e.if((0,I._)(a||(a=k([""," !== null"])),P.default.vErrors),()=>e.if(t,()=>e.assign((0,I._)(l||(l=k(["",".length"])),P.default.vErrors),t),()=>e.assign(P.default.vErrors,null)))},t.extendErrors=function(e){let{gen:t,keyword:n,schemaValue:i,data:s,errsCount:r,it:o}=e;if(void 0===r)throw new Error("ajv implementation error");const a=t.name("err");t.forRange("i",r,P.default.errors,e=>{t.const(a,(0,I._)(c||(c=k(["","[","]"])),P.default.vErrors,e)),t.if((0,I._)(u||(u=k(["",".instancePath === undefined"])),a),()=>t.assign((0,I._)(d||(d=k(["",".instancePath"])),a),(0,I.strConcat)(P.default.instancePath,o.errorPath))),t.assign((0,I._)(h||(h=k(["",".schemaPath"])),a),(0,I.str)(p||(p=k(["","/",""])),o.errSchemaPath,n)),o.opts.verbose&&(t.assign((0,I._)(f||(f=k(["",".schema"])),a),i),t.assign((0,I._)(m||(m=k(["",".data"])),a),s))})};const O={keyword:new I.Name("keyword"),schemaPath:new I.Name("schemaPath"),params:new I.Name("params"),propertyName:new I.Name("propertyName"),message:new I.Name("message"),schema:new I.Name("schema"),parentSchema:new I.Name("parentSchema")};function D(e,t,n){const{createErrors:i}=e.it;return!1===i?(0,I._)(x||(x=k(["{}"]))):function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{gen:i,it:s}=e,r=[F(s,n),L(e,n)];return function(e,t,n){let{params:i,message:s}=t;const{keyword:r,data:o,schemaValue:a,it:l}=e,{opts:c,propertyName:u,topSchemaRef:d,schemaPath:h}=l;n.push([O.keyword,r],[O.params,"function"==typeof i?i(e):i||(0,I._)(C||(C=k(["{}"])))]),c.messages&&n.push([O.message,"function"==typeof s?s(e):s]);c.verbose&&n.push([O.schema,a],[O.parentSchema,(0,I._)(T||(T=k(["","",""])),d,h)],[P.default.data,o]);u&&n.push([O.propertyName,u])}(e,t,r),i.object(...r)}(e,t,n)}function F(e,t){let{errorPath:n}=e,{instancePath:i}=t;const s=i?(0,I.str)(E||(E=k(["","",""])),n,(0,N.getErrorPath)(i,N.Type.Str)):n;return[P.default.instancePath,(0,I.strConcat)(P.default.instancePath,s)]}function L(e,t){let{keyword:n,it:{errSchemaPath:i}}=e,{schemaPath:s,parentSchema:r}=t,o=r?i:(0,I.str)(S||(S=k(["","/",""])),i,n);return s&&(o=(0,I.str)(A||(A=k(["","",""])),o,(0,N.getErrorPath)(s,N.Type.Str))),[O.schemaPath,o]}},6817(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}t.default=n},7003(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const i=n(9281),s=n(9497),r=n(138),o=n(2079),a=["/properties"],l="http://json-schema.org/draft-07/schema";class c extends i.default{_addVocabularies(){super._addVocabularies(),s.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(r.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,a):o;this.addMetaSchema(e,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var u=n(5413);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var d=n(8584);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var h=n(6817);Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return h.default}});var p=n(9550);Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return p.default}})},7234(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,s=e[i];if(!(0<r(s,t)))break e;e[i]=t,e[n]=s,n=i}}function i(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,s=e.length,o=s>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>r(l,n))c<s&&0>r(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<s&&0>r(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function _(e){if(g=!1,w(e),!m)if(null!==i(c))m=!0,R(x);else{var t=i(u);null!==t&&O(_,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,y(C),C=-1),f=!0;var r=p;try{for(w(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!I());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===i(c)&&s(c),w(n)}else s(c);h=i(c)}if(null!==h)var l=!0;else{var d=i(u);null!==d&&O(_,d.startTime-n),l=!1}return l}finally{h=null,p=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,A=null,C=-1,T=5,k=-1;function I(){return!(t.unstable_now()-k<T)}function N(){if(null!==A){var e=t.unstable_now();k=e;var n=!0;try{n=A(!0,e)}finally{n?E():(S=!1,A=null)}}else S=!1}if("function"===typeof b)E=function(){b(N)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,M=P.port2;P.port1.onmessage=N,E=function(){M.postMessage(null)}}else E=function(){v(N,0)};function R(e){A=e,S||(S=!0,E())}function O(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,R(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,s,r){var o=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?o+r:o:r=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>o?(e.sortIndex=r,n(u,e),null===i(c)&&e===i(u)&&(g?(y(C),C=-1):g=!0,O(_,r-o))):(e.sortIndex=a,n(c,e),m||f||(m=!0,R(x))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7352(e,t,n){"use strict";var i,s,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const c=n(8584),u={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:e=>{let{schemaCode:t}=e;return(0,c.str)(i||(i=l(["must be multiple of ",""])),t)},params:e=>{let{schemaCode:t}=e;return(0,c._)(s||(s=l(["{multipleOf: ","}"])),t)}},code(e){const{gen:t,data:n,schemaCode:i,it:s}=e,u=s.opts.multipleOfPrecision,d=t.let("res"),h=u?(0,c._)(r||(r=l(["Math.abs(Math.round(",") - ",") > 1e-",""])),d,d,u):(0,c._)(o||(o=l([""," !== parseInt(",")"])),d,d);e.fail$data((0,c._)(a||(a=l(["("," === 0 || ("," = ","/",", ","))"])),i,d,n,i,h))}};t.default=u},7736(e,t,n){var i=n(3738).default,s=n(9045);e.exports=function(e){var t=s(e,"string");return"symbol"==i(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7864(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const h=n(7003),p=n(8584),f=p.operators,m={formatMaximum:{okStr:"<=",ok:f.LTE,fail:f.GT},formatMinimum:{okStr:">=",ok:f.GTE,fail:f.LT},formatExclusiveMaximum:{okStr:"<",ok:f.LT,fail:f.GTE},formatExclusiveMinimum:{okStr:">",ok:f.GT,fail:f.LTE}},g={message:e=>{let{keyword:t,schemaCode:n}=e;return p.str(i||(i=d(["should be "," ",""])),m[t].okStr,n)},params:e=>{let{keyword:t,schemaCode:n}=e;return p._(s||(s=d(["{comparison: ",", limit: ","}"])),m[t].okStr,n)}};t.formatLimitDefinition={keyword:Object.keys(m),type:"string",schemaType:"string",$data:!0,error:g,code(e){const{gen:t,data:n,schemaCode:i,keyword:s,it:f}=e,{opts:g,self:v}=f;if(!g.validateFormats)return;const y=new h.KeywordCxt(f,v.RULES.all.format.definition,"format");function b(e){return p._(u||(u=d(["",".compare(",", ",") "," 0"])),e,n,i,m[s].fail)}y.$data?function(){const n=t.scopeValue("formats",{ref:v.formats,code:g.code.formats}),i=t.const("fmt",p._(r||(r=d(["","[","]"])),n,y.schemaCode));e.fail$data(p.or(p._(o||(o=d(["typeof ",' != "object"'])),i),p._(a||(a=d([""," instanceof RegExp"])),i),p._(l||(l=d(["typeof ",'.compare != "function"'])),i),b(i)))}():function(){const n=y.schema,i=v.formats[n];if(!i||!0===i)return;if("object"!=typeof i||i instanceof RegExp||"function"!=typeof i.compare)throw new Error('"'.concat(s,'": format "').concat(n,'" does not define "compare" function'));const r=t.scopeValue("formats",{key:n,ref:i,code:g.code.formats?p._(c||(c=d(["","",""])),g.code.formats,p.getProperty(n)):void 0});e.fail$data(b(r))}()},dependencies:["format"]};t.default=e=>(e.addKeyword(t.formatLimitDefinition),e)},7950(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},7968(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;const p=n(9550),f=n(656),m=n(8584),g=n(266),v=n(1762),y=n(8396),b={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:s}=e,{baseId:r,schemaEnv:o,validateName:a,opts:l,self:c}=s,{root:u}=o;if(("#"===n||"#/"===n)&&r===u.baseId)return function(){if(o===u)return _(e,a,o,o.$async);const n=t.scopeValue("root",{ref:u});return _(e,(0,m._)(i||(i=h(["",".validate"])),n),u,u.$async)}();const d=v.resolveRef.call(c,u,r,n);if(void 0===d)throw new p.default(s.opts.uriResolver,r,n);return d instanceof v.SchemaEnv?function(t){const n=w(e,t);_(e,n,t,t.$async)}(d):function(i){const s=t.scopeValue("schema",!0===l.code.source?{ref:i,code:(0,m.stringify)(i)}:{ref:i}),r=t.name("valid"),o=e.subschema({schema:i,dataTypes:[],schemaPath:m.nil,topSchemaRef:s,errSchemaPath:n},r);e.mergeEvaluated(o),e.ok(r)}(d)}};function w(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0,m._)(s||(s=h(["",".validate"])),n.scopeValue("wrapper",{ref:t}))}function _(e,t,n,i){const{gen:s,it:p}=e,{allErrors:v,schemaEnv:b,opts:w}=p,_=w.passContext?g.default.this:m.nil;function x(e){const t=(0,m._)(a||(a=h(["",".errors"])),e);s.assign(g.default.vErrors,(0,m._)(l||(l=h([""," === null ? "," : ",".concat(",")"])),g.default.vErrors,t,g.default.vErrors,t)),s.assign(g.default.errors,(0,m._)(c||(c=h(["",".length"])),g.default.vErrors))}function E(e){var t;if(!p.opts.unevaluated)return;const i=null===(t=null===n||void 0===n?void 0:n.validate)||void 0===t?void 0:t.evaluated;if(!0!==p.props)if(i&&!i.dynamicProps)void 0!==i.props&&(p.props=y.mergeEvaluated.props(s,i.props,p.props));else{const t=s.var("props",(0,m._)(u||(u=h(["",".evaluated.props"])),e));p.props=y.mergeEvaluated.props(s,t,p.props,m.Name)}if(!0!==p.items)if(i&&!i.dynamicItems)void 0!==i.items&&(p.items=y.mergeEvaluated.items(s,i.items,p.items));else{const t=s.var("items",(0,m._)(d||(d=h(["",".evaluated.items"])),e));p.items=y.mergeEvaluated.items(s,t,p.items,m.Name)}}i?function(){if(!b.$async)throw new Error("async schema referenced by sync schema");const n=s.let("valid");s.try(()=>{s.code((0,m._)(r||(r=h(["await ",""])),(0,f.callValidateCode)(e,t,_))),E(t),v||s.assign(n,!0)},e=>{s.if((0,m._)(o||(o=h(["!("," instanceof ",")"])),e,p.ValidationError),()=>s.throw(e)),x(e),v||s.assign(n,!1)}),e.ok(n)}():e.result((0,f.callValidateCode)(e,t,_),()=>E(t),()=>x(t))}t.getValidate=w,t.callRef=_,t.default=b},8211(e,t,n){"use strict";var i,s,r,o=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const a=n(8584),l={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message(e){let{keyword:t,schemaCode:n}=e;const s="maxProperties"===t?"more":"fewer";return(0,a.str)(i||(i=o(["must NOT have "," than "," properties"])),s,n)},params:e=>{let{schemaCode:t}=e;return(0,a._)(s||(s=o(["{limit: ","}"])),t)}},code(e){const{keyword:t,data:n,schemaCode:i}=e,s="maxProperties"===t?a.operators.GT:a.operators.LT;e.fail$data((0,a._)(r||(r=o(["Object.keys(",").length "," ",""])),n,s,i))}};t.default=l},8218(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8396),s={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:s}=e;if((0,i.alwaysValidSchema)(s,n))return void e.fail();const r=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},r),e.failResult(r,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};t.default=s},8396(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y,b,w,_=n(2897).default,x=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const E=n(8584),S=n(5467);function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema;const{opts:n,self:i}=e;if(!n.strictSchema)return;if("boolean"===typeof t)return;const s=i.RULES.keywords;for(const r in t)s[r]||O(e,'unknown keyword: "'.concat(r,'"'))}function C(e,t){if("boolean"==typeof e)return!e;for(const n in e)if(t[n])return!0;return!1}function T(e){return"number"==typeof e?"".concat(e):e.replace(/~/g,"~0").replace(/\//g,"~1")}function k(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function I(e){let{mergeNames:t,mergeToName:n,mergeValues:i,resultToName:s}=e;return(e,r,o,a)=>{const l=void 0===o?r:o instanceof E.Name?(r instanceof E.Name?t(e,r,o):n(e,r,o),o):r instanceof E.Name?(n(e,o,r),r):i(r,o);return a!==E.Name||l instanceof E.Name?l:s(e,l)}}function N(e,t){if(!0===t)return e.var("props",!0);const n=e.var("props",(0,E._)(m||(m=x(["{}"]))));return void 0!==t&&P(e,n,t),n}function P(e,t,n){Object.keys(n).forEach(n=>e.assign((0,E._)(g||(g=x(["","",""])),t,(0,E.getProperty)(n)),!0))}t.toHash=function(e){const t={};for(const n of e)t[n]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(A(e,t),!C(t,e.self.RULES.all))},t.checkUnknownRules=A,t.schemaHasRules=C,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const n in e)if("$ref"!==n&&t.all[n])return!0;return!1},t.schemaRefOrVal=function(e,t,n,r){let{topSchemaRef:o,schemaPath:a}=e;if(!r){if("number"==typeof t||"boolean"==typeof t)return t;if("string"==typeof t)return(0,E._)(i||(i=x(["",""])),t)}return(0,E._)(s||(s=x(["","","",""])),o,a,(0,E.getProperty)(n))},t.unescapeFragment=function(e){return k(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(T(e))},t.escapeJsonPointer=T,t.unescapeJsonPointer=k,t.eachItem=function(e,t){if(Array.isArray(e))for(const n of e)t(n);else t(e)},t.mergeEvaluated={props:I({mergeNames:(e,t,n)=>e.if((0,E._)(r||(r=x([""," !== true && "," !== undefined"])),n,t),()=>{e.if((0,E._)(o||(o=x([""," === true"])),t),()=>e.assign(n,!0),()=>e.assign(n,(0,E._)(a||(a=x([""," || {}"])),n)).code((0,E._)(l||(l=x(["Object.assign(",", ",")"])),n,t)))}),mergeToName:(e,t,n)=>e.if((0,E._)(c||(c=x([""," !== true"])),n),()=>{!0===t?e.assign(n,!0):(e.assign(n,(0,E._)(u||(u=x([""," || {}"])),n)),P(e,n,t))}),mergeValues:(e,t)=>!0===e||_(_({},e),t),resultToName:N}),items:I({mergeNames:(e,t,n)=>e.if((0,E._)(d||(d=x([""," !== true && "," !== undefined"])),n,t),()=>e.assign(n,(0,E._)(h||(h=x([""," === true ? true : "," > "," ? "," : ",""])),t,n,t,n,t))),mergeToName:(e,t,n)=>e.if((0,E._)(p||(p=x([""," !== true"])),n),()=>e.assign(n,!0===t||(0,E._)(f||(f=x([""," > "," ? "," : ",""])),n,t,n,t))),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=N,t.setEvaluated=P;const M={};var R;function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.opts.strictSchema;if(n){if(t="strict mode: ".concat(t),!0===n)throw new Error(t);e.self.logger.warn(t)}}t.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:M[t.code]||(M[t.code]=new S._Code(t.code))})},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(R||(t.Type=R={})),t.getErrorPath=function(e,t,n){if(e instanceof E.Name){const i=t===R.Num;return n?i?(0,E._)(v||(v=x(['"[" + ',' + "]"'])),e):(0,E._)(y||(y=x(['"[\'" + ',' + "\']"'])),e):i?(0,E._)(b||(b=x(['"/" + ',""])),e):(0,E._)(w||(w=x(['"/" + ','.replace(/~/g, "~0").replace(/\\//g, "~1")'],['"/" + ','.replace(/~/g, "~0").replace(/\\\\//g, "~1")'])),e)}return n?(0,E.getProperty)(e).toString():"/"+T(e)},t.checkStrictMode=O},8584(e,t,n){"use strict";var i,s,r,o,a,l,c=n(166).default,u=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const d=n(5467),h=n(5280);var p=n(5467);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return p._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return p.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return p.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return p.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return p.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return p.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return p.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return p.Name}});var f=n(5280);Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return f.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return f.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return f.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return f.varKinds}}),t.operators={GT:new d._Code(">"),GTE:new d._Code(">="),LT:new d._Code("<"),LTE:new d._Code("<="),EQ:new d._Code("==="),NEQ:new d._Code("!=="),NOT:new d._Code("!"),OR:new d._Code("||"),AND:new d._Code("&&"),ADD:new d._Code("+")};class m{optimizeNodes(){return this}optimizeNames(e,t){return this}}class g extends m{constructor(e,t,n){super(),this.varKind=e,this.name=t,this.rhs=n}render(e){let{es5:t,_n:n}=e;const i=t?h.varKinds.var:this.varKind,s=void 0===this.rhs?"":" = ".concat(this.rhs);return"".concat(i," ").concat(this.name).concat(s,";")+n}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=U(this.rhs,e,t)),this}get names(){return this.rhs instanceof d._CodeOrName?this.rhs.names:{}}}class v extends m{constructor(e,t,n){super(),this.lhs=e,this.rhs=t,this.sideEffects=n}render(e){let{_n:t}=e;return"".concat(this.lhs," = ").concat(this.rhs,";")+t}optimizeNames(e,t){if(!(this.lhs instanceof d.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=U(this.rhs,e,t),this}get names(){return j(this.lhs instanceof d.Name?{}:u({},this.lhs.names),this.rhs)}}class y extends v{constructor(e,t,n,i){super(e,n,i),this.op=t}render(e){let{_n:t}=e;return"".concat(this.lhs," ").concat(this.op,"= ").concat(this.rhs,";")+t}}class b extends m{constructor(e){super(),this.label=e,this.names={}}render(e){let{_n:t}=e;return"".concat(this.label,":")+t}}class w extends m{constructor(e){super(),this.label=e,this.names={}}render(e){let{_n:t}=e;const n=this.label?" ".concat(this.label):"";return"break".concat(n,";")+t}}class _ extends m{constructor(e){super(),this.error=e}render(e){let{_n:t}=e;return"throw ".concat(this.error,";")+t}get names(){return this.error.names}}class x extends m{constructor(e){super(),this.code=e}render(e){let{_n:t}=e;return"".concat(this.code,";")+t}optimizeNodes(){return"".concat(this.code)?this:void 0}optimizeNames(e,t){return this.code=U(this.code,e,t),this}get names(){return this.code instanceof d._CodeOrName?this.code.names:{}}}class E extends m{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.nodes=e}render(e){return this.nodes.reduce((t,n)=>t+n.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const n=e[t].optimizeNodes();Array.isArray(n)?e.splice(t,1,...n):n?e[t]=n:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:n}=this;let i=n.length;for(;i--;){const s=n[i];s.optimizeNames(e,t)||(B(e,s.names),n.splice(i,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>L(e,t.names),{})}}class S extends E{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class A extends E{}class C extends S{}C.kind="else";class T extends S{constructor(e,t){super(t),this.condition=e}render(e){let t="if(".concat(this.condition,")")+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new C(e):e}return t?!1===e?t instanceof T?t:t.nodes:this.nodes.length?this:new T(W(e),t instanceof T?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var n;if(this.else=null===(n=this.else)||void 0===n?void 0:n.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=U(this.condition,e,t),this}get names(){const e=super.names;return j(e,this.condition),this.else&&L(e,this.else.names),e}}T.kind="if";class k extends S{}k.kind="for";class I extends k{constructor(e){super(),this.iteration=e}render(e){return"for(".concat(this.iteration,")")+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=U(this.iteration,e,t),this}get names(){return L(super.names,this.iteration.names)}}class N extends k{constructor(e,t,n,i){super(),this.varKind=e,this.name=t,this.from=n,this.to=i}render(e){const t=e.es5?h.varKinds.var:this.varKind,{name:n,from:i,to:s}=this;return"for(".concat(t," ").concat(n,"=").concat(i,"; ").concat(n,"<").concat(s,"; ").concat(n,"++)")+super.render(e)}get names(){const e=j(super.names,this.from);return j(e,this.to)}}class P extends k{constructor(e,t,n,i){super(),this.loop=e,this.varKind=t,this.name=n,this.iterable=i}render(e){return"for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=U(this.iterable,e,t),this}get names(){return L(super.names,this.iterable.names)}}class M extends S{constructor(e,t,n){super(),this.name=e,this.args=t,this.async=n}render(e){const t=this.async?"async ":"";return"".concat(t,"function ").concat(this.name,"(").concat(this.args,")")+super.render(e)}}M.kind="func";class R extends E{render(e){return"return "+super.render(e)}}R.kind="return";class O extends S{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var n,i;return super.optimizeNames(e,t),null===(n=this.catch)||void 0===n||n.optimizeNames(e,t),null===(i=this.finally)||void 0===i||i.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&L(e,this.catch.names),this.finally&&L(e,this.finally.names),e}}class D extends S{constructor(e){super(),this.error=e}render(e){return"catch(".concat(this.error,")")+super.render(e)}}D.kind="catch";class F extends S{render(e){return"finally"+super.render(e)}}F.kind="finally";function L(e,t){for(const n in t)e[n]=(e[n]||0)+(t[n]||0);return e}function j(e,t){return t instanceof d._CodeOrName?L(e,t.names):e}function U(e,t,n){return e instanceof d.Name?s(e):(i=e)instanceof d._Code&&i._items.some(e=>e instanceof d.Name&&1===t[e.str]&&void 0!==n[e.str])?new d._Code(e._items.reduce((e,t)=>(t instanceof d.Name&&(t=s(t)),t instanceof d._Code?e.push(...t._items):e.push(t),e),[])):e;var i;function s(e){const i=n[e.str];return void 0===i||1!==t[e.str]?e:(delete t[e.str],i)}}function B(e,t){for(const n in t)e[n]=(e[n]||0)-(t[n]||0)}function W(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:(0,d._)(o||(o=c(["!",""])),z(e))}t.CodeGen=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._values={},this._blockStarts=[],this._constants={},this.opts=u(u({},t),{},{_n:t.lines?"\n":""}),this._extScope=e,this._scope=new h.Scope({parent:e}),this._nodes=[new A]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const n=this._extScope.value(e,t);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,n,i){const s=this._scope.toName(t);return void 0!==n&&i&&(this._constants[s.str]=n),this._leafNode(new g(e,s,n)),s}const(e,t,n){return this._def(h.varKinds.const,e,t,n)}let(e,t,n){return this._def(h.varKinds.let,e,t,n)}var(e,t,n){return this._def(h.varKinds.var,e,t,n)}assign(e,t,n){return this._leafNode(new v(e,t,n))}add(e,n){return this._leafNode(new y(e,t.operators.ADD,n))}code(e){return"function"==typeof e?e():e!==d.nil&&this._leafNode(new x(e)),this}object(){const e=["{"];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const[s,r]of n)e.length>1&&e.push(","),e.push(s),(s!==r||this.opts.es5)&&(e.push(":"),(0,d.addCodeArg)(e,r));return e.push("}"),new d._Code(e)}if(e,t,n){if(this._blockNode(new T(e)),t&&n)this.code(t).else().code(n).endIf();else if(t)this.code(t).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new T(e))}else(){return this._elseNode(new C)}endIf(){return this._endBlockNode(T,C)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new I(e),t)}forRange(e,t,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.es5?h.varKinds.var:h.varKinds.let;const r=this._scope.toName(e);return this._for(new N(s,r,t,n),()=>i(r))}forOf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.varKinds.const;const o=this._scope.toName(e);if(this.opts.es5){const e=t instanceof d.Name?t:this.var("_arr",t);return this.forRange("_i",0,(0,d._)(i||(i=c(["",".length"])),e),t=>{this.var(o,(0,d._)(s||(s=c(["","[","]"])),e,t)),n(o)})}return this._for(new P("of",r,o,t),()=>n(o))}forIn(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.es5?h.varKinds.var:h.varKinds.const;if(this.opts.ownProperties)return this.forOf(e,(0,d._)(r||(r=c(["Object.keys(",")"])),t),n);const s=this._scope.toName(e);return this._for(new P("in",i,s,t),()=>n(s))}endFor(){return this._endBlockNode(k)}label(e){return this._leafNode(new b(e))}break(e){return this._leafNode(new w(e))}return(e){const t=new R;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(R)}try(e,t,n){if(!t&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');const i=new O;if(this._blockNode(i),this.code(e),t){const e=this.name("e");this._currNode=i.catch=new D(e),t(e)}return n&&(this._currNode=i.finally=new F,this.code(n)),this._endBlockNode(D,F)}throw(e){return this._leafNode(new _(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const n=this._nodes.length-t;if(n<0||void 0!==e&&n!==e)throw new Error("CodeGen: wrong number of nodes: ".concat(n," vs ").concat(e," expected"));return this._nodes.length=t,this}func(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.nil,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this._blockNode(new M(e,t,n)),i&&this.code(i).endFunc(),this}endFunc(){return this._endBlockNode(M)}optimize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const n=this._currNode;if(n instanceof e||t&&n instanceof t)return this._nodes.pop(),this;throw new Error('CodeGen: not in block "'.concat(t?"".concat(e.kind,"/").concat(t.kind):e.kind,'"'))}_elseNode(e){const t=this._currNode;if(!(t instanceof T))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},t.not=W;const H=q(t.operators.AND);t.and=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(H)};const V=q(t.operators.OR);function q(e){return(t,n)=>t===d.nil?n:n===d.nil?t:(0,d._)(a||(a=c([""," "," ",""])),z(t),e,z(n))}function z(e){return e instanceof d.Name?e:(0,d._)(l||(l=c(["(",")"])),e)}t.or=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(V)}},8617(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(3740),s=n(7968),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",i.default,s.default];t.default=r},8853(e,t,n){"use strict";e.exports=n(7234)},9045(e,t,n){var i=n(3738).default;e.exports=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=i(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9142(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;const f=n(8584),m=n(266),g=n(656),v=n(6772);function y(e){const{gen:t,data:n,it:i}=e;t.if(i.parentData,()=>t.assign(n,(0,f._)(c||(c=p(["","[","]"])),i.parentData,i.parentDataProperty)))}function b(e,t,n){if(void 0===n)throw new Error('keyword "'.concat(t,'" failed to compile'));return e.scopeValue("keyword","function"==typeof n?{ref:n}:{ref:n,code:(0,f.stringify)(n)})}t.macroKeywordCode=function(e,t){const{gen:n,keyword:i,schema:s,parentSchema:r,it:o}=e,a=t.macro.call(o.self,s,r,o),l=b(n,i,a);!1!==o.opts.validateSchema&&o.self.validateSchema(a,!0);const c=n.name("valid");e.subschema({schema:a,schemaPath:f.nil,errSchemaPath:"".concat(o.errSchemaPath,"/").concat(i),topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))},t.funcKeywordCode=function(e,t){var n;const{gen:c,keyword:w,schema:_,parentSchema:x,$data:E,it:S}=e;!function(e,t){let{schemaEnv:n}=e;if(t.async&&!n.$async)throw new Error("async keyword in sync schema")}(S,t);const A=!E&&t.compile?t.compile.call(S.self,_,x,S):t.validate,C=b(c,w,A),T=c.let("valid");function k(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.async?(0,f._)(a||(a=p(["await "]))):f.nil;const i=S.opts.passContext?m.default.this:m.default.self,s=!("compile"in t&&!E||!1===t.schema);c.assign(T,(0,f._)(l||(l=p(["","",""])),n,(0,g.callValidateCode)(e,C,i,s)),t.modifying)}function I(e){var n;c.if((0,f.not)(null!==(n=t.valid)&&void 0!==n?n:T),e)}e.block$data(T,function(){if(!1===t.errors)k(),t.modifying&&y(e),I(()=>e.error());else{const n=t.async?function(){const e=c.let("ruleErrs",null);return c.try(()=>k((0,f._)(i||(i=p(["await "])))),t=>c.assign(T,!1).if((0,f._)(s||(s=p([""," instanceof ",""])),t,S.ValidationError),()=>c.assign(e,(0,f._)(r||(r=p(["",".errors"])),t)),()=>c.throw(t))),e}():function(){const e=(0,f._)(o||(o=p(["",".errors"])),C);return c.assign(e,null),k(f.nil),e}();t.modifying&&y(e),I(()=>function(e,t){const{gen:n}=e;n.if((0,f._)(u||(u=p(["Array.isArray(",")"])),t),()=>{n.assign(m.default.vErrors,(0,f._)(d||(d=p([""," === null ? "," : ",".concat(",")"])),m.default.vErrors,t,m.default.vErrors,t)).assign(m.default.errors,(0,f._)(h||(h=p(["",".length"])),m.default.vErrors)),(0,v.extendErrors)(e)},()=>e.error())}(e,n))}}),e.ok(null!==(n=t.valid)&&void 0!==n?n:T)},t.validSchemaType=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||n&&"undefined"==typeof e)},t.validateKeywordUsage=function(e,t,n){let{schema:i,opts:s,self:r,errSchemaPath:o}=e;if(Array.isArray(t.keyword)?!t.keyword.includes(n):t.keyword!==n)throw new Error("ajv implementation error");const a=t.dependencies;if(null===a||void 0===a?void 0:a.some(e=>!Object.prototype.hasOwnProperty.call(i,e)))throw new Error("parent schema must have dependencies of ".concat(n,": ").concat(a.join(",")));if(t.validateSchema){if(!t.validateSchema(i[n])){const e='keyword "'.concat(n,'" value is invalid at path "').concat(o,'": ')+r.errorsText(t.validateSchema.errors);if("log"!==s.validateSchema)throw new Error(e);r.logger.error(e)}}}},9207(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(n||(t.DiscrError=n={}))},9273(e,t,n){"use strict";var i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y,b,w,_,x,E,S,A,C,T,k,I,N,P,M,R,O,D,F=n(166).default;Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const L=n(4445),j=n(2392),U=n(6772),B=n(8584),W=n(8396);var H;function V(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(L.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(H||(t.DataType=H={})),t.getSchemaTypes=function(e){const t=V(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=V,t.coerceAndCheckDataType=function(e,t){const{gen:n,data:A,opts:C}=e,T=function(e,t){return t?e.filter(e=>q.has(e)||"array"===t&&"array"===e):[]}(t,C.coerceTypes),k=t.length>0&&!(0===T.length&&1===t.length&&(0,j.schemaHasRulesForType)(e,t[0]));if(k){const k=G(t,A,C.strictNumbers,H.Wrong);n.if(k,()=>{T.length?function(e,t,n){const{gen:A,data:C,opts:T}=e,k=A.let("dataType",(0,B._)(i||(i=F(["typeof ",""])),C)),I=A.let("coerced",(0,B._)(s||(s=F(["undefined"]))));"array"===T.coerceTypes&&A.if((0,B._)(r||(r=F([""," == 'object' && Array.isArray(",") && ",".length == 1"])),k,C,C),()=>A.assign(C,(0,B._)(o||(o=F(["","[0]"])),C)).assign(k,(0,B._)(a||(a=F(["typeof ",""])),C)).if(G(t,C,T.strictNumbers),()=>A.assign(I,C)));A.if((0,B._)(l||(l=F([""," !== undefined"])),I));for(const i of n)(q.has(i)||"array"===i&&"array"===T.coerceTypes)&&N(i);function N(e){switch(e){case"string":return void A.elseIf((0,B._)(u||(u=F(["",' == "number" || ',' == "boolean"'])),k,k)).assign(I,(0,B._)(d||(d=F(['"" + ',""])),C)).elseIf((0,B._)(h||(h=F([""," === null"])),C)).assign(I,(0,B._)(p||(p=F(['""']))));case"number":return void A.elseIf((0,B._)(f||(f=F(["",' == "boolean" || '," === null\n              || (",' == "string" && '," && "," == +",")"])),k,C,k,C,C,C)).assign(I,(0,B._)(m||(m=F(["+",""])),C));case"integer":return void A.elseIf((0,B._)(g||(g=F(["",' === "boolean" || '," === null\n              || (",' === "string" && '," && "," == +"," && !("," % 1))"])),k,C,k,C,C,C,C)).assign(I,(0,B._)(v||(v=F(["+",""])),C));case"boolean":return void A.elseIf((0,B._)(y||(y=F(["",' === "false" || '," === 0 || "," === null"])),C,C,C)).assign(I,!1).elseIf((0,B._)(b||(b=F(["",' === "true" || '," === 1"])),C,C)).assign(I,!0);case"null":return A.elseIf((0,B._)(w||(w=F(["",' === "" || '," === 0 || "," === false"])),C,C,C)),void A.assign(I,null);case"array":A.elseIf((0,B._)(_||(_=F(["",' === "string" || ',' === "number"\n              || ',' === "boolean" || '," === null"])),k,k,k,C)).assign(I,(0,B._)(x||(x=F(["[","]"])),C))}}A.else(),K(e),A.endIf(),A.if((0,B._)(c||(c=F([""," !== undefined"])),I),()=>{A.assign(C,I),function(e,t){let{gen:n,parentData:i,parentDataProperty:s}=e;n.if((0,B._)(E||(E=F([""," !== undefined"])),i),()=>n.assign((0,B._)(S||(S=F(["","[","]"])),i,s),t))}(e,I)})}(e,t,T):K(e)})}return k};const q=new Set(["string","number","integer","boolean","null"]);function z(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:H.Correct;const s=i===H.Correct?B.operators.EQ:B.operators.NEQ;let r;switch(e){case"null":return(0,B._)(A||(A=F([""," "," null"])),t,s);case"array":r=(0,B._)(C||(C=F(["Array.isArray(",")"])),t);break;case"object":r=(0,B._)(T||(T=F([""," && typeof ",' == "object" && !Array.isArray(',")"])),t,t,t);break;case"integer":r=o((0,B._)(k||(k=F(["!("," % 1) && !isNaN(",")"])),t,t));break;case"number":r=o();break;default:return(0,B._)(I||(I=F(["typeof "," "," ",""])),t,s,e)}return i===H.Correct?r:(0,B.not)(r);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B.nil;return(0,B.and)((0,B._)(N||(N=F(["typeof ",' == "number"'])),t),e,n?(0,B._)(P||(P=F(["isFinite(",")"])),t):B.nil)}}function G(e,t,n,i){if(1===e.length)return z(e[0],t,n,i);let s;const r=(0,W.toHash)(e);if(r.array&&r.object){const e=(0,B._)(M||(M=F(["typeof ",' != "object"'])),t);s=r.null?e:(0,B._)(R||(R=F(["!"," || ",""])),t,e),delete r.null,delete r.array,delete r.object}else s=B.nil;r.number&&delete r.integer;for(const o in r)s=(0,B.and)(s,z(o,t,n,i));return s}t.checkDataType=z,t.checkDataTypes=G;const J={message:e=>{let{schema:t}=e;return"must be ".concat(t)},params:e=>{let{schema:t,schemaValue:n}=e;return"string"==typeof t?(0,B._)(O||(O=F(["{type: ","}"])),t):(0,B._)(D||(D=F(["{type: ","}"])),n)}};function K(e){const t=function(e){const{gen:t,data:n,schema:i}=e,s=(0,W.schemaRefOrVal)(e,i,"type");return{gen:t,keyword:"type",data:n,schema:i.type,schemaCode:s,schemaValue:s,parentSchema:i,params:{},it:e}}(e);(0,U.reportError)(t,J)}t.reportTypeError=K},9281(e,t,n){"use strict";var i=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var s=n(5413);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return s.KeywordCxt}});var r=n(8584);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const o=n(6817),a=n(9550),l=n(4445),c=n(1762),u=n(8584),d=n(2302),h=n(9273),p=n(8396),f=n(3837),m=n(4601),g=(e,t)=>new RegExp(e,t);g.code="new RegExp";const v=["removeAdditional","useDefaults","coerceTypes"],y=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),b={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},w={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};class _{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts=i(i({},e),function(e){var t,n,s,r,o,a,l,c,u,d,h,p,f,v,y,b,w,_,x,E,S,A,C,T,k;const I=e.strict,N=null===(t=e.code)||void 0===t?void 0:t.optimize,P=!0===N||void 0===N?1:N||0,M=null!==(s=null===(n=e.code)||void 0===n?void 0:n.regExp)&&void 0!==s?s:g,R=null!==(r=e.uriResolver)&&void 0!==r?r:m.default;return{strictSchema:null===(a=null!==(o=e.strictSchema)&&void 0!==o?o:I)||void 0===a||a,strictNumbers:null===(c=null!==(l=e.strictNumbers)&&void 0!==l?l:I)||void 0===c||c,strictTypes:null!==(d=null!==(u=e.strictTypes)&&void 0!==u?u:I)&&void 0!==d?d:"log",strictTuples:null!==(p=null!==(h=e.strictTuples)&&void 0!==h?h:I)&&void 0!==p?p:"log",strictRequired:null!==(v=null!==(f=e.strictRequired)&&void 0!==f?f:I)&&void 0!==v&&v,code:e.code?i(i({},e.code),{},{optimize:P,regExp:M}):{optimize:P,regExp:M},loopRequired:null!==(y=e.loopRequired)&&void 0!==y?y:200,loopEnum:null!==(b=e.loopEnum)&&void 0!==b?b:200,meta:null===(w=e.meta)||void 0===w||w,messages:null===(_=e.messages)||void 0===_||_,inlineRefs:null===(x=e.inlineRefs)||void 0===x||x,schemaId:null!==(E=e.schemaId)&&void 0!==E?E:"$id",addUsedSchema:null===(S=e.addUsedSchema)||void 0===S||S,validateSchema:null===(A=e.validateSchema)||void 0===A||A,validateFormats:null===(C=e.validateFormats)||void 0===C||C,unicodeRegExp:null===(T=e.unicodeRegExp)||void 0===T||T,int32range:null===(k=e.int32range)||void 0===k||k,uriResolver:R}}(e));const{es5:t,lines:n}=this.opts.code;this.scope=new u.ValueScope({scope:{},prefixes:y,es5:t,lines:n}),this.logger=function(e){if(!1===e)return k;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,l.getRules)(),x.call(this,b,e,"NOT SUPPORTED"),x.call(this,w,e,"DEPRECATED","warn"),this._metaOpts=T.call(this),e.formats&&A.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&C.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),S.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:n}=this.opts;let s=f;"id"===n&&(s=i({},f),s.id=s.$id,delete s.$id),t&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let n;if("string"==typeof e){if(n=this.getSchema(e),!n)throw new Error('no schema with key or ref "'.concat(e,'"'))}else n=this.compile(e);const i=n(t);return"$async"in n||(this.errors=n.errors),i}compile(e,t){const n=this._addSchema(e,t);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:n}=this.opts;return i.call(this,e,t);async function i(e,t){await s.call(this,e.$schema);const n=this._addSchema(e,t);return n.validate||r.call(this,n)}async function s(e){e&&!this.getSchema(e)&&await i.call(this,{$ref:e},!0)}async function r(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof a.default))throw t;return o.call(this,t),await l.call(this,t.missingSchema),r.call(this,e)}}function o(e){let{missingSchema:t,missingRef:n}=e;if(this.refs[t])throw new Error("AnySchema ".concat(t," is loaded but ").concat(n," cannot be resolved"))}async function l(e){const n=await c.call(this,e);this.refs[e]||await s.call(this,n.$schema),this.refs[e]||this.addSchema(n,e,t)}async function c(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=n(e))}finally{delete this._loading[e]}}}addSchema(e,t,n){let i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema;if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,n,s);return this}if("object"===typeof e){const{schemaId:t}=this.opts;if(i=e[t],void 0!==i&&"string"!=typeof i)throw new Error("schema ".concat(t," must be string"))}return t=(0,d.normalizeId)(t||i),this._checkUnique(t),this.schemas[t]=this._addSchema(e,n,t,s,!0),this}addMetaSchema(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.validateSchema;return this.addSchema(e,t,!0,n),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let n;if(n=e.$schema,void 0!==n&&"string"!=typeof n)throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const i=this.validate(n,e);if(!i&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return i}getSchema(e){let t;for(;"string"==typeof(t=E.call(this,e));)e=t;if(void 0===t){const{schemaId:n}=this.opts,i=new c.SchemaEnv({schema:{},schemaId:n});if(t=c.resolveSchema.call(this,i,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=E.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let n=e[this.opts.schemaId];return n&&(n=(0,d.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let n;if("string"==typeof e)n=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=n);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(n=(t=e).keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(N.call(this,n,t),!t)return(0,p.eachItem)(n,e=>P.call(this,e)),this;R.call(this,t);const s=i(i({},t),{},{type:(0,h.getJSONTypes)(t.type),schemaType:(0,h.getJSONTypes)(t.schemaType)});return(0,p.eachItem)(n,0===s.type.length?e=>P.call(this,e,s):e=>s.type.forEach(t=>P.call(this,e,s,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const n of t.rules){const t=n.rules.findIndex(t=>t.keyword===e);t>=0&&n.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.errors,{separator:t=", ",dataVar:n="data"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&0!==e.length?e.map(e=>"".concat(n).concat(e.instancePath," ").concat(e.message)).reduce((e,n)=>e+t+n):"No errors"}$dataMetaSchema(e,t){const n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const i of t){const t=i.split("/").slice(1);let s=e;for(const e of t)s=s[e];for(const e in n){const t=n[e];if("object"!=typeof t)continue;const{$data:i}=t.definition,r=s[e];i&&r&&(s[e]=D(r))}}return e}_removeAllSchemas(e,t){for(const n in e){const i=e[n];t&&!t.test(n)||("string"==typeof i?delete e[n]:i&&!i.meta&&(this._cache.delete(i.schema),delete e[n]))}}_addSchema(e,t,n){let i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.addUsedSchema;const{schemaId:o}=this.opts;if("object"==typeof e)i=e[o];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let a=this._cache.get(e);if(void 0!==a)return a;n=(0,d.normalizeId)(i||n);const l=d.getSchemaRefs.call(this,e,n);return a=new c.SchemaEnv({schema:e,schemaId:o,meta:t,baseId:n,localRefs:l}),this._cache.set(a.schema,a),r&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=a),s&&this.validateSchema(e,!0),a}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error('schema with key or id "'.concat(e,'" already exists'))}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):c.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{c.compileSchema.call(this,e)}finally{this.opts=t}}}function x(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"error";for(const s in e){const r=s;r in t&&this.logger[i]("".concat(n,": option ").concat(s,". ").concat(e[r]))}}function E(e){return e=(0,d.normalizeId)(e),this.schemas[e]||this.refs[e]}function S(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function A(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function C(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const n=e[t];n.keyword||(n.keyword=t),this.addKeyword(n)}}}function T(){const e=i({},this.opts);for(const t of v)delete e[t];return e}_.ValidationError=o.default,_.MissingRefError=a.default,t.default=_;const k={log(){},warn(){},error(){}};const I=/^[a-z_$][a-z0-9_$:-]*$/i;function N(e,t){const{RULES:n}=this;if((0,p.eachItem)(e,e=>{if(n.keywords[e])throw new Error("Keyword ".concat(e," is already defined"));if(!I.test(e))throw new Error("Keyword ".concat(e," has invalid name"))}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function P(e,t,n){var s;const r=null===t||void 0===t?void 0:t.post;if(n&&r)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let a=r?o.post:o.rules.find(e=>{let{type:t}=e;return t===n});if(a||(a={type:n,rules:[]},o.rules.push(a)),o.keywords[e]=!0,!t)return;const l={keyword:e,definition:i(i({},t),{},{type:(0,h.getJSONTypes)(t.type),schemaType:(0,h.getJSONTypes)(t.schemaType)})};t.before?M.call(this,a,l,t.before):a.rules.push(l),o.all[e]=l,null===(s=t.implements)||void 0===s||s.forEach(e=>this.addKeyword(e))}function M(e,t,n){const i=e.rules.findIndex(e=>e.keyword===n);i>=0?e.rules.splice(i,0,t):(e.rules.push(t),this.logger.warn("rule ".concat(n," is not defined")))}function R(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=D(t)),e.validateSchema=this.compile(t,!0))}const O={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function D(e){return{anyOf:[e,O]}}},9294(e,t,n){"use strict";var i,s,r,o,a,l=n(166).default;Object.defineProperty(t,"__esModule",{value:!0});const c=n(8584),u=n(8396),d=n(6754),h={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message(e){let{keyword:t,schemaCode:n}=e;const s="maxLength"===t?"more":"fewer";return(0,c.str)(i||(i=l(["must NOT have "," than "," characters"])),s,n)},params:e=>{let{schemaCode:t}=e;return(0,c._)(s||(s=l(["{limit: ","}"])),t)}},code(e){const{keyword:t,data:n,schemaCode:i,it:s}=e,h="maxLength"===t?c.operators.GT:c.operators.LT,p=!1===s.opts.unicode?(0,c._)(r||(r=l(["",".length"])),n):(0,c._)(o||(o=l(["","(",")"])),(0,u.useFunc)(e.gen,d.default),n);e.fail$data((0,c._)(a||(a=l([""," "," ",""])),p,h,i))}};t.default=h},9497(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8617),s=n(2141),r=n(3939),o=n(3709),a=n(6280),l=[i.default,s.default,(0,r.default)(),o.default,a.metadataVocabulary,a.contentVocabulary];t.default=l},9550(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2302);class s extends Error{constructor(e,t,n,s){super(s||"can't resolve reference ".concat(n," from id ").concat(t)),this.missingRef=(0,i.resolveUrl)(e,t,n),this.missingSchema=(0,i.normalizeId)((0,i.getFullPath)(e,this.missingRef))}}t.default=s}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(5043),t=n(4391);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=i(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function r(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const l={descritor:{tipo_documento:"Presta\xe7\xe3o de Contas de Conv\xeanio",municipio:0,entidade:0,ano:2025,mes:1},codigo_ajuste:"",retificacao:!1,relacao_empregados:[],relacao_bens:{relacao_bens_moveis_adquiridos:[],relacao_bens_moveis_cedidos:[],relacao_bens_moveis_baixados_devolvidos:[],relacao_bens_imoveis_adquiridos:[],relacao_bens_imoveis_cedidos:[],relacao_bens_imoveis_baixados_devolvidos:[]},contratos:[],documentos_fiscais:[],pagamentos:[],disponibilidades:{saldos:[],saldo_fundo_fixo:0},receitas:{repasses_recebidos:[],outras_receitas:[],recursos_proprios:[]},ajustes_saldo:{retificacao_repasses:[],inclusao_repasses:[],retificacao_pagamentos:[],inclusao_pagamentos:[]},servidores_cedidos:[],descontos:[],devolucoes:[],glosas:[],empenhos:[],repasses:[],relatorio_atividades:{programas:[]},dados_gerais_entidade_beneficiaria:{identificacao_certidao_dados_gerais:"",identificacao_certidao_corpo_diretivo:"",identificacao_certidao_membros_conselho:""},responsaveis_membros_orgao_concessor:{identificacao_certidao_responsaveis:"",identificacao_certidao_membros_comissao_avaliacao:"",identificacao_certidao_membros_controle_interno:""},declaracoes:{houve_contratacao_empresas_pertencentes:!1,houve_participacao_quadro_diretivo_administrativo:!1},relatorio_governamental_analise_execucao:{houve_emissao_relatorio_final:!1},demonstracoes_contabeis:{publicacoes:[],responsavel:{numero_crc:"",cpf:"",situacao_regular_crc:!1}},publicacoes_parecer_ata:[],prestacao_contas_entidade_beneficiaria:{data_prestacao:"",periodo_referencia_data_inicial:"",periodo_referencia_data_final:""},parecer_conclusivo:{identificacao_parecer:"",conclusao_parecer:1,declaracoes:[]},transparencia:{entidade_beneficiaria_mantem_sitio_internet:!1,sitios_internet:[],requisitos_artigos_7o_8o_paragrafo_1o:[],requisitos_sitio_artigo_8o_paragrafo_3o:[],requisitos_divulgacao_informacoes:[]}},c="undefined"!==typeof window&&"localhost"===window.location.hostname,u=c?"/proxy-piloto-login":"https://audesp-piloto.tce.sp.gov.br";"undefined"!==typeof window&&console.log("[Auth Init]",{hostname:window.location.hostname,isLocalhost:c,API_BASE:u,protocol:window.location.protocol,url:window.location.href});const d="audesp_token",h="audesp_expire";function p(){return sessionStorage.getItem(d)}const f="audesp_protocolos";function m(e){const t=function(){const e=localStorage.getItem(f);if(!e)return[];try{return JSON.parse(e)}catch(t){return[]}}();t.unshift(e),localStorage.setItem(f,JSON.stringify(t))}class g{static logOperation(e){const t=a(a({},e),{},{id:this.generateId(),timestamp:(new Date).toISOString()}),n=[t,...this.getLog()].slice(0,this.MAX_ENTRIES);return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n)),console.log("[AUDIT]",t),t}static logCreate(e,t,n){return this.logOperation({action:"CREATE",section:e,newValue:t,status:"SUCCESS",userId:n})}static logUpdate(e,t,n,i,s){return this.logOperation({action:"UPDATE",section:e,field:t,oldValue:n,newValue:i,status:"SUCCESS",userId:s})}static logTransmission(e,t,n,i,s){return this.logOperation({action:"TRANSMIT",section:"TRANSMISSION",status:n,details:"".concat(e," - Protocolo: ").concat(t||"N/A"),errorMessage:i,userId:s})}static logValidation(e,t,n){return this.logOperation({action:"VALIDATE",section:"VALIDATION",status:e?"SUCCESS":"FAILED",details:"Erros encontrados: ".concat(t),userId:n})}static logLogin(e,t,n){return this.logOperation({action:"LOGIN",status:t?"SUCCESS":"FAILED",userId:e,errorMessage:n})}static logLogout(e){return this.logOperation({action:"LOGOUT",status:"SUCCESS",userId:e})}static logExport(e,t){return this.logOperation({action:"EXPORT",section:"EXPORT_".concat(e.toUpperCase()),status:"SUCCESS",userId:t})}static logImport(e,t,n,i){return this.logOperation({action:"IMPORT",section:"IMPORT_".concat(e.toUpperCase()),status:t?"SUCCESS":"FAILED",errorMessage:n,userId:i})}static getLog(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao ler log de auditoria"),[]}}static getLogByPeriod(e,t){const n=this.getLog(),i=new Date(e).getTime(),s=new Date(t).getTime();return n.filter(e=>{const t=new Date(e.timestamp).getTime();return t>=i&&t<=s})}static getLogByAction(e){return this.getLog().filter(t=>t.action===e)}static getLogBySection(e){return this.getLog().filter(t=>t.section===e)}static getLogByUser(e){return this.getLog().filter(t=>t.userId===e)}static clearLog(e){return"CONFIRM_CLEAR_AUDIT_LOG"!==e?(console.warn("Tentativa de limpar log sem confirma\xe7\xe3o"),!1):(localStorage.removeItem(this.STORAGE_KEY),console.warn("[AUDIT] Log de auditoria foi limpo"),!0)}static generateId(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}}g.STORAGE_KEY="audesp_audit_log",g.MAX_ENTRIES=1e4;class v{static async computeDataHash(e){var t;const n=JSON.stringify(e);if("undefined"!==typeof window&&null!==(t=window.crypto)&&void 0!==t&&t.subtle){const e=(new TextEncoder).encode(n),t=await window.crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}return this.simpleHash(n)}static simpleHash(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return(t>>>0).toString(16)}static async registerIntegrityCheck(e,t){var n;const i=await this.computeDataHash(e),s=this.getIntegrityHistory(),r={dataHash:i,previousHash:s.length>0?s[0].dataHash:void 0,timestamp:(new Date).toISOString(),userId:t,isValid:!0,hashAlgorithm:"undefined"!==typeof window&&null!==(n=window.crypto)&&void 0!==n&&n.subtle?"SHA-256":"SIMPLE_HASH"},o=[r,...s].slice(0,100);return localStorage.setItem(this.INTEGRITY_KEY,JSON.stringify(o)),g.logOperation({action:"VALIDATE",status:"SUCCESS",details:"Integrity check: ".concat(i),userId:t}),r}static async verifyIntegrity(e){const t=await this.computeDataHash(e),n=this.getIntegrityHistory();if(0===n.length)return!0;return t===n[0].dataHash}static getIntegrityHistory(){try{const e=localStorage.getItem(this.INTEGRITY_KEY);return e?JSON.parse(e):[]}catch(e){return[]}}static async detectUnregisteredChanges(e){const t=await this.computeDataHash(e),n=this.getIntegrityHistory();if(0===n.length)return!1;return t!==n[0].dataHash}}v.INTEGRITY_KEY="audesp_integrity_check";class y{static async validateTransmissionPermission(e,t,n){try{if(console.log("[Permission] Validando permiss\xe3o para: ".concat(e)),!t)return{hasPermission:!1,reason:"Token n\xe3o encontrado. Fa\xe7a login novamente."};n||console.warn("[Permission] CPF n\xe3o informado - prosseguindo com cautela");const i=sessionStorage.getItem("audesp_expire");return i&&parseInt(i)<Date.now()?{hasPermission:!1,reason:"Token expirado. Fa\xe7a login novamente."}:(console.log("[Permission] \u2713 Valida\xe7\xf5es b\xe1sicas passadas para: ".concat(e)),{hasPermission:!0})}catch(i){return console.error("[Permission] Erro na valida\xe7\xe3o:",i),{hasPermission:!1,reason:"Erro ao validar permiss\xf5es. Tente novamente."}}}static getPermissionErrorMessage(e,t){const n="ERR-403-".concat(Date.now().toString().slice(-6));return"\u274c Acesso Negado - Permiss\xe3o Insuficiente\n\nSeu CPF ".concat(t?"(".concat(t,")"):""," n\xe3o possui permiss\xe3o para:\n\ud83d\udcc4 ").concat(e,"\n\nPoss\xedveis motivos:\n1. Seu perfil no Audesp n\xe3o est\xe1 configurado para este tipo de documento\n2. Sua credencial est\xe1 em processo de valida\xe7\xe3o\n3. Suas permiss\xf5es foram revogadas temporariamente\n4. Voc\xea est\xe1 usando uma CPF/Email n\xe3o autorizado\n\nO que fazer:\n\u2713 Tente com outra CPF que voc\xea sabe ter permiss\xe3o\n\u2713 Fa\xe7a logout e login novamente\n\u2713 Contate o administrador da sua institui\xe7\xe3o\n\u2713 Se persisidr, contate suporte: suporte@audesp.tce.sp.gov.br\n\nC\xf3digo de erro: ").concat(n)}static getResolutionSteps(e){return["1. Verifique se seu CPF est\xe1 ativo no Audesp","2. Confirme que seu CPF tem permiss\xe3o para transmitir este tipo de documento","3. Fa\xe7a logout (menu) e login novamente com suas credenciais",'4. Tente transmitir outro tipo de documento para confirmar se \xe9 espec\xedfico de "'.concat(e,'"'),"5. Se outros tipos tamb\xe9m falham, sua credencial pode estar suspensa","6. Entre em contato com o administrador da sua institui\xe7\xe3o","7. \xdaltimamente: suporte@audesp.tce.sp.gov.br com seu CPF e tipo de documento"]}}const b="undefined"!==typeof window&&"localhost"===window.location.hostname,w=b?"/proxy-piloto-f5":"https://audesp-piloto.tce.sp.gov.br/f5";"undefined"!==typeof window&&console.log("[Transmission Init]",{hostname:window.location.hostname,isLocalhost:b,API_BASE:w,protocol:window.location.protocol,url:window.location.href});const _={"Presta\xe7\xe3o de Contas de Conv\xeanio":"/enviar-prestacao-contas-convenio","Presta\xe7\xe3o de Contas de Contrato de Gest\xe3o":"/enviar-prestacao-contas-contrato-gestao","Presta\xe7\xe3o de Contas de Termo de Parceria":"/enviar-prestacao-contas-parceria","Presta\xe7\xe3o de Contas de Termo de Fomento":"/enviar-prestacao-contas-termo-fomento","Presta\xe7\xe3o de Contas de Termo de Colabora\xe7\xe3o":"/enviar-prestacao-contas-termo-colaboracao","Declara\xe7\xe3o Negativa":"/enviar-prestacao-contas-declaracao-negativa"};var x=n(7003),E=n.n(x),S=n(483),A=n.n(S);const C=new(E())({allErrors:!0,verbose:!0,coerceTypes:!0});function T(e){const t={};return Array.from({length:27},(e,t)=>String(t+1)).forEach(n=>{const i=function(e,t){var n,i,s,r,o,a,l,c,u,d,h,p,f,m,g,v,y;const b=[];switch(e){case"1":t.descritor.municipio||b.push("Munic\xedpio \xe9 obrigat\xf3rio."),t.descritor.entidade||b.push("C\xf3digo da Entidade \xe9 obrigat\xf3rio."),t.descritor.ano||b.push("Ano \xe9 obrigat\xf3rio."),t.descritor.mes||b.push("M\xeas \xe9 obrigat\xf3rio.");break;case"2":t.codigo_ajuste||b.push("C\xf3digo do Ajuste \xe9 obrigat\xf3rio.");break;case"3":case"11":case"22":break;case"4":null===(n=t.relacao_empregados)||void 0===n||n.forEach((e,t)=>{var n;e.cpf&&11===e.cpf.length||b.push("Empregado #".concat(t+1,": CPF inv\xe1lido (deve ter 11 d\xedgitos).")),e.data_admissao||b.push("Empregado #".concat(t+1,": Data de admiss\xe3o obrigat\xf3ria.")),e.periodos_remuneracao&&0!==e.periodos_remuneracao.length||b.push("Empregado #".concat(t+1,": Deve ter ao menos um per\xedodo de remunera\xe7\xe3o.")),null===(n=e.periodos_remuneracao)||void 0===n||n.forEach((e,n)=>{e.remuneracao_bruta<=0&&b.push("Empregado #".concat(t+1,", M\xeas ").concat(e.mes,": Remunera\xe7\xe3o deve ser maior que zero.")),(e.mes>12||e.mes<1)&&b.push("Empregado #".concat(t+1,": M\xeas ").concat(e.mes," inv\xe1lido."))})});break;case"5":const e=null===(i=t.relacao_bens)||void 0===i?void 0:i.relacao_bens_moveis_adquiridos;null===e||void 0===e||e.forEach((e,t)=>{e.numero_patrimonio||b.push("Bem #".concat(t+1,": N\xba Patrim\xf4nio obrigat\xf3rio.")),e.descricao||b.push("Bem #".concat(t+1,": Descri\xe7\xe3o obrigat\xf3ria.")),(!e.valor_aquisicao||e.valor_aquisicao<=0)&&b.push("Bem #".concat(t+1,": Valor inv\xe1lido."))});break;case"6":null===(s=t.contratos)||void 0===s||s.forEach((e,t)=>{var n;e.numero||b.push("Contrato #".concat(t+1,": N\xfamero obrigat\xf3rio.")),null!==(n=e.credor)&&void 0!==n&&n.documento_numero||b.push("Contrato #".concat(t+1,": Credor obrigat\xf3rio.")),e.valor_montante<=0&&b.push("Contrato #".concat(t+1,": Valor deve ser positivo.")),e.vigencia_data_inicial&&e.vigencia_data_final&&new Date(e.vigencia_data_inicial)>new Date(e.vigencia_data_final)&&b.push("Contrato #".concat(t+1,": Data final de vig\xeancia anterior \xe0 inicial."))});break;case"7":null===(r=t.documentos_fiscais)||void 0===r||r.forEach((e,t)=>{var n;e.numero||b.push("Doc. Fiscal #".concat(t+1,": N\xfamero obrigat\xf3rio.")),e.valor_bruto<=0&&b.push("Doc. Fiscal #".concat(t+1,": Valor deve ser positivo.")),null!==(n=e.credor)&&void 0!==n&&n.documento_numero||b.push("Doc. Fiscal #".concat(t+1,": Credor obrigat\xf3rio.")),e.data_emissao||b.push("Doc. Fiscal #".concat(t+1,": Data emiss\xe3o obrigat\xf3ria."))});break;case"8":null===(o=t.pagamentos)||void 0===o||o.forEach((e,n)=>{var i;if(e.pagamento_data||b.push("Pagamento #".concat(n+1,": Data obrigat\xf3ria.")),e.pagamento_valor<=0&&b.push("Pagamento #".concat(n+1,": Valor deve ser positivo.")),null!==(i=e.identificacao_documento_fiscal)&&void 0!==i&&i.numero||b.push("Pagamento #".concat(n+1,": V\xednculo com Nota Fiscal obrigat\xf3rio.")),t.documentos_fiscais){const i=t.documentos_fiscais.find(t=>t.numero===e.identificacao_documento_fiscal.numero);i?i.data_emissao&&e.pagamento_data&&new Date(e.pagamento_data)<new Date(i.data_emissao)&&b.push("Pagamento #".concat(n+1,": Data do pagamento (").concat(e.pagamento_data,") anterior \xe0 emiss\xe3o da nota (").concat(i.data_emissao,").")):b.push("Pagamento #".concat(n+1,": Nota Fiscal vinculada (").concat(e.identificacao_documento_fiscal.numero,") n\xe3o encontrada na se\xe7\xe3o 7."))}});break;case"9":null===(a=t.disponibilidades)||void 0===a||a.saldos.forEach((e,t)=>{e.conta||b.push("Saldo #".concat(t+1,": Conta obrigat\xf3ria.")),e.banco||b.push("Saldo #".concat(t+1,": Banco obrigat\xf3rio.")),void 0===e.saldo_bancario&&b.push("Saldo #".concat(t+1,": Valor banc\xe1rio obrigat\xf3rio."))});break;case"10":null!==(l=t.receitas)&&void 0!==l&&l.repasses_recebidos&&t.receitas.repasses_recebidos.forEach((e,t)=>{e.data_repasse||b.push("Receita (Repasse) #".concat(t+1,": Data obrigat\xf3ria.")),e.valor<=0&&b.push("Receita (Repasse) #".concat(t+1,": Valor deve ser positivo."))});break;case"12":null===(c=t.servidores_cedidos)||void 0===c||c.forEach((e,t)=>{e.cpf||b.push("Servidor #".concat(t+1,": CPF obrigat\xf3rio.")),e.data_inicial_cessao||b.push("Servidor #".concat(t+1,": Data in\xedcio obrigat\xf3ria."))});break;case"16":null===(u=t.empenhos)||void 0===u||u.forEach((e,t)=>{e.numero||b.push("Empenho #".concat(t+1,": N\xfamero obrigat\xf3rio.")),e.valor<=0&&b.push("Empenho #".concat(t+1,": Valor inv\xe1lido."))});break;case"17":null===(d=t.repasses)||void 0===d||d.forEach((e,t)=>{(!e.valor_repasse||e.valor_repasse<=0)&&b.push("Repasse #".concat(t+1,": Valor inv\xe1lido.")),e.data_repasse||b.push("Repasse #".concat(t+1,": Data obrigat\xf3ria."))});break;case"18":null!==(h=t.relatorio_atividades)&&void 0!==h&&h.programas?(0===t.relatorio_atividades.programas.length&&b.push("Pelo menos um Programa deve ser cadastrado."),t.relatorio_atividades.programas.forEach((e,t)=>{e.nome_programa||b.push("Programa #".concat(t+1,": Nome obrigat\xf3rio.")),e.metas&&0!==e.metas.length||b.push("Programa #".concat(t+1,": Deve ter ao menos uma meta.")),e.metas.forEach((e,n)=>{e.codigo_meta||b.push("Programa #".concat(t+1,", Meta #").concat(n+1,": C\xf3digo obrigat\xf3rio.")),e.meta_atendida||e.justificativa||b.push("Programa #".concat(t+1,", Meta #").concat(n+1,": Justificativa obrigat\xf3ria para meta n\xe3o atendida."))})})):b.push("Relat\xf3rio de atividades vazio (Se\xe7\xe3o 18).");break;case"19":null!==(p=t.dados_gerais_entidade_beneficiaria)&&void 0!==p&&p.identificacao_certidao_dados_gerais||b.push("Certid\xe3o de Dados Gerais obrigat\xf3ria."),null!==(f=t.dados_gerais_entidade_beneficiaria)&&void 0!==f&&f.identificacao_certidao_corpo_diretivo||b.push("Certid\xe3o de Corpo Diretivo obrigat\xf3ria.");break;case"20":null!==(m=t.responsaveis_membros_orgao_concessor)&&void 0!==m&&m.identificacao_certidao_responsaveis||b.push("Certid\xe3o de Respons\xe1veis obrigat\xf3ria.");break;case"21":const w=t.declaracoes;null===w||void 0===w||!w.houve_contratacao_empresas_pertencentes||w.empresas_pertencentes&&0!==w.empresas_pertencentes.length||b.push("Se houve contrata\xe7\xe3o de empresas pertencentes, a lista de empresas \xe9 obrigat\xf3ria.");break;case"23":null!==(g=t.demonstracoes_contabeis)&&void 0!==g&&null!==(v=g.responsavel)&&void 0!==v&&v.cpf||b.push("CPF do Respons\xe1vel T\xe9cnico obrigat\xf3rio.");break;case"26":null!==(y=t.parecer_conclusivo)&&void 0!==y&&y.identificacao_parecer||b.push("Identifica\xe7\xe3o do Parecer Conclusivo obrigat\xf3ria.");break;case"27":const _=t.transparencia;null!==_&&void 0!==_&&_.entidade_beneficiaria_mantem_sitio_internet&&(_.sitios_internet&&0!==_.sitios_internet.length&&!_.sitios_internet.some(e=>!e.trim())||b.push("Se mant\xe9m s\xedtio na internet, informe a URL."))}return b}(n,e);let s="valid";const r=function(e,t){var n,i,s,r,o,a,l,c,u,d,h;switch(e){case"1":return!t.descritor.municipio;case"2":return!t.codigo_ajuste;case"3":case"27":return!1;case"4":return!t.relacao_empregados||0===t.relacao_empregados.length;case"5":return!(null!==(n=t.relacao_bens)&&void 0!==n&&n.relacao_bens_moveis_adquiridos)||0===t.relacao_bens.relacao_bens_moveis_adquiridos.length;case"6":return!t.contratos||0===t.contratos.length;case"7":return!t.documentos_fiscais||0===t.documentos_fiscais.length;case"8":return!t.pagamentos||0===t.pagamentos.length;case"9":return!(null!==(i=t.disponibilidades)&&void 0!==i&&i.saldos)||0===t.disponibilidades.saldos.length;case"10":return!(null!==(s=t.receitas)&&void 0!==s&&s.repasses_recebidos)||0===t.receitas.repasses_recebidos.length;case"11":return!(null!==(r=t.ajustes_saldo)&&void 0!==r&&r.retificacao_repasses)||0===t.ajustes_saldo.retificacao_repasses.length;case"12":return!t.servidores_cedidos||0===t.servidores_cedidos.length;case"13":return!t.descontos||0===t.descontos.length;case"14":return!t.devolucoes||0===t.devolucoes.length;case"15":return!t.glosas||0===t.glosas.length;case"16":return!t.empenhos||0===t.empenhos.length;case"17":return!t.repasses||0===t.repasses.length;case"18":return!(null!==(o=t.relatorio_atividades)&&void 0!==o&&o.programas)||0===t.relatorio_atividades.programas.length;case"19":return!(null!==(a=t.dados_gerais_entidade_beneficiaria)&&void 0!==a&&a.identificacao_certidao_dados_gerais);case"20":return!(null!==(l=t.responsaveis_membros_orgao_concessor)&&void 0!==l&&l.identificacao_certidao_responsaveis);case"21":return!t.declaracoes;case"22":return!(null!==(c=t.relatorio_governamental_analise_execucao)&&void 0!==c&&c.houve_emissao_relatorio_final);case"23":return!(null!==(u=t.demonstracoes_contabeis)&&void 0!==u&&u.publicacoes)||0===t.demonstracoes_contabeis.publicacoes.length;case"24":return!t.publicacoes_parecer_ata||0===t.publicacoes_parecer_ata.length;case"25":return!(null!==(d=t.prestacao_contas_entidade_beneficiaria)&&void 0!==d&&d.data_prestacao);case"26":return!(null!==(h=t.parecer_conclusivo)&&void 0!==h&&h.identificacao_parecer);default:return!0}}(n,e);i.length>0?s="invalid":r&&(s="empty",["1","2","18","19","20","21","26","27"].includes(n)&&(s="invalid",0===i.length&&i.push("Se\xe7\xe3o obrigat\xf3ria n\xe3o preenchida."))),t[n]={id:n,status:s,errors:i}}),t}A()(C);function k(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var I,N,P,M;let R,O;function D(e,t,n,i){var s,r;if(!(null===e||void 0===e?void 0:e.baseUrl)){const e={geminiUrl:R,vertexUrl:O};return t?null!==(s=e.vertexUrl)&&void 0!==s?s:n:null!==(r=e.geminiUrl)&&void 0!==r?r:i}return e.baseUrl}class F{}function L(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return void 0!==e&&null!==e?String(e):""}throw new Error("Key '".concat(n,"' not found in valueMap."))})}function j(e,t,n){for(let r=0;r<t.length-1;r++){const i=t[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(!(s in e)){if(!Array.isArray(n))throw new Error("Value must be a list given an array path ".concat(i));e[s]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[s])){const i=e[s];if(Array.isArray(n))for(let e=0;e<i.length;e++){j(i[e],t.slice(r+1),n[e])}else for(const e of i)j(e,t.slice(r+1),n)}return}if(i.endsWith("[0]")){const s=i.slice(0,-3);s in e||(e[s]=[{}]);return void j(e[s][0],t.slice(r+1),n)}e[i]&&"object"===typeof e[i]||(e[i]={}),e=e[i]}const i=t[t.length-1],s=e[i];if(void 0!==s){if(!n||"object"===typeof n&&0===Object.keys(n).length)return;if(n===s)return;if("object"!==typeof s||"object"!==typeof n||null===s||null===n)throw new Error("Cannot set value for an existing key. Key: ".concat(i));Object.assign(s,n)}else if("_self"!==i||"object"!==typeof n||null===n||Array.isArray(n))e[i]=n;else{const t=n;Object.assign(e,t)}}function U(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;try{if(1===t.length&&"_self"===t[0])return e;for(let i=0;i<t.length;i++){if("object"!==typeof e||null===e)return n;const s=t[i];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in e){const s=e[r];return Array.isArray(s)?s.map(e=>U(e,t.slice(i+1),n)):n}return n}e=e[s]}return e}catch(i){if(i instanceof TypeError)return n;throw i}}function B(e,t,n,i,s){if(i>=t.length)return;if("object"!==typeof e||null===e)return;const r=t[i];if(r.endsWith("[]")){const o=r.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const e of a[o])B(e,t,n,i+1,s)}else if("*"===r){if("object"===typeof e&&null!==e&&!Array.isArray(e)){const t=e,r=Object.keys(t).filter(e=>!e.startsWith("_")&&!s.has(e)),o={};for(const e of r)o[e]=t[e];for(const[e,s]of Object.entries(o)){const r=[];for(const t of n.slice(i))"*"===t?r.push(e):r.push(t);j(t,r,s)}for(const e of r)delete t[e]}}else{r in e&&B(e[r],t,n,i+1,s)}}function W(e){if("string"!==typeof e)throw new Error("fromImageBytes must be a string");return e}function H(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response","generateVideoResponse"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["video"]);null!=n&&j(t,["video"],function(e){const t={},n=U(e,["uri"]);null!=n&&j(t,["uri"],n);const i=U(e,["encodedVideo"]);null!=i&&j(t,["videoBytes"],W(i));const s=U(e,["encoding"]);null!=s&&j(t,["mimeType"],s);return t}(n));return t}(e))),j(t,["generatedVideos"],e)}const i=U(e,["raiMediaFilteredCount"]);null!=i&&j(t,["raiMediaFilteredCount"],i);const s=U(e,["raiMediaFilteredReasons"]);null!=s&&j(t,["raiMediaFilteredReasons"],s);return t}(o)),t}function V(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["_self"]);null!=n&&j(t,["video"],function(e){const t={},n=U(e,["gcsUri"]);null!=n&&j(t,["uri"],n);const i=U(e,["bytesBase64Encoded"]);null!=i&&j(t,["videoBytes"],W(i));const s=U(e,["mimeType"]);null!=s&&j(t,["mimeType"],s);return t}(n));return t}(e))),j(t,["generatedVideos"],e)}const i=U(e,["raiMediaFilteredCount"]);null!=i&&j(t,["raiMediaFilteredCount"],i);const s=U(e,["raiMediaFilteredReasons"]);null!=s&&j(t,["raiMediaFilteredReasons"],s);return t}(o)),t}function q(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["parent"]);null!=i&&j(t,["parent"],i);const s=U(e,["documentName"]);null!=s&&j(t,["documentName"],s);return t}(o)),t}function z(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["parent"]);null!=i&&j(t,["parent"],i);const s=U(e,["documentName"]);null!=s&&j(t,["documentName"],s);return t}(o)),t}var G,J,K,Y,$,X,Q,Z,ee,te,ne,ie,se,re,oe,ae,le,ce,ue,de,he,pe,fe,me,ge,ve,ye,be,we,_e,xe,Ee,Se,Ae,Ce,Te,ke,Ie,Ne,Pe,Me,Re,Oe,De,Fe,Le,je,Ue,Be,We,He,Ve,qe,ze,Ge,Je,Ke;!function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(G||(G={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(J||(J={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(K||(K={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(Y||(Y={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}($||($={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(X||(X={})),function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"}(Q||(Q={})),function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"}(Z||(Z={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(ee||(ee={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(te||(te={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"}(ne||(ne={})),function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"}(ie||(ie={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"}(se||(se={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(re||(re={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(oe||(oe={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"}(ae||(ae={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(le||(le={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(ce||(ce={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(ue||(ue={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"}(de||(de={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(he||(he={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(pe||(pe={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(fe||(fe={})),function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(me||(me={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(ge||(ge={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(ve||(ve={})),function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"}(ye||(ye={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"}(be||(be={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(we||(we={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(_e||(_e={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(xe||(xe={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(Ee||(Ee={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(Se||(Se={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(Ae||(Ae={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(Ce||(Ce={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(Te||(Te={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(ke||(ke={})),function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"}(Ie||(Ie={})),function(e){e.ASSET="ASSET",e.STYLE="STYLE"}(Ne||(Ne={})),function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"}(Pe||(Pe={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(Me||(Me={})),function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"}(Re||(Re={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"}(Oe||(Oe={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(De||(De={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"}(Fe||(Fe={})),function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"}(Le||(Le={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(je||(je={})),function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"}(Ue||(Ue={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"}(Be||(Be={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(We||(We={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(He||(He={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(Ve||(Ve={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(qe||(qe={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(ze||(ze={})),function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"}(Ge||(Ge={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(Je||(Je={}));class Ye{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class $e{get text(){var e,t,n,i,s,r,o,a;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",c=!1;const u=[];for(const d of null!==(a=null===(o=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(const[e,t]of Object.entries(d))"text"===e||"thought"===e||"thoughtSignature"===e||null===t&&void 0===t||u.push(e);if("string"===typeof d.text){if("boolean"===typeof d.thought&&d.thought)continue;c=!0,l+=d.text}}return u.length>0&&console.warn("there are non-text parts ".concat(u," in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.")),c?l:void 0}get data(){var e,t,n,i,s,r,o,a;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="";const c=[];for(const u of null!==(a=null===(o=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(const[e,t]of Object.entries(u))"inlineData"===e||null===t&&void 0===t||c.push(e);u.inlineData&&"string"===typeof u.inlineData.data&&(l+=atob(u.inlineData.data))}return c.length>0&&console.warn("there are non-data parts ".concat(c," in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.")),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,n,i,s,r,o,a;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const l=null===(a=null===(o=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null===l||void 0===l?void 0:l.length)?l:void 0}get executableCode(){var e,t,n,i,s,r,o,a,l;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const c=null===(a=null===(o=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null===c||void 0===c?void 0:c.length)?null===(l=null===c||void 0===c?void 0:c[0])||void 0===l?void 0:l.code:void 0}get codeExecutionResult(){var e,t,n,i,s,r,o,a,l;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const c=null===(a=null===(o=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null===c||void 0===c?void 0:c.length)?null===(l=null===c||void 0===c?void 0:c[0])||void 0===l?void 0:l.output:void 0}}class Xe{}class Qe{}class Ze{}class et{}class tt{}class nt{}class it{}class st{}class rt{}class ot{}class at{_fromAPIResponse(e){let{apiResponse:t,_isVertexAI:n}=e;const i=new at;let s;const r=t;return s=n?V(r):H(r),Object.assign(i,s),i}}class lt{}class ct{}class ut{}class dt{}class ht{}class pt{}class ft{}class mt{_fromAPIResponse(e){let{apiResponse:t,_isVertexAI:n}=e;const i=new mt,s=q(t);return Object.assign(i,s),i}}class gt{}class vt{}class yt{}class bt{}class wt{get text(){var e,t,n;let i="",s=!1;const r=[];for(const o of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&r.push(e);if("string"===typeof o.text){if("boolean"===typeof o.thought&&o.thought)continue;s=!0,i+=o.text}}return r.length>0&&console.warn("there are non-text parts ".concat(r," in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.")),s?i:void 0}get data(){var e,t,n;let i="";const s=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"inlineData"!==e&&null!==t&&s.push(e);r.inlineData&&"string"===typeof r.inlineData.data&&(i+=atob(r.inlineData.data))}return s.length>0&&console.warn("there are non-data parts ".concat(s," in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.")),i.length>0?btoa(i):void 0}}class _t{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class xt{_fromAPIResponse(e){let{apiResponse:t,_isVertexAI:n}=e;const i=new xt,s=z(t);return Object.assign(i,s),i}}function Et(e,t){if(!t||"string"!==typeof t)throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return"publishers/".concat(e[0],"/models/").concat(e[1])}return"publishers/google/models/".concat(t)}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:"models/".concat(t)}function St(e,t){const n=Et(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(n):n.startsWith("models/")&&e.isVertexAI()?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/publishers/google/").concat(n):n:""}function At(e){return Array.isArray(e)?e.map(e=>Ct(e)):[Ct(e)]}function Ct(e){if("object"===typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: ".concat(typeof e))}function Tt(e){const t=Ct(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error("Unsupported mime type: ".concat(t.mimeType))}function kt(e){const t=Ct(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error("Unsupported mime type: ".concat(t.mimeType))}function It(e){if(null===e||void 0===e)throw new Error("PartUnion is required");if("object"===typeof e)return e;if("string"===typeof e)return{text:e};throw new Error("Unsupported part type: ".concat(typeof e))}function Nt(e){if(null===e||void 0===e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>It(e)):[It(e)]}function Pt(e){return null!==e&&void 0!==e&&"object"===typeof e&&"parts"in e&&Array.isArray(e.parts)}function Mt(e){return null!==e&&void 0!==e&&"object"===typeof e&&"functionCall"in e}function Rt(e){return null!==e&&void 0!==e&&"object"===typeof e&&"functionResponse"in e}function Ot(e){if(null===e||void 0===e)throw new Error("ContentUnion is required");return Pt(e)?e:{role:"user",parts:Nt(e)}}function Dt(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=Ot(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=Ot(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>Ot(e)):[Ot(t)]}function Ft(e){if(null===e||void 0===e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(Mt(e)||Rt(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ot(e)]}const t=[],n=[],i=Pt(e[0]);for(const s of e){const e=Pt(s);if(e!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(s);else{if(Mt(s)||Rt(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return i||t.push({role:"user",parts:Nt(n)}),t}function Lt(e){const t={},n=["items"],i=["anyOf"],s=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=e.anyOf;null!=r&&2==r.length&&("null"===r[0].type?(t.nullable=!0,e=r[1]):"null"===r[1].type&&(t.nullable=!0,e=r[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(Y).includes(n[0].toUpperCase())?n[0].toUpperCase():Y.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(Y).includes(e.toUpperCase())?e.toUpperCase():Y.TYPE_UNSPECIFIED})}}(e.type,t);for(const[o,a]of Object.entries(e))if(null!=a)if("type"==o){if("null"===a)throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(Y).includes(a.toUpperCase())?a.toUpperCase():Y.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=Lt(a);else if(i.includes(o)){const e=[];for(const n of a)"null"!=n.type?e.push(Lt(n)):t.nullable=!0;t[o]=e}else if(s.includes(o)){const e={};for(const[t,n]of Object.entries(a))e[t]=Lt(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}return t}function jt(e){return Lt(e)}function Ut(e){if("object"===typeof e)return e;if("string"===typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: ".concat(typeof e))}function Bt(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Wt(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Lt(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Lt(t.response));return e}function Ht(e){if(void 0===e||null===e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Vt(e,t){if("string"!==typeof t)throw new Error("name must be a string");return function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const s=!t.startsWith("".concat(n,"/"))&&t.split("/").length===i;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?"projects/".concat(e.getProject(),"/").concat(t):t.startsWith("".concat(n,"/"))?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(t):s?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(n,"/").concat(t):t:s?"".concat(n,"/").concat(t):t}(e,t,"cachedContents")}function qt(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function zt(e){return W(e)}function Gt(e){var t;let n;var i;if(null!==(i=e)&&void 0!==i&&"object"===typeof i&&"name"in i&&(n=e.name),(!function(e){return null!==e&&void 0!==e&&"object"===typeof e&&"uri"in e}(e)||(n=e.uri,void 0!==n))&&(!function(e){return null!==e&&void 0!==e&&"object"===typeof e&&"video"in e}(e)||(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0!==n))){if("string"===typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error("Could not extract file name from URI ".concat(n));n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Jt(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function Kt(e){for(const t of["models","tunedModels","publisherModels"])if(Yt(e,t))return e[t];return[]}function Yt(e,t){return null!==e&&"object"===typeof e&&t in e}function $t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};n.outputSchema&&(i.responseJsonSchema=n.outputSchema),t.behavior&&(i.behavior=t.behavior);return{functionDeclarations:[i]}}function Xt(e,t){let n;if("string"===typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else{if(!t.startsWith("bq://"))throw new Error("Unsupported string source for Vertex AI: ".concat(t));n={format:"bigquery",bigqueryUri:t}}else{if(!t.startsWith("files/"))throw new Error("Unsupported string source for Gemini API: ".concat(t));n={fileName:t}}else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,s=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(s>0||1!==i)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||1!==s)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Qt(e){if("object"!==typeof e||null===e)return{};const t=e,n=t.inlinedResponses;if("object"!==typeof n||null===n)return e;const i=n.inlinedResponses;if(!Array.isArray(i)||0===i.length)return e;let s=!1;for(const r of i){if("object"!==typeof r||null===r)continue;const e=r.response;if("object"!==typeof e||null===e)continue;if(void 0!==e.embedding){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function Zt(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error("Invalid batch job name: ".concat(n,"."))}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error("Invalid batch job name: ".concat(n,"."))}function en(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_RUNNING"===e?"JOB_STATE_RUNNING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":"BATCH_STATE_EXPIRED"===e?"JOB_STATE_EXPIRED":e}function tn(e){const t={},n=U(e,["responsesFile"]);null!=n&&j(t,["fileName"],n);const i=U(e,["inlinedResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["response"]);null!=n&&j(t,["response"],function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["content"]);null!=n&&j(t,["content"],n);const i=U(e,["citationMetadata"]);null!=i&&j(t,["citationMetadata"],function(e){const t={},n=U(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["citations"],e)}return t}(i));const s=U(e,["tokenCount"]);null!=s&&j(t,["tokenCount"],s);const r=U(e,["finishReason"]);null!=r&&j(t,["finishReason"],r);const o=U(e,["avgLogprobs"]);null!=o&&j(t,["avgLogprobs"],o);const a=U(e,["groundingMetadata"]);null!=a&&j(t,["groundingMetadata"],a);const l=U(e,["index"]);null!=l&&j(t,["index"],l);const c=U(e,["logprobsResult"]);null!=c&&j(t,["logprobsResult"],c);const u=U(e,["safetyRatings"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["safetyRatings"],e)}const d=U(e,["urlContextMetadata"]);null!=d&&j(t,["urlContextMetadata"],d);return t}(e))),j(t,["candidates"],e)}const s=U(e,["modelVersion"]);null!=s&&j(t,["modelVersion"],s);const r=U(e,["promptFeedback"]);null!=r&&j(t,["promptFeedback"],r);const o=U(e,["responseId"]);null!=o&&j(t,["responseId"],o);const a=U(e,["usageMetadata"]);null!=a&&j(t,["usageMetadata"],a);return t}(n));const i=U(e,["error"]);null!=i&&j(t,["error"],i);return t}(e))),j(t,["inlinedResponses"],e)}const s=U(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["inlinedEmbedContentResponses"],e)}return t}function nn(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata","displayName"]);null!=i&&j(t,["displayName"],i);const s=U(e,["metadata","state"]);null!=s&&j(t,["state"],en(s));const r=U(e,["metadata","createTime"]);null!=r&&j(t,["createTime"],r);const o=U(e,["metadata","endTime"]);null!=o&&j(t,["endTime"],o);const a=U(e,["metadata","updateTime"]);null!=a&&j(t,["updateTime"],a);const l=U(e,["metadata","model"]);null!=l&&j(t,["model"],l);const c=U(e,["metadata","output"]);return null!=c&&j(t,["dest"],tn(Qt(c))),t}function sn(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["displayName"]);null!=i&&j(t,["displayName"],i);const s=U(e,["state"]);null!=s&&j(t,["state"],en(s));const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["createTime"]);null!=o&&j(t,["createTime"],o);const a=U(e,["startTime"]);null!=a&&j(t,["startTime"],a);const l=U(e,["endTime"]);null!=l&&j(t,["endTime"],l);const c=U(e,["updateTime"]);null!=c&&j(t,["updateTime"],c);const u=U(e,["model"]);null!=u&&j(t,["model"],u);const d=U(e,["inputConfig"]);null!=d&&j(t,["src"],function(e){const t={},n=U(e,["instancesFormat"]);null!=n&&j(t,["format"],n);const i=U(e,["gcsSource","uris"]);null!=i&&j(t,["gcsUri"],i);const s=U(e,["bigquerySource","inputUri"]);null!=s&&j(t,["bigqueryUri"],s);return t}(d));const h=U(e,["outputConfig"]);null!=h&&j(t,["dest"],function(e){const t={},n=U(e,["predictionsFormat"]);null!=n&&j(t,["format"],n);const i=U(e,["gcsDestination","outputUriPrefix"]);null!=i&&j(t,["gcsUri"],i);const s=U(e,["bigqueryDestination","outputUri"]);return null!=s&&j(t,["bigqueryUri"],s),t}(Qt(h)));const p=U(e,["completionStats"]);return null!=p&&j(t,["completionStats"],p),t}function rn(e,t){const n={};if(void 0!==U(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==U(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==U(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=U(t,["fileName"]);null!=i&&j(n,["fileName"],i);const s=U(t,["inlinedRequests"]);if(null!=s){let t=s;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["request","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let e=Ft(s);Array.isArray(e)&&(e=e.map(e=>on(e))),j(n,["request","contents"],e)}const r=U(t,["metadata"]);null!=r&&j(n,["metadata"],r);const o=U(t,["config"]);null!=o&&j(n,["request","generationConfig"],function(e,t,n){const i={},s=U(t,["systemInstruction"]);void 0!==n&&null!=s&&j(n,["systemInstruction"],on(Ot(s)));const r=U(t,["temperature"]);null!=r&&j(i,["temperature"],r);const o=U(t,["topP"]);null!=o&&j(i,["topP"],o);const a=U(t,["topK"]);null!=a&&j(i,["topK"],a);const l=U(t,["candidateCount"]);null!=l&&j(i,["candidateCount"],l);const c=U(t,["maxOutputTokens"]);null!=c&&j(i,["maxOutputTokens"],c);const u=U(t,["stopSequences"]);null!=u&&j(i,["stopSequences"],u);const d=U(t,["responseLogprobs"]);null!=d&&j(i,["responseLogprobs"],d);const h=U(t,["logprobs"]);null!=h&&j(i,["logprobs"],h);const p=U(t,["presencePenalty"]);null!=p&&j(i,["presencePenalty"],p);const f=U(t,["frequencyPenalty"]);null!=f&&j(i,["frequencyPenalty"],f);const m=U(t,["seed"]);null!=m&&j(i,["seed"],m);const g=U(t,["responseMimeType"]);null!=g&&j(i,["responseMimeType"],g);const v=U(t,["responseSchema"]);null!=v&&j(i,["responseSchema"],jt(v));const y=U(t,["responseJsonSchema"]);null!=y&&j(i,["responseJsonSchema"],y);if(void 0!==U(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==U(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=U(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["category"]);null!=n&&j(t,["category"],n);if(void 0!==U(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const i=U(e,["threshold"]);null!=i&&j(t,["threshold"],i);return t}(e))),j(n,["safetySettings"],e)}const w=U(t,["tools"]);if(void 0!==n&&null!=w){let e=Ht(w);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==U(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=U(e,["computerUse"]);null!=n&&j(t,["computerUse"],n);const i=U(e,["fileSearch"]);null!=i&&j(t,["fileSearch"],i);const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);if(void 0!==U(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=U(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["functionDeclarations"],e)}const o=U(e,["googleMaps"]);null!=o&&j(t,["googleMaps"],function(e){const t={};if(void 0!==U(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=U(e,["enableWidget"]);null!=n&&j(t,["enableWidget"],n);return t}(o));const a=U(e,["googleSearch"]);null!=a&&j(t,["googleSearch"],function(e){const t={};if(void 0!==U(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==U(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=U(e,["timeRangeFilter"]);null!=n&&j(t,["timeRangeFilter"],n);return t}(a));const l=U(e,["googleSearchRetrieval"]);null!=l&&j(t,["googleSearchRetrieval"],l);const c=U(e,["urlContext"]);null!=c&&j(t,["urlContext"],c);return t}(Wt(e)))),j(n,["tools"],e)}const _=U(t,["toolConfig"]);void 0!==n&&null!=_&&j(n,["toolConfig"],function(e){const t={},n=U(e,["retrievalConfig"]);null!=n&&j(t,["retrievalConfig"],n);const i=U(e,["functionCallingConfig"]);null!=i&&j(t,["functionCallingConfig"],function(e){const t={},n=U(e,["allowedFunctionNames"]);null!=n&&j(t,["allowedFunctionNames"],n);const i=U(e,["mode"]);null!=i&&j(t,["mode"],i);if(void 0!==U(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(i));return t}(_));if(void 0!==U(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const x=U(t,["cachedContent"]);void 0!==n&&null!=x&&j(n,["cachedContent"],Vt(e,x));const E=U(t,["responseModalities"]);null!=E&&j(i,["responseModalities"],E);const S=U(t,["mediaResolution"]);null!=S&&j(i,["mediaResolution"],S);const A=U(t,["speechConfig"]);null!=A&&j(i,["speechConfig"],Ut(A));if(void 0!==U(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const C=U(t,["thinkingConfig"]);null!=C&&j(i,["thinkingConfig"],C);const T=U(t,["imageConfig"]);null!=T&&j(i,["imageConfig"],function(e){const t={},n=U(e,["aspectRatio"]);null!=n&&j(t,["aspectRatio"],n);const i=U(e,["imageSize"]);null!=i&&j(t,["imageSize"],i);if(void 0!==U(e,["personGeneration"]))throw new Error("personGeneration parameter is not supported in Gemini API.");if(void 0!==U(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==U(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(T));const k=U(t,["enableEnhancedCivicAnswers"]);null!=k&&j(i,["enableEnhancedCivicAnswers"],k);return i}(e,o,U(n,["request"],{})));return n}(e,t))),j(n,["requests","requests"],t)}return n}function on(e){const t={},n=U(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["mediaResolution"]);null!=n&&j(t,["mediaResolution"],n);const i=U(e,["codeExecutionResult"]);null!=i&&j(t,["codeExecutionResult"],i);const s=U(e,["executableCode"]);null!=s&&j(t,["executableCode"],s);const r=U(e,["fileData"]);null!=r&&j(t,["fileData"],function(e){const t={};if(void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=U(e,["fileUri"]);null!=n&&j(t,["fileUri"],n);const i=U(e,["mimeType"]);null!=i&&j(t,["mimeType"],i);return t}(r));const o=U(e,["functionCall"]);null!=o&&j(t,["functionCall"],function(e){const t={},n=U(e,["id"]);null!=n&&j(t,["id"],n);const i=U(e,["args"]);null!=i&&j(t,["args"],i);const s=U(e,["name"]);null!=s&&j(t,["name"],s);if(void 0!==U(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==U(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=U(e,["functionResponse"]);null!=a&&j(t,["functionResponse"],a);const l=U(e,["inlineData"]);null!=l&&j(t,["inlineData"],function(e){const t={},n=U(e,["data"]);if(null!=n&&j(t,["data"],n),void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=U(e,["mimeType"]);return null!=i&&j(t,["mimeType"],i),t}(l));const c=U(e,["text"]);null!=c&&j(t,["text"],c);const u=U(e,["thought"]);null!=u&&j(t,["thought"],u);const d=U(e,["thoughtSignature"]);null!=d&&j(t,["thoughtSignature"],d);const h=U(e,["videoMetadata"]);null!=h&&j(t,["videoMetadata"],h);return t}(e))),j(t,["parts"],e)}const i=U(e,["role"]);return null!=i&&j(t,["role"],i),t}function an(e,t){const n=U(e,["displayName"]);void 0!==t&&null!=n&&j(t,["displayName"],n);const i=U(e,["dest"]);return void 0!==t&&null!=i&&j(t,["outputConfig"],function(e){const t={},n=U(e,["format"]);null!=n&&j(t,["predictionsFormat"],n);const i=U(e,["gcsUri"]);null!=i&&j(t,["gcsDestination","outputUriPrefix"],i);const s=U(e,["bigqueryUri"]);if(null!=s&&j(t,["bigqueryDestination","outputUri"],s),void 0!==U(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==U(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==U(e,["inlinedEmbedContentResponses"]))throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!==typeof e)return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error("Unsupported destination: ".concat(t))}(i))),{}}function ln(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["src"]);null!=s&&j(n,["batch","inputConfig"],rn(e,Xt(e,s)));const r=U(t,["config"]);return null!=r&&function(e,t){const n=U(e,["displayName"]);if(void 0!==t&&null!=n&&j(t,["batch","displayName"],n),void 0!==U(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.")}(r,n),n}function cn(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["model"],Et(e,i));const s=U(t,["src"]);null!=s&&j(n,["inputConfig"],function(e){const t={},n=U(e,["format"]);null!=n&&j(t,["instancesFormat"],n);const i=U(e,["gcsUri"]);null!=i&&j(t,["gcsSource","uris"],i);const s=U(e,["bigqueryUri"]);if(null!=s&&j(t,["bigquerySource","inputUri"],s),void 0!==U(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==U(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(Xt(e,s)));const r=U(t,["config"]);return null!=r&&an(r,n),n}function un(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["src"]);null!=s&&j(n,["batch","inputConfig"],function(e,t){const n={},i=U(t,["fileName"]);null!=i&&j(n,["file_name"],i);const s=U(t,["inlinedRequests"]);null!=s&&j(n,["requests"],function(e,t){const n={},i=U(t,["contents"]);if(null!=i){let t=Dt(e,i);Array.isArray(t)&&(t=t.map(e=>e)),j(n,["requests[]","request","content"],t)}const s=U(t,["config"]);null!=s&&(j(n,["_self"],function(e,t){const n={},i=U(e,["taskType"]);void 0!==t&&null!=i&&j(t,["requests[]","taskType"],i);const s=U(e,["title"]);void 0!==t&&null!=s&&j(t,["requests[]","title"],s);const r=U(e,["outputDimensionality"]);void 0!==t&&null!=r&&j(t,["requests[]","outputDimensionality"],r);if(void 0!==U(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==U(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}(s,n)),function(e,t){for(const[n,i]of Object.entries(t)){const t=n.split("."),s=i.split("."),r=new Set;let o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&s.length>o)for(let e=o;e<s.length;e++){const t=s[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||r.add(t)}B(e,t,s,0,r)}}(n,{"requests[].*":"requests[].request.*"}));return n}(e,s));return n}(e,s));const r=U(t,["config"]);return null!=r&&function(e,t){const n=U(e,["displayName"]);void 0!==t&&null!=n&&j(t,["batch","displayName"],n)}(r,n),n}function dn(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);if(void 0!==t&&null!=i&&j(t,["_query","pageToken"],i),void 0!==U(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.")}(n,t),t}function hn(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i);const s=U(e,["filter"]);void 0!==t&&null!=s&&j(t,["_query","filter"],s)}(n,t),t}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"}(Ke||(Ke={}));class pn{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null===t||void 0===t?void 0:t.sdkHttpResponse,this.idxInternal=0;let r={config:{}};r=n&&0!==Object.keys(n).length?"object"===typeof n?Object.assign({},n):n:{config:{}},r.config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!==(s=null===(i=r.config)||void 0===i?void 0:i.pageSize)&&void 0!==s?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}class fn extends F{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pn(Ke.PAGED_ITEM_BATCH_JOBS,e=>t.listInternal(e),await t.listInternal(e),e)},this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){const t=ln(this.apiClient,e),n=L("{model}:batchGenerateContent",t._url),i=t.batch.inputConfig.requests,s=i.requests,r=[];for(const o of s){const e=Object.assign({},o);if(e.systemInstruction){const t=e.systemInstruction;delete e.systemInstruction;const n=e.request;n.systemInstruction=t,e.request=n}r.push(e)}return i.requests=r,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"===typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"===typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName="genaiBatchJob_".concat(i)),void 0===n.dest){const t=this.getGcsUri(e),s=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest="".concat(t.slice(0,-6),"/dest"):n.dest="".concat(t,"_dest_").concat(i);else{if(!s)throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");n.dest="".concat(s,"_dest_").concat(i)}}return n}async createInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=cn(this.apiClient,e);return o=L("batchPredictionJobs",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>sn(e))}{const t=ln(this.apiClient,e);return o=L("{model}:batchGenerateContent",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>nn(e))}}async createEmbeddingsInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=un(this.apiClient,e);return s=L("{model}:asyncBatchEmbedContent",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>nn(e))}}async get(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Zt(e,i)),n}(this.apiClient,e);return o=L("batchPredictionJobs/{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>sn(e))}{const t=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Zt(e,i)),n}(this.apiClient,e);return o=L("batches/{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>nn(e))}}async cancel(e){var t,n,i,s;let r="",o={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Zt(e,i)),n}(this.apiClient,e);r=L("batchPredictionJobs/{name}:cancel",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Zt(e,i)),n}(this.apiClient,e);r=L("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal})}}async listInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=hn(e);return o=L("batchPredictionJobs",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["batchPredictionJobs"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>sn(e))),j(t,["batchJobs"],e)}return t}(e),n=new bt;return Object.assign(n,t),n})}{const t=dn(e);return o=L("batches",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["operations"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>nn(e))),j(t,["batchJobs"],e)}return t}(e),n=new bt;return Object.assign(n,t),n})}}async delete(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Zt(e,i)),n}(this.apiClient,e);return o=L("batchPredictionJobs/{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["name"]);null!=i&&j(t,["name"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);return null!=r&&j(t,["error"],r),t}(e))}{const t=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Zt(e,i)),n}(this.apiClient,e);return o=L("batches/{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["name"]);null!=i&&j(t,["name"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);return null!=r&&j(t,["error"],r),t}(e))}}}function mn(e){const t={},n=U(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["mediaResolution"]);null!=n&&j(t,["mediaResolution"],n);const i=U(e,["codeExecutionResult"]);null!=i&&j(t,["codeExecutionResult"],i);const s=U(e,["executableCode"]);null!=s&&j(t,["executableCode"],s);const r=U(e,["fileData"]);null!=r&&j(t,["fileData"],function(e){const t={};if(void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=U(e,["fileUri"]);null!=n&&j(t,["fileUri"],n);const i=U(e,["mimeType"]);null!=i&&j(t,["mimeType"],i);return t}(r));const o=U(e,["functionCall"]);null!=o&&j(t,["functionCall"],function(e){const t={},n=U(e,["id"]);null!=n&&j(t,["id"],n);const i=U(e,["args"]);null!=i&&j(t,["args"],i);const s=U(e,["name"]);null!=s&&j(t,["name"],s);if(void 0!==U(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==U(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=U(e,["functionResponse"]);null!=a&&j(t,["functionResponse"],a);const l=U(e,["inlineData"]);null!=l&&j(t,["inlineData"],function(e){const t={},n=U(e,["data"]);if(null!=n&&j(t,["data"],n),void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=U(e,["mimeType"]);return null!=i&&j(t,["mimeType"],i),t}(l));const c=U(e,["text"]);null!=c&&j(t,["text"],c);const u=U(e,["thought"]);null!=u&&j(t,["thought"],u);const d=U(e,["thoughtSignature"]);null!=d&&j(t,["thoughtSignature"],d);const h=U(e,["videoMetadata"]);null!=h&&j(t,["videoMetadata"],h);return t}(e))),j(t,["parts"],e)}const i=U(e,["role"]);return null!=i&&j(t,["role"],i),t}function gn(e,t){const n=U(e,["ttl"]);void 0!==t&&null!=n&&j(t,["ttl"],n);const i=U(e,["expireTime"]);void 0!==t&&null!=i&&j(t,["expireTime"],i);const s=U(e,["displayName"]);void 0!==t&&null!=s&&j(t,["displayName"],s);const r=U(e,["contents"]);if(void 0!==t&&null!=r){let e=Ft(r);Array.isArray(e)&&(e=e.map(e=>mn(e))),j(t,["contents"],e)}const o=U(e,["systemInstruction"]);void 0!==t&&null!=o&&j(t,["systemInstruction"],mn(Ot(o)));const a=U(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==U(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=U(e,["computerUse"]);null!=n&&j(t,["computerUse"],n);const i=U(e,["fileSearch"]);null!=i&&j(t,["fileSearch"],i);const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);if(void 0!==U(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=U(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["functionDeclarations"],e)}const o=U(e,["googleMaps"]);null!=o&&j(t,["googleMaps"],function(e){const t={};if(void 0!==U(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=U(e,["enableWidget"]);null!=n&&j(t,["enableWidget"],n);return t}(o));const a=U(e,["googleSearch"]);null!=a&&j(t,["googleSearch"],function(e){const t={};if(void 0!==U(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==U(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=U(e,["timeRangeFilter"]);null!=n&&j(t,["timeRangeFilter"],n);return t}(a));const l=U(e,["googleSearchRetrieval"]);null!=l&&j(t,["googleSearchRetrieval"],l);const c=U(e,["urlContext"]);null!=c&&j(t,["urlContext"],c);return t}(e))),j(t,["tools"],e)}const l=U(e,["toolConfig"]);if(void 0!==t&&null!=l&&j(t,["toolConfig"],function(e){const t={},n=U(e,["retrievalConfig"]);null!=n&&j(t,["retrievalConfig"],n);const i=U(e,["functionCallingConfig"]);null!=i&&j(t,["functionCallingConfig"],function(e){const t={},n=U(e,["allowedFunctionNames"]);null!=n&&j(t,["allowedFunctionNames"],n);const i=U(e,["mode"]);null!=i&&j(t,["mode"],i);if(void 0!==U(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(i));return t}(l)),void 0!==U(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}function vn(e,t){const n=U(e,["ttl"]);void 0!==t&&null!=n&&j(t,["ttl"],n);const i=U(e,["expireTime"]);void 0!==t&&null!=i&&j(t,["expireTime"],i);const s=U(e,["displayName"]);void 0!==t&&null!=s&&j(t,["displayName"],s);const r=U(e,["contents"]);if(void 0!==t&&null!=r){let e=Ft(r);Array.isArray(e)&&(e=e.map(e=>e)),j(t,["contents"],e)}const o=U(e,["systemInstruction"]);void 0!==t&&null!=o&&j(t,["systemInstruction"],Ot(o));const a=U(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["retrieval"]);null!=n&&j(t,["retrieval"],n);const i=U(e,["computerUse"]);null!=i&&j(t,["computerUse"],i);if(void 0!==U(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);const r=U(e,["enterpriseWebSearch"]);null!=r&&j(t,["enterpriseWebSearch"],r);const o=U(e,["functionDeclarations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["description"]);null!=n&&j(t,["description"],n);const i=U(e,["name"]);null!=i&&j(t,["name"],i);const s=U(e,["parameters"]);null!=s&&j(t,["parameters"],s);const r=U(e,["parametersJsonSchema"]);null!=r&&j(t,["parametersJsonSchema"],r);const o=U(e,["response"]);null!=o&&j(t,["response"],o);const a=U(e,["responseJsonSchema"]);null!=a&&j(t,["responseJsonSchema"],a);if(void 0!==U(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return t}(e))),j(t,["functionDeclarations"],e)}const a=U(e,["googleMaps"]);null!=a&&j(t,["googleMaps"],a);const l=U(e,["googleSearch"]);null!=l&&j(t,["googleSearch"],l);const c=U(e,["googleSearchRetrieval"]);null!=c&&j(t,["googleSearchRetrieval"],c);const u=U(e,["urlContext"]);null!=u&&j(t,["urlContext"],u);return t}(e))),j(t,["tools"],e)}const l=U(e,["toolConfig"]);void 0!==t&&null!=l&&j(t,["toolConfig"],l);const c=U(e,["kmsKeyName"]);return void 0!==t&&null!=c&&j(t,["encryption_spec","kmsKeyName"],c),{}}function yn(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i)}(n,t),t}function bn(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i)}(n,t),t}function wn(e,t){const n={},i=U(t,["name"]);null!=i&&j(n,["_url","name"],Vt(e,i));const s=U(t,["config"]);return null!=s&&function(e,t){const n=U(e,["ttl"]);void 0!==t&&null!=n&&j(t,["ttl"],n);const i=U(e,["expireTime"]);void 0!==t&&null!=i&&j(t,["expireTime"],i)}(s,n),n}function _n(e,t){const n={},i=U(t,["name"]);null!=i&&j(n,["_url","name"],Vt(e,i));const s=U(t,["config"]);return null!=s&&function(e,t){const n=U(e,["ttl"]);void 0!==t&&null!=n&&j(t,["ttl"],n);const i=U(e,["expireTime"]);void 0!==t&&null!=i&&j(t,["expireTime"],i)}(s,n),n}class xn extends F{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pn(Ke.PAGED_ITEM_CACHED_CONTENTS,e=>t.listInternal(e),await t.listInternal(e),e)}}async create(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["model"],St(e,i));const s=U(t,["config"]);return null!=s&&vn(s,n),n}(this.apiClient,e);return o=L("cachedContents",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}{const t=function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["model"],St(e,i));const s=U(t,["config"]);return null!=s&&gn(s,n),n}(this.apiClient,e);return o=L("cachedContents",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async get(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Vt(e,i)),n}(this.apiClient,e);return o=L("{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}{const t=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Vt(e,i)),n}(this.apiClient,e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async delete(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Vt(e,i)),n}(this.apiClient,e);return o=L("{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new ut;return Object.assign(n,t),n})}{const t=function(e,t){const n={},i=U(t,["name"]);return null!=i&&j(n,["_url","name"],Vt(e,i)),n}(this.apiClient,e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new ut;return Object.assign(n,t),n})}}async update(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=_n(this.apiClient,e);return o=L("{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}{const t=wn(this.apiClient,e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async listInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=bn(e);return o=L("cachedContents",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["cachedContents"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["cachedContents"],e)}return t}(e),n=new dt;return Object.assign(n,t),n})}{const t=yn(e);return o=L("cachedContents",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["cachedContents"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["cachedContents"],e)}return t}(e),n=new dt;return Object.assign(n,t),n})}}}function En(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}function Sn(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function An(e){return this instanceof An?(this.v=e,this):new An(e)}function Cn(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,s=n.apply(e,t||[]),r=[];return i=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),i[Symbol.asyncIterator]=function(){return this},i;function o(e,t){s[e]&&(i[e]=function(t){return new Promise(function(n,i){r.push([e,t,n,i])>1||a(e,t)})},t&&(i[e]=t(i[e])))}function a(e,t){try{(n=s[e](t)).value instanceof An?Promise.resolve(n.value.v).then(l,c):u(r[0][2],n)}catch(i){u(r[0][3],i)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function Tn(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Sn(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,s){(function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)})(i,s,(t=e[n](t)).done,t.value)})}}}function kn(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&In(n)}function In(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function Nn(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let i=0;for(;i<n;)if("user"===e[i].role)t.push(e[i]),i++;else{const s=[];let r=!0;for(;i<n&&"model"===e[i].role;)s.push(e[i]),r&&!In(e[i])&&(r=!1),i++;r?t.push(...s):t.pop()}return t}"function"===typeof SuppressedError&&SuppressedError;class Pn{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Mn(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Mn{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error("Role must be user or model, but got ".concat(t.role,"."))}(s)}async sendMessage(e){var t;await this.sendPromise;const n=Ot(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,s;const r=await i,o=null===(t=null===(e=r.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=r.automaticFunctionCallingHistory,l=this.getHistory(!0).length;let c=[];null!=a&&(c=null!==(s=a.slice(l))&&void 0!==s?s:[]);const u=o?[o]:[];this.recordHistory(n,u,c)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const n=Ot(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,n)}getHistory(){const e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Nn(this.history):this.history;return structuredClone(e)}processStreamResponse(e,t){return Cn(this,arguments,function*(){var n,i,s,r,o,a;const l=[];try{for(var c,u=!0,d=Tn(e);!(n=(c=yield An(d.next())).done);u=!0){r=c.value,u=!1;const e=r;if(kn(e)){const t=null===(a=null===(o=e.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content;void 0!==t&&l.push(t)}yield yield An(e)}}catch(h){i={error:h}}finally{try{u||n||!(s=d.return)||(yield An(s.call(d)))}finally{if(i)throw i.error}}this.recordHistory(t,l)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(e=>void 0!==e.role)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...Nn(n)):this.history.push(e),this.history.push(...i)}}class Rn extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Rn.prototype)}}function On(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i)}(n,t),t}class Dn extends F{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pn(Ke.PAGED_ITEM_FILES,e=>t.listInternal(e),await t.listInternal(e),e)}}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=On(e);return s=L("files",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["files"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["files"],e)}return t}(e),n=new gt;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=U(e,["file"]);return null!=n&&j(t,["file"],n),t}(e);return s=L("upload/v1beta/files",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new vt;return Object.assign(n,t),n})}}async get(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","file"],Gt(n)),t}(e);return s=L("files/{file}",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async delete(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","file"],Gt(n)),t}(e);return s=L("files/{file}",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new yt;return Object.assign(n,t),n})}}}function Fn(e){const t={},n=U(e,["data"]);if(null!=n&&j(t,["data"],n),void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=U(e,["mimeType"]);return null!=i&&j(t,["mimeType"],i),t}function Ln(e){const t={},n=U(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["mediaResolution"]);null!=n&&j(t,["mediaResolution"],n);const i=U(e,["codeExecutionResult"]);null!=i&&j(t,["codeExecutionResult"],i);const s=U(e,["executableCode"]);null!=s&&j(t,["executableCode"],s);const r=U(e,["fileData"]);null!=r&&j(t,["fileData"],function(e){const t={};if(void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=U(e,["fileUri"]);null!=n&&j(t,["fileUri"],n);const i=U(e,["mimeType"]);null!=i&&j(t,["mimeType"],i);return t}(r));const o=U(e,["functionCall"]);null!=o&&j(t,["functionCall"],function(e){const t={},n=U(e,["id"]);null!=n&&j(t,["id"],n);const i=U(e,["args"]);null!=i&&j(t,["args"],i);const s=U(e,["name"]);null!=s&&j(t,["name"],s);if(void 0!==U(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==U(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=U(e,["functionResponse"]);null!=a&&j(t,["functionResponse"],a);const l=U(e,["inlineData"]);null!=l&&j(t,["inlineData"],Fn(l));const c=U(e,["text"]);null!=c&&j(t,["text"],c);const u=U(e,["thought"]);null!=u&&j(t,["thought"],u);const d=U(e,["thoughtSignature"]);null!=d&&j(t,["thoughtSignature"],d);const h=U(e,["videoMetadata"]);null!=h&&j(t,["videoMetadata"],h);return t}(e))),j(t,["parts"],e)}const i=U(e,["role"]);return null!=i&&j(t,["role"],i),t}function jn(e,t){const n=U(e,["generationConfig"]);void 0!==t&&null!=n&&j(t,["setup","generationConfig"],n);const i=U(e,["responseModalities"]);void 0!==t&&null!=i&&j(t,["setup","generationConfig","responseModalities"],i);const s=U(e,["temperature"]);void 0!==t&&null!=s&&j(t,["setup","generationConfig","temperature"],s);const r=U(e,["topP"]);void 0!==t&&null!=r&&j(t,["setup","generationConfig","topP"],r);const o=U(e,["topK"]);void 0!==t&&null!=o&&j(t,["setup","generationConfig","topK"],o);const a=U(e,["maxOutputTokens"]);void 0!==t&&null!=a&&j(t,["setup","generationConfig","maxOutputTokens"],a);const l=U(e,["mediaResolution"]);void 0!==t&&null!=l&&j(t,["setup","generationConfig","mediaResolution"],l);const c=U(e,["seed"]);void 0!==t&&null!=c&&j(t,["setup","generationConfig","seed"],c);const u=U(e,["speechConfig"]);void 0!==t&&null!=u&&j(t,["setup","generationConfig","speechConfig"],Bt(u));const d=U(e,["thinkingConfig"]);void 0!==t&&null!=d&&j(t,["setup","generationConfig","thinkingConfig"],d);const h=U(e,["enableAffectiveDialog"]);void 0!==t&&null!=h&&j(t,["setup","generationConfig","enableAffectiveDialog"],h);const p=U(e,["systemInstruction"]);void 0!==t&&null!=p&&j(t,["setup","systemInstruction"],Ln(Ot(p)));const f=U(e,["tools"]);if(void 0!==t&&null!=f){let e=Ht(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==U(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=U(e,["computerUse"]);null!=n&&j(t,["computerUse"],n);const i=U(e,["fileSearch"]);null!=i&&j(t,["fileSearch"],i);const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);if(void 0!==U(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=U(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["functionDeclarations"],e)}const o=U(e,["googleMaps"]);null!=o&&j(t,["googleMaps"],function(e){const t={};if(void 0!==U(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=U(e,["enableWidget"]);return null!=n&&j(t,["enableWidget"],n),t}(o));const a=U(e,["googleSearch"]);null!=a&&j(t,["googleSearch"],function(e){const t={};if(void 0!==U(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==U(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=U(e,["timeRangeFilter"]);return null!=n&&j(t,["timeRangeFilter"],n),t}(a));const l=U(e,["googleSearchRetrieval"]);null!=l&&j(t,["googleSearchRetrieval"],l);const c=U(e,["urlContext"]);null!=c&&j(t,["urlContext"],c);return t}(Wt(e)))),j(t,["setup","tools"],e)}const m=U(e,["sessionResumption"]);void 0!==t&&null!=m&&j(t,["setup","sessionResumption"],function(e){const t={},n=U(e,["handle"]);null!=n&&j(t,["handle"],n);if(void 0!==U(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(m));const g=U(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&j(t,["setup","inputAudioTranscription"],g);const v=U(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&j(t,["setup","outputAudioTranscription"],v);const y=U(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&j(t,["setup","realtimeInputConfig"],y);const b=U(e,["contextWindowCompression"]);void 0!==t&&null!=b&&j(t,["setup","contextWindowCompression"],b);const w=U(e,["proactivity"]);if(void 0!==t&&null!=w&&j(t,["setup","proactivity"],w),void 0!==U(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}function Un(e,t){const n=U(e,["generationConfig"]);void 0!==t&&null!=n&&j(t,["setup","generationConfig"],function(e){const t={},n=U(e,["modelSelectionConfig"]);null!=n&&j(t,["modelConfig"],n);const i=U(e,["responseJsonSchema"]);null!=i&&j(t,["responseJsonSchema"],i);const s=U(e,["audioTimestamp"]);null!=s&&j(t,["audioTimestamp"],s);const r=U(e,["candidateCount"]);null!=r&&j(t,["candidateCount"],r);const o=U(e,["enableAffectiveDialog"]);null!=o&&j(t,["enableAffectiveDialog"],o);const a=U(e,["frequencyPenalty"]);null!=a&&j(t,["frequencyPenalty"],a);const l=U(e,["logprobs"]);null!=l&&j(t,["logprobs"],l);const c=U(e,["maxOutputTokens"]);null!=c&&j(t,["maxOutputTokens"],c);const u=U(e,["mediaResolution"]);null!=u&&j(t,["mediaResolution"],u);const d=U(e,["presencePenalty"]);null!=d&&j(t,["presencePenalty"],d);const h=U(e,["responseLogprobs"]);null!=h&&j(t,["responseLogprobs"],h);const p=U(e,["responseMimeType"]);null!=p&&j(t,["responseMimeType"],p);const f=U(e,["responseModalities"]);null!=f&&j(t,["responseModalities"],f);const m=U(e,["responseSchema"]);null!=m&&j(t,["responseSchema"],m);const g=U(e,["routingConfig"]);null!=g&&j(t,["routingConfig"],g);const v=U(e,["seed"]);null!=v&&j(t,["seed"],v);const y=U(e,["speechConfig"]);null!=y&&j(t,["speechConfig"],y);const b=U(e,["stopSequences"]);null!=b&&j(t,["stopSequences"],b);const w=U(e,["temperature"]);null!=w&&j(t,["temperature"],w);const _=U(e,["thinkingConfig"]);null!=_&&j(t,["thinkingConfig"],_);const x=U(e,["topK"]);null!=x&&j(t,["topK"],x);const E=U(e,["topP"]);if(null!=E&&j(t,["topP"],E),void 0!==U(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));const i=U(e,["responseModalities"]);void 0!==t&&null!=i&&j(t,["setup","generationConfig","responseModalities"],i);const s=U(e,["temperature"]);void 0!==t&&null!=s&&j(t,["setup","generationConfig","temperature"],s);const r=U(e,["topP"]);void 0!==t&&null!=r&&j(t,["setup","generationConfig","topP"],r);const o=U(e,["topK"]);void 0!==t&&null!=o&&j(t,["setup","generationConfig","topK"],o);const a=U(e,["maxOutputTokens"]);void 0!==t&&null!=a&&j(t,["setup","generationConfig","maxOutputTokens"],a);const l=U(e,["mediaResolution"]);void 0!==t&&null!=l&&j(t,["setup","generationConfig","mediaResolution"],l);const c=U(e,["seed"]);void 0!==t&&null!=c&&j(t,["setup","generationConfig","seed"],c);const u=U(e,["speechConfig"]);void 0!==t&&null!=u&&j(t,["setup","generationConfig","speechConfig"],Bt(u));const d=U(e,["thinkingConfig"]);void 0!==t&&null!=d&&j(t,["setup","generationConfig","thinkingConfig"],d);const h=U(e,["enableAffectiveDialog"]);void 0!==t&&null!=h&&j(t,["setup","generationConfig","enableAffectiveDialog"],h);const p=U(e,["systemInstruction"]);void 0!==t&&null!=p&&j(t,["setup","systemInstruction"],Ot(p));const f=U(e,["tools"]);if(void 0!==t&&null!=f){let e=Ht(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["retrieval"]);null!=n&&j(t,["retrieval"],n);const i=U(e,["computerUse"]);null!=i&&j(t,["computerUse"],i);if(void 0!==U(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);const r=U(e,["enterpriseWebSearch"]);null!=r&&j(t,["enterpriseWebSearch"],r);const o=U(e,["functionDeclarations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["description"]);null!=n&&j(t,["description"],n);const i=U(e,["name"]);null!=i&&j(t,["name"],i);const s=U(e,["parameters"]);null!=s&&j(t,["parameters"],s);const r=U(e,["parametersJsonSchema"]);null!=r&&j(t,["parametersJsonSchema"],r);const o=U(e,["response"]);null!=o&&j(t,["response"],o);const a=U(e,["responseJsonSchema"]);if(null!=a&&j(t,["responseJsonSchema"],a),void 0!==U(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return t}(e))),j(t,["functionDeclarations"],e)}const a=U(e,["googleMaps"]);null!=a&&j(t,["googleMaps"],a);const l=U(e,["googleSearch"]);null!=l&&j(t,["googleSearch"],l);const c=U(e,["googleSearchRetrieval"]);null!=c&&j(t,["googleSearchRetrieval"],c);const u=U(e,["urlContext"]);null!=u&&j(t,["urlContext"],u);return t}(Wt(e)))),j(t,["setup","tools"],e)}const m=U(e,["sessionResumption"]);void 0!==t&&null!=m&&j(t,["setup","sessionResumption"],m);const g=U(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&j(t,["setup","inputAudioTranscription"],g);const v=U(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&j(t,["setup","outputAudioTranscription"],v);const y=U(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&j(t,["setup","realtimeInputConfig"],y);const b=U(e,["contextWindowCompression"]);void 0!==t&&null!=b&&j(t,["setup","contextWindowCompression"],b);const w=U(e,["proactivity"]);void 0!==t&&null!=w&&j(t,["setup","proactivity"],w);const _=U(e,["explicitVadSignal"]);return void 0!==t&&null!=_&&j(t,["setup","explicitVadSignal"],_),{}}function Bn(e){const t={},n=U(e,["media"]);if(null!=n){let e=At(n);Array.isArray(e)&&(e=e.map(e=>Fn(e))),j(t,["mediaChunks"],e)}const i=U(e,["audio"]);null!=i&&j(t,["audio"],Fn(kt(i)));const s=U(e,["audioStreamEnd"]);null!=s&&j(t,["audioStreamEnd"],s);const r=U(e,["video"]);null!=r&&j(t,["video"],Fn(Tt(r)));const o=U(e,["text"]);null!=o&&j(t,["text"],o);const a=U(e,["activityStart"]);null!=a&&j(t,["activityStart"],a);const l=U(e,["activityEnd"]);return null!=l&&j(t,["activityEnd"],l),t}function Wn(e){const t={},n=U(e,["media"]);if(null!=n){let e=At(n);Array.isArray(e)&&(e=e.map(e=>e)),j(t,["mediaChunks"],e)}const i=U(e,["audio"]);null!=i&&j(t,["audio"],kt(i));const s=U(e,["audioStreamEnd"]);null!=s&&j(t,["audioStreamEnd"],s);const r=U(e,["video"]);null!=r&&j(t,["video"],Tt(r));const o=U(e,["text"]);null!=o&&j(t,["text"],o);const a=U(e,["activityStart"]);null!=a&&j(t,["activityStart"],a);const l=U(e,["activityEnd"]);return null!=l&&j(t,["activityEnd"],l),t}function Hn(e){const t={},n=U(e,["setupComplete"]);null!=n&&j(t,["setupComplete"],n);const i=U(e,["serverContent"]);null!=i&&j(t,["serverContent"],i);const s=U(e,["toolCall"]);null!=s&&j(t,["toolCall"],s);const r=U(e,["toolCallCancellation"]);null!=r&&j(t,["toolCallCancellation"],r);const o=U(e,["usageMetadata"]);null!=o&&j(t,["usageMetadata"],function(e){const t={},n=U(e,["promptTokenCount"]);null!=n&&j(t,["promptTokenCount"],n);const i=U(e,["cachedContentTokenCount"]);null!=i&&j(t,["cachedContentTokenCount"],i);const s=U(e,["candidatesTokenCount"]);null!=s&&j(t,["responseTokenCount"],s);const r=U(e,["toolUsePromptTokenCount"]);null!=r&&j(t,["toolUsePromptTokenCount"],r);const o=U(e,["thoughtsTokenCount"]);null!=o&&j(t,["thoughtsTokenCount"],o);const a=U(e,["totalTokenCount"]);null!=a&&j(t,["totalTokenCount"],a);const l=U(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["promptTokensDetails"],e)}const c=U(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["cacheTokensDetails"],e)}const u=U(e,["candidatesTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["responseTokensDetails"],e)}const d=U(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["toolUsePromptTokensDetails"],e)}const h=U(e,["trafficType"]);null!=h&&j(t,["trafficType"],h);return t}(o));const a=U(e,["goAway"]);null!=a&&j(t,["goAway"],a);const l=U(e,["sessionResumptionUpdate"]);null!=l&&j(t,["sessionResumptionUpdate"],l);const c=U(e,["voiceActivityDetectionSignal"]);null!=c&&j(t,["voiceActivityDetectionSignal"],c);const u=U(e,["voiceActivity"]);return null!=u&&j(t,["voiceActivity"],function(e){const t={},n=U(e,["type"]);null!=n&&j(t,["voiceActivityType"],n);return t}(u)),t}function Vn(e){const t={},n=U(e,["content"]);null!=n&&j(t,["content"],n);const i=U(e,["citationMetadata"]);null!=i&&j(t,["citationMetadata"],function(e){const t={},n=U(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["citations"],e)}return t}(i));const s=U(e,["tokenCount"]);null!=s&&j(t,["tokenCount"],s);const r=U(e,["finishReason"]);null!=r&&j(t,["finishReason"],r);const o=U(e,["avgLogprobs"]);null!=o&&j(t,["avgLogprobs"],o);const a=U(e,["groundingMetadata"]);null!=a&&j(t,["groundingMetadata"],a);const l=U(e,["index"]);null!=l&&j(t,["index"],l);const c=U(e,["logprobsResult"]);null!=c&&j(t,["logprobsResult"],c);const u=U(e,["safetyRatings"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["safetyRatings"],e)}const d=U(e,["urlContextMetadata"]);return null!=d&&j(t,["urlContextMetadata"],d),t}function qn(e){const t={},n=U(e,["values"]);null!=n&&j(t,["values"],n);const i=U(e,["statistics"]);return null!=i&&j(t,["statistics"],function(e){const t={},n=U(e,["truncated"]);null!=n&&j(t,["truncated"],n);const i=U(e,["token_count"]);null!=i&&j(t,["tokenCount"],i);return t}(i)),t}function zn(e){const t={},n=U(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["mediaResolution"]);null!=n&&j(t,["mediaResolution"],n);const i=U(e,["codeExecutionResult"]);null!=i&&j(t,["codeExecutionResult"],i);const s=U(e,["executableCode"]);null!=s&&j(t,["executableCode"],s);const r=U(e,["fileData"]);null!=r&&j(t,["fileData"],function(e){const t={};if(void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=U(e,["fileUri"]);null!=n&&j(t,["fileUri"],n);const i=U(e,["mimeType"]);null!=i&&j(t,["mimeType"],i);return t}(r));const o=U(e,["functionCall"]);null!=o&&j(t,["functionCall"],function(e){const t={},n=U(e,["id"]);null!=n&&j(t,["id"],n);const i=U(e,["args"]);null!=i&&j(t,["args"],i);const s=U(e,["name"]);null!=s&&j(t,["name"],s);if(void 0!==U(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==U(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=U(e,["functionResponse"]);null!=a&&j(t,["functionResponse"],a);const l=U(e,["inlineData"]);null!=l&&j(t,["inlineData"],function(e){const t={},n=U(e,["data"]);if(null!=n&&j(t,["data"],n),void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=U(e,["mimeType"]);return null!=i&&j(t,["mimeType"],i),t}(l));const c=U(e,["text"]);null!=c&&j(t,["text"],c);const u=U(e,["thought"]);null!=u&&j(t,["thought"],u);const d=U(e,["thoughtSignature"]);null!=d&&j(t,["thoughtSignature"],d);const h=U(e,["videoMetadata"]);null!=h&&j(t,["videoMetadata"],h);return t}(e))),j(t,["parts"],e)}const i=U(e,["role"]);return null!=i&&j(t,["role"],i),t}function Gn(e,t){const n=U(e,["systemInstruction"]);void 0!==t&&null!=n&&j(t,["systemInstruction"],Ot(n));const i=U(e,["tools"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>Ai(e))),j(t,["tools"],e)}const s=U(e,["generationConfig"]);return void 0!==t&&null!=s&&j(t,["generationConfig"],function(e){const t={},n=U(e,["modelSelectionConfig"]);null!=n&&j(t,["modelConfig"],n);const i=U(e,["responseJsonSchema"]);null!=i&&j(t,["responseJsonSchema"],i);const s=U(e,["audioTimestamp"]);null!=s&&j(t,["audioTimestamp"],s);const r=U(e,["candidateCount"]);null!=r&&j(t,["candidateCount"],r);const o=U(e,["enableAffectiveDialog"]);null!=o&&j(t,["enableAffectiveDialog"],o);const a=U(e,["frequencyPenalty"]);null!=a&&j(t,["frequencyPenalty"],a);const l=U(e,["logprobs"]);null!=l&&j(t,["logprobs"],l);const c=U(e,["maxOutputTokens"]);null!=c&&j(t,["maxOutputTokens"],c);const u=U(e,["mediaResolution"]);null!=u&&j(t,["mediaResolution"],u);const d=U(e,["presencePenalty"]);null!=d&&j(t,["presencePenalty"],d);const h=U(e,["responseLogprobs"]);null!=h&&j(t,["responseLogprobs"],h);const p=U(e,["responseMimeType"]);null!=p&&j(t,["responseMimeType"],p);const f=U(e,["responseModalities"]);null!=f&&j(t,["responseModalities"],f);const m=U(e,["responseSchema"]);null!=m&&j(t,["responseSchema"],m);const g=U(e,["routingConfig"]);null!=g&&j(t,["routingConfig"],g);const v=U(e,["seed"]);null!=v&&j(t,["seed"],v);const y=U(e,["speechConfig"]);null!=y&&j(t,["speechConfig"],y);const b=U(e,["stopSequences"]);null!=b&&j(t,["stopSequences"],b);const w=U(e,["temperature"]);null!=w&&j(t,["temperature"],w);const _=U(e,["thinkingConfig"]);null!=_&&j(t,["thinkingConfig"],_);const x=U(e,["topK"]);null!=x&&j(t,["topK"],x);const E=U(e,["topP"]);null!=E&&j(t,["topP"],E);if(void 0!==U(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(s)),{}}function Jn(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let e=Ft(s);Array.isArray(e)&&(e=e.map(e=>zn(e))),j(n,["contents"],e)}const r=U(t,["config"]);return null!=r&&function(e){if(void 0!==U(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==U(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==U(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.")}(r),n}function Kn(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["prompt"]);null!=s&&j(n,["instances[0]","prompt"],s);const r=U(t,["referenceImages"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["referenceImage"]);null!=n&&j(t,["referenceImage"],mi(n));const i=U(e,["referenceId"]);null!=i&&j(t,["referenceId"],i);const s=U(e,["referenceType"]);null!=s&&j(t,["referenceType"],s);const r=U(e,["maskImageConfig"]);null!=r&&j(t,["maskImageConfig"],function(e){const t={},n=U(e,["maskMode"]);null!=n&&j(t,["maskMode"],n);const i=U(e,["segmentationClasses"]);null!=i&&j(t,["maskClasses"],i);const s=U(e,["maskDilation"]);null!=s&&j(t,["dilation"],s);return t}(r));const o=U(e,["controlImageConfig"]);null!=o&&j(t,["controlImageConfig"],function(e){const t={},n=U(e,["controlType"]);null!=n&&j(t,["controlType"],n);const i=U(e,["enableControlImageComputation"]);return null!=i&&j(t,["computeControl"],i),t}(o));const a=U(e,["styleImageConfig"]);null!=a&&j(t,["styleImageConfig"],a);const l=U(e,["subjectImageConfig"]);null!=l&&j(t,["subjectImageConfig"],l);return t}(e))),j(n,["instances[0]","referenceImages"],e)}const o=U(t,["config"]);return null!=o&&function(e,t){const n=U(e,["outputGcsUri"]);void 0!==t&&null!=n&&j(t,["parameters","storageUri"],n);const i=U(e,["negativePrompt"]);void 0!==t&&null!=i&&j(t,["parameters","negativePrompt"],i);const s=U(e,["numberOfImages"]);void 0!==t&&null!=s&&j(t,["parameters","sampleCount"],s);const r=U(e,["aspectRatio"]);void 0!==t&&null!=r&&j(t,["parameters","aspectRatio"],r);const o=U(e,["guidanceScale"]);void 0!==t&&null!=o&&j(t,["parameters","guidanceScale"],o);const a=U(e,["seed"]);void 0!==t&&null!=a&&j(t,["parameters","seed"],a);const l=U(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&j(t,["parameters","safetySetting"],l);const c=U(e,["personGeneration"]);void 0!==t&&null!=c&&j(t,["parameters","personGeneration"],c);const u=U(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&j(t,["parameters","includeSafetyAttributes"],u);const d=U(e,["includeRaiReason"]);void 0!==t&&null!=d&&j(t,["parameters","includeRaiReason"],d);const h=U(e,["language"]);void 0!==t&&null!=h&&j(t,["parameters","language"],h);const p=U(e,["outputMimeType"]);void 0!==t&&null!=p&&j(t,["parameters","outputOptions","mimeType"],p);const f=U(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&j(t,["parameters","outputOptions","compressionQuality"],f);const m=U(e,["addWatermark"]);void 0!==t&&null!=m&&j(t,["parameters","addWatermark"],m);const g=U(e,["labels"]);void 0!==t&&null!=g&&j(t,["labels"],g);const v=U(e,["editMode"]);void 0!==t&&null!=v&&j(t,["parameters","editMode"],v);const y=U(e,["baseSteps"]);void 0!==t&&null!=y&&j(t,["parameters","editConfig","baseSteps"],y)}(o,n),n}function Yn(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let t=Dt(e,s);Array.isArray(t)&&(t=t.map(e=>e)),j(n,["requests[]","content"],t)}const r=U(t,["config"]);null!=r&&function(e,t){const n=U(e,["taskType"]);void 0!==t&&null!=n&&j(t,["requests[]","taskType"],n);const i=U(e,["title"]);void 0!==t&&null!=i&&j(t,["requests[]","title"],i);const s=U(e,["outputDimensionality"]);if(void 0!==t&&null!=s&&j(t,["requests[]","outputDimensionality"],s),void 0!==U(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==U(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.")}(r,n);const o=U(t,["model"]);return void 0!==o&&j(n,["requests[]","model"],Et(e,o)),n}function $n(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let t=Dt(e,s);Array.isArray(t)&&(t=t.map(e=>e)),j(n,["instances[]","content"],t)}const r=U(t,["config"]);return null!=r&&function(e,t){const n=U(e,["taskType"]);void 0!==t&&null!=n&&j(t,["instances[]","task_type"],n);const i=U(e,["title"]);void 0!==t&&null!=i&&j(t,["instances[]","title"],i);const s=U(e,["outputDimensionality"]);void 0!==t&&null!=s&&j(t,["parameters","outputDimensionality"],s);const r=U(e,["mimeType"]);void 0!==t&&null!=r&&j(t,["instances[]","mimeType"],r);const o=U(e,["autoTruncate"]);void 0!==t&&null!=o&&j(t,["parameters","autoTruncate"],o)}(r,n),n}function Xn(e,t,n){const i={},s=U(t,["systemInstruction"]);void 0!==n&&null!=s&&j(n,["systemInstruction"],zn(Ot(s)));const r=U(t,["temperature"]);null!=r&&j(i,["temperature"],r);const o=U(t,["topP"]);null!=o&&j(i,["topP"],o);const a=U(t,["topK"]);null!=a&&j(i,["topK"],a);const l=U(t,["candidateCount"]);null!=l&&j(i,["candidateCount"],l);const c=U(t,["maxOutputTokens"]);null!=c&&j(i,["maxOutputTokens"],c);const u=U(t,["stopSequences"]);null!=u&&j(i,["stopSequences"],u);const d=U(t,["responseLogprobs"]);null!=d&&j(i,["responseLogprobs"],d);const h=U(t,["logprobs"]);null!=h&&j(i,["logprobs"],h);const p=U(t,["presencePenalty"]);null!=p&&j(i,["presencePenalty"],p);const f=U(t,["frequencyPenalty"]);null!=f&&j(i,["frequencyPenalty"],f);const m=U(t,["seed"]);null!=m&&j(i,["seed"],m);const g=U(t,["responseMimeType"]);null!=g&&j(i,["responseMimeType"],g);const v=U(t,["responseSchema"]);null!=v&&j(i,["responseSchema"],jt(v));const y=U(t,["responseJsonSchema"]);if(null!=y&&j(i,["responseJsonSchema"],y),void 0!==U(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==U(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=U(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["category"]);null!=n&&j(t,["category"],n);if(void 0!==U(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const i=U(e,["threshold"]);null!=i&&j(t,["threshold"],i);return t}(e))),j(n,["safetySettings"],e)}const w=U(t,["tools"]);if(void 0!==n&&null!=w){let e=Ht(w);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==U(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=U(e,["computerUse"]);null!=n&&j(t,["computerUse"],n);const i=U(e,["fileSearch"]);null!=i&&j(t,["fileSearch"],i);const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);if(void 0!==U(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=U(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["functionDeclarations"],e)}const o=U(e,["googleMaps"]);null!=o&&j(t,["googleMaps"],function(e){const t={};if(void 0!==U(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=U(e,["enableWidget"]);null!=n&&j(t,["enableWidget"],n);return t}(o));const a=U(e,["googleSearch"]);null!=a&&j(t,["googleSearch"],function(e){const t={};if(void 0!==U(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==U(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=U(e,["timeRangeFilter"]);null!=n&&j(t,["timeRangeFilter"],n);return t}(a));const l=U(e,["googleSearchRetrieval"]);null!=l&&j(t,["googleSearchRetrieval"],l);const c=U(e,["urlContext"]);null!=c&&j(t,["urlContext"],c);return t}(Wt(e)))),j(n,["tools"],e)}const _=U(t,["toolConfig"]);if(void 0!==n&&null!=_&&j(n,["toolConfig"],function(e){const t={},n=U(e,["retrievalConfig"]);null!=n&&j(t,["retrievalConfig"],n);const i=U(e,["functionCallingConfig"]);null!=i&&j(t,["functionCallingConfig"],function(e){const t={},n=U(e,["allowedFunctionNames"]);null!=n&&j(t,["allowedFunctionNames"],n);const i=U(e,["mode"]);if(null!=i&&j(t,["mode"],i),void 0!==U(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(i));return t}(_)),void 0!==U(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const x=U(t,["cachedContent"]);void 0!==n&&null!=x&&j(n,["cachedContent"],Vt(e,x));const E=U(t,["responseModalities"]);null!=E&&j(i,["responseModalities"],E);const S=U(t,["mediaResolution"]);null!=S&&j(i,["mediaResolution"],S);const A=U(t,["speechConfig"]);if(null!=A&&j(i,["speechConfig"],Ut(A)),void 0!==U(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const C=U(t,["thinkingConfig"]);null!=C&&j(i,["thinkingConfig"],C);const T=U(t,["imageConfig"]);null!=T&&j(i,["imageConfig"],function(e){const t={},n=U(e,["aspectRatio"]);null!=n&&j(t,["aspectRatio"],n);const i=U(e,["imageSize"]);null!=i&&j(t,["imageSize"],i);if(void 0!==U(e,["personGeneration"]))throw new Error("personGeneration parameter is not supported in Gemini API.");if(void 0!==U(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==U(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(T));const k=U(t,["enableEnhancedCivicAnswers"]);return null!=k&&j(i,["enableEnhancedCivicAnswers"],k),i}function Qn(e,t,n){const i={},s=U(t,["systemInstruction"]);void 0!==n&&null!=s&&j(n,["systemInstruction"],Ot(s));const r=U(t,["temperature"]);null!=r&&j(i,["temperature"],r);const o=U(t,["topP"]);null!=o&&j(i,["topP"],o);const a=U(t,["topK"]);null!=a&&j(i,["topK"],a);const l=U(t,["candidateCount"]);null!=l&&j(i,["candidateCount"],l);const c=U(t,["maxOutputTokens"]);null!=c&&j(i,["maxOutputTokens"],c);const u=U(t,["stopSequences"]);null!=u&&j(i,["stopSequences"],u);const d=U(t,["responseLogprobs"]);null!=d&&j(i,["responseLogprobs"],d);const h=U(t,["logprobs"]);null!=h&&j(i,["logprobs"],h);const p=U(t,["presencePenalty"]);null!=p&&j(i,["presencePenalty"],p);const f=U(t,["frequencyPenalty"]);null!=f&&j(i,["frequencyPenalty"],f);const m=U(t,["seed"]);null!=m&&j(i,["seed"],m);const g=U(t,["responseMimeType"]);null!=g&&j(i,["responseMimeType"],g);const v=U(t,["responseSchema"]);null!=v&&j(i,["responseSchema"],jt(v));const y=U(t,["responseJsonSchema"]);null!=y&&j(i,["responseJsonSchema"],y);const b=U(t,["routingConfig"]);null!=b&&j(i,["routingConfig"],b);const w=U(t,["modelSelectionConfig"]);null!=w&&j(i,["modelConfig"],w);const _=U(t,["safetySettings"]);if(void 0!==n&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>e)),j(n,["safetySettings"],e)}const x=U(t,["tools"]);if(void 0!==n&&null!=x){let e=Ht(x);Array.isArray(e)&&(e=e.map(e=>Ai(Wt(e)))),j(n,["tools"],e)}const E=U(t,["toolConfig"]);void 0!==n&&null!=E&&j(n,["toolConfig"],E);const S=U(t,["labels"]);void 0!==n&&null!=S&&j(n,["labels"],S);const A=U(t,["cachedContent"]);void 0!==n&&null!=A&&j(n,["cachedContent"],Vt(e,A));const C=U(t,["responseModalities"]);null!=C&&j(i,["responseModalities"],C);const T=U(t,["mediaResolution"]);null!=T&&j(i,["mediaResolution"],T);const k=U(t,["speechConfig"]);null!=k&&j(i,["speechConfig"],Ut(k));const I=U(t,["audioTimestamp"]);null!=I&&j(i,["audioTimestamp"],I);const N=U(t,["thinkingConfig"]);null!=N&&j(i,["thinkingConfig"],N);const P=U(t,["imageConfig"]);if(null!=P&&j(i,["imageConfig"],function(e){const t={},n=U(e,["aspectRatio"]);null!=n&&j(t,["aspectRatio"],n);const i=U(e,["imageSize"]);null!=i&&j(t,["imageSize"],i);const s=U(e,["personGeneration"]);null!=s&&j(t,["personGeneration"],s);const r=U(e,["outputMimeType"]);null!=r&&j(t,["imageOutputOptions","mimeType"],r);const o=U(e,["outputCompressionQuality"]);null!=o&&j(t,["imageOutputOptions","compressionQuality"],o);return t}(P)),void 0!==U(t,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function Zn(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let e=Ft(s);Array.isArray(e)&&(e=e.map(e=>zn(e))),j(n,["contents"],e)}const r=U(t,["config"]);return null!=r&&j(n,["generationConfig"],Xn(e,r,n)),n}function ei(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let e=Ft(s);Array.isArray(e)&&(e=e.map(e=>e)),j(n,["contents"],e)}const r=U(t,["config"]);return null!=r&&j(n,["generationConfig"],Qn(e,r,n)),n}function ti(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>Vn(e))),j(t,["candidates"],e)}const s=U(e,["modelVersion"]);null!=s&&j(t,["modelVersion"],s);const r=U(e,["promptFeedback"]);null!=r&&j(t,["promptFeedback"],r);const o=U(e,["responseId"]);null!=o&&j(t,["responseId"],o);const a=U(e,["usageMetadata"]);return null!=a&&j(t,["usageMetadata"],a),t}function ni(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["candidates"],e)}const s=U(e,["createTime"]);null!=s&&j(t,["createTime"],s);const r=U(e,["modelVersion"]);null!=r&&j(t,["modelVersion"],r);const o=U(e,["promptFeedback"]);null!=o&&j(t,["promptFeedback"],o);const a=U(e,["responseId"]);null!=a&&j(t,["responseId"],a);const l=U(e,["usageMetadata"]);return null!=l&&j(t,["usageMetadata"],l),t}function ii(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["prompt"]);null!=s&&j(n,["instances[0]","prompt"],s);const r=U(t,["config"]);return null!=r&&function(e,t){if(void 0!==U(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==U(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=U(e,["numberOfImages"]);void 0!==t&&null!=n&&j(t,["parameters","sampleCount"],n);const i=U(e,["aspectRatio"]);void 0!==t&&null!=i&&j(t,["parameters","aspectRatio"],i);const s=U(e,["guidanceScale"]);if(void 0!==t&&null!=s&&j(t,["parameters","guidanceScale"],s),void 0!==U(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const r=U(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&j(t,["parameters","safetySetting"],r);const o=U(e,["personGeneration"]);void 0!==t&&null!=o&&j(t,["parameters","personGeneration"],o);const a=U(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&j(t,["parameters","includeSafetyAttributes"],a);const l=U(e,["includeRaiReason"]);void 0!==t&&null!=l&&j(t,["parameters","includeRaiReason"],l);const c=U(e,["language"]);void 0!==t&&null!=c&&j(t,["parameters","language"],c);const u=U(e,["outputMimeType"]);void 0!==t&&null!=u&&j(t,["parameters","outputOptions","mimeType"],u);const d=U(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&j(t,["parameters","outputOptions","compressionQuality"],d),void 0!==U(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==U(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const h=U(e,["imageSize"]);if(void 0!==t&&null!=h&&j(t,["parameters","sampleImageSize"],h),void 0!==U(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.")}(r,n),n}function si(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["prompt"]);null!=s&&j(n,["instances[0]","prompt"],s);const r=U(t,["config"]);return null!=r&&function(e,t){const n=U(e,["outputGcsUri"]);void 0!==t&&null!=n&&j(t,["parameters","storageUri"],n);const i=U(e,["negativePrompt"]);void 0!==t&&null!=i&&j(t,["parameters","negativePrompt"],i);const s=U(e,["numberOfImages"]);void 0!==t&&null!=s&&j(t,["parameters","sampleCount"],s);const r=U(e,["aspectRatio"]);void 0!==t&&null!=r&&j(t,["parameters","aspectRatio"],r);const o=U(e,["guidanceScale"]);void 0!==t&&null!=o&&j(t,["parameters","guidanceScale"],o);const a=U(e,["seed"]);void 0!==t&&null!=a&&j(t,["parameters","seed"],a);const l=U(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&j(t,["parameters","safetySetting"],l);const c=U(e,["personGeneration"]);void 0!==t&&null!=c&&j(t,["parameters","personGeneration"],c);const u=U(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&j(t,["parameters","includeSafetyAttributes"],u);const d=U(e,["includeRaiReason"]);void 0!==t&&null!=d&&j(t,["parameters","includeRaiReason"],d);const h=U(e,["language"]);void 0!==t&&null!=h&&j(t,["parameters","language"],h);const p=U(e,["outputMimeType"]);void 0!==t&&null!=p&&j(t,["parameters","outputOptions","mimeType"],p);const f=U(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&j(t,["parameters","outputOptions","compressionQuality"],f);const m=U(e,["addWatermark"]);void 0!==t&&null!=m&&j(t,["parameters","addWatermark"],m);const g=U(e,["labels"]);void 0!==t&&null!=g&&j(t,["labels"],g);const v=U(e,["imageSize"]);void 0!==t&&null!=v&&j(t,["parameters","sampleImageSize"],v);const y=U(e,["enhancePrompt"]);void 0!==t&&null!=y&&j(t,["parameters","enhancePrompt"],y)}(r,n),n}function ri(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["_self"]);null!=n&&j(t,["image"],function(e){const t={},n=U(e,["bytesBase64Encoded"]);null!=n&&j(t,["imageBytes"],zt(n));const i=U(e,["mimeType"]);null!=i&&j(t,["mimeType"],i);return t}(n));const i=U(e,["raiFilteredReason"]);null!=i&&j(t,["raiFilteredReason"],i);const s=U(e,["_self"]);null!=s&&j(t,["safetyAttributes"],_i(s));return t}(e))),j(t,["generatedImages"],e)}const s=U(e,["positivePromptSafetyAttributes"]);return null!=s&&j(t,["positivePromptSafetyAttributes"],_i(s)),t}function oi(e,t){const n=U(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&j(t,["parameters","sampleCount"],n),void 0!==U(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==U(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const i=U(e,["durationSeconds"]);if(void 0!==t&&null!=i&&j(t,["parameters","durationSeconds"],i),void 0!==U(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const s=U(e,["aspectRatio"]);void 0!==t&&null!=s&&j(t,["parameters","aspectRatio"],s);const r=U(e,["resolution"]);void 0!==t&&null!=r&&j(t,["parameters","resolution"],r);const o=U(e,["personGeneration"]);if(void 0!==t&&null!=o&&j(t,["parameters","personGeneration"],o),void 0!==U(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const a=U(e,["negativePrompt"]);void 0!==t&&null!=a&&j(t,["parameters","negativePrompt"],a);const l=U(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&j(t,["parameters","enhancePrompt"],l),void 0!==U(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");const c=U(e,["lastFrame"]);void 0!==t&&null!=c&&j(t,["instances[0]","lastFrame"],fi(c));const u=U(e,["referenceImages"]);if(void 0!==t&&null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["image"]);null!=n&&j(t,["image"],fi(n));const i=U(e,["referenceType"]);null!=i&&j(t,["referenceType"],i);return t}(e))),j(t,["instances[0]","referenceImages"],e)}if(void 0!==U(e,["mask"]))throw new Error("mask parameter is not supported in Gemini API.");if(void 0!==U(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}function ai(e,t){const n=U(e,["numberOfVideos"]);void 0!==t&&null!=n&&j(t,["parameters","sampleCount"],n);const i=U(e,["outputGcsUri"]);void 0!==t&&null!=i&&j(t,["parameters","storageUri"],i);const s=U(e,["fps"]);void 0!==t&&null!=s&&j(t,["parameters","fps"],s);const r=U(e,["durationSeconds"]);void 0!==t&&null!=r&&j(t,["parameters","durationSeconds"],r);const o=U(e,["seed"]);void 0!==t&&null!=o&&j(t,["parameters","seed"],o);const a=U(e,["aspectRatio"]);void 0!==t&&null!=a&&j(t,["parameters","aspectRatio"],a);const l=U(e,["resolution"]);void 0!==t&&null!=l&&j(t,["parameters","resolution"],l);const c=U(e,["personGeneration"]);void 0!==t&&null!=c&&j(t,["parameters","personGeneration"],c);const u=U(e,["pubsubTopic"]);void 0!==t&&null!=u&&j(t,["parameters","pubsubTopic"],u);const d=U(e,["negativePrompt"]);void 0!==t&&null!=d&&j(t,["parameters","negativePrompt"],d);const h=U(e,["enhancePrompt"]);void 0!==t&&null!=h&&j(t,["parameters","enhancePrompt"],h);const p=U(e,["generateAudio"]);void 0!==t&&null!=p&&j(t,["parameters","generateAudio"],p);const f=U(e,["lastFrame"]);void 0!==t&&null!=f&&j(t,["instances[0]","lastFrame"],mi(f));const m=U(e,["referenceImages"]);if(void 0!==t&&null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["image"]);null!=n&&j(t,["image"],mi(n));const i=U(e,["referenceType"]);null!=i&&j(t,["referenceType"],i);return t}(e))),j(t,["instances[0]","referenceImages"],e)}const g=U(e,["mask"]);void 0!==t&&null!=g&&j(t,["instances[0]","mask"],function(e){const t={},n=U(e,["image"]);null!=n&&j(t,["_self"],mi(n));const i=U(e,["maskMode"]);null!=i&&j(t,["maskMode"],i);return t}(g));const v=U(e,["compressionQuality"]);return void 0!==t&&null!=v&&j(t,["parameters","compressionQuality"],v),{}}function li(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response","generateVideoResponse"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["video"]);null!=n&&j(t,["video"],function(e){const t={},n=U(e,["uri"]);null!=n&&j(t,["uri"],n);const i=U(e,["encodedVideo"]);null!=i&&j(t,["videoBytes"],zt(i));const s=U(e,["encoding"]);null!=s&&j(t,["mimeType"],s);return t}(n));return t}(e))),j(t,["generatedVideos"],e)}const i=U(e,["raiMediaFilteredCount"]);null!=i&&j(t,["raiMediaFilteredCount"],i);const s=U(e,["raiMediaFilteredReasons"]);null!=s&&j(t,["raiMediaFilteredReasons"],s);return t}(o)),t}function ci(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["_self"]);null!=n&&j(t,["video"],function(e){const t={},n=U(e,["gcsUri"]);null!=n&&j(t,["uri"],n);const i=U(e,["bytesBase64Encoded"]);null!=i&&j(t,["videoBytes"],zt(i));const s=U(e,["mimeType"]);null!=s&&j(t,["mimeType"],s);return t}(n));return t}(e))),j(t,["generatedVideos"],e)}const i=U(e,["raiMediaFilteredCount"]);null!=i&&j(t,["raiMediaFilteredCount"],i);const s=U(e,["raiMediaFilteredReasons"]);null!=s&&j(t,["raiMediaFilteredReasons"],s);return t}(o)),t}function ui(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["prompt"]);null!=s&&j(n,["instances[0]","prompt"],s);const r=U(t,["image"]);null!=r&&j(n,["instances[0]","image"],fi(r));const o=U(t,["video"]);null!=o&&j(n,["instances[0]","video"],Ii(o));const a=U(t,["source"]);null!=a&&function(e,t){const n={},i=U(e,["prompt"]);void 0!==t&&null!=i&&j(t,["instances[0]","prompt"],i);const s=U(e,["image"]);void 0!==t&&null!=s&&j(t,["instances[0]","image"],fi(s));const r=U(e,["video"]);void 0!==t&&null!=r&&j(t,["instances[0]","video"],Ii(r))}(a,n);const l=U(t,["config"]);return null!=l&&oi(l,n),n}function di(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["prompt"]);null!=s&&j(n,["instances[0]","prompt"],s);const r=U(t,["image"]);null!=r&&j(n,["instances[0]","image"],mi(r));const o=U(t,["video"]);null!=o&&j(n,["instances[0]","video"],Ni(o));const a=U(t,["source"]);null!=a&&function(e,t){const n={},i=U(e,["prompt"]);void 0!==t&&null!=i&&j(t,["instances[0]","prompt"],i);const s=U(e,["image"]);void 0!==t&&null!=s&&j(t,["instances[0]","image"],mi(s));const r=U(e,["video"]);void 0!==t&&null!=r&&j(t,["instances[0]","video"],Ni(r))}(a,n);const l=U(t,["config"]);return null!=l&&ai(l,n),n}function hi(e){const t={},n=U(e,["_self"]);null!=n&&j(t,["image"],pi(n));const i=U(e,["raiFilteredReason"]);null!=i&&j(t,["raiFilteredReason"],i);const s=U(e,["_self"]);null!=s&&j(t,["safetyAttributes"],xi(s));const r=U(e,["prompt"]);return null!=r&&j(t,["enhancedPrompt"],r),t}function pi(e){const t={},n=U(e,["gcsUri"]);null!=n&&j(t,["gcsUri"],n);const i=U(e,["bytesBase64Encoded"]);null!=i&&j(t,["imageBytes"],zt(i));const s=U(e,["mimeType"]);return null!=s&&j(t,["mimeType"],s),t}function fi(e){const t={};if(void 0!==U(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=U(e,["imageBytes"]);null!=n&&j(t,["bytesBase64Encoded"],zt(n));const i=U(e,["mimeType"]);return null!=i&&j(t,["mimeType"],i),t}function mi(e){const t={},n=U(e,["gcsUri"]);null!=n&&j(t,["gcsUri"],n);const i=U(e,["imageBytes"]);null!=i&&j(t,["bytesBase64Encoded"],zt(i));const s=U(e,["mimeType"]);return null!=s&&j(t,["mimeType"],s),t}function gi(e,t){const n={},i=U(t,["config"]);return null!=i&&function(e,t,n){const i=U(t,["pageSize"]);void 0!==n&&null!=i&&j(n,["_query","pageSize"],i);const s=U(t,["pageToken"]);void 0!==n&&null!=s&&j(n,["_query","pageToken"],s);const r=U(t,["filter"]);void 0!==n&&null!=r&&j(n,["_query","filter"],r);const o=U(t,["queryBase"]);void 0!==n&&null!=o&&j(n,["_url","models_url"],Jt(e,o))}(e,i,n),n}function vi(e,t){const n={},i=U(t,["config"]);return null!=i&&function(e,t,n){const i=U(t,["pageSize"]);void 0!==n&&null!=i&&j(n,["_query","pageSize"],i);const s=U(t,["pageToken"]);void 0!==n&&null!=s&&j(n,["_query","pageToken"],s);const r=U(t,["filter"]);void 0!==n&&null!=r&&j(n,["_query","filter"],r);const o=U(t,["queryBase"]);void 0!==n&&null!=o&&j(n,["_url","models_url"],Jt(e,o))}(e,i,n),n}function yi(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["displayName"]);null!=i&&j(t,["displayName"],i);const s=U(e,["description"]);null!=s&&j(t,["description"],s);const r=U(e,["version"]);null!=r&&j(t,["version"],r);const o=U(e,["_self"]);null!=o&&j(t,["tunedModelInfo"],function(e){const t={},n=U(e,["baseModel"]);null!=n&&j(t,["baseModel"],n);const i=U(e,["createTime"]);null!=i&&j(t,["createTime"],i);const s=U(e,["updateTime"]);null!=s&&j(t,["updateTime"],s);return t}(o));const a=U(e,["inputTokenLimit"]);null!=a&&j(t,["inputTokenLimit"],a);const l=U(e,["outputTokenLimit"]);null!=l&&j(t,["outputTokenLimit"],l);const c=U(e,["supportedGenerationMethods"]);null!=c&&j(t,["supportedActions"],c);const u=U(e,["temperature"]);null!=u&&j(t,["temperature"],u);const d=U(e,["maxTemperature"]);null!=d&&j(t,["maxTemperature"],d);const h=U(e,["topP"]);null!=h&&j(t,["topP"],h);const p=U(e,["topK"]);null!=p&&j(t,["topK"],p);const f=U(e,["thinking"]);return null!=f&&j(t,["thinking"],f),t}function bi(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["displayName"]);null!=i&&j(t,["displayName"],i);const s=U(e,["description"]);null!=s&&j(t,["description"],s);const r=U(e,["versionId"]);null!=r&&j(t,["version"],r);const o=U(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["endpoint"]);null!=n&&j(t,["name"],n);const i=U(e,["deployedModelId"]);return null!=i&&j(t,["deployedModelId"],i),t}(e))),j(t,["endpoints"],e)}const a=U(e,["labels"]);null!=a&&j(t,["labels"],a);const l=U(e,["_self"]);null!=l&&j(t,["tunedModelInfo"],function(e){const t={},n=U(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&j(t,["baseModel"],n);const i=U(e,["createTime"]);null!=i&&j(t,["createTime"],i);const s=U(e,["updateTime"]);null!=s&&j(t,["updateTime"],s);return t}(l));const c=U(e,["defaultCheckpointId"]);null!=c&&j(t,["defaultCheckpointId"],c);const u=U(e,["checkpoints"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["checkpoints"],e)}return t}function wi(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["source"]);null!=s&&function(e,t){const n={},i=U(e,["prompt"]);void 0!==t&&null!=i&&j(t,["instances[0]","prompt"],i);const s=U(e,["personImage"]);void 0!==t&&null!=s&&j(t,["instances[0]","personImage","image"],mi(s));const r=U(e,["productImages"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["productImage"]);return null!=n&&j(t,["image"],mi(n)),t}(e))),j(t,["instances[0]","productImages"],e)}}(s,n);const r=U(t,["config"]);return null!=r&&function(e,t){const n=U(e,["numberOfImages"]);void 0!==t&&null!=n&&j(t,["parameters","sampleCount"],n);const i=U(e,["baseSteps"]);void 0!==t&&null!=i&&j(t,["parameters","baseSteps"],i);const s=U(e,["outputGcsUri"]);void 0!==t&&null!=s&&j(t,["parameters","storageUri"],s);const r=U(e,["seed"]);void 0!==t&&null!=r&&j(t,["parameters","seed"],r);const o=U(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&j(t,["parameters","safetySetting"],o);const a=U(e,["personGeneration"]);void 0!==t&&null!=a&&j(t,["parameters","personGeneration"],a);const l=U(e,["addWatermark"]);void 0!==t&&null!=l&&j(t,["parameters","addWatermark"],l);const c=U(e,["outputMimeType"]);void 0!==t&&null!=c&&j(t,["parameters","outputOptions","mimeType"],c);const u=U(e,["outputCompressionQuality"]);void 0!==t&&null!=u&&j(t,["parameters","outputOptions","compressionQuality"],u);const d=U(e,["enhancePrompt"]);void 0!==t&&null!=d&&j(t,["parameters","enhancePrompt"],d);const h=U(e,["labels"]);void 0!==t&&null!=h&&j(t,["labels"],h)}(r,n),n}function _i(e){const t={},n=U(e,["safetyAttributes","categories"]);null!=n&&j(t,["categories"],n);const i=U(e,["safetyAttributes","scores"]);null!=i&&j(t,["scores"],i);const s=U(e,["contentType"]);return null!=s&&j(t,["contentType"],s),t}function xi(e){const t={},n=U(e,["safetyAttributes","categories"]);null!=n&&j(t,["categories"],n);const i=U(e,["safetyAttributes","scores"]);null!=i&&j(t,["scores"],i);const s=U(e,["contentType"]);return null!=s&&j(t,["contentType"],s),t}function Ei(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["source"]);null!=s&&function(e,t){const n={},i=U(e,["prompt"]);void 0!==t&&null!=i&&j(t,["instances[0]","prompt"],i);const s=U(e,["image"]);void 0!==t&&null!=s&&j(t,["instances[0]","image"],mi(s));const r=U(e,["scribbleImage"]);void 0!==t&&null!=r&&j(t,["instances[0]","scribble"],function(e){const t={},n=U(e,["image"]);return null!=n&&j(t,["image"],mi(n)),t}(r))}(s,n);const r=U(t,["config"]);return null!=r&&function(e,t){const n=U(e,["mode"]);void 0!==t&&null!=n&&j(t,["parameters","mode"],n);const i=U(e,["maxPredictions"]);void 0!==t&&null!=i&&j(t,["parameters","maxPredictions"],i);const s=U(e,["confidenceThreshold"]);void 0!==t&&null!=s&&j(t,["parameters","confidenceThreshold"],s);const r=U(e,["maskDilation"]);void 0!==t&&null!=r&&j(t,["parameters","maskDilation"],r);const o=U(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&j(t,["parameters","binaryColorThreshold"],o);const a=U(e,["labels"]);void 0!==t&&null!=a&&j(t,["labels"],a)}(r,n),n}function Si(e){const t={},n=U(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["_self"]);null!=n&&j(t,["mask"],pi(n));const i=U(e,["labels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["labels"],e)}return t}(e))),j(t,["generatedMasks"],e)}return t}function Ai(e){const t={},n=U(e,["retrieval"]);null!=n&&j(t,["retrieval"],n);const i=U(e,["computerUse"]);if(null!=i&&j(t,["computerUse"],i),void 0!==U(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);const r=U(e,["enterpriseWebSearch"]);null!=r&&j(t,["enterpriseWebSearch"],r);const o=U(e,["functionDeclarations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["description"]);null!=n&&j(t,["description"],n);const i=U(e,["name"]);null!=i&&j(t,["name"],i);const s=U(e,["parameters"]);null!=s&&j(t,["parameters"],s);const r=U(e,["parametersJsonSchema"]);null!=r&&j(t,["parametersJsonSchema"],r);const o=U(e,["response"]);null!=o&&j(t,["response"],o);const a=U(e,["responseJsonSchema"]);if(null!=a&&j(t,["responseJsonSchema"],a),void 0!==U(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return t}(e))),j(t,["functionDeclarations"],e)}const a=U(e,["googleMaps"]);null!=a&&j(t,["googleMaps"],a);const l=U(e,["googleSearch"]);null!=l&&j(t,["googleSearch"],l);const c=U(e,["googleSearchRetrieval"]);null!=c&&j(t,["googleSearchRetrieval"],c);const u=U(e,["urlContext"]);return null!=u&&j(t,["urlContext"],u),t}function Ci(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","name"],Et(e,i));const s=U(t,["config"]);return null!=s&&function(e,t){const n=U(e,["displayName"]);void 0!==t&&null!=n&&j(t,["displayName"],n);const i=U(e,["description"]);void 0!==t&&null!=i&&j(t,["description"],i);const s=U(e,["defaultCheckpointId"]);void 0!==t&&null!=s&&j(t,["defaultCheckpointId"],s)}(s,n),n}function Ti(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["config"]);return null!=s&&function(e,t){const n=U(e,["displayName"]);void 0!==t&&null!=n&&j(t,["displayName"],n);const i=U(e,["description"]);void 0!==t&&null!=i&&j(t,["description"],i);const s=U(e,["defaultCheckpointId"]);void 0!==t&&null!=s&&j(t,["defaultCheckpointId"],s)}(s,n),n}function ki(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["image"]);null!=s&&j(n,["instances[0]","image"],mi(s));const r=U(t,["upscaleFactor"]);null!=r&&j(n,["parameters","upscaleConfig","upscaleFactor"],r);const o=U(t,["config"]);return null!=o&&function(e,t){const n=U(e,["outputGcsUri"]);void 0!==t&&null!=n&&j(t,["parameters","storageUri"],n);const i=U(e,["safetyFilterLevel"]);void 0!==t&&null!=i&&j(t,["parameters","safetySetting"],i);const s=U(e,["personGeneration"]);void 0!==t&&null!=s&&j(t,["parameters","personGeneration"],s);const r=U(e,["includeRaiReason"]);void 0!==t&&null!=r&&j(t,["parameters","includeRaiReason"],r);const o=U(e,["outputMimeType"]);void 0!==t&&null!=o&&j(t,["parameters","outputOptions","mimeType"],o);const a=U(e,["outputCompressionQuality"]);void 0!==t&&null!=a&&j(t,["parameters","outputOptions","compressionQuality"],a);const l=U(e,["enhanceInputImage"]);void 0!==t&&null!=l&&j(t,["parameters","upscaleConfig","enhanceInputImage"],l);const c=U(e,["imagePreservationFactor"]);void 0!==t&&null!=c&&j(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const u=U(e,["labels"]);void 0!==t&&null!=u&&j(t,["labels"],u);const d=U(e,["numberOfImages"]);void 0!==t&&null!=d&&j(t,["parameters","sampleCount"],d);const h=U(e,["mode"]);void 0!==t&&null!=h&&j(t,["parameters","mode"],h)}(o,n),n}function Ii(e){const t={},n=U(e,["uri"]);null!=n&&j(t,["uri"],n);const i=U(e,["videoBytes"]);null!=i&&j(t,["encodedVideo"],zt(i));const s=U(e,["mimeType"]);return null!=s&&j(t,["encoding"],s),t}function Ni(e){const t={},n=U(e,["uri"]);null!=n&&j(t,["gcsUri"],n);const i=U(e,["videoBytes"]);null!=i&&j(t,["bytesBase64Encoded"],zt(i));const s=U(e,["mimeType"]);return null!=s&&j(t,["mimeType"],s),t}function Pi(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["displayName"]);void 0!==t&&null!=n&&j(t,["displayName"],n)}(n,t),t}function Mi(e){const t={},n=U(e,["name"]);null!=n&&j(t,["_url","name"],n);const i=U(e,["config"]);return null!=i&&function(e,t){const n=U(e,["force"]);void 0!==t&&null!=n&&j(t,["_query","force"],n)}(i,t),t}function Ri(e){const t={},n=U(e,["name"]);null!=n&&j(t,["name"],n);const i=U(e,["metadata"]);null!=i&&j(t,["metadata"],i);const s=U(e,["done"]);null!=s&&j(t,["done"],s);const r=U(e,["error"]);null!=r&&j(t,["error"],r);const o=U(e,["response"]);return null!=o&&j(t,["response"],function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["parent"]);null!=i&&j(t,["parent"],i);const s=U(e,["documentName"]);null!=s&&j(t,["documentName"],s);return t}(o)),t}function Oi(e){const t={},n=U(e,["fileSearchStoreName"]);null!=n&&j(t,["_url","file_search_store_name"],n);const i=U(e,["fileName"]);null!=i&&j(t,["fileName"],i);const s=U(e,["config"]);return null!=s&&function(e,t){const n=U(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["customMetadata"],e)}const i=U(e,["chunkingConfig"]);void 0!==t&&null!=i&&j(t,["chunkingConfig"],i)}(s,t),t}function Di(e){const t={},n=U(e,["config"]);return null!=n&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i)}(n,t),t}function Fi(e,t){const n=U(e,["mimeType"]);void 0!==t&&null!=n&&j(t,["mimeType"],n);const i=U(e,["displayName"]);void 0!==t&&null!=i&&j(t,["displayName"],i);const s=U(e,["customMetadata"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["customMetadata"],e)}const r=U(e,["chunkingConfig"]);return void 0!==t&&null!=r&&j(t,["chunkingConfig"],r),{}}const Li="x-goog-api-client",ji="google-genai-sdk/".concat("1.36.0");class Ui{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?"https://".concat(this.clientOptions.location,"-aiplatform.googleapis.com/"):"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return"projects/".concat(this.clientOptions.project,"/locations/").concat(this.clientOptions.location)}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];n&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e);return new URL("".concat(i.join("/")))}shouldPrependVertexProjectPath(e){return!this.clientOptions.apiKey&&(!!this.clientOptions.vertexai&&(!e.path.startsWith("projects/")&&("GET"!==e.httpMethod||!e.path.startsWith("publishers/google/models"))))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[r,o]of Object.entries(e.queryParams))i.searchParams.append(r,String(o));let s={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))"object"===typeof s?n[i]=Object.assign(Object.assign({},n[i]),s):void 0!==s&&(n[i]=s);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);i.searchParams.has("alt")&&"sse"===i.searchParams.get("alt")||i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){const n=new AbortController,s=n.signal;if(t.timeout&&(null===t||void 0===t?void 0:t.timeout)>0){const e=setTimeout(()=>n.abort(),t.timeout);e&&"function"===typeof e.unref&&e.unref()}i&&i.addEventListener("abort",()=>{n.abort()}),e.signal=s}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return void console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"===typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!==typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(r){return void console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.")}function i(e,t){const n=Object.assign({},e);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const e=t[s],r=n[s];e&&"object"===typeof e&&!Array.isArray(e)&&r&&"object"===typeof r&&!Array.isArray(r)?n[s]=i(r,e):(r&&e&&typeof r!==typeof e&&console.warn('includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "'.concat(s,'". Original type: ').concat(typeof r,", New type: ").concat(typeof e,". Overwriting.")),n[s]=e)}return n}const s=i(n,t);e.body=JSON.stringify(s)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await Bi(e),new Ye(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await Bi(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){return Cn(this,arguments,function*(){var t;const n=null===(t=null===e||void 0===e?void 0:e.body)||void 0===t?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";const r="data:",o=["\n\n","\r\r","\r\n\r\n"];for(;;){const{done:a,value:l}=yield An(n.read());if(a){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=i.decode(l,{stream:!0});try{const e=JSON.parse(c);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,i=t.code,s="got status: ".concat(n,". ").concat(JSON.stringify(e));if(i>=400&&i<600){throw new Rn({message:s,status:i})}}}catch(s){if("ApiError"===s.name)throw s}t+=c;let u=-1,d=0;for(;;){u=-1,d=0;for(const e of o){const n=t.indexOf(e);-1!==n&&(-1===u||n<u)&&(u=n,d=e.length)}if(-1===u)break;const n=t.substring(0,u);t=t.substring(u+d);const i=n.trim();if(i.startsWith(r)){const t=i.substring(r.length).trim();try{const n=new Response(t,{headers:null===e||void 0===e?void 0:e.headers,status:null===e||void 0===e?void 0:e.status,statusText:null===e||void 0===e?void 0:e.statusText});yield yield An(new Ye(n))}catch(s){throw new Error("exception parsing stream chunk ".concat(t,". ").concat(s))}}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error("exception ".concat(e," sending request"))})}getDefaultHeaders(){const e={},t=ji+" "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[Li]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[t,i]of Object.entries(e.headers))n.append(t,i);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"===typeof e&&(n=e.replace(/[/\\]+$/,""),n=null!==(t=n.split(/[/\\]/).pop())&&void 0!==t?t:""),n}async uploadFile(e,t){var n;const i={};null!=t&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name="files/".concat(i.name));const s=this.clientOptions.uploader,r=await s.stat(e);i.sizeBytes=String(r.size);const o=null!==(n=null===t||void 0===t?void 0:t.mimeType)&&void 0!==n?n:r.type;if(void 0===o||""===o)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;const a={file:i},l=this.getFileName(e),c=L("upload/v1beta/files",a._url),u=await this.fetchUploadUrl(c,i.sizeBytes,i.mimeType,l,a,null===t||void 0===t?void 0:t.httpOptions);return s.upload(e,u,this)}async uploadFileToFileSearchStore(e,t,n){var i;const s=this.clientOptions.uploader,r=await s.stat(t),o=String(r.size),a=null!==(i=null===n||void 0===n?void 0:n.mimeType)&&void 0!==i?i:r.type;if(void 0===a||""===a)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const l="upload/v1beta/".concat(e,":uploadToFileSearchStore"),c=this.getFileName(t),u={};null!=n&&Fi(n,u);const d=await this.fetchUploadUrl(l,o,a,c,u,null===n||void 0===n?void 0:n.httpOptions);return s.uploadToFileSearchStore(t,d,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,i,s,r){var o;let a={};a=r||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(t),"X-Goog-Upload-Header-Content-Type":"".concat(n)},i?{"X-Goog-Upload-File-Name":i}:{})};const l=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:a});if(!l||!(null===l||void 0===l?void 0:l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=null===(o=null===l||void 0===l?void 0:l.headers)||void 0===o?void 0:o["x-goog-upload-url"];if(void 0===c)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function Bi(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let i;i=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const s=JSON.stringify(i);if(n>=400&&n<600){throw new Rn({message:s,status:n})}throw new Error(s)}}let Wi=!1;function Hi(e){for(const t of e){if(qi(t))return!0;if("object"===typeof t&&"inputSchema"in t)return!0}return Wi}function Vi(e){var t;const n=null!==(t=e[Li])&&void 0!==t?t:"";e[Li]=(n+" ".concat("mcp_used/unknown")).trimStart()}function qi(e){return null!==e&&"object"===typeof e&&e instanceof Gi}function zi(e){return Cn(this,arguments,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function*(){let n,i=0;for(;i<t;){const t=yield An(e.listTools({cursor:n}));for(const e of t.tools)yield yield An(e),i++;if(!t.nextCursor)break;n=t.nextCursor}}()})}class Gi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Gi(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;const s={},r=[];for(const u of this.mcpClients)try{for(var o,a=!0,l=(t=void 0,Tn(zi(u)));!(e=(o=await l.next()).done);a=!0){i=o.value,a=!1;const e=i;r.push(e);const t=e.name;if(s[t])throw new Error("Duplicate function name ".concat(t," found in MCP tools. Please ensure function names are unique."));s[t]=u}}catch(c){t={error:c}}finally{try{a||e||!(n=l.return)||await n.call(l)}finally{if(t)throw t.error}}this.mcpTools=r,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[],i=new Set;for(const s of e){const e=s.name;if(i.has(e))throw new Error("Duplicate function name ".concat(e," found in MCP tools. Please ensure function names are unique."));i.add(e);const r=$t(s,t);r.functionDeclarations&&n.push(...r.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const s=await e.callTool({name:n.name,arguments:n.args},void 0,i);t.push({functionResponse:{name:n.name,response:s.isError?{error:s}:s}})}return t}}class Ji{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),r=function(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a="".concat(i,"/ws/google.ai.generativelanguage.").concat(s,".GenerativeService.BidiGenerateMusic?key=").concat(o);let l=()=>{};const c=new Promise(e=>{l=e}),u=e.callbacks,d=(this.apiClient,{onopen:function(){l({})},onmessage:e=>{!async function(e,t,n){const i=new _t;let s;s=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),Object.assign(i,s),t(i)}(0,u.onmessage,e)},onerror:null!==(t=null===u||void 0===u?void 0:u.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null===u||void 0===u?void 0:u.onclose)&&void 0!==n?n:function(e){}}),h=this.webSocketFactory.create(a,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(r),d);h.connect(),await c;const p={setup:{model:Et(this.apiClient,e.model)}};return h.send(JSON.stringify(p)),new Ki(h,this.apiClient)}}class Ki{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=function(e){const t={},n=U(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=function(e){const t={},n=U(e,["musicGenerationConfig"]);return null!=n&&j(t,["musicGenerationConfig"],n),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Je.PLAY)}pause(){this.sendPlaybackControl(Je.PAUSE)}stop(){this.sendPlaybackControl(Je.STOP)}resetContext(){this.sendPlaybackControl(Je.RESET_CONTEXT)}close(){this.conn.close()}}class Yi{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new Ji(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,s,r,o;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=this.apiClient.getHeaders();e.config&&e.config.tools&&Hi(e.config.tools)&&Vi(u);const d=function(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}(u);if(this.apiClient.isVertexAI())c="".concat(a,"/ws/google.cloud.aiplatform.").concat(l,".LlmBidiService/BidiGenerateContent"),await this.auth.addAuthHeaders(d,c);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null===e||void 0===e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==l&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),c="".concat(a,"/ws/google.ai.generativelanguage.").concat(l,".GenerativeService.").concat(t,"?").concat(n,"=").concat(e)}let h=()=>{};const p=new Promise(e=>{h=e}),f=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null===f||void 0===f?void 0:f.onopen)||void 0===e||e.call(f),h({})},onmessage:e=>{!async function(e,t,n){const i=new wt;let s;s=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const r=JSON.parse(s);if(e.isVertexAI()){const e=Hn(r);Object.assign(i,e)}else{const e=r;Object.assign(i,e)}t(i)}(m,f.onmessage,e)},onerror:null!==(t=null===f||void 0===f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null===f||void 0===f?void 0:f.onclose)&&void 0!==n?n:function(e){}},v=this.webSocketFactory.create(c,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(d),g);v.connect(),await p;let y=Et(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&y.startsWith("publishers/")){const e=this.apiClient.getProject(),t=this.apiClient.getLocation();y="projects/".concat(e,"/locations/").concat(t,"/")+y}let b={};this.apiClient.isVertexAI()&&void 0===(null===(i=e.config)||void 0===i?void 0:i.responseModalities)&&(void 0===e.config?e.config={responseModalities:[pe.AUDIO]}:e.config.responseModalities=[pe.AUDIO]),(null===(s=e.config)||void 0===s?void 0:s.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const w=null!==(o=null===(r=e.config)||void 0===r?void 0:r.tools)&&void 0!==o?o:[],_=[];for(const E of w)if(this.isCallableTool(E)){const e=E;_.push(await e.tool())}else _.push(E);_.length>0&&(e.config.tools=_);const x={model:y,config:e.config,callbacks:e.callbacks};return b=this.apiClient.isVertexAI()?function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["setup","model"],Et(e,i));const s=U(t,["config"]);return null!=s&&j(n,["config"],Un(s,n)),n}(this.apiClient,x):function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["setup","model"],Et(e,i));const s=U(t,["config"]);return null!=s&&j(n,["config"],jn(s,n)),n}(this.apiClient,x),delete b.config,v.send(JSON.stringify(b)),new Xi(v,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"===typeof e.callTool}}const $i={turnComplete:!0};class Xi{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=Ft(t.turns),e.isVertexAI()||(n=n.map(e=>zn(e)))}catch(wr){throw new Error('Failed to parse client content "turns", type: \''.concat(typeof t.turns,"'"))}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const i of n){if("object"!==typeof i||null===i||!("name"in i)||!("response"in i))throw new Error("Could not parse function response, type '".concat(typeof i,"'."));if(!e.isVertexAI()&&!("id"in i))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},$i),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:Wn(e)}:{realtimeInput:Bn(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Qi(e){var t,n,i;if(null===(t=null===e||void 0===e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let s=!1;for(const o of null!==(n=null===e||void 0===e?void 0:e.tools)&&void 0!==n?n:[])if(Zi(o)){s=!0;break}if(!s)return!0;const r=null===(i=null===e||void 0===e?void 0:e.automaticFunctionCalling)||void 0===i?void 0:i.maximumRemoteCalls;return!!(r&&(r<0||!Number.isInteger(r))||0==r)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0)}function Zi(e){return"callTool"in e&&"function"===typeof e.callTool}function es(e){var t;const n=[];return(null===(t=null===e||void 0===e?void 0:e.config)||void 0===t?void 0:t.tools)?(e.config.tools.forEach((e,t)=>{if(Zi(e))return;const i=e;i.functionDeclarations&&i.functionDeclarations.length>0&&n.push(t)}),n):n}function ts(e){var t;return!(null===(t=null===e||void 0===e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}class ns extends F{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,i,s,r;const o=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,i;return null!==(i=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>Zi(e)))&&void 0!==i&&i}(e)||Qi(e.config))return await this.generateContentInternal(o);const a=es(e);if(a.length>0){const e=a.map(e=>"tools[".concat(e,"]")).join(", ");throw new Error("Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ".concat(e,"."))}let l,c;const u=Ft(o.contents),d=null!==(i=null===(n=null===(t=o.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==i?i:10;let h=0;for(;h<d&&(l=await this.generateContentInternal(o),l.functionCalls&&0!==l.functionCalls.length);){const t=l.candidates[0].content,n=[];for(const i of null!==(r=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==r?r:[])if(Zi(i)){const e=i,t=await e.callTool(l.functionCalls);n.push(...t)}h++,c={role:"user",parts:n},o.contents=Ft(o.contents),o.contents.push(t),o.contents.push(c),ts(o.config)&&(u.push(t),u.push(c))}return ts(o.config)&&(l.automaticFunctionCallingHistory=u),l},this.generateContentStream=async e=>{var t,n,i,s,r;if(this.maybeMoveToResponseJsonSchem(e),Qi(e.config)){const t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}const o=es(e);if(o.length>0){const e=o.map(e=>"tools[".concat(e,"]")).join(", ");throw new Error("Incompatible tools found at ".concat(e,'. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.'))}const a=null===(i=null===(n=null===(t=null===e||void 0===e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===n?void 0:n.functionCallingConfig)||void 0===i?void 0:i.streamFunctionCallArguments,l=null===(r=null===(s=null===e||void 0===e?void 0:e.config)||void 0===s?void 0:s.automaticFunctionCalling)||void 0===r?void 0:r.disable;if(a&&!l)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const i=[];if(null===e||void 0===e?void 0:e.generatedImages)for(const r of e.generatedImages)r&&(null===r||void 0===r?void 0:r.safetyAttributes)&&"Positive Prompt"===(null===(t=null===r||void 0===r?void 0:r.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null===r||void 0===r?void 0:r.safetyAttributes:i.push(r);let s;return s=n?{generatedImages:i,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:i,sdkHttpResponse:e.sdkHttpResponse},s}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null===e||void 0===e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new pn(Ke.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,i,s,r,o;if((e.prompt||e.image||e.video)&&e.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(n=e.video)||void 0===n?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(s=null===(i=e.source)||void 0===i?void 0:i.video)||void 0===s?void 0:s.uri)&&(null===(o=null===(r=e.source)||void 0===r?void 0:r.video)||void 0===o?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,i;const s=null===(t=e.config)||void 0===t?void 0:t.tools;if(!s)return e;const r=await Promise.all(s.map(async e=>{if(Zi(e)){const t=e;return await t.tool()}return e})),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};if(o.config.tools=r,e.config&&e.config.tools&&Hi(e.config.tools)){const t=null!==(i=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==i?i:{};let s=Object.assign({},t);0===Object.keys(s).length&&(s=this.apiClient.getDefaultHeaders()),Vi(s),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:s})}return o}async initAfcToolsMap(e){var t,n,i;const s=new Map;for(const r of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(Zi(r)){const e=r,t=await e.tool();for(const n of null!==(i=t.functionDeclarations)&&void 0!==i?i:[]){if(!n.name)throw new Error("Function declaration name is required.");if(s.has(n.name))throw new Error("Duplicate tool declaration name: ".concat(n.name));s.set(n.name,e)}}return s}async processAfcStream(e){var t,n,i;const s=null!==(i=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==i?i:10;let r=!1,o=0;return function(e,t,n){return Cn(this,arguments,function*(){for(var i,a,l,c,u,d;o<s;){r&&(o++,r=!1);const g=yield An(e.processParamsMaybeAddMcpUsage(n)),v=yield An(e.generateContentStreamInternal(g)),y=[],b=[];try{for(var h,p=!0,f=(a=void 0,Tn(v));!(i=(h=yield An(f.next())).done);p=!0){c=h.value,p=!1;const e=c;if(yield yield An(e),e.candidates&&(null===(u=e.candidates[0])||void 0===u?void 0:u.content)){b.push(e.candidates[0].content);for(const n of null!==(d=e.candidates[0].content.parts)&&void 0!==d?d:[])if(o<s&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error("Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ".concat(t.keys(),", mising tool: ").concat(n.functionCall.name));{const e=yield An(t.get(n.functionCall.name).callTool([n.functionCall]));y.push(...e)}}}}}catch(m){a={error:m}}finally{try{p||i||!(l=f.return)||(yield An(l.call(f)))}finally{if(a)throw a.error}}if(!(y.length>0))break;{r=!0;const e=new $e;e.candidates=[{content:{role:"user",parts:y}}],yield yield An(e);const t=[];t.push(...b),t.push({role:"user",parts:y});const i=Ft(n.contents).concat(t);n.contents=i}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=ei(this.apiClient,e);return o=L("{model}:generateContent",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=ni(e),n=new $e;return Object.assign(n,t),n})}{const t=Zn(this.apiClient,e);return o=L("{model}:generateContent",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=ti(e),n=new $e;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=ei(this.apiClient,e);o=L("{model}:streamGenerateContent?alt=sse",i._url),a=i._query,delete i._url,delete i._query;return r=this.apiClient.requestStream({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),r.then(function(e){return Cn(this,arguments,function*(){var t,n,i,s;try{for(var r,o=!0,a=Tn(e);!(t=(r=yield An(a.next())).done);o=!0){s=r.value,o=!1;const e=s,t=ni(yield An(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new $e;Object.assign(n,t),yield yield An(n)}}catch(l){n={error:l}}finally{try{o||t||!(i=a.return)||(yield An(i.call(a)))}finally{if(n)throw n.error}}})})}{const t=Zn(this.apiClient,e);o=L("{model}:streamGenerateContent?alt=sse",t._url),a=t._query,delete t._url,delete t._query;return r=this.apiClient.requestStream({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}),r.then(function(e){return Cn(this,arguments,function*(){var t,n,i,s;try{for(var r,o=!0,a=Tn(e);!(t=(r=yield An(a.next())).done);o=!0){s=r.value,o=!1;const e=s,t=ti(yield An(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new $e;Object.assign(n,t),yield yield An(n)}}catch(l){n={error:l}}finally{try{o||t||!(i=a.return)||(yield An(i.call(a)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=$n(this.apiClient,e);return o=L("{model}:predict",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["predictions[]","embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>qn(e))),j(t,["embeddings"],e)}const s=U(e,["metadata"]);return null!=s&&j(t,["metadata"],s),t}(e),n=new Xe;return Object.assign(n,t),n})}{const t=Yn(this.apiClient,e);return o=L("{model}:batchEmbedContents",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["embeddings"],e)}const s=U(e,["metadata"]);return null!=s&&j(t,["metadata"],s),t}(e),n=new Xe;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=si(this.apiClient,e);return o=L("{model}:predict",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>hi(e))),j(t,["generatedImages"],e)}const s=U(e,["positivePromptSafetyAttributes"]);return null!=s&&j(t,["positivePromptSafetyAttributes"],xi(s)),t}(e),n=new Qe;return Object.assign(n,t),n})}{const t=ii(this.apiClient,e);return o=L("{model}:predict",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=ri(e),n=new Qe;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=Kn(this.apiClient,e);return s=L("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>hi(e))),j(t,["generatedImages"],e)}return t}(e),n=new Ze;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=ki(this.apiClient,e);return s=L("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>hi(e))),j(t,["generatedImages"],e)}return t}(e),n=new et;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=wi(this.apiClient,e);return s=L("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=U(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>hi(e))),j(t,["generatedImages"],e)}return t}(e),n=new tt;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=Ei(this.apiClient,e);return s=L("{model}:predict",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=Si(e),n=new nt;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["model"]);return null!=i&&j(n,["_url","name"],Et(e,i)),n}(this.apiClient,e);return o=L("{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>bi(e))}{const t=function(e,t){const n={},i=U(t,["model"]);return null!=i&&j(n,["_url","name"],Et(e,i)),n}(this.apiClient,e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>yi(e))}}async listInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=vi(this.apiClient,e);return o=L("{models_url}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["_self"]);if(null!=s){let e=Kt(s);Array.isArray(e)&&(e=e.map(e=>bi(e))),j(t,["models"],e)}return t}(e),n=new it;return Object.assign(n,t),n})}{const t=gi(this.apiClient,e);return o=L("{models_url}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["_self"]);if(null!=s){let e=Kt(s);Array.isArray(e)&&(e=e.map(e=>yi(e))),j(t,["models"],e)}return t}(e),n=new it;return Object.assign(n,t),n})}}async update(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=Ti(this.apiClient,e);return o=L("{model}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>bi(e))}{const t=Ci(this.apiClient,e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>yi(e))}}async delete(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["model"]);return null!=i&&j(n,["_url","name"],Et(e,i)),n}(this.apiClient,e);return o=L("{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new st;return Object.assign(n,t),n})}{const t=function(e,t){const n={},i=U(t,["model"]);return null!=i&&j(n,["_url","name"],Et(e,i)),n}(this.apiClient,e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new st;return Object.assign(n,t),n})}}async countTokens(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let e=Ft(s);Array.isArray(e)&&(e=e.map(e=>e)),j(n,["contents"],e)}const r=U(t,["config"]);return null!=r&&Gn(r,n),n}(this.apiClient,e);return o=L("{model}:countTokens",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["totalTokens"]);return null!=i&&j(t,["totalTokens"],i),t}(e),n=new rt;return Object.assign(n,t),n})}{const t=Jn(this.apiClient,e);return o=L("{model}:countTokens",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["totalTokens"]);null!=i&&j(t,["totalTokens"],i);const s=U(e,["cachedContentTokenCount"]);return null!=s&&j(t,["cachedContentTokenCount"],s),t}(e),n=new rt;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["_url","model"],Et(e,i));const s=U(t,["contents"]);if(null!=s){let e=Ft(s);Array.isArray(e)&&(e=e.map(e=>e)),j(n,["contents"],e)}return n}(this.apiClient,e);return s=L("{model}:computeTokens",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["tokensInfo"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["tokensInfo"],e)}return t}(e),n=new ot;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=di(this.apiClient,e);return o=L("{model}:predictLongRunning",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=ci(e),n=new at;return Object.assign(n,t),n})}{const t=ui(this.apiClient,e);return o=L("{model}:predictLongRunning",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=li(e),n=new at;return Object.assign(n,t),n})}}}class is extends F{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let i;n&&"httpOptions"in n&&(i=n.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:i}});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let i;n&&"httpOptions"in n&&(i=n.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:i}});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e){const t={},n=U(e,["operationName"]);return null!=n&&j(t,["_url","operationName"],n),t}(e);return o=L("{operationName}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r}{const t=function(e){const t={},n=U(e,["operationName"]);return null!=n&&j(t,["_url","operationName"],n),t}(e);return o=L("{operationName}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r}}async fetchPredictVideosOperationInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=U(e,["operationName"]);null!=n&&j(t,["operationName"],n);const i=U(e,["resourceName"]);return null!=i&&j(t,["_url","resourceName"],i),t}(e);return s=L("{resourceName}:fetchPredictOperation",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i}throw new Error("This method is only supported by the Vertex AI.")}}function ss(e){const t={},n=U(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=U(e,["mediaResolution"]);null!=n&&j(t,["mediaResolution"],n);const i=U(e,["codeExecutionResult"]);null!=i&&j(t,["codeExecutionResult"],i);const s=U(e,["executableCode"]);null!=s&&j(t,["executableCode"],s);const r=U(e,["fileData"]);null!=r&&j(t,["fileData"],function(e){const t={};if(void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=U(e,["fileUri"]);null!=n&&j(t,["fileUri"],n);const i=U(e,["mimeType"]);null!=i&&j(t,["mimeType"],i);return t}(r));const o=U(e,["functionCall"]);null!=o&&j(t,["functionCall"],function(e){const t={},n=U(e,["id"]);null!=n&&j(t,["id"],n);const i=U(e,["args"]);null!=i&&j(t,["args"],i);const s=U(e,["name"]);null!=s&&j(t,["name"],s);if(void 0!==U(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==U(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const a=U(e,["functionResponse"]);null!=a&&j(t,["functionResponse"],a);const l=U(e,["inlineData"]);null!=l&&j(t,["inlineData"],function(e){const t={},n=U(e,["data"]);if(null!=n&&j(t,["data"],n),void 0!==U(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=U(e,["mimeType"]);return null!=i&&j(t,["mimeType"],i),t}(l));const c=U(e,["text"]);null!=c&&j(t,["text"],c);const u=U(e,["thought"]);null!=u&&j(t,["thought"],u);const d=U(e,["thoughtSignature"]);null!=d&&j(t,["thoughtSignature"],d);const h=U(e,["videoMetadata"]);null!=h&&j(t,["videoMetadata"],h);return t}(e))),j(t,["parts"],e)}const i=U(e,["role"]);return null!=i&&j(t,["role"],i),t}function rs(e,t,n){const i=U(t,["expireTime"]);void 0!==n&&null!=i&&j(n,["expireTime"],i);const s=U(t,["newSessionExpireTime"]);void 0!==n&&null!=s&&j(n,["newSessionExpireTime"],s);const r=U(t,["uses"]);void 0!==n&&null!=r&&j(n,["uses"],r);const o=U(t,["liveConnectConstraints"]);void 0!==n&&null!=o&&j(n,["bidiGenerateContentSetup"],function(e,t){const n={},i=U(t,["model"]);null!=i&&j(n,["setup","model"],Et(e,i));const s=U(t,["config"]);null!=s&&j(n,["config"],function(e,t){const n={},i=U(e,["generationConfig"]);void 0!==t&&null!=i&&j(t,["setup","generationConfig"],i);const s=U(e,["responseModalities"]);void 0!==t&&null!=s&&j(t,["setup","generationConfig","responseModalities"],s);const r=U(e,["temperature"]);void 0!==t&&null!=r&&j(t,["setup","generationConfig","temperature"],r);const o=U(e,["topP"]);void 0!==t&&null!=o&&j(t,["setup","generationConfig","topP"],o);const a=U(e,["topK"]);void 0!==t&&null!=a&&j(t,["setup","generationConfig","topK"],a);const l=U(e,["maxOutputTokens"]);void 0!==t&&null!=l&&j(t,["setup","generationConfig","maxOutputTokens"],l);const c=U(e,["mediaResolution"]);void 0!==t&&null!=c&&j(t,["setup","generationConfig","mediaResolution"],c);const u=U(e,["seed"]);void 0!==t&&null!=u&&j(t,["setup","generationConfig","seed"],u);const d=U(e,["speechConfig"]);void 0!==t&&null!=d&&j(t,["setup","generationConfig","speechConfig"],Bt(d));const h=U(e,["thinkingConfig"]);void 0!==t&&null!=h&&j(t,["setup","generationConfig","thinkingConfig"],h);const p=U(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&j(t,["setup","generationConfig","enableAffectiveDialog"],p);const f=U(e,["systemInstruction"]);void 0!==t&&null!=f&&j(t,["setup","systemInstruction"],ss(Ot(f)));const m=U(e,["tools"]);if(void 0!==t&&null!=m){let e=Ht(m);Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==U(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const n=U(e,["computerUse"]);null!=n&&j(t,["computerUse"],n);const i=U(e,["fileSearch"]);null!=i&&j(t,["fileSearch"],i);const s=U(e,["codeExecution"]);null!=s&&j(t,["codeExecution"],s);if(void 0!==U(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=U(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["functionDeclarations"],e)}const o=U(e,["googleMaps"]);null!=o&&j(t,["googleMaps"],function(e){const t={};if(void 0!==U(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=U(e,["enableWidget"]);null!=n&&j(t,["enableWidget"],n);return t}(o));const a=U(e,["googleSearch"]);null!=a&&j(t,["googleSearch"],function(e){const t={};if(void 0!==U(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==U(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=U(e,["timeRangeFilter"]);null!=n&&j(t,["timeRangeFilter"],n);return t}(a));const l=U(e,["googleSearchRetrieval"]);null!=l&&j(t,["googleSearchRetrieval"],l);const c=U(e,["urlContext"]);null!=c&&j(t,["urlContext"],c);return t}(Wt(e)))),j(t,["setup","tools"],e)}const g=U(e,["sessionResumption"]);void 0!==t&&null!=g&&j(t,["setup","sessionResumption"],function(e){const t={},n=U(e,["handle"]);null!=n&&j(t,["handle"],n);if(void 0!==U(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(g));const v=U(e,["inputAudioTranscription"]);void 0!==t&&null!=v&&j(t,["setup","inputAudioTranscription"],v);const y=U(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&j(t,["setup","outputAudioTranscription"],y);const b=U(e,["realtimeInputConfig"]);void 0!==t&&null!=b&&j(t,["setup","realtimeInputConfig"],b);const w=U(e,["contextWindowCompression"]);void 0!==t&&null!=w&&j(t,["setup","contextWindowCompression"],w);const _=U(e,["proactivity"]);void 0!==t&&null!=_&&j(t,["setup","proactivity"],_);if(void 0!==U(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}(s,n));return n}(e,o));const a=U(t,["lockAdditionalFields"]);return void 0!==n&&null!=a&&j(n,["fieldMask"],a),{}}function os(e,t){let n=null;const i=e.bidiGenerateContentSetup;if("object"===typeof i&&null!==i&&"setup"in i){const t=i.setup;"object"===typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==i&&delete e.bidiGenerateContentSetup;const s=e.fieldMask;if(n){const i=function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];if("object"===typeof i&&null!=i&&Object.keys(i).length>0){const e=Object.keys(i).map(e=>"".concat(n,".").concat(e));t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null===t||void 0===t?void 0:t.lockAdditionalFields)&&0===(null===t||void 0===t?void 0:t.lockAdditionalFields.length))i?e.fieldMask=i:delete e.fieldMask;else if((null===t||void 0===t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==s&&Array.isArray(s)&&s.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];s.length>0&&(n=s.map(e=>t.includes(e)?"generationConfig.".concat(e):e));const r=[];i&&r.push(i),n.length>0&&r.push(...n),r.length>0?e.fieldMask=r.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==s&&Array.isArray(s)&&s.length>0?e.fieldMask=s.join(","):delete e.fieldMask;return e}class as extends F{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=function(e,t){const n={},i=U(t,["config"]);return null!=i&&j(n,["config"],rs(e,i,n)),n}(this.apiClient,e);s=L("auth_tokens",o._url),r=o._query,delete o.config,delete o._url,delete o._query;const a=os(o,e.config);return i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}}}function ls(e){const t={},n=U(e,["name"]);null!=n&&j(t,["_url","name"],n);const i=U(e,["config"]);return null!=i&&function(e,t){const n=U(e,["force"]);void 0!==t&&null!=n&&j(t,["_query","force"],n)}(i,t),t}function cs(e){const t={},n=U(e,["parent"]);null!=n&&j(t,["_url","parent"],n);const i=U(e,["config"]);return null!=i&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i)}(i,t),t}class us extends F{constructor(e){super(),this.apiClient=e,this.list=async e=>new pn(Ke.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","name"],n),t}(e);return s=L("{name}",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async delete(e){var t,n;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=ls(e);i=L("{name}",r._url),s=r._query,delete r._url,delete r._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=cs(e);return s=L("{parent}/documents",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["documents"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["documents"],e)}return t}(e),n=new ht;return Object.assign(n,t),n})}}}class ds extends F{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new us(e);super(),t=this,this.apiClient=e,this.documents=n,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pn(Ke.PAGED_ITEM_FILE_SEARCH_STORES,e=>t.listInternal(e),await t.listInternal(e),e)}}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Pi(e);return s=L("fileSearchStores",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async get(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","name"],n),t}(e);return s=L("{name}",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async delete(e){var t,n;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=Mi(e);i=L("{name}",r._url),s=r._query,delete r._url,delete r._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Di(e);return s=L("fileSearchStores",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["fileSearchStores"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["fileSearchStores"],e)}return t}(e),n=new pt;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=U(e,["fileSearchStoreName"]);null!=n&&j(t,["_url","file_search_store_name"],n);const i=U(e,["config"]);return null!=i&&Fi(i,t),t}(e);return s=L("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new ft;return Object.assign(n,t),n})}}async importFile(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Oi(e);return s=L("{file_search_store_name}:importFile",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=Ri(e),n=new mt;return Object.assign(n,t),n})}}}let hs=function(){const{crypto:e}=globalThis;if(null===e||void 0===e?void 0:e.randomUUID)return hs=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^n()&15>>+e/4).toString(16))};function ps(e){return"object"===typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const fs=e=>{if(e instanceof Error)return e;if("object"===typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch(wr){}try{return new Error(JSON.stringify(e))}catch(t){}}return new Error(e)};class ms extends Error{}class gs extends ms{constructor(e,t,n,i){super("".concat(gs.makeMessage(e,t,n))),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,n){const i=(null===t||void 0===t?void 0:t.message)?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?"".concat(e," ").concat(i):e?"".concat(e," status code (no body)"):i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new ys({message:n,cause:fs(t)});const s=t;return 400===e?new ws(e,s,n,i):401===e?new _s(e,s,n,i):403===e?new xs(e,s,n,i):404===e?new Es(e,s,n,i):409===e?new Ss(e,s,n,i):422===e?new As(e,s,n,i):429===e?new Cs(e,s,n,i):e>=500?new Ts(e,s,n,i):new gs(e,s,n,i)}}class vs extends gs{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(void 0,void 0,e||"Request was aborted.",void 0)}}class ys extends gs{constructor(e){let{message:t,cause:n}=e;super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class bs extends ys{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:null!==e&&void 0!==e?e:"Request timed out."})}}class ws extends gs{}class _s extends gs{}class xs extends gs{}class Es extends gs{}class Ss extends gs{}class As extends gs{}class Cs extends gs{}class Ts extends gs{}const ks=/^[a-z][a-z0-9+.-]*:/i;let Is=e=>(Is=Array.isArray,Is(e));const Ns=Is;const Ps="0.0.1";const Ms=()=>{var e,t,n,i,s;const r="undefined"!==typeof Deno&&null!=Deno.build?"deno":"undefined"!==typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call("undefined"!==typeof globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===r)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ps,"X-Stainless-OS":Os(Deno.build.os),"X-Stainless-Arch":Rs(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:null!==(t=null===(e=Deno.version)||void 0===e?void 0:e.deno)&&void 0!==t?t:"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ps,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:".concat(EdgeRuntime),"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===r)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ps,"X-Stainless-OS":Os(null!==(n=globalThis.process.platform)&&void 0!==n?n:"unknown"),"X-Stainless-Arch":Rs(null!==(i=globalThis.process.arch)&&void 0!==i?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!==(s=globalThis.process.version)&&void 0!==s?s:"unknown"};const o=function(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0,i=e[2]||0,s=e[3]||0;return{browser:t,version:"".concat(n,".").concat(i,".").concat(s)}}}return null}();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ps,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:".concat(o.browser),"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ps,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const Rs=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?"other:".concat(e):"unknown",Os=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?"Other:".concat(e):"Unknown";let Ds;function Fs(){const e=globalThis.ReadableStream;if("undefined"===typeof e)throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return new e(...n)}function Ls(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return Fs({start(){},async pull(e){const{done:n,value:i}=await t.next();n?e.close():e.enqueue(i)},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}function js(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null===e||void 0===e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Us=e=>{let{headers:t,body:n}=e;return{bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(n)}},Bs=()=>{var e;if("undefined"===typeof File){const{process:t}=globalThis,n="string"===typeof(null===(e=null===t||void 0===t?void 0:t.versions)||void 0===e?void 0:e.node)&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ws(e,t,n){return Bs(),new File(e,null!==t&&void 0!==t?t:"unknown_file",n)}const Hs=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer;async function Vs(e){var t,n,i,s,r;let o=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)o.push(e);else if(Hs(e))o.push(e instanceof Blob?e:await e.arrayBuffer());else{if(!(e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator])(e)){const t=null===(r=null===e||void 0===e?void 0:e.constructor)||void 0===r?void 0:r.name;throw new Error("Unexpected data type: ".concat(typeof e).concat(t?"; constructor: ".concat(t):"").concat(function(e){if("object"!==typeof e||null===e)return"";const t=Object.getOwnPropertyNames(e);return"; props: [".concat(t.map(e=>'"'.concat(e,'"')).join(", "),"]")}(e)))}try{for(var a,l=!0,c=Tn(e);!(t=(a=await c.next()).done);l=!0){s=a.value,l=!1;const e=s;o.push(...await Vs(e))}}catch(u){n={error:u}}finally{try{l||t||!(i=c.return)||await i.call(c)}finally{if(n)throw n.error}}}return o}class qs{constructor(e){this._client=e}}function zs(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}qs._key=[];const Gs=Object.freeze(Object.create(null)),Js=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zs;return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];if(1===t.length)return t[0];let r=!1;const o=[],a=t.reduce((t,n,s)=>{var a,l,c;/[?#]/.test(n)&&(r=!0);const u=i[s];let d=(r?encodeURIComponent:e)(""+u);return s!==i.length&&(null==u||"object"===typeof u&&u.toString===(null===(c=Object.getPrototypeOf(null!==(l=Object.getPrototypeOf(null!==(a=u.hasOwnProperty)&&void 0!==a?a:Gs))&&void 0!==l?l:Gs))||void 0===c?void 0:c.toString))&&(d=u+"",o.push({start:t.length+n.length,length:d.length,error:"Value of type ".concat(Object.prototype.toString.call(u).slice(8,-1)," is not a valid path parameter")})),t+n+(s===i.length?"":d)},""),l=a.split(/[?#]/,1)[0],c=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let u;for(;null!==(u=c.exec(l));)o.push({start:u.index,length:u[0].length,error:'Value "'.concat(u[0],"\" can't be safely passed as a path parameter")});if(o.sort((e,t)=>e.start-t.start),o.length>0){let e=0;const t=o.reduce((t,n)=>{const i=" ".repeat(n.start-e),s="^".repeat(n.length);return e=n.start+n.length,t+i+s},"");throw new ms("Path parameters result in path with invalid segments:\n".concat(o.map(e=>e.error).join("\n"),"\n").concat(a,"\n").concat(t))}return a}},Ks=Js(zs);class Ys extends qs{create(e,t){var n;const{api_version:i=this._client.apiVersion}=e,s=En(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new ms("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new ms("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Ks(I||(I=k(["/","/interactions"])),i),Object.assign(Object.assign({body:s},t),{stream:null!==(n=e.stream)&&void 0!==n&&n}))}delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const{api_version:i=this._client.apiVersion}=null!==t&&void 0!==t?t:{};return this._client.delete(Ks(N||(N=k(["/","/interactions/",""])),i,e),n)}cancel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const{api_version:i=this._client.apiVersion}=null!==t&&void 0!==t?t:{};return this._client.post(Ks(P||(P=k(["/","/interactions/","/cancel"])),i,e),n)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;var i;const s=null!==t&&void 0!==t?t:{},{api_version:r=this._client.apiVersion}=s,o=En(s,["api_version"]);return this._client.get(Ks(M||(M=k(["/","/interactions/",""])),r,e),Object.assign(Object.assign({query:o},n),{stream:null!==(i=null===t||void 0===t?void 0:t.stream)&&void 0!==i&&i}))}}Ys._key=Object.freeze(["interactions"]);class $s extends Ys{}let Xs,Qs;function Zs(e){let t;return(null!==Xs&&void 0!==Xs?Xs:(t=new globalThis.TextEncoder,Xs=t.encode.bind(t)))(e)}function er(e){let t;return(null!==Qs&&void 0!==Qs?Qs:(t=new globalThis.TextDecoder,Qs=t.decode.bind(t)))(e)}class tr{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?Zs(e):e;this.buffer=function(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;return n}([this.buffer,t]);const n=[];let i;for(;null!=(i=nr(this.buffer,this.carriageReturnIndex));){if(i.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=i.index;continue}if(null!=this.carriageReturnIndex&&(i.index!==this.carriageReturnIndex+1||i.carriage)){n.push(er(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const e=null!==this.carriageReturnIndex?i.preceding-1:i.preceding,t=er(this.buffer.subarray(0,e));n.push(t),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode("\n"):[]}}function nr(e,t){for(let n=null!==t&&void 0!==t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function ir(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}tr.NEWLINE_CHARS=new Set(["\n","\r"]),tr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const sr={off:0,error:200,warn:300,info:400,debug:500},rr=(e,t,n)=>{var i,s;if(e)return i=sr,s=e,Object.prototype.hasOwnProperty.call(i,s)?e:void ur(n).warn("".concat(t," was set to ").concat(JSON.stringify(e),", expected one of ").concat(JSON.stringify(Object.keys(sr))))};function or(){}function ar(e,t,n){return!t||sr[e]>sr[n]?or:t[e].bind(t)}const lr={error:or,warn:or,info:or,debug:or};let cr=new WeakMap;function ur(e){var t;const n=e.logger,i=null!==(t=e.logLevel)&&void 0!==t?t:"off";if(!n)return lr;const s=cr.get(n);if(s&&s[0]===i)return s[1];const r={error:ar("error",n,i),warn:ar("warn",n,i),info:ar("info",n,i),debug:ar("debug",n,i)};return cr.set(n,[i,r]),r}const dr=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(e=>{let[t,n]=e;return[t,"x-goog-api-key"===t.toLowerCase()||"authorization"===t.toLowerCase()||"cookie"===t.toLowerCase()||"set-cookie"===t.toLowerCase()?"***":n]}))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class hr{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let i=!1;const s=n?ur(n):console;return new hr(function(){return Cn(this,arguments,function*(){var n,r,o,a;if(i)throw new ms("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let l=!1;try{try{for(var c,u=!0,d=Tn(function(e,t){return Cn(this,arguments,function*(){var n,i,s,r;if(!e.body){if(t.abort(),"undefined"!==typeof globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new ms("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new ms("Attempted to iterate over a response with no body")}const o=new pr,a=new tr,l=js(e.body);try{for(var c,u=!0,d=Tn(function(e){return Cn(this,arguments,function*(){var t,n,i,s;let r=new Uint8Array;try{for(var o,a=!0,l=Tn(e);!(t=(o=yield An(l.next())).done);a=!0){s=o.value,a=!1;const e=s;if(null==e)continue;const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?Zs(e):e;let n,i=new Uint8Array(r.length+t.length);for(i.set(r),i.set(t,r.length),r=i;-1!==(n=ir(r));)yield yield An(r.slice(0,n)),r=r.slice(n)}}catch(c){n={error:c}}finally{try{a||t||!(i=l.return)||(yield An(i.call(l)))}finally{if(n)throw n.error}}r.length>0&&(yield yield An(r))})}(l));!(n=(c=yield An(d.next())).done);u=!0){r=c.value,u=!1;const e=r;for(const t of a.decode(e)){const e=o.decode(t);e&&(yield yield An(e))}}}catch(h){i={error:h}}finally{try{u||n||!(s=d.return)||(yield An(s.call(d)))}finally{if(i)throw i.error}}for(const e of a.flush()){const t=o.decode(e);t&&(yield yield An(t))}})}(e,t));!(n=(c=yield An(d.next())).done);u=!0){a=c.value,u=!1;const e=a;if(!l)if(e.data.startsWith("[DONE]"))l=!0;else try{yield yield An(JSON.parse(e.data))}catch(h){throw s.error("Could not parse message into JSON:",e.data),s.error("From chunk:",e.raw),h}}}catch(p){r={error:p}}finally{try{u||n||!(o=d.return)||(yield An(o.call(d)))}finally{if(r)throw r.error}}l=!0}catch(h){if(ps(h))return yield An(void 0);throw h}finally{l||t.abort()}})},t,n)}static fromReadableStream(e,t,n){let i=!1;return new hr(function(){return Cn(this,arguments,function*(){var n,s,r,o;if(i)throw new ms("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let a=!1;try{try{for(var l,c=!0,u=Tn(function(){return Cn(this,arguments,function*(){var t,n,i,s;const r=new tr,o=js(e);try{for(var a,l=!0,c=Tn(o);!(t=(a=yield An(c.next())).done);l=!0){s=a.value,l=!1;const e=s;for(const t of r.decode(e))yield yield An(t)}}catch(u){n={error:u}}finally{try{l||t||!(i=c.return)||(yield An(i.call(c)))}finally{if(n)throw n.error}}for(const e of r.flush())yield yield An(e)})}());!(n=(l=yield An(u.next())).done);c=!0){o=l.value,c=!1;const e=o;a||e&&(yield yield An(JSON.parse(e)))}}catch(d){s={error:d}}finally{try{c||n||!(r=u.return)||(yield An(r.call(u)))}finally{if(s)throw s.error}}a=!0}catch(h){if(ps(h))return yield An(void 0);throw h}finally{a||t.abort()}})},t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=i=>({next:()=>{if(0===i.length){const i=n.next();e.push(i),t.push(i)}return i.shift()}});return[new hr(()=>i(e),this.controller,this.client),new hr(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Fs({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:n,done:i}=await t.next();if(i)return e.close();const s=Zs(JSON.stringify(n)+"\n");e.enqueue(s)}catch(n){e.error(n)}},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}}class pr{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return i.startsWith(" ")&&(i=i.substring(1)),"event"===t?this.event=i:"data"===t&&this.data.push(i),null}}async function fr(e,t){const{response:n,requestLogID:i,retryOfRequestLogID:s,startTime:r}=t,o=await(async()=>{var i;if(t.options.stream)return ur(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):hr.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;const s=n.headers.get("content-type"),r=null===(i=null===s||void 0===s?void 0:s.split(";")[0])||void 0===i?void 0:i.trim();if((null===r||void 0===r?void 0:r.includes("application/json"))||(null===r||void 0===r?void 0:r.endsWith("+json"))){return await n.json()}return await n.text()})();return ur(e).debug("[".concat(i,"] response parsed"),dr({retryOfRequestLogID:s,url:n.url,status:n.status,body:o,durationMs:Date.now()-r})),o}class mr extends Promise{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fr;super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new mr(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const gr=Symbol("brand.privateNullableHeaders");function*vr(e){if(!e)return;if(gr in e){const{values:t,nulls:n}=e;yield*t.entries();for(const e of n)yield[e,null];return}let t,n=!1;e instanceof Headers?t=e.entries():Ns(e)?t=e:(n=!0,t=Object.entries(null!==e&&void 0!==e?e:{}));for(let i of t){const e=i[0];if("string"!==typeof e)throw new TypeError("expected header name to be a string");const t=Ns(i[1])?i[1]:[i[1]];let s=!1;for(const i of t)void 0!==i&&(n&&!s&&(s=!0,yield[e,null]),yield[e,i])}}const yr=e=>{const t=new Headers,n=new Set;for(const i of e){const e=new Set;for(const[s,r]of vr(i)){const i=s.toLowerCase();e.has(i)||(t.delete(s),e.add(i)),null===r?(t.delete(s),n.add(i)):(t.append(s,r),n.delete(i))}}return{[gr]:!0,values:t,nulls:n}},br=e=>{var t,n,i,s,r,o;return"undefined"!==typeof globalThis.process?null!==(i=null===(n=null===(t=globalThis.process.env)||void 0===t?void 0:t[e])||void 0===n?void 0:n.trim())&&void 0!==i?i:void 0:"undefined"!==typeof globalThis.Deno?null===(o=null===(r=null===(s=globalThis.Deno.env)||void 0===s?void 0:s.get)||void 0===r?void 0:r.call(s,e))||void 0===o?void 0:o.trim():void 0};var wr;class _r{constructor(e){var t,n,i,s,r,o,a,{baseURL:l=br("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:c=(null!==(t=br("GEMINI_API_KEY"))&&void 0!==t?t:null),apiVersion:u="v1beta"}=e,d=En(e,["baseURL","apiKey","apiVersion"]);const h=Object.assign(Object.assign({apiKey:c,apiVersion:u},d),{baseURL:l||"https://generativelanguage.googleapis.com"});this.baseURL=h.baseURL,this.timeout=null!==(n=h.timeout)&&void 0!==n?n:_r.DEFAULT_TIMEOUT,this.logger=null!==(i=h.logger)&&void 0!==i?i:console;const p="warn";this.logLevel=p,this.logLevel=null!==(r=null!==(s=rr(h.logLevel,"ClientOptions.logLevel",this))&&void 0!==s?s:rr(br("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))&&void 0!==r?r:p,this.fetchOptions=h.fetchOptions,this.maxRetries=null!==(o=h.maxRetries)&&void 0!==o?o:2,this.fetch=null!==(a=h.fetch)&&void 0!==a?a:function(){if("undefined"!==typeof fetch)return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=Us,this._options=h,this.apiKey=c,this.apiVersion=u,this.clientAdapter=h.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders(e){let{values:t,nulls:n}=e;if(!t.has("authorization")&&!t.has("x-goog-api-key")&&(!this.apiKey||!t.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=yr([e.headers]);if(!t.values.has("authorization")&&!t.values.has("x-goog-api-key"))return this.apiKey?yr([{"x-goog-api-key":this.apiKey}]):this.clientAdapter.isVertexAI()?yr([await this.clientAdapter.getAuthHeaders()]):void 0}stringifyQuery(e){return Object.entries(e).filter(e=>{let[t,n]=e;return"undefined"!==typeof n}).map(e=>{let[t,n]=e;if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n));if(null===n)return"".concat(encodeURIComponent(t),"=");throw new ms("Cannot stringify type ".concat(typeof n,"; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case."))}).join("&")}getUserAgent(){return"".concat(this.constructor.name,"/JS ").concat(Ps)}defaultIdempotencyKey(){return"stainless-node-retry-".concat(hs())}makeStatusError(e,t,n,i){return gs.generate(e,t,n,i)}buildURL(e,t,n){const i=!this.baseURLOverridden()&&n||this.baseURL,s=(e=>ks.test(e))(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return function(e){if(!e)return!0;for(const t in e)return!1;return!0}(r)||(t=Object.assign(Object.assign({},r),t)),"object"===typeof t&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith("/".concat(this.apiVersion,"/projects/"))){const t=e.path.slice(this.apiVersion.length+1);e.path="/".concat(this.apiVersion,"/projects/").concat(this.clientAdapter.getProject(),"/locations/").concat(this.clientAdapter.getLocation()).concat(t)}}async prepareRequest(e,t){let{url:n,options:i}=t}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>Object.assign({method:e,path:t},n)))}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new mr(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var i,s,r;const o=await e,a=null!==(i=o.maxRetries)&&void 0!==i?i:this.maxRetries;null==t&&(t=a),await this.prepareOptions(o);const{req:l,url:c,timeout:u}=await this.buildRequest(o,{retryCount:a-t});await this.prepareRequest(l,{url:c,options:o});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),h=void 0===n?"":", retryOf: ".concat(n),p=Date.now();if(ur(this).debug("[".concat(d,"] sending request"),dr({retryOfRequestLogID:n,method:o.method,url:c,options:o,headers:l.headers})),null===(s=o.signal)||void 0===s?void 0:s.aborted)throw new vs;const f=new AbortController,m=await this.fetchWithTimeout(c,l,u,f).catch(fs),g=Date.now();if(m instanceof globalThis.Error){const e="retrying, ".concat(t," attempts remaining");if(null===(r=o.signal)||void 0===r?void 0:r.aborted)throw new vs;const i=ps(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return ur(this).info("[".concat(d,"] connection ").concat(i?"timed out":"failed"," - ").concat(e)),ur(this).debug("[".concat(d,"] connection ").concat(i?"timed out":"failed"," (").concat(e,")"),dr({retryOfRequestLogID:n,url:c,durationMs:g-p,message:m.message})),this.retryRequest(o,t,null!==n&&void 0!==n?n:d);if(ur(this).info("[".concat(d,"] connection ").concat(i?"timed out":"failed"," - error; no more retries left")),ur(this).debug("[".concat(d,"] connection ").concat(i?"timed out":"failed"," (error; no more retries left)"),dr({retryOfRequestLogID:n,url:c,durationMs:g-p,message:m.message})),i)throw new bs;throw new ys({cause:m})}const v="[".concat(d).concat(h,"] ").concat(l.method," ").concat(c," ").concat(m.ok?"succeeded":"failed"," with status ").concat(m.status," in ").concat(g-p,"ms");if(!m.ok){const e=await this.shouldRetry(m);if(t&&e){const e="retrying, ".concat(t," attempts remaining");return await async function(e){var t,n;if(null===e||"object"!==typeof e)return;if(e[Symbol.asyncIterator])return void await(null===(n=(t=e[Symbol.asyncIterator]()).return)||void 0===n?void 0:n.call(t));const i=e.getReader(),s=i.cancel();i.releaseLock(),await s}(m.body),ur(this).info("".concat(v," - ").concat(e)),ur(this).debug("[".concat(d,"] response error (").concat(e,")"),dr({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-p})),this.retryRequest(o,t,null!==n&&void 0!==n?n:d,m.headers)}const i=e?"error; no more retries left":"error; not retryable";ur(this).info("".concat(v," - ").concat(i));const s=await m.text().catch(e=>fs(e).message),r=(e=>{try{return JSON.parse(e)}catch(t){return}})(s),a=r?void 0:s;ur(this).debug("[".concat(d,"] response error (").concat(i,")"),dr({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:a,durationMs:Date.now()-p}));throw this.makeStatusError(m.status,r,a,m.headers)}return ur(this).info(v),ur(this).debug("[".concat(d,"] response start"),dr({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-p})),{response:m,options:o,controller:f,requestLogID:d,retryOfRequestLogID:n,startTime:p}}async fetchWithTimeout(e,t,n,i){const s=t||{},{signal:r,method:o}=s,a=En(s,["signal","method"]);r&&r.addEventListener("abort",()=>i.abort());const l=setTimeout(()=>i.abort(),n),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||"object"===typeof a.body&&null!==a.body&&Symbol.asyncIterator in a.body,u=Object.assign(Object.assign(Object.assign({signal:i.signal},c?{duplex:"half"}:{}),{method:"GET"}),a);o&&(u.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(l)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n,i){var s;let r;const o=null===i||void 0===i?void 0:i.get("retry-after-ms");if(o){const e=parseFloat(o);Number.isNaN(e)||(r=e)}const a=null===i||void 0===i?void 0:i.get("retry-after");if(a&&!r){const e=parseFloat(a);r=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=null!==(s=e.maxRetries)&&void 0!==s?s:this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}var l;return await(l=r,new Promise(e=>setTimeout(e,l))),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}async buildRequest(e){let{retryCount:t=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i,s;const r=Object.assign({},e),{method:o,path:a,query:l,defaultBaseURL:c}=r,u=this.buildURL(a,l,c);"timeout"in r&&((e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new ms("".concat(e," must be an integer"));if(t<0)throw new ms("".concat(e," must be a positive integer"))})("timeout",r.timeout),r.timeout=null!==(n=r.timeout)&&void 0!==n?n:this.timeout;const{bodyHeaders:d,body:h}=this.buildBody({options:r}),p=await this.buildHeaders({options:e,method:o,bodyHeaders:d,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:p},r.signal&&{signal:r.signal}),globalThis.ReadableStream&&h instanceof globalThis.ReadableStream&&{duplex:"half"}),h&&{body:h}),null!==(i=this.fetchOptions)&&void 0!==i?i:{}),null!==(s=r.fetchOptions)&&void 0!==s?s:{}),url:u,timeout:r.timeout}}async buildHeaders(e){let{options:t,method:n,bodyHeaders:i,retryCount:s}=e,r={};this.idempotencyHeader&&"get"!==n&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=t.idempotencyKey);const o=await this.authHeaders(t);let a=yr([r,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),null!==Ds&&void 0!==Ds?Ds:Ds=Ms()),this._options.defaultHeaders,i,t.headers,o]);return this.validateHeaders(a),a.values}buildBody(e){let{options:{body:t,headers:n}}=e;if(!t)return{bodyHeaders:void 0,body:void 0};const i=yr([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||"string"===typeof t&&i.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:"object"===typeof t&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&"function"===typeof t.next)?{bodyHeaders:void 0,body:Ls(t)}:this.encoder({body:t,headers:i})}}_r.DEFAULT_TIMEOUT=6e4;class xr extends _r{constructor(){super(...arguments),this.interactions=new $s(this)}}function Er(e,t){const n={},i=U(e,["baseModel"]);null!=i&&j(n,["baseModel"],i);const s=U(e,["preTunedModel"]);null!=s&&j(n,["preTunedModel"],s);const r=U(e,["trainingDataset"]);null!=r&&function(e){const t={};if(void 0!==U(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==U(e,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=U(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),j(t,["examples","examples"],e)}}(r);const o=U(e,["config"]);return null!=o&&function(e,t){const n={};if(void 0!==U(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const i=U(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=i&&j(t,["displayName"],i),void 0!==U(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const s=U(e,["epochCount"]);void 0!==t&&null!=s&&j(t,["tuningTask","hyperparameters","epochCount"],s);const r=U(e,["learningRateMultiplier"]);if(null!=r&&j(n,["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==U(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==U(e,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==U(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const o=U(e,["batchSize"]);void 0!==t&&null!=o&&j(t,["tuningTask","hyperparameters","batchSize"],o);const a=U(e,["learningRate"]);if(void 0!==t&&null!=a&&j(t,["tuningTask","hyperparameters","learningRate"],a),void 0!==U(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");if(void 0!==U(e,["beta"]))throw new Error("beta parameter is not supported in Gemini API.")}(o,n),n}function Sr(e,t){const n={},i=U(e,["baseModel"]);null!=i&&j(n,["baseModel"],i);const s=U(e,["preTunedModel"]);null!=s&&j(n,["preTunedModel"],s);const r=U(e,["trainingDataset"]);null!=r&&function(e,t,n){const i={};let s=U(n,["config","method"]);void 0===s&&(s="SUPERVISED_FINE_TUNING");if("SUPERVISED_FINE_TUNING"===s){const n=U(e,["gcsUri"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===s){const n=U(e,["gcsUri"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let r=U(n,["config","method"]);void 0===r&&(r="SUPERVISED_FINE_TUNING");if("SUPERVISED_FINE_TUNING"===r){const n=U(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===r){const n=U(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==U(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.")}(r,n,t);const o=U(e,["config"]);return null!=o&&function(e,t,n){let i=U(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){const n=U(e,["validationDataset"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec"],Ir(n))}else if("PREFERENCE_TUNING"===i){const n=U(e,["validationDataset"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec"],Ir(n))}const s=U(e,["tunedModelDisplayName"]);void 0!==t&&null!=s&&j(t,["tunedModelDisplayName"],s);const r=U(e,["description"]);void 0!==t&&null!=r&&j(t,["description"],r);let o=U(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){const n=U(e,["epochCount"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===o){const n=U(e,["epochCount"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let a=U(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){const n=U(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===a){const n=U(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let l=U(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){const n=U(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===l){const n=U(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let c=U(n,["config","method"]);if(void 0===c&&(c="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===c){const n=U(e,["adapterSize"]);void 0!==t&&null!=n&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===c){const n=U(e,["adapterSize"]);void 0!==t&&null!=n&&j(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==U(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==U(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");const u=U(e,["labels"]);void 0!==t&&null!=u&&j(t,["labels"],u);const d=U(e,["beta"]);void 0!==t&&null!=d&&j(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(o,n,t),n}function Ar(e,t){const n={},i=U(e,["config"]);return null!=i&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i);const s=U(e,["filter"]);void 0!==t&&null!=s&&j(t,["_query","filter"],s)}(i,n),n}function Cr(e,t){const n={},i=U(e,["config"]);return null!=i&&function(e,t){const n=U(e,["pageSize"]);void 0!==t&&null!=n&&j(t,["_query","pageSize"],n);const i=U(e,["pageToken"]);void 0!==t&&null!=i&&j(t,["_query","pageToken"],i);const s=U(e,["filter"]);void 0!==t&&null!=s&&j(t,["_query","filter"],s)}(i,n),n}function Tr(e,t){const n={},i=U(e,["sdkHttpResponse"]);null!=i&&j(n,["sdkHttpResponse"],i);const s=U(e,["name"]);null!=s&&j(n,["name"],s);const r=U(e,["state"]);null!=r&&j(n,["state"],qt(r));const o=U(e,["createTime"]);null!=o&&j(n,["createTime"],o);const a=U(e,["tuningTask","startTime"]);null!=a&&j(n,["startTime"],a);const l=U(e,["tuningTask","completeTime"]);null!=l&&j(n,["endTime"],l);const c=U(e,["updateTime"]);null!=c&&j(n,["updateTime"],c);const u=U(e,["description"]);null!=u&&j(n,["description"],u);const d=U(e,["baseModel"]);null!=d&&j(n,["baseModel"],d);const h=U(e,["_self"]);return null!=h&&j(n,["tunedModel"],function(e){const t={},n=U(e,["name"]);null!=n&&j(t,["model"],n);const i=U(e,["name"]);return null!=i&&j(t,["endpoint"],i),t}(h)),n}function kr(e,t){const n={},i=U(e,["sdkHttpResponse"]);null!=i&&j(n,["sdkHttpResponse"],i);const s=U(e,["name"]);null!=s&&j(n,["name"],s);const r=U(e,["state"]);null!=r&&j(n,["state"],qt(r));const o=U(e,["createTime"]);null!=o&&j(n,["createTime"],o);const a=U(e,["startTime"]);null!=a&&j(n,["startTime"],a);const l=U(e,["endTime"]);null!=l&&j(n,["endTime"],l);const c=U(e,["updateTime"]);null!=c&&j(n,["updateTime"],c);const u=U(e,["error"]);null!=u&&j(n,["error"],u);const d=U(e,["description"]);null!=d&&j(n,["description"],d);const h=U(e,["baseModel"]);null!=h&&j(n,["baseModel"],h);const p=U(e,["tunedModel"]);null!=p&&j(n,["tunedModel"],p);const f=U(e,["preTunedModel"]);null!=f&&j(n,["preTunedModel"],f);const m=U(e,["supervisedTuningSpec"]);null!=m&&j(n,["supervisedTuningSpec"],m);const g=U(e,["preferenceOptimizationSpec"]);null!=g&&j(n,["preferenceOptimizationSpec"],g);const v=U(e,["tuningDataStats"]);null!=v&&j(n,["tuningDataStats"],v);const y=U(e,["encryptionSpec"]);null!=y&&j(n,["encryptionSpec"],y);const b=U(e,["partnerModelTuningSpec"]);null!=b&&j(n,["partnerModelTuningSpec"],b);const w=U(e,["customBaseModel"]);null!=w&&j(n,["customBaseModel"],w);const _=U(e,["experiment"]);null!=_&&j(n,["experiment"],_);const x=U(e,["labels"]);null!=x&&j(n,["labels"],x);const E=U(e,["outputUri"]);null!=E&&j(n,["outputUri"],E);const S=U(e,["pipelineJob"]);null!=S&&j(n,["pipelineJob"],S);const A=U(e,["serviceAccount"]);null!=A&&j(n,["serviceAccount"],A);const C=U(e,["tunedModelDisplayName"]);null!=C&&j(n,["tunedModelDisplayName"],C);const T=U(e,["veoTuningSpec"]);return null!=T&&j(n,["veoTuningSpec"],T),n}function Ir(e,t){const n={},i=U(e,["gcsUri"]);null!=i&&j(n,["validationDatasetUri"],i);const s=U(e,["vertexDatasetResource"]);return null!=s&&j(n,["validationDatasetUri"],s),n}wr=xr,xr.GeminiNextGenAPIClient=wr,xr.GeminiNextGenAPIClientError=ms,xr.APIError=gs,xr.APIConnectionError=ys,xr.APIConnectionTimeoutError=bs,xr.APIUserAbortError=vs,xr.NotFoundError=Es,xr.ConflictError=Ss,xr.RateLimitError=Cs,xr.BadRequestError=ws,xr.AuthenticationError=_s,xr.InternalServerError=Ts,xr.PermissionDeniedError=xs,xr.UnprocessableEntityError=As,xr.toFile=async function(e,t,n){if(Bs(),(e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&Hs(e))(e=await e))return e instanceof File?e:Ws([await e.arrayBuffer()],e.name);if((e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob)(e)){const i=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Ws(await Vs(i),t,n)}const i=await Vs(e);if(t||(t=function(e){return("object"===typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}(e)),!(null===n||void 0===n?void 0:n.type)){const e=i.find(e=>"object"===typeof e&&"type"in e&&e.type);"string"===typeof e&&(n=Object.assign(Object.assign({},n),{type:e}))}return Ws(i,t,n)},xr.Interactions=$s;class Nr extends F{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pn(Ke.PAGED_ITEM_TUNING_JOBS,e=>t.listInternal(e),await t.listInternal(e),e)},this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){const n={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);const i=Object.assign(Object.assign({},e),{preTunedModel:n});return i.baseModel=void 0,await this.tuneInternal(i)}{const t=Object.assign({},e);return await this.tuneInternal(t)}}{const t=Object.assign({},e),n=await this.tuneMldevInternal(t);let i="";void 0!==n.metadata&&void 0!==n.metadata.tunedModel?i=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]);return{name:i,state:ve.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","name"],n),t}(e);return o=L("{name}",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>kr(e))}{const t=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","name"],n),t}(e);return o=L("{name}",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>Tr(e))}}async listInternal(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=Cr(e);return o=L("tuningJobs",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["tuningJobs"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>kr(e))),j(t,["tuningJobs"],e)}return t}(e),n=new lt;return Object.assign(n,t),n})}{const t=Ar(e);return o=L("tunedModels",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["nextPageToken"]);null!=i&&j(t,["nextPageToken"],i);const s=U(e,["tunedModels"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>Tr(e))),j(t,["tuningJobs"],e)}return t}(e),n=new lt;return Object.assign(n,t),n})}}async cancel(e){var t,n,i,s;let r,o="",a={};if(this.apiClient.isVertexAI()){const i=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","name"],n),t}(e);return o=L("{name}:cancel",i._url),a=i._query,delete i._url,delete i._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new ct;return Object.assign(n,t),n})}{const t=function(e){const t={},n=U(e,["name"]);return null!=n&&j(t,["_url","name"],n),t}(e);return o=L("{name}:cancel",t._url),a=t._query,delete t._url,delete t._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=U(e,["sdkHttpResponse"]);return null!=n&&j(t,["sdkHttpResponse"],n),t}(e),n=new ct;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI()){const o=Sr(e,e);return s=L("tuningJobs",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>kr(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Er(e);return s=L("tunedModels",o._url),r=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>function(e){const t={},n=U(e,["sdkHttpResponse"]);null!=n&&j(t,["sdkHttpResponse"],n);const i=U(e,["name"]);null!=i&&j(t,["name"],i);const s=U(e,["metadata"]);null!=s&&j(t,["metadata"],s);const r=U(e,["done"]);null!=r&&j(t,["done"],r);const o=U(e,["error"]);return null!=o&&j(t,["error"],o),t}(e))}}}class Pr{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Mr="x-goog-upload-status";async function Rr(e,t,n){var i,s;let r=0,o=0,a=new Ye(new Response),l="upload";for(r=e.size;o<r;){const c=Math.min(8388608,r-o),u=e.slice(o,o+c);o+c>=r&&(l+=", finalize");let d=0,h=1e3;for(;d<3&&(a=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(c)}}}),!(null===(i=null===a||void 0===a?void 0:a.headers)||void 0===i?void 0:i[Mr]));)d++,await Or(h),h*=2;if(o+=c,"active"!==(null===(s=null===a||void 0===a?void 0:a.headers)||void 0===s?void 0:s[Mr]))break;if(r<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}function Or(e){return new Promise(t=>setTimeout(t,e))}class Dr{async upload(e,t,n){if("string"===typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var i;const s=await Rr(e,t,n),r=await(null===s||void 0===s?void 0:s.json());if("final"!==(null===(i=null===s||void 0===s?void 0:s.headers)||void 0===i?void 0:i[Mr]))throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"===typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var i;const s=await Rr(e,t,n),r=await(null===s||void 0===s?void 0:s.json());if("final"!==(null===(i=null===s||void 0===s?void 0:s.headers)||void 0===i?void 0:i[Mr]))throw new Error("Failed to upload file: Upload status is not finalized.");const o=z(r),a=new xt;return Object.assign(a,o),a}(e,t,n)}async stat(e){if("string"===typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}class Fr{create(e,t,n){return new Lr(e,t,n)}}class Lr{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const jr="x-goog-api-key";class Ur{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(jr)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(jr,this.apiKey)}}}class Br{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;(null===e||void 0===e?void 0:e.extraBody)&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new xr({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null===e||void 0===e?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=D(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new Ur(this.apiKey);this.apiClient=new Ui({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new Dr,downloader:new Pr}),this.models=new ns(this.apiClient),this.live=new Yi(this.apiClient,i,new Fr),this.batches=new fn(this.apiClient),this.chats=new Pn(this.models,this.apiClient),this.caches=new xn(this.apiClient),this.files=new Dn(this.apiClient),this.operations=new is(this.apiClient),this.authTokens=new as(this.apiClient),this.tunings=new Nr(this.apiClient),this.fileSearchStores=new ds(this.apiClient)}}const Wr=e=>{if(!e)return"";return String(e).replace(/\D/g,"")},Hr=e=>{if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=e.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);if(t){const e=t[1].padStart(2,"0"),n=t[2].padStart(2,"0"),i=t[3];return"".concat(i,"-").concat(n,"-").concat(e)}return e},Vr=e=>{if("number"===typeof e)return e;if(!e)return 0;let t=String(e);t.includes(",")&&!t.includes("US")&&(t=t.replace(/\./g,"").replace(",",".")),t=t.replace(/[^\d.-]/g,"");const n=parseFloat(t);return isNaN(n)?0:n};function qr(e){if(Array.isArray(e))return e.map(e=>qr(e));if("object"===typeof e&&null!==e){const t={};for(const n in e){const i=e[n];n.includes("cpf")||n.includes("cnpj")||n.includes("documento_numero")?t[n]=Wr(i):n.includes("data")||"vigencia_data_inicial"===n||"vigencia_data_final"===n?t[n]=Hr(i):n.includes("valor")||n.includes("saldo")||n.includes("remuneracao")||n.includes("montante")?t[n]=Vr(i):t[n]="object"===typeof i?qr(i):i}return t}return e}let zr=null;"undefined"===typeof window&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"sua_chave_aqui",REACT_APP_OCR_API:"http://localhost:8000",REACT_APP_API_TIMEOUT:"60000"}.API_KEY&&(zr=new Br({apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"sua_chave_aqui",REACT_APP_OCR_API:"http://localhost:8000",REACT_APP_API_TIMEOUT:"60000"}.API_KEY}));const Gr={type:Y.OBJECT,properties:{documento_numero:{type:Y.STRING,description:"CNPJ or CPF numbers only"},nome:{type:Y.STRING},documento_tipo:{type:Y.NUMBER,description:"2 for CNPJ, 1 for CPF"}}},Jr={type:Y.OBJECT,properties:{numero:{type:Y.STRING},data_emissao:{type:Y.STRING,description:"YYYY-MM-DD"},valor_bruto:{type:Y.NUMBER},credor:Gr,descricao:{type:Y.STRING},categoria_despesas_tipo:{type:Y.NUMBER}}},Kr={type:Y.OBJECT,properties:{cpf:{type:Y.STRING},data_admissao:{type:Y.STRING},salario_contratual:{type:Y.NUMBER},cbo:{type:Y.STRING},periodos_remuneracao:{type:Y.ARRAY,items:{type:Y.OBJECT,properties:{mes:{type:Y.NUMBER},carga_horaria:{type:Y.NUMBER},remuneracao_bruta:{type:Y.NUMBER}}}}}},Yr={type:Y.OBJECT,properties:{numero:{type:Y.STRING},objeto:{type:Y.STRING},data_assinatura:{type:Y.STRING},valor_montante:{type:Y.NUMBER},vigencia_data_inicial:{type:Y.STRING},credor:Gr}},$r={type:Y.OBJECT,properties:{pagamento_data:{type:Y.STRING},pagamento_valor:{type:Y.NUMBER},numero_transacao:{type:Y.STRING},identificacao_documento_fiscal:{type:Y.OBJECT,properties:{numero:{type:Y.STRING}}},meio_pagamento_tipo:{type:Y.NUMBER}}};Y.OBJECT,Y.STRING,Y.STRING,Y.STRING,Y.NUMBER,Y.OBJECT,Y.NUMBER,Y.NUMBER,Y.STRING,Y.NUMBER,Y.NUMBER,Y.OBJECT,Y.STRING,Y.NUMBER,Y.STRING,Y.OBJECT,Y.STRING,Y.STRING,Y.STRING,Y.NUMBER;async function Xr(e,t){const n={type:Y.OBJECT,properties:{descritor:{type:Y.OBJECT,properties:{ano:{type:Y.NUMBER},mes:{type:Y.NUMBER},entidade:{type:Y.NUMBER},municipio:{type:Y.NUMBER}}},relacao_empregados:{type:Y.ARRAY,items:Kr},contratos:{type:Y.ARRAY,items:Yr},documentos_fiscais:{type:Y.ARRAY,items:Jr},pagamentos:{type:Y.ARRAY,items:$r},empenhos:{type:Y.ARRAY,items:{type:Y.OBJECT,properties:{numero:{type:Y.STRING},data_emissao:{type:Y.STRING},valor:{type:Y.NUMBER},historico:{type:Y.STRING}}}},repasses:{type:Y.ARRAY,items:{type:Y.OBJECT,properties:{data_repasse:{type:Y.STRING},valor_repasse:{type:Y.NUMBER},numero_documento:{type:Y.STRING}}}}}};try{const i=await zr.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{inlineData:{mimeType:t,data:e}},{text:"\n    You are an expert accountant and auditor for TCESP Audesp Phase V.\n    Analyze this ENTIRE document (Accountability Report / Presta\xe7\xe3o de Contas).\n    \n    Your task is to identify and extract ALL relevant sections into a single JSON structure.\n    \n    1. Identify the 'Descritor' (Year, Month, Entity, City).\n    2. Identify 'Empregados' (Payroll).\n    3. Identify 'Contratos' (Contracts).\n    4. Identify 'Documentos Fiscais' (Invoices, Receipts).\n    5. Identify 'Pagamentos' (Bank transfers, checks).\n    6. Identify 'Empenhos' (Commitments).\n    7. Identify 'Repasses' (Transfers received).\n    \n    If a section is not found, return an empty array for it.\n    Normalize all dates to YYYY-MM-DD.\n    Normalize all values to float (e.g. 1250.50).\n    Clean CPF/CNPJ (numbers only).\n    "}]},config:{responseMimeType:"application/json",responseSchema:n}});if(i.text){return qr(JSON.parse(i.text))}return null}catch(i){throw console.error("Full Report Extraction Error:",i),i}}var Qr=n(579);const Zr="h-9 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium shadow-sm transition-colors flex items-center gap-2 cursor-pointer";const eo=t=>{let{onDataMerge:n,onCancel:i}=t;const[s,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)(""),[l,c]=(0,e.useState)(null),u=()=>{l&&n(l)};var d,h,p,f;return l?(0,Qr.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4",children:(0,Qr.jsxs)("div",{className:"bg-white w-full max-w-4xl h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[(0,Qr.jsxs)("div",{className:"p-6 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Revis\xe3o da Importa\xe7\xe3o Inteligente"}),(0,Qr.jsx)("p",{className:"text-sm text-slate-500",children:"O OCR identificou os seguintes registros no seu documento."})]}),(0,Qr.jsxs)("div",{className:"flex gap-3",children:[(0,Qr.jsx)("button",{onClick:i,className:"text-slate-500 hover:text-slate-800 font-bold text-sm px-4",children:"Cancelar"}),(0,Qr.jsx)("button",{onClick:u,className:Zr,children:"Confirmar e Importar Tudo"})]})]}),(0,Qr.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-100 space-y-6",children:[(0,Qr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,Qr.jsx)(to,{label:"Empregados",count:(null===(d=l.relacao_empregados)||void 0===d?void 0:d.length)||0}),(0,Qr.jsx)(to,{label:"Contratos",count:(null===(h=l.contratos)||void 0===h?void 0:h.length)||0}),(0,Qr.jsx)(to,{label:"Notas Fiscais",count:(null===(p=l.documentos_fiscais)||void 0===p?void 0:p.length)||0}),(0,Qr.jsx)(to,{label:"Pagamentos",count:(null===(f=l.pagamentos)||void 0===f?void 0:f.length)||0})]}),(0,Qr.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200",children:[(0,Qr.jsx)("h3",{className:"font-bold text-sm mb-2 text-slate-700",children:"Pr\xe9-visualiza\xe7\xe3o dos Dados Estruturados"}),(0,Qr.jsx)("pre",{className:"text-xs font-mono bg-slate-900 text-green-400 p-4 rounded overflow-auto max-h-96",children:JSON.stringify(l,null,2)})]})]})]})}):(0,Qr.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4",children:(0,Qr.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-lg shadow-2xl p-8 text-center",children:[(0,Qr.jsxs)("div",{className:"mb-6",children:[(0,Qr.jsx)("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Qr.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Qr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 011.414.586l4.414 4.414a1 1 0 01.586 1.414V19a2 2 0 01-2 2z"})})}),(0,Qr.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Importar Presta\xe7\xe3o Completa"}),(0,Qr.jsx)("p",{className:"text-slate-500 mt-2 text-sm",children:"Fa\xe7a upload de um PDF contendo m\xfaltiplos documentos (Notas, Extratos, Folha). A IA ir\xe1 separar e classificar tudo automaticamente."})]}),(0,Qr.jsxs)("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-8 hover:bg-slate-50 transition-colors relative cursor-pointer",children:[(0,Qr.jsx)("input",{type:"file",accept:"application/pdf",onChange:async e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0];r(!0),a("Lendo arquivo (Isso pode levar alguns segundos)...");const n=new FileReader;n.onloadend=async()=>{try{const e=n.result.split(",")[1];a("Enviando para IA (Gemini 2.0)...");const i=await Xr(e,t.type);i?(c(i),a("An\xe1lise conclu\xedda. Revise os dados abaixo.")):a("Falha: Nenhum dado estruturado encontrado.")}catch(e){a("Erro: ".concat(e.message))}finally{r(!1)}},n.readAsDataURL(t)}},disabled:s,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),s?(0,Qr.jsxs)("div",{className:"space-y-3",children:[(0,Qr.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),(0,Qr.jsx)("p",{className:"text-sm font-bold text-blue-600",children:o})]}):(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("p",{className:"font-bold text-slate-700",children:"Clique ou arraste o PDF aqui"}),(0,Qr.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Suporta arquivos PDF digitalizados (OCR via Gemini)"})]})]}),(0,Qr.jsx)("button",{onClick:i,className:"mt-6 text-slate-400 hover:text-slate-600 text-sm font-medium",children:"Cancelar"})]})})},to=e=>{let{label:t,count:n}=e;return(0,Qr.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200 shadow-sm text-center",children:[(0,Qr.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:n}),(0,Qr.jsx)("div",{className:"text-xs text-slate-500 uppercase font-bold",children:t})]})},no=e=>{let{data:t,onClose:n}=e;const i=function(e){var t,n,i,s;const r={totalMissing:0,categories:{},readyToTransmit:!0};null!==(t=e.descritor)&&void 0!==t&&t.municipio&&null!==(n=e.descritor)&&void 0!==n&&n.entidade&&null!==(i=e.descritor)&&void 0!==i&&i.ano&&null!==(s=e.descritor)&&void 0!==s&&s.mes||(r.categories["Informa\xe7\xf5es B\xe1sicas"]={description:"Dados de identifica\xe7\xe3o do documento (obrigat\xf3rios)",fields:[{fieldName:"Tipo de Documento",requirement:"Selecione o tipo",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"},{fieldName:"Munic\xedpio",requirement:"C\xf3digo IBGE do munic\xedpio",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"},{fieldName:"Entidade",requirement:"C\xf3digo da entidade no Audesp",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"},{fieldName:"Ano/M\xeas",requirement:"Per\xedodo da presta\xe7\xe3o (obrigatoriamente m\xeas 12 - dezembro)",manualRef:"Manual v1.9 - Se\xe7\xe3o 1"}]},r.totalMissing+=4,r.readyToTransmit=!1),e.dados_gerais_entidade_beneficiaria||(r.categories["Dados da Entidade"]={description:"Informa\xe7\xf5es sobre a entidade benefici\xe1ria",fields:[{fieldName:"CNPJ",requirement:"CNPJ v\xe1lido (14 d\xedgitos)",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Raz\xe3o Social",requirement:"Nome da entidade",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Dados Gerais",requirement:"Preenchimento de dados gerais",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Corpo Diretivo",requirement:"Informa\xe7\xf5es do corpo diretivo",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Conselho",requirement:"Informa\xe7\xf5es do conselho",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"},{fieldName:"Certid\xe3o - Membros Comiss\xe3o",requirement:"Membros da comiss\xe3o de avalia\xe7\xe3o",manualRef:"Manual v1.9 - Se\xe7\xe3o 2"}]},r.totalMissing+=6,r.readyToTransmit=!1),e.responsaveis_membros_orgao_concessor&&0!==Object.keys(e.responsaveis_membros_orgao_concessor).length||r.categories["Respons\xe1veis"]||(r.categories["Respons\xe1veis"]={description:"Pessoas respons\xe1veis pela presta\xe7\xe3o",fields:[{fieldName:"Respons\xe1vel",requirement:"Nome completo do respons\xe1vel",manualRef:"Manual v1.9 - Se\xe7\xe3o 3"},{fieldName:"CPF",requirement:"CPF v\xe1lido do respons\xe1vel",manualRef:"Manual v1.9 - Se\xe7\xe3o 3"},{fieldName:"Certid\xe3o - Membros",requirement:"Identifica\xe7\xe3o de membros do \xf3rg\xe3o",manualRef:"Manual v1.9 - Se\xe7\xe3o 3"}]},r.totalMissing+=3,r.readyToTransmit=!1),e.receitas&&0!==Object.keys(e.receitas).length||(r.categories.Receitas={description:"Movimento financeiro de entrada (repasses, arrecada\xe7\xf5es, etc)",fields:[{fieldName:"Repasses Recebidos",requirement:"Valores recebidos de \xf3rg\xe3o concedente",manualRef:"Manual v1.9 - Se\xe7\xe3o 4"},{fieldName:"Receitas de Aplica\xe7\xf5es Financeiras",requirement:"Juros e rendimentos",manualRef:"Manual v1.9 - Se\xe7\xe3o 4"},{fieldName:"Recursos Pr\xf3prios",requirement:"Receitas do pr\xf3prio \xf3rg\xe3o",manualRef:"Manual v1.9 - Se\xe7\xe3o 4"}]},r.totalMissing+=3,r.readyToTransmit=!1),e.documentos_fiscais&&0!==e.documentos_fiscais.length||(r.categories["Documentos Fiscais"]={description:"Notas fiscais, recibos e comprovantes de despesas",fields:[{fieldName:"Documentos Fiscais",requirement:"Pelo menos 1 documento ou deixar vazio se sem despesas",manualRef:"Manual v1.9 - Se\xe7\xe3o 5"}]},r.readyToTransmit=!1),e.relacao_bens&&0!==Object.keys(e.relacao_bens).length||(r.categories["Rela\xe7\xe3o de Bens"]={description:"Bens m\xf3veis e im\xf3veis adquiridos, cedidos ou baixados",fields:[{fieldName:"Bens M\xf3veis Adquiridos",requirement:"Lista de bens m\xf3veis adquiridos (pode ser vazio)",manualRef:"Manual v1.9 - Se\xe7\xe3o 6"},{fieldName:"Bens M\xf3veis Cedidos",requirement:"Bens cedidos para terceiros (pode ser vazio)",manualRef:"Manual v1.9 - Se\xe7\xe3o 6"},{fieldName:"Bens Im\xf3veis",requirement:"Propriedades (pode ser vazio)",manualRef:"Manual v1.9 - Se\xe7\xe3o 6"}]},r.readyToTransmit=!1),e.ajustes_saldo&&0!==Object.keys(e.ajustes_saldo).length||(r.categories["Ajustes Cont\xe1beis"]={description:"Retifica\xe7\xf5es e inclus\xf5es de transa\xe7\xf5es",fields:[{fieldName:"Retifica\xe7\xf5es de Repasses",requirement:"Ajustes em repasses anteriores",manualRef:"Manual v1.9 - Se\xe7\xe3o 7"},{fieldName:"Inclus\xf5es de Repasses",requirement:"Novos repasses descobertos",manualRef:"Manual v1.9 - Se\xe7\xe3o 7"},{fieldName:"Ajustes de Pagamentos",requirement:"Retifica\xe7\xf5es e inclus\xf5es de pagamentos",manualRef:"Manual v1.9 - Se\xe7\xe3o 7"}]},r.totalMissing+=3,r.readyToTransmit=!1),e.disponibilidades&&0!==Object.keys(e.disponibilidades).length||(r.categories.Disponibilidades={description:"Saldos banc\xe1rios e fundos de caixa",fields:[{fieldName:"Saldos Banc\xe1rios",requirement:"Saldo de contas banc\xe1rias",manualRef:"Manual v1.9 - Se\xe7\xe3o 8"},{fieldName:"Saldo de Fundo Fixo",requirement:"Dinheiro em caixa ou fundo fixo",manualRef:"Manual v1.9 - Se\xe7\xe3o 8"}]},r.totalMissing+=2,r.readyToTransmit=!1);const o={relatorio_atividades:"Relat\xf3rio de Atividades",demonstracoes_contabeis:"Demonstra\xe7\xf5es Cont\xe1beis",relatorio_governamental_analise_execucao:"An\xe1lise de Execu\xe7\xe3o Governamental",parecer_conclusivo:"Parecer Conclusivo"},a=[];for(const[l,c]of Object.entries(o))e[l]||a.push(c);return a.length>0&&(r.categories["Relat\xf3rios"]={description:"Documentos de an\xe1lise e parecer",fields:a.map(e=>({fieldName:e,requirement:"Descri\xe7\xe3o ou documento anexado",manualRef:"Manual v1.9 - Se\xe7\xf5es 9-12"}))},r.totalMissing+=a.length,r.readyToTransmit=!1),r}(t);return i.readyToTransmit&&0===i.totalMissing?(0,Qr.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:(0,Qr.jsxs)("div",{className:"flex items-start",children:[(0,Qr.jsx)("div",{className:"flex-shrink-0",children:(0,Qr.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Qr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Qr.jsxs)("div",{className:"ml-4",children:[(0,Qr.jsx)("h3",{className:"text-lg font-medium text-green-800",children:"Pronto para Transmiss\xe3o!"}),(0,Qr.jsx)("p",{className:"mt-2 text-sm text-green-700",children:"Todos os campos obrigat\xf3rios foram preenchidos. Voc\xea pode enviar a presta\xe7\xe3o de contas para o Audesp Piloto."})]})]})}):(0,Qr.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,Qr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Qr.jsxs)("div",{className:"flex items-start flex-1",children:[(0,Qr.jsx)("div",{className:"flex-shrink-0",children:(0,Qr.jsx)("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Qr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4v2m0-12a9 9 0 110 18 9 9 0 010-18z"})})}),(0,Qr.jsxs)("div",{className:"ml-4 flex-1",children:[(0,Qr.jsxs)("h3",{className:"text-lg font-medium text-yellow-800",children:[i.totalMissing," Campo(s) Faltando"]}),(0,Qr.jsx)("p",{className:"mt-2 text-sm text-yellow-700",children:"Complete os campos abaixo para poder transmitir a presta\xe7\xe3o de contas. Siga as refer\xeancias do Manual v1.9."})]})]}),n&&(0,Qr.jsx)("button",{onClick:n,className:"ml-4 text-yellow-600 hover:text-yellow-700",children:(0,Qr.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Qr.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,Qr.jsx)("div",{className:"mt-6 space-y-6",children:Object.entries(i.categories).map(e=>{let[t,n]=e;return(0,Qr.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-yellow-100",children:[(0,Qr.jsx)("h4",{className:"font-semibold text-yellow-900 mb-2",children:t}),(0,Qr.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:n.description}),(0,Qr.jsx)("ul",{className:"space-y-2",children:n.fields.map((e,t)=>(0,Qr.jsxs)("li",{className:"flex items-start text-sm",children:[(0,Qr.jsx)("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-red-100 text-red-700 mr-3 flex-shrink-0",children:"\u2715"}),(0,Qr.jsxs)("div",{className:"flex-1",children:[(0,Qr.jsx)("p",{className:"font-medium text-gray-800",children:e.fieldName}),(0,Qr.jsx)("p",{className:"text-gray-600",children:e.requirement}),e.manualRef&&(0,Qr.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["\ud83d\udcd6 ",e.manualRef]})]})]},t))})]},t)})}),(0,Qr.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,Qr.jsx)("h5",{className:"font-semibold text-blue-900 mb-2",children:"\ud83d\udca1 Dicas para Completar"}),(0,Qr.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[(0,Qr.jsx)("li",{children:"Preencha um campo por vez e verifique a valida\xe7\xe3o em tempo real"}),(0,Qr.jsx)("li",{children:"Consulte o Manual T\xe9cnico v1.9 para entender o formato esperado"}),(0,Qr.jsx)("li",{children:"Campos com asterisco (*) s\xe3o obrigat\xf3rios"}),(0,Qr.jsx)("li",{children:"Valores monet\xe1rios devem usar ponto (.) como separador decimal"}),(0,Qr.jsx)("li",{children:"Datas devem estar no formato YYYY-MM-DD (ISO 8601)"})]})]}),(0,Qr.jsx)("div",{className:"mt-6 pt-4 border-t border-yellow-200",children:(0,Qr.jsx)("p",{className:"text-sm text-gray-700",children:'Quando todos os campos forem preenchidos corretamente, o bot\xe3o "Transmitir" ficar\xe1 ativado.'})})]})},io=e=>{let{result:t,onClose:n,formData:i}=e;const s="Recebido"===t.status,r="Armazenado"===t.status,o="Rejeitado"===t.status;return(0,Qr.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-[60] flex items-center justify-center p-4",children:(0,Qr.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,Qr.jsxs)("div",{className:"p-6 border-b-4 ".concat(s?"border-green-500 bg-green-100":r?"border-yellow-500 bg-yellow-100":"border-red-500 bg-red-100"," flex items-start justify-between"),children:[(0,Qr.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,Qr.jsx)("span",{className:"text-3xl",children:s?"\u2705":r?"\u26a0\ufe0f":"\u26d4"}),(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("h2",{className:"text-xl font-black text-slate-800 tracking-tight",children:s?"SUCESSO: DOCUMENTO RECEBIDO":r?"ATEN\xc7\xc3O: DOCUMENTO ARMAZENADO COM RESSALVAS":"ERRO: DOCUMENTO REJEITADO"}),(0,Qr.jsx)("p",{className:"text-sm font-bold text-slate-600 opacity-80",children:t.tipoDocumento})]})]}),(0,Qr.jsx)("button",{onClick:n,className:"text-slate-400 hover:text-slate-600 transition-colors p-2",title:"Fechar (Esc)",children:(0,Qr.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Qr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Qr.jsxs)("div",{className:"p-6 overflow-y-auto bg-slate-50 flex-1 space-y-6",children:[(0,Qr.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm flex justify-between items-center",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Protocolo Audesp"}),(0,Qr.jsx)("div",{className:"text-2xl font-mono font-bold text-slate-800 select-all",children:t.protocolo})]}),(0,Qr.jsxs)("div",{className:"text-right",children:[(0,Qr.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Data/Hora"}),(0,Qr.jsx)("div",{className:"text-sm font-bold text-slate-600",children:t.dataHora})]})]}),t.erros&&t.erros.length>0&&(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:[(0,Qr.jsx)("div",{className:"bg-slate-100 p-2 border-b border-slate-200",children:(0,Qr.jsx)("h4",{className:"text-xs font-bold text-slate-600 uppercase",children:"Detalhamento da An\xe1lise"})}),(0,Qr.jsxs)("table",{className:"w-full text-xs text-left",children:[(0,Qr.jsx)("thead",{className:"bg-slate-50 text-slate-500 border-b border-slate-100",children:(0,Qr.jsxs)("tr",{children:[(0,Qr.jsx)("th",{className:"p-2",children:"Tipo"}),(0,Qr.jsx)("th",{className:"p-2",children:"C\xf3digo"}),(0,Qr.jsx)("th",{className:"p-2",children:"Campo"}),(0,Qr.jsx)("th",{className:"p-2",children:"Mensagem"})]})}),(0,Qr.jsx)("tbody",{className:"divide-y divide-slate-100",children:t.erros.map((e,t)=>(0,Qr.jsxs)("tr",{className:"Impedittivo"===e.classificacao?"bg-red-50/50":"",children:[(0,Qr.jsx)("td",{className:"p-2 font-bold",children:(0,Qr.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] ".concat("Impedittivo"===e.classificacao?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:e.classificacao})}),(0,Qr.jsx)("td",{className:"p-2 font-mono text-slate-500",children:e.codigoErro}),(0,Qr.jsx)("td",{className:"p-2 font-mono text-slate-600",children:e.campo}),(0,Qr.jsx)("td",{className:"p-2 text-slate-800",children:e.mensagem})]},t))})]})]}),i&&o&&(0,Qr.jsxs)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,Qr.jsx)("h4",{className:"font-bold text-blue-900 mb-3",children:"\ud83d\udccb Campos Faltando para Transmiss\xe3o"}),(0,Qr.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"Complete os campos listados abaixo conforme especificado no Manual v1.9:"}),(0,Qr.jsx)(no,{data:i})]})]})]}),(0,Qr.jsxs)("div",{className:"p-4 border-t border-slate-200 bg-white flex justify-end gap-3",children:[(0,Qr.jsxs)("button",{onClick:n,className:"px-6 py-2 bg-slate-600 hover:bg-slate-700 text-white font-bold rounded shadow transition-colors flex items-center gap-2",title:"Fechar resultado (Esc)",children:[(0,Qr.jsx)("span",{children:"\u2715"})," Fechar"]}),s&&(0,Qr.jsxs)("button",{onClick:()=>window.print(),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded shadow transition-colors flex items-center gap-2",children:[(0,Qr.jsx)("span",{children:"\ud83d\udda8\ufe0f"})," Imprimir Recibo"]})]})]})})},so=t=>{let{isOpen:n,onConfirm:i,onCancel:s,currentEmail:r=""}=t;const[o,a]=(0,e.useState)(r),[l,c]=(0,e.useState)("");return n?(0,Qr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Qr.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full",children:[(0,Qr.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 rounded-t-lg",children:[(0,Qr.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,Qr.jsx)("span",{children:"\ud83d\udd10"})," Verificar Email"]}),(0,Qr.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Confirme seu email para transmitir"})]}),(0,Qr.jsxs)("div",{className:"px-6 py-6",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\ud83d\udce7 Email"}),(0,Qr.jsx)("input",{type:"email",value:o,onChange:e=>{a(e.target.value),c("")},placeholder:"seu.email@dominio.com",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"}),r&&(0,Qr.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Email atual: ",r]})]}),l&&(0,Qr.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[(0,Qr.jsx)("span",{className:"text-red-600 mt-0.5",children:"\u26a0\ufe0f"}),(0,Qr.jsx)("p",{className:"text-red-700 text-sm",children:l})]}),(0,Qr.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Qr.jsxs)("p",{className:"text-blue-900 text-xs",children:[(0,Qr.jsx)("strong",{children:"\ud83d\udca1 Dica:"})," Seu email ser\xe1 verificado com Audesp. Se receber erro 401, seu email pode n\xe3o ter permiss\xe3o para transmitir."]})})]}),(0,Qr.jsxs)("div",{className:"flex gap-3 px-6 py-4 bg-gray-50 rounded-b-lg border-t",children:[(0,Qr.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-100 transition",children:"Cancelar"}),(0,Qr.jsx)("button",{onClick:()=>{(c(""),o.trim())?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)?i(o):c("Email inv\xe1lido"):c("Por favor, informe o email")},className:"flex-1 px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition",children:"Confirmar"})]})]})}):null};const ro=class{static diagnoseError(e){const t=[];var n,i;400===e.status&&(null!==(n=e.message)&&void 0!==n&&null!==(i=n.mensagem)&&void 0!==i&&i.includes("Schema")&&t.push(...this.analyzeSchemaErrors(e)));return 401===e.status&&t.push(this.createDiagnostic("AUTH_401","Autentica\xe7\xe3o","error","Credencial fornecida n\xe3o \xe9 v\xe1lida","CPF/Email ou senha incorretos, ou usu\xe1rio sem permiss\xe3o",'Verifique CPF/Email e senha. Se corretos, usu\xe1rio pode n\xe3o ter permiss\xe3o no Audesp. Clique "Fazer Login Novamente" para tentar outro usu\xe1rio.',"erro_401")),403===e.status&&t.push(this.createDiagnostic("PERM_403","Permiss\xe3o","error","Acesso negado - O usu\xe1rio n\xe3o possui autoriza\xe7\xe3o","Voc\xea tentou acessar um recurso para o qual n\xe3o tem permiss\xe3o. Poss\xedveis causas:\n\n1. CPF/Email sem permiss\xe3o para transmitir este tipo de documento\n2. Credencial n\xe3o reconhecida como validada no Audesp\n3. Acesso revogado ou suspenso\n4. Ambiente (Piloto vs Produ\xe7\xe3o) pode ter permiss\xf5es diferentes",'A\xc7\xd5ES RECOMENDADAS:\n\n1. Clique "Fazer Login Novamente" e use outro CPF/Email autorizado\n2. Verifique com administrador Audesp se sua credencial est\xe1 ativa\n3. Se est\xe1 usando Piloto, tente no ambiente Produ\xe7\xe3o\n4. Contate: suporte@audesp.tce.sp.gov.br com seu CPF/Email',"erro_403")),404===e.status&&t.push(this.createDiagnostic("NOT_FOUND_404","Recurso","error","Recurso n\xe3o encontrado","Endpoint ou recurso n\xe3o existe","Verifique se est\xe1 usando ambiente correto (Piloto vs Produ\xe7\xe3o).","erro_404")),e.status>=500&&t.push(this.createDiagnostic("SERVER_ERROR_500","Servidor","critical","Erro interno do servidor Audesp","Servidor Audesp est\xe1 com problema","Tente novamente em alguns minutos. Se persistir, contate suporte.","erro_500")),e.status||t.push(this.createDiagnostic("NETWORK_ERR","Rede","critical","Falha de conex\xe3o","N\xe3o conseguiu conectar ao servidor Audesp","Verifique sua conex\xe3o com internet. Se problema persistir, contate suporte.","erro_rede")),t.length>0?t:[this.createUnknownError()]}static analyzeSchemaErrors(e){var t;const n=[],i=(null===(t=e.message)||void 0===t?void 0:t.erros)||[];for(const s of i)if("string"===typeof s){if(s.includes("is not defined in the schema")){const e=s.match(/\$\.([\w.\[\]]+):/),t=(null===e||void 0===e?void 0:e[1])||"desconhecido";n.push(this.createDiagnostic("SCHEMA_UNDEFINED","Valida\xe7\xe3o Schema","error",'Campo "'.concat(t,'" n\xe3o \xe9 definido no schema'),"Seu JSON cont\xe9m um campo que n\xe3o \xe9 permitido pelo Audesp",'Remova o campo "'.concat(t,'" do seu JSON e tente novamente.'),t))}if(s.includes("may only have a maximum of")){const e=s.match(/\$\.([\w.\[\]]+):/),t=(null===e||void 0===e?void 0:e[1])||"desconhecido",i=s.match(/maximum of (\d+)/),r=(null===i||void 0===i?void 0:i[1])||"?";n.push(this.createDiagnostic("SCHEMA_MAX_PROPS","Valida\xe7\xe3o Schema","error",'Objeto "'.concat(t,'" tem muitas propriedades'),"Este objeto pode ter no m\xe1ximo ".concat(r," propriedade(s), mas voc\xea enviou mais."),'Verifique o objeto "'.concat(t,'" e remova propriedades extras, deixando apenas as obrigat\xf3rias.'),t))}if(s.includes("is required")){const e=s.match(/\$\.([\w.\[\]]+):/),t=(null===e||void 0===e?void 0:e[1])||"desconhecido";n.push(this.createDiagnostic("SCHEMA_REQUIRED","Valida\xe7\xe3o Schema","error",'Campo obrigat\xf3rio "'.concat(t,'" n\xe3o foi fornecido'),"Este campo \xe9 necess\xe1rio para valida\xe7\xe3o",'Adicione o campo "'.concat(t,'" ao seu JSON com um valor v\xe1lido.'),t))}if(s.includes("does not conform to the specified format")){const e=s.match(/\$\.([\w.\[\]]+):/),t=(null===e||void 0===e?void 0:e[1])||"desconhecido";n.push(this.createDiagnostic("SCHEMA_FORMAT","Valida\xe7\xe3o Schema","error",'Campo "'.concat(t,'" tem formato inv\xe1lido'),"Valor n\xe3o est\xe1 no formato esperado pelo schema",'Verifique o formato do campo "'.concat(t,'". Pode ser data (DD/MM/YYYY), n\xfamero com decimais, etc.'),t))}}return n}static createDiagnostic(e,t,n,i,s,r,o,a){return{code:e,type:t,severity:n,message:i,cause:s,solution:r,affectedField:o,suggestion:a}}static createUnknownError(){return{code:"UNKNOWN_ERROR",type:"Desconhecido",severity:"warning",message:"Erro desconhecido durante transmiss\xe3o",cause:"N\xe3o foi poss\xedvel identificar a causa exata do erro",solution:"Verifique o console do navegador (F12) para mais detalhes. Se o problema persistir, contate suporte."}}static suggestFixesForJSON(e,t){let n=JSON.parse(JSON.stringify(e));for(const i of t)i.affectedField&&("SCHEMA_UNDEFINED"===i.code&&(n=this.removeField(n,i.affectedField)),"SCHEMA_MAX_PROPS"===i.code&&(n=this.limitProperties(n,i.affectedField,2)));return n}static removeField(e,t){const n=t.split(".");let i=e;for(let r=0;r<n.length-1;r++){const t=n[r],o=t.match(/(\w+)\[(\d+)\]/);if(o){var s;const[,e,t]=o;i=null===(s=i[e])||void 0===s?void 0:s[parseInt(t)]}else i=i[t];if(!i)return e}return delete i[n[n.length-1]],e}static limitProperties(e,t,n){const i=t.split(".");let s=e;for(let o=0;o<i.length;o++){const t=i[o],n=t.match(/(\w+)\[(\d+)\]/);if(n){var r;const[,e,t]=n;s=null===(r=s[e])||void 0===r?void 0:r[parseInt(t)]}else s=s[t];if(!s)return e}if("object"===typeof s&&!Array.isArray(s)){const e=Object.keys(s);if(e.length>n){e.slice(n).forEach(e=>delete s[e])}}return e}static formatDiagnosticForDisplay(e){let t="\n".concat("=".repeat(60),"\n");return t+="\ud83d\udd34 ".concat(e.type,"\n"),t+="".concat("=".repeat(60),"\n\n"),t+="\ud83d\udccc Problema:\n".concat(e.message,"\n\n"),t+="\ud83d\udd0d Por qu\xea:\n".concat(e.cause,"\n\n"),t+="\u2705 Solu\xe7\xe3o:\n".concat(e.solution,"\n\n"),e.affectedField&&(t+="\ud83d\udccd Campo afetado: ".concat(e.affectedField,"\n\n")),t+="".concat("=".repeat(60),"\n"),t}static formatDiagnosticsForDisplay(e){let t="\n\n";t+="\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n",t+="\u2551         DIAGN\xd3STICO DE ERROS DE TRANSMISS\xc3O                \u2551\n",t+="\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n";const n={critical:e.filter(e=>"critical"===e.severity),error:e.filter(e=>"error"===e.severity),warning:e.filter(e=>"warning"===e.severity),info:e.filter(e=>"info"===e.severity)};return n.critical.length>0&&(t+="\ud83d\udd34 CR\xcdTICO:\n",n.critical.forEach(e=>{t+="  \u2022 ".concat(e.message,"\n"),t+="    \u2192 ".concat(e.solution,"\n\n")})),n.error.length>0&&(t+="\u274c ERROS:\n",n.error.forEach(e=>{t+="  \u2022 ".concat(e.message,"\n"),t+="    \u2192 ".concat(e.solution,"\n\n")})),n.warning.length>0&&(t+="\u26a0\ufe0f  AVISOS:\n",n.warning.forEach(e=>{t+="  \u2022 ".concat(e.message,"\n\n")})),t}},oo=t=>{let{jsonData:n,diagnostics:i,onEdit:s}=t;const[r,o]=(0,e.useState)(new Set(["root"])),[a,l]=(0,e.useState)(null),[c,u]=(0,e.useState)(""),d=new Map;i.forEach(e=>{if(e.affectedField){const t="$.".concat(e.affectedField);d.set(t,e)}});const h=e=>{const t=new Set(r);t.has(e)?t.delete(e):t.add(e),o(t)},p=e=>{if(d.has(e))return d.get(e);for(const[t]of d)if(t.startsWith(e+".")||t.startsWith(e+"["))return d.get(t)},f=(e,t,i)=>{const o=p(t),d=r.has(t);return null===e?(0,Qr.jsx)("span",{className:"font-mono text-xs ".concat(o?"text-red-600":"text-gray-500"),children:"null"}):"object"!==typeof e?(0,Qr.jsx)("span",{className:"font-mono text-xs ".concat(o?"text-red-600":"text-blue-600"),children:"string"===typeof e?'"'.concat(e,'"'):String(e)}):Array.isArray(e)?(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("button",{onClick:()=>h(t),className:"font-mono text-xs text-blue-600 hover:text-blue-800 transition",children:[d?"\u25bc":"\u25b6"," [",e.length,"]"]}),d&&(0,Qr.jsx)("div",{className:"ml-4 border-l border-gray-300 pl-2",children:e.map((e,n)=>(0,Qr.jsxs)("div",{className:"py-1",children:[(0,Qr.jsxs)("span",{className:"text-gray-500",children:["[",n,"]: "]}),f(e,"".concat(t,"[").concat(n,"]"),i+1)]},n))})]}):(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("button",{onClick:()=>h(t),className:"font-mono text-xs transition ".concat(o?"text-red-600 hover:text-red-800 font-bold":"text-blue-600 hover:text-blue-800"),children:[d?"\u25bc":"\u25b6"," ","{","...","}"]}),d&&(0,Qr.jsx)("div",{className:"ml-4 border-l ".concat(o?"border-red-300 bg-red-50":"border-gray-300"," pl-2 py-1"),children:Object.entries(e).map(e=>{let[r,o]=e;const d="".concat(t,".").concat(r),h=p(d);return(0,Qr.jsxs)("div",{className:"py-1 px-2 rounded ".concat(h?"bg-red-100 border-l-2 border-red-500":"hover:bg-gray-50"),children:[(0,Qr.jsxs)("span",{className:"font-mono text-xs font-semibold ".concat(h?"text-red-700":"text-purple-600"),children:['"',r,'"']}),(0,Qr.jsx)("span",{className:"text-gray-600",children:": "}),a===d?(0,Qr.jsxs)("div",{className:"mt-1 p-2 bg-white border border-yellow-300 rounded",children:[(0,Qr.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs font-mono"}),(0,Qr.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,Qr.jsx)("button",{onClick:()=>{try{let t=c;try{t=JSON.parse(c)}catch(e){}const i=JSON.parse(JSON.stringify(n)),r=d.slice(2).split(".");let o=i;for(let e=0;e<r.length-1;e++)o=o[r[e]];o[r[r.length-1]]=t,null===s||void 0===s||s(i),l(null)}catch(t){alert("Erro ao salvar: "+t.message)}},className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"\u2713 Salvar"}),(0,Qr.jsx)("button",{onClick:()=>l(null),className:"px-2 py-1 bg-gray-400 text-white text-xs rounded hover:bg-gray-500",children:"\u2715 Cancelar"})]})]}):(0,Qr.jsxs)("div",{className:"inline-block",children:[f(o,d,i+1),h&&(0,Qr.jsx)("button",{onClick:()=>{l(d),u("string"===typeof o?o:JSON.stringify(o))},className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline",children:"[editar]"})]}),h&&(0,Qr.jsxs)("div",{className:"mt-1 p-2 bg-red-100 border-l-2 border-red-500 rounded",children:[(0,Qr.jsx)("p",{className:"text-xs font-bold text-red-700",children:"\u26a0\ufe0f Erro:"}),(0,Qr.jsx)("p",{className:"text-xs text-red-600 mt-1",children:h.message}),(0,Qr.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:[(0,Qr.jsx)("strong",{children:"Solu\xe7\xe3o:"})," ",h.solution]})]})]},r)})})]})};return(0,Qr.jsxs)("div",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-xs overflow-auto max-h-96 border border-gray-700",children:[(0,Qr.jsxs)("div",{className:"mb-2 pb-2 border-b border-gray-700",children:[(0,Qr.jsx)("p",{className:"text-yellow-400 text-xs font-bold",children:"\ud83d\udcc4 JSON com Highlighting de Erros"}),(0,Qr.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"Campos em vermelho t\xeam erros. Clique [editar] para corrigir."})]}),(0,Qr.jsxs)("div",{className:"space-y-1",children:[(0,Qr.jsx)("span",{className:"text-blue-400",children:"{"}),(0,Qr.jsx)("div",{className:"ml-4",children:f(n,"$",0)}),(0,Qr.jsx)("span",{className:"text-blue-400",children:"}"})]})]})},ao=t=>{let{error:n,onDismiss:i,onRetry:s,onAutoFix:r,jsonData:o,diagnostics:a}=t;const[l,c]=e.useState([]),[u,d]=e.useState(0),[h,p]=e.useState(!1),[f,m]=e.useState(o);e.useEffect(()=>{if(a&&a.length>0)c(a);else{const e=ro.diagnoseError(n);c(e)}},[n,a]);const g=e=>{switch(e){case"critical":return"bg-red-50 border-red-200";case"error":return"bg-orange-50 border-orange-200";case"warning":return"bg-yellow-50 border-yellow-200";default:return"bg-blue-50 border-blue-200"}},v=e=>{switch(e){case"critical":return"\ud83d\udd34";case"error":return"\u274c";case"warning":return"\u26a0\ufe0f";default:return"\u2139\ufe0f"}};return(0,Qr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-auto",children:(0,Qr.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full my-4",children:[(0,Qr.jsx)("div",{className:"bg-gradient-to-r from-red-600 to-red-700 px-6 py-4 rounded-t-lg",children:(0,Qr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Qr.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,Qr.jsx)("span",{children:"\ud83d\udd0d"})," Diagn\xf3stico de Erro"]}),(0,Qr.jsx)("button",{onClick:i,className:"text-white hover:bg-white hover:bg-opacity-20 rounded p-1 transition",children:"\u2715"})]})}),(0,Qr.jsxs)("div",{className:"px-6 py-6 max-h-[70vh] overflow-y-auto",children:[(0,Qr.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Qr.jsx)("h3",{className:"font-bold text-blue-900 mb-2",children:"\ud83d\udccb Resumo"}),(0,Qr.jsxs)("p",{className:"text-blue-800 text-sm",children:[l.length," ",1===l.length?"problema encontrado":"problemas encontrados",".",l.some(e=>"SCHEMA_UNDEFINED"===e.code)&&(0,Qr.jsx)(Qr.Fragment,{children:" Seu JSON cont\xe9m campos que n\xe3o s\xe3o permitidos pelo schema."})]})]}),(0,Qr.jsx)("div",{className:"mb-4",children:(0,Qr.jsxs)("button",{onClick:()=>p(!h),className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition text-sm font-semibold",children:[(0,Qr.jsx)("span",{children:"\ud83d\udcc4"}),h?"\u25bc Ocultar JSON":"\u25b6 Ver JSON com Erros"]})}),h&&o&&(0,Qr.jsxs)("div",{className:"mb-6 bg-gray-100 p-4 rounded-lg border-2 border-gray-300",children:[(0,Qr.jsx)(oo,{jsonData:f||o,diagnostics:l,onEdit:e=>{m(e)}}),(0,Qr.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,Qr.jsx)("button",{onClick:()=>{r&&f&&(r(f),i())},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm font-semibold",children:"\u2728 Usar JSON Corrigido"}),(0,Qr.jsx)("button",{onClick:()=>{m(o),p(!1)},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition text-sm font-semibold",children:"\u21ba Resetar"})]})]}),(0,Qr.jsx)("div",{className:"space-y-3",children:l.map((e,t)=>(0,Qr.jsxs)("div",{className:"border rounded-lg overflow-hidden ".concat(g(e.severity)),children:[(0,Qr.jsxs)("button",{onClick:()=>d(u===t?null:t),className:"w-full px-4 py-3 flex items-start justify-between hover:opacity-80 transition",children:[(0,Qr.jsxs)("div",{className:"flex items-start gap-3 text-left",children:[(0,Qr.jsx)("span",{className:"text-lg",children:v(e.severity)}),(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("p",{className:"font-bold text-gray-900",children:e.message}),e.affectedField&&(0,Qr.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["\ud83d\udccd Campo: ",(0,Qr.jsx)("code",{className:"bg-black bg-opacity-10 px-1 rounded",children:e.affectedField})]})]})]}),(0,Qr.jsx)("span",{className:"text-gray-400",children:u===t?"\u25bc":"\u25b6"})]}),u===t&&(0,Qr.jsxs)("div",{className:"px-4 py-3 border-t bg-white bg-opacity-50 space-y-2",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("p",{className:"text-xs font-bold text-gray-700 uppercase",children:"Causa:"}),(0,Qr.jsx)("p",{className:"text-sm text-gray-800 mt-1",children:e.cause})]}),(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("p",{className:"text-xs font-bold text-gray-700 uppercase",children:"Solu\xe7\xe3o:"}),(0,Qr.jsx)("p",{className:"text-sm text-gray-800 mt-1",children:e.solution})]}),"SCHEMA_UNDEFINED"===e.code&&(0,Qr.jsxs)("div",{className:"mt-3 p-3 bg-yellow-100 border border-yellow-300 rounded text-xs",children:[(0,Qr.jsx)("p",{className:"font-bold text-yellow-900",children:"\ud83d\udca1 Dica:"}),(0,Qr.jsx)("p",{className:"text-yellow-800 mt-1",children:"Remova campos extras do seu JSON. O schema Audesp \xe9 rigoroso e n\xe3o permite propriedades adicionais."})]}),"SCHEMA_MAX_PROPS"===e.code&&(0,Qr.jsxs)("div",{className:"mt-3 p-3 bg-yellow-100 border border-yellow-300 rounded text-xs",children:[(0,Qr.jsx)("p",{className:"font-bold text-yellow-900",children:"\ud83d\udca1 Dica:"}),(0,Qr.jsx)("p",{className:"text-yellow-800 mt-1",children:"Este objeto tem limite de propriedades. Verifique quais campos s\xe3o obrigat\xf3rios e remova os extras."})]})]})]},t))}),n.message&&(0,Qr.jsxs)("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg",children:[(0,Qr.jsx)("p",{className:"text-xs font-bold text-gray-700 uppercase mb-2",children:"Detalhes T\xe9cnicos:"}),(0,Qr.jsx)("pre",{className:"text-xs text-gray-800 overflow-auto max-h-40 bg-white p-3 rounded border border-gray-300",children:"string"===typeof n.message?n.message:JSON.stringify(n.message,null,2)})]})]}),(0,Qr.jsxs)("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg border-t flex gap-3",children:[(0,Qr.jsx)("button",{onClick:i,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-100 transition",children:"Fechar"}),r&&l.length>0&&(0,Qr.jsxs)("button",{onClick:()=>{if(r&&o){const e=ro.suggestFixesForJSON(o,l);r(e)}},className:"flex-1 px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition flex items-center justify-center gap-2",children:[(0,Qr.jsx)("span",{children:"\u2728"})," Corrigir Automaticamente"]}),s&&(0,Qr.jsxs)("button",{onClick:s,className:"flex-1 px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2",children:[(0,Qr.jsx)("span",{children:"\ud83d\udd04"})," Tentar Novamente"]})]}),(0,Qr.jsx)("div",{className:"px-6 py-3 bg-blue-50 border-t text-xs text-gray-600",children:(0,Qr.jsxs)("p",{children:["\ud83d\udca1 ",(0,Qr.jsx)("strong",{children:"Dica:"})," Se o problema persistir ap\xf3s corre\xe7\xe3o, verifique se todos os campos obrigat\xf3rios est\xe3o preenchidos corretamente."]})})]})})},lo={piloto:"https://audesp-piloto.tce.sp.gov.br",producao:"https://audesp.tce.sp.gov.br"},co="audesp_auth_token",uo="audesp_environment";class ho{static setEnvironment(e){this.currentEnvironment=e,localStorage.setItem(uo,e)}static getEnvironment(){return localStorage.getItem(uo)||"piloto"}static getBaseUrl(){const e=this.getEnvironment();return"undefined"!==typeof window&&"localhost"===window.location.hostname?"piloto"===e?"/proxy-piloto-login":"/proxy-producao-login":lo[e]}static async login(e){const t="undefined"!==typeof window&&"localhost"===window.location.hostname,n=this.getEnvironment(),i=t?"piloto"===n?"/proxy-piloto-login":"/proxy-producao-login":this.getBaseUrl(),s=t?i:"".concat(i,"/login");try{console.log("[Auth] Tentando login em ".concat(this.getEnvironment()," (").concat(s,")"));const t=e.cpf||e.email,n=e.cpf?"CPF":"Email";console.log("[Auth] ".concat(n,": ").concat(t));const i="".concat(t,":").concat(e.password),r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","x-authorization":i}});console.log("[Auth] Response status: ".concat(r.status));const o=await r.text();if(console.log("[Auth] Response body: ".concat(o.substring(0,100))),!r.ok){if(401===r.status)throw new Error("\u274c Usu\xe1rio ou senha inv\xe1lidos. Verifique suas credenciais TCESP.");if(403===r.status)throw new Error("\u274c Acesso proibido. Seu usu\xe1rio pode n\xe3o ter permiss\xe3o neste ambiente.");throw new Error("\u274c Erro de autentica\xe7\xe3o: ".concat(r.status))}const a=JSON.parse(o),l=a.access_token||a.token;let c=3600;a.expire_in?a.expire_in>Date.now()?c=Math.floor((a.expire_in-Date.now())/1e3):a.expire_in>100&&(c=Math.floor(a.expire_in)):a.expires_in?c=Math.floor(a.expires_in):a.ttl&&(c=Math.floor(a.ttl));const u={token:l,expire_in:c,token_type:a.token_type||"bearer",environment:this.getEnvironment(),timestamp:Date.now()};return localStorage.setItem(co,JSON.stringify(u)),this.currentToken=u,console.log("[Auth] \u2705 Login bem-sucedido em ".concat(this.getEnvironment()),{token:(null===l||void 0===l?void 0:l.substring(0,20))+"...",expiresInSeconds:c,tokenType:u.token_type}),u}catch(r){throw console.error("[Auth] Erro no login:",r),new Error("Erro ao autenticar: ".concat(r.message))}}static logout(){localStorage.removeItem(co),this.currentToken=null,console.log("[Auth] Logout realizado")}static getToken(){if(this.currentToken){const e=this.currentToken.timestamp+1e3*this.currentToken.expire_in;return Date.now()>e?(console.warn("[Auth] Token expirado, limpando sess\xe3o"),this.logout(),null):this.currentToken}const e=localStorage.getItem(co);if(e)try{this.currentToken=JSON.parse(e);const t=this.currentToken.timestamp+1e3*this.currentToken.expire_in;return Date.now()>t?(console.warn("[Auth] Token armazenado expirado, limpando sess\xe3o"),this.logout(),null):this.currentToken}catch(t){return null}return null}static isAuthenticated(){return null!==this.getToken()}static getAuthHeader(){const e=this.getToken();return e?{Authorization:"".concat(e.token_type," ").concat(e.token)}:{}}}ho.currentEnvironment="piloto",ho.currentToken=null;const po=ho,fo=t=>{let{onLoginSuccess:n,onError:i}=t;const[s,r]=(0,e.useState)("piloto"),[o,a]=(0,e.useState)(""),[l,c]=(0,e.useState)(""),[u,d]=(0,e.useState)(!1),[h,p]=(0,e.useState)(!1),[f,m]=(0,e.useState)(!1),g=e=>{r(e),po.setEnvironment(e)},v=po.getBaseUrl();return(0,Qr.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:(0,Qr.jsxs)("div",{className:"w-full max-w-md",children:[(0,Qr.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 border border-slate-100",children:[(0,Qr.jsxs)("div",{className:"text-center mb-8",children:[(0,Qr.jsx)("div",{className:"flex justify-center mb-4",children:(0,Qr.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:(0,Qr.jsx)("span",{className:"text-white text-2xl font-bold",children:"\ud83c\udfdb\ufe0f"})})}),(0,Qr.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Audesp Connect"}),(0,Qr.jsx)("p",{className:"text-sm text-slate-500",children:"Presta\xe7\xe3o de Contas v2.0"})]}),(0,Qr.jsxs)("div",{className:"mb-6",children:[(0,Qr.jsx)("label",{className:"block text-xs font-bold uppercase text-slate-600 mb-3",children:"Ambiente"}),(0,Qr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Qr.jsxs)("button",{onClick:()=>g("piloto"),className:"p-3 rounded-lg border-2 font-bold text-sm transition-all ".concat("piloto"===s?"border-blue-600 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"),children:[(0,Qr.jsx)("span",{className:"block mb-1",children:"\ud83e\uddea"}),(0,Qr.jsx)("span",{className:"text-xs",children:"Piloto (Teste)"})]}),(0,Qr.jsxs)("button",{onClick:()=>g("producao"),className:"p-3 rounded-lg border-2 font-bold text-sm transition-all ".concat("producao"===s?"border-red-600 bg-red-50 text-red-700":"border-slate-200 bg-white text-slate-700 hover:border-slate-300"),children:[(0,Qr.jsx)("span",{className:"block mb-1",children:"\ud83d\ude80"}),(0,Qr.jsx)("span",{className:"text-xs",children:"Produ\xe7\xe3o"})]})]}),"producao"===s&&(0,Qr.jsxs)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,Qr.jsx)("p",{className:"text-xs text-red-700 font-bold",children:"\u26a0\ufe0f Voc\xea est\xe1 conectando ao ambiente de PRODU\xc7\xc3O."}),(0,Qr.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Certifique-se de estar enviando dados reais."})]}),(0,Qr.jsxs)("div",{className:"mt-3 p-2 bg-slate-50 rounded text-xs text-slate-600",children:[(0,Qr.jsx)("strong",{children:"Endpoint:"})," ",(0,Qr.jsx)("span",{className:"font-mono text-[10px]",children:v})]})]}),(0,Qr.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!o||!l)return void i("CPF e senha s\xe3o obrigat\xf3rios");const t=o.replace(/\D/g,"");if(11===t.length){d(!0);try{const e=await po.login({email:t,password:l});console.log("[Login] ========== RESULTADO DO LOGIN COM CPF =========="),console.log("[Login] CPF informado:",t),console.log("[Login] Senha: \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"),console.log("[Login] Token obtido com sucesso"),console.log("[Login] ============================================"),f&&(localStorage.setItem("audesp_last_environment",s),localStorage.setItem("audesp_last_cpf",t)),n(e.token,s,t)}catch(r){i(r.message||"Erro ao fazer login com CPF")}finally{d(!1)}}else i("CPF deve ter 11 d\xedgitos")},className:"space-y-4",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("label",{className:"block text-xs font-bold uppercase text-slate-600 mb-2",children:"\ud83d\udd11 CPF (11 d\xedgitos)"}),(0,Qr.jsx)("input",{type:"text",value:o,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,11);a(t)},placeholder:"00000000000",className:"w-full h-11 px-4 border border-slate-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition text-slate-700 placeholder:text-slate-400 font-mono text-lg",disabled:u,required:!0,autoFocus:!0}),(0,Qr.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Seu CPF com 11 d\xedgitos (usado como identificador)"})]}),(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("label",{className:"block text-xs font-bold uppercase text-slate-600 mb-2",children:"\ud83d\udd10 Senha"}),(0,Qr.jsxs)("div",{className:"relative",children:[(0,Qr.jsx)("input",{type:h?"text":"password",value:l,onChange:e=>c(e.target.value),placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",className:"w-full h-11 px-4 border border-slate-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition text-slate-700 placeholder:text-slate-400",disabled:u,required:!0}),(0,Qr.jsx)("button",{type:"button",onClick:()=>p(!h),className:"absolute right-3 top-3 text-slate-500 hover:text-slate-700",children:h?"\ud83d\udc41\ufe0f":"\ud83d\ude48"})]})]}),(0,Qr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Qr.jsx)("input",{type:"checkbox",id:"rememberMe",checked:f,onChange:e=>m(e.target.checked),className:"w-4 h-4 border-slate-300 rounded text-blue-600 focus:ring-blue-500 cursor-pointer",disabled:u}),(0,Qr.jsx)("label",{htmlFor:"rememberMe",className:"text-sm text-slate-600 cursor-pointer",children:"Lembrar CPF e ambiente"})]}),(0,Qr.jsx)("button",{type:"submit",disabled:u,className:"w-full h-11 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-lg hover:from-blue-700 hover:to-blue-800 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:u?(0,Qr.jsxs)(Qr.Fragment,{children:[(0,Qr.jsx)("span",{className:"animate-spin",children:"\u23f3"}),"Autenticando..."]}):(0,Qr.jsxs)(Qr.Fragment,{children:[(0,Qr.jsx)("span",{children:"\ud83d\udd10"}),"Entrar com CPF"]})})]}),(0,Qr.jsxs)("div",{className:"mt-6 pt-4 border-t border-slate-200 text-center",children:[(0,Qr.jsx)("p",{className:"text-xs text-slate-500 mb-2",children:"Sistema de Presta\xe7\xe3o de Contas Eletr\xf4nica"}),(0,Qr.jsxs)("p",{className:"text-xs text-slate-600",children:[(0,Qr.jsx)("strong",{children:"Ambiente:"})," ","piloto"===s?"\ud83e\uddea Teste (Piloto)":"\ud83d\ude80 Produ\xe7\xe3o"]}),(0,Qr.jsxs)("p",{className:"text-xs text-slate-500 mt-2",children:[(0,Qr.jsx)("strong",{children:"Login via CPF"})," - Conforme Manual Audesp"]})]})]}),(0,Qr.jsxs)("div",{className:"mt-6 bg-white bg-opacity-10 rounded-lg p-4 text-white text-sm",children:[(0,Qr.jsxs)("p",{className:"mb-2",children:[(0,Qr.jsx)("strong",{children:"\ud83d\udca1 Dica:"})," Use o ambiente Piloto para testar antes de enviar em Produ\xe7\xe3o."]}),(0,Qr.jsx)("p",{className:"text-xs opacity-90",children:"\xa9 2024 Tribunal de Contas do Estado de S\xe3o Paulo"})]})]})})};function mo(e,t,n){t||(t=[]);var i=t.length++;return Object.defineProperty({},"_",{set:function(s){t[i]=s,e.apply(n,t)}})}function go(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(e,t){go(e,t),t.add(e)}function yo(e,t,n){go(e,t),t.set(e,n)}function bo(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function wo(e,t,n){return n(bo(e,t))}function _o(e,t){return e.get(bo(e,t))}function xo(e,t,n){return e.set(bo(e,t),n),n}function Eo(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Eo=function(e){this.s=e,this.n=e.next},Eo.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Eo(e)}var So,Ao,Co,To,ko,Io,No,Po,Mo,Ro,Oo,Do,Fo,Lo,jo,Uo,Bo,Wo;const Ho="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),Vo=[.001,0,0,.001,0,0],qo=1.35,zo=1,Go=2,Jo=4,Ko=16,Yo=32,$o=64,Xo=128,Qo=256,Zo={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ea="pdfjs_internal_editor_",ta={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},na={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},ia=1,sa=2,ra=0,oa=1,aa=2,la=3,ca=3,ua=4,da={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ha={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},pa=1,fa=2,ma=3,ga=4,va=5,ya={ERRORS:0,WARNINGS:1,INFOS:5},ba={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},wa=0,_a=1,xa=2,Ea=3,Sa=4;let Aa=ya.WARNINGS;function Ca(e){Number.isInteger(e)&&(Aa=e)}function Ta(){return Aa}function ka(e){Aa>=ya.INFOS&&console.info("Info: ".concat(e))}function Ia(e){Aa>=ya.WARNINGS&&console.warn("Warning: ".concat(e))}function Na(e){throw new Error(e)}function Pa(e,t){e||Na(t)}function Ma(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;if(n&&"string"===typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);(null===t||void 0===t?void 0:t.length)>=2&&(e="http://".concat(e))}if(n.tryConvertEncoding)try{e=decodeURIComponent(escape(e))}catch(s){}}const i=t?URL.parse(e,t):URL.parse(e);return function(e){switch(null===e||void 0===e?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i)?i:null}function Ra(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=URL.parse(e);return i?(i.hash=t,i.href):n&&Ma(e,"http://example.com")?e.split("#",1)[0]+"".concat(t?"#".concat(t):""):""}function Oa(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const Da=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class Fa extends Da{constructor(e,t){super(e,"PasswordException"),this.code=t}}class La extends Da{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ja extends Da{constructor(e){super(e,"InvalidPDFException")}}class Ua extends Da{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class Ba extends Da{constructor(e){super(e,"FormatError")}}class Wa extends Da{constructor(e){super(e,"AbortException")}}function Ha(e){"object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.length)||Na("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const i=[];for(let s=0;s<t;s+=n){const r=Math.min(s+n,t),o=e.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Va(e){"string"!==typeof e&&Na("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}class qa{static get isLittleEndian(){return Oa(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return Oa(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(e){return!1}}())}static get isOffscreenCanvasSupported(){return Oa(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return Oa(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get isFloat16ArraySupported(){return Oa(this,"isFloat16ArraySupported","undefined"!==typeof Float16Array)}static get isSanitizerSupported(){return Oa(this,"isSanitizerSupported","undefined"!==typeof Sanitizer)}static get platform(){const{platform:e,userAgent:t}=navigator;return Oa(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Oa(this,"isCSSRoundSupported",null===(e=globalThis.CSS)||void 0===e||null===(t=e.supports)||void 0===t?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const za=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));class Ga{static makeHexColor(e,t,n){return"#".concat(za[e]).concat(za[t]).concat(za[n])}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=e[n],s=e[n+1];e[n]=i*t[0]+s*t[2]+t[4],e[n+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t[0],s=t[1],r=t[2],o=t[3],a=t[4],l=t[5];for(let c=0;c<6;c+=2){const t=e[n+c],u=e[n+c+1];e[n+c]=t*i+u*r+a,e[n+c+1]=t*s+u*o+l}}static applyInverseTransform(e,t){const n=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,n){const i=t[0],s=t[1],r=t[2],o=t[3],a=t[4],l=t[5],c=e[0],u=e[1],d=e[2],h=e[3];let p=i*c+a,f=p,m=i*d+a,g=m,v=o*u+l,y=v,b=o*h+l,w=b;if(0!==s||0!==r){const e=s*c,t=s*d,n=r*u,i=r*h;p+=n,g+=n,m+=i,f+=i,v+=e,w+=e,b+=t,y+=t}n[0]=Math.min(n[0],p,m,f,g),n[1]=Math.min(n[1],v,b,y,w),n[2]=Math.max(n[2],p,m,f,g),n[3]=Math.max(n[3],v,b,y,w)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],s=e[2],r=e[3],o=n**2+i**2,a=n*s+i*r,l=s**2+r**2,c=(o+l)/2,u=Math.sqrt(c**2-(o*l-a**2));t[0]=Math.sqrt(c+u||1),t[1]=Math.sqrt(c-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>r?null:[n,s,i,r]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,s){s[0]=Math.min(s[0],e,n),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,n),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,n,i,s,r,o,a,l){l[0]=Math.min(l[0],e,o),l[1]=Math.min(l[1],t,a),l[2]=Math.max(l[2],e,o),l[3]=Math.max(l[3],t,a),bo(Ga,this,Ka).call(this,e,n,s,o,t,i,r,a,3*(3*(n-s)-e+o),6*(e-2*n+s),3*(n-e),l),bo(Ga,this,Ka).call(this,e,n,s,o,t,i,r,a,3*(3*(i-r)-t+a),6*(t-2*i+r),3*(i-t),l)}}function Ja(e,t,n,i,s,r,o,a,l,c){if(l<=0||l>=1)return;const u=1-l,d=l*l,h=d*l,p=u*(u*(u*e+3*l*t)+3*d*n)+h*i,f=u*(u*(u*s+3*l*r)+3*d*o)+h*a;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}function Ka(e,t,n,i,s,r,o,a,l,c,u,d){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&bo(So,this,Ja).call(this,e,t,n,i,s,r,o,a,-u/c,d));const h=c**2-4*u*l;if(h<0)return;const p=Math.sqrt(h),f=2*l;bo(So,this,Ja).call(this,e,t,n,i,s,r,o,a,(-c+p)/f,d),bo(So,this,Ja).call(this,e,t,n,i,s,r,o,a,(-c-p)/f,d)}So=Ga;let Ya=null,$a=null;function Xa(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),Ha(e)}const Qa="pdfjs_internal_id_";function Za(e,t,n){return Math.min(Math.max(e,t),n)}function el(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(Ha(e))}"function"!==typeof Promise.try&&(Promise.try=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Promise(t=>{t(e(...n))})}),"function"!==typeof Math.sumPrecise&&(Math.sumPrecise=function(e){return e.reduce((e,t)=>e+t,0)});class tl{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};return function e(n){var i;if(!n)return;let s=null;const r=n.name;if("#text"===r)s=n.value;else{if(!tl.shouldBuildText(r))return;null!==n&&void 0!==n&&null!==(i=n.attributes)&&void 0!==i&&i.textContent?s=n.attributes.textContent:n.value&&(s=n.value)}if(null!==s&&t.push({str:s}),n.children)for(const t of n.children)e(t)}(e),n}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}class nl{static setupStorage(e,t,n,i,s){const r=i.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==r.value&&(e.textContent=r.value),"print"===s)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(r.value===n.attributes.xfaOn?e.setAttribute("checked",!0):r.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===s)break;e.addEventListener("change",e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==r.value&&e.setAttribute("value",r.value),"print"===s)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})})}break;case"select":if(null!==r.value){e.setAttribute("value",r.value);for(const e of n.children)e.attributes.value===r.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,s=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(t,{value:s})})}}static setAttributes(e){let{html:t,element:n,storage:i=null,intent:s,linkService:r}=e;const{attributes:o}=n,a=t instanceof HTMLAnchorElement;"radio"===o.type&&(o.name="".concat(o.name,"-").concat(s));for(const[l,c]of Object.entries(o))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!a||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}a&&r.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,n,i)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,s=e.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:s,linkService:n});const o="richText"!==s,a=e.div;if(a.append(r),e.viewport){const t="matrix(".concat(e.viewport.transform.join(","),")");a.style.transform=t}o&&a.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const e=document.createTextNode(i.value);r.append(e),o&&tl.shouldBuildText(i.name)&&l.push(e)}return{textDivs:l}}const c=[[i,-1,r]];for(;c.length>0;){var u,d;const[e,i,r]=c.at(-1);if(i+1===e.children.length){c.pop();continue}const a=e.children[++c.at(-1)[1]];if(null===a)continue;const{name:h}=a;if("#text"===h){const e=document.createTextNode(a.value);l.push(e),r.append(e);continue}const p=null!==a&&void 0!==a&&null!==(u=a.attributes)&&void 0!==u&&u.xmlns?document.createElementNS(a.attributes.xmlns,h):document.createElement(h);if(r.append(p),a.attributes&&this.setAttributes({html:p,element:a,storage:t,intent:s,linkService:n}),(null===(d=a.children)||void 0===d?void 0:d.length)>0)c.push([a,-1,p]);else if(a.value){const e=document.createTextNode(a.value);o&&tl.shouldBuildText(h)&&l.push(e),p.append(e)}}for(const h of a.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t="matrix(".concat(e.viewport.transform.join(","),")");e.div.style.transform=t,e.div.hidden=!1}}const il="http://www.w3.org/2000/svg";class sl{}async function rl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(dl(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);switch(t){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,i)=>{const s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200!==s.status&&0!==s.status)i(new Error(s.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void n(s.response)}n(s.responseText)}},s.send(null)})}Ao=sl,r(sl,"CSS",96),r(sl,"PDF",72),r(sl,"PDF_TO_CSS_UNITS",Ao.CSS/Ao.PDF);class ol{constructor(e){let{viewBox:t,userUnit:n,scale:i,rotation:s,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}=e;this.viewBox=t,this.userUnit=n,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=o,i*=n;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let u,d,h,p,f,m,g,v;switch(s%=360,s<0&&(s+=360),s){case 180:u=-1,d=0,h=0,p=1;break;case 90:u=0,d=1,h=1,p=0;break;case 270:u=0,d=-1,h=-1,p=0;break;case 0:u=1,d=0,h=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(h=-h,p=-p),0===u?(f=Math.abs(c-t[1])*i+r,m=Math.abs(l-t[0])*i+o,g=(t[3]-t[1])*i,v=(t[2]-t[0])*i):(f=Math.abs(l-t[0])*i+r,m=Math.abs(c-t[1])*i+o,g=(t[2]-t[0])*i,v=(t[3]-t[1])*i),this.transform=[u*i,d*i,h*i,p*i,f-u*i*l-h*i*c,m-d*i*l-p*i*c],this.width=g,this.height=v}get rawDims(){const e=this.viewBox;return Oa(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ol({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const n=[e,t];return Ga.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Ga.applyTransform(t,this.transform);const n=[e[2],e[3]];return Ga.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Ga.applyInverseTransform(n,this.transform),n}}class al extends Da{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function ll(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function cl(e){return"string"===typeof e&&/\.pdf$/i.test(e)}class ul{constructor(){r(this,"started",Object.create(null)),r(this,"times",[])}time(e){e in this.started&&Ia("Timer is already running for ".concat(e)),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ia("Timer has not been started for ".concat(e)),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:s}of this.times)e.push("".concat(n.padEnd(t)," ").concat(s-i,"ms\n"));return e.join("")}}function dl(e,t){const n=t?URL.parse(e,t):URL.parse(e);return"http:"===(null===n||void 0===n?void 0:n.protocol)||"https:"===(null===n||void 0===n?void 0:n.protocol)}function hl(e){e.preventDefault()}function pl(e){e.preventDefault(),e.stopPropagation()}class fl{static toDateObject(e){if(e instanceof Date)return e;if(!e||"string"!==typeof e)return null;bo(fl,this,ml)._||(ml._=bo(fl,this,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?")));const t=bo(fl,this,ml)._.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let a=parseInt(t[6],10);a=a>=0&&a<=59?a:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,"-"===l?(r+=c,o+=u):"+"===l&&(r-=c,o-=u),new Date(Date.UTC(n,i,s,r,o,a))}}var ml={_:void 0};function gl(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ia('Not a valid color format: "'.concat(e,'"')),[0,0,0])}function vl(e){const{a:t,b:n,c:i,d:s,e:r,f:o}=e.getTransform();return[t,n,i,s,r,o]}function yl(e){const{a:t,b:n,c:i,d:s,e:r,f:o}=e.getTransform().invertSelf();return[t,n,i,s,r,o]}function bl(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof ol){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:r}=e,o=qa.isCSSRoundSupported,a="var(--total-scale-factor) * ".concat(i,"px"),l="var(--total-scale-factor) * ".concat(s,"px"),c=o?"round(down, ".concat(a,", var(--scale-round-x))"):"calc(".concat(a,")"),u=o?"round(down, ".concat(l,", var(--scale-round-y))"):"calc(".concat(l,")");n&&t.rotation%180!==0?(r.width=u,r.height=c):(r.width=c,r.height=u)}i&&e.setAttribute("data-main-rotation",t.rotation)}class wl{constructor(){const{pixelRatio:e}=wl;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,r=1/0,o=1/0,a=1/0;(n=wl.capPixels(n,s))>0&&(r=Math.sqrt(n/(e*t))),-1!==i&&(o=i/e,a=i/t);const l=Math.min(r,o,a);return(this.sx>l||this.sy>l)&&(this.sx=l,this.sy=l,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const _l=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class xl{static get isDarkMode(){var e,t;return Oa(this,"isDarkMode",!(null===(e=window)||void 0===e||null===(t=e.matchMedia)||void 0===t||!t.call(e,"(prefers-color-scheme: dark)").matches))}}function El(e,t){const n=e[0]/255,i=e[1]/255,s=e[2]/255,r=Math.max(n,i,s),o=Math.min(n,i,s),a=(r+o)/2;if(r===o)t[0]=t[1]=0;else{const e=r-o;switch(t[1]=a<.5?e/(r+o):e/(2-r-o),r){case n:t[0]=60*((i-s)/e+(i<s?6:0));break;case i:t[0]=60*((s-n)/e+2);break;case s:t[0]=60*((n-i)/e+4)}}t[2]=a}function Sl(e,t){const n=e[0],i=e[1],s=e[2],r=(1-Math.abs(2*s-1))*i,o=r*(1-Math.abs(n/60%2-1)),a=s-r/2;switch(Math.floor(n/60)){case 0:t[0]=r+a,t[1]=o+a,t[2]=a;break;case 1:t[0]=o+a,t[1]=r+a,t[2]=a;break;case 2:t[0]=a,t[1]=r+a,t[2]=o+a;break;case 3:t[0]=a,t[1]=o+a,t[2]=r+a;break;case 4:t[0]=o+a,t[1]=a,t[2]=r+a;break;case 5:case 6:t[0]=r+a,t[1]=a,t[2]=o+a}}function Al(e){return e<=.03928?e/12.92:((e+.055)/1.055)**2.4}function Cl(e,t,n){Sl(e,n),n.map(Al);const i=.2126*n[0]+.7152*n[1]+.0722*n[2];Sl(t,n),n.map(Al);const s=.2126*n[0]+.7152*n[1]+.0722*n[2];return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)}const Tl=new Map;function kl(e,t){let{html:n,dir:i,className:s}=e;const r=document.createDocumentFragment();if("string"===typeof n){const e=document.createElement("p");e.dir=i||"auto";const t=n.split(/(?:\r\n?|\n)/);for(let n=0,i=t.length;n<i;++n){const s=t[n];e.append(document.createTextNode(s)),n<i-1&&e.append(document.createElement("br"))}r.append(e)}else nl.render({xfaHtml:n,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",s),t.append(r)}function Il(e){const t=new Path2D;if(!e)return t;for(let n=0,i=e.length;n<i;)switch(e[n++]){case wa:t.moveTo(e[n++],e[n++]);break;case _a:t.lineTo(e[n++],e[n++]);break;case xa:t.bezierCurveTo(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);break;case Ea:t.quadraticCurveTo(e[n++],e[n++],e[n++],e[n++]);break;case Sa:t.closePath();break;default:Ia("Unrecognized drawing path operator: ".concat(e[n-1]))}return t}var Nl=new WeakMap,Pl=new WeakMap,Ml=new WeakMap,Rl=new WeakMap,Ol=new WeakMap,Dl=new WeakMap,Fl=new WeakMap,Ll=new WeakMap,jl=new WeakSet;class Ul{constructor(e){vo(this,jl),yo(this,Nl,null),yo(this,Pl,null),yo(this,Ml,void 0),yo(this,Rl,null),yo(this,Ol,null),yo(this,Dl,null),yo(this,Fl,null),yo(this,Ll,null),xo(Ml,this,e),zl._||(zl._=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=xo(Nl,this,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=_o(Ml,this)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",hl,{signal:t}),e.addEventListener("pointerdown",Bl,{signal:t}));const n=xo(Rl,this,document.createElement("div"));n.className="buttons",e.append(n);const i=_o(Ml,this).toolbarPosition;if(i){const{style:t}=e,n="ltr"===_o(Ml,this)._uiManager.direction?1-i[0]:i[0];t.insetInlineEnd="".concat(100*n,"%"),t.top="calc(".concat(100*i[1],"% + var(--editor-toolbar-vert-offset))")}return e}get div(){return _o(Nl,this)}hide(){var e;_o(Nl,this).classList.add("hidden"),null===(e=_o(Pl,this))||void 0===e||e.hideDropdown()}show(){var e,t;_o(Nl,this).classList.remove("hidden"),null===(e=_o(Ol,this))||void 0===e||e.shown(),null===(t=_o(Dl,this))||void 0===t||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=_o(Ml,this),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",zl._[e]),bo(jl,this,Vl).call(this,n)&&n.addEventListener("click",e=>{t.delete()},{signal:t._signal}),_o(Rl,this).append(n)}async addAltText(e){const t=await e.render();bo(jl,this,Vl).call(this,t),_o(Rl,this).append(t,wo(jl,this,ql)),xo(Ol,this,e)}addComment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(_o(Dl,this))return;const n=e.renderForToolbar();if(!n)return;bo(jl,this,Vl).call(this,n);const i=xo(Fl,this,wo(jl,this,ql));t?(_o(Rl,this).insertBefore(n,t),_o(Rl,this).insertBefore(i,t)):_o(Rl,this).append(n,i),xo(Dl,this,e),e.toolbar=this}addColorPicker(e){if(_o(Pl,this))return;xo(Pl,this,e);const t=e.renderButton();bo(jl,this,Vl).call(this,t),_o(Rl,this).append(t,wo(jl,this,ql))}async addEditSignatureButton(e){const t=xo(Ll,this,await e.renderEditButton(_o(Ml,this)));bo(jl,this,Vl).call(this,t),_o(Rl,this).append(t,wo(jl,this,ql))}removeButton(e){var t,n;if("comment"===e)null===(t=_o(Dl,this))||void 0===t||t.removeToolbarCommentButton(),xo(Dl,this,null),null===(n=_o(Fl,this))||void 0===n||n.remove(),xo(Fl,this,null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t)}}async addButtonBefore(e,t,n){if(!t&&"comment"===e)return;const i=_o(Rl,this).querySelector(n);i&&"comment"===e&&this.addComment(t,i)}updateEditSignatureButton(e){_o(Ll,this)&&(_o(Ll,this).title=e)}remove(){var e;_o(Nl,this).remove(),null===(e=_o(Pl,this))||void 0===e||e.destroy(),xo(Pl,this,null)}}function Bl(e){e.stopPropagation()}function Wl(e){_o(Ml,this)._focusEventsAllowed=!1,pl(e)}function Hl(e){_o(Ml,this)._focusEventsAllowed=!0,pl(e)}function Vl(e){const t=_o(Ml,this)._uiManager._signal;return t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("focusin",bo(jl,this,Wl).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",bo(jl,this,Hl).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",hl,{signal:t}),!0)}function ql(e){const t=document.createElement("div");return t.className="divider",t}var zl={_:null},Gl=new WeakMap,Jl=new WeakMap,Kl=new WeakMap,Yl=new WeakSet;class $l{constructor(e){vo(this,Yl),yo(this,Gl,null),yo(this,Jl,null),yo(this,Kl,void 0),xo(Kl,this,e)}show(e,t,n){const[i,s]=bo(Yl,this,Ql).call(this,t,n),{style:r}=_o(Jl,this)||xo(Jl,this,bo(Yl,this,Xl).call(this));e.append(_o(Jl,this)),r.insetInlineEnd="".concat(100*i,"%"),r.top="calc(".concat(100*s,"% + var(--editor-toolbar-vert-offset))")}hide(){_o(Jl,this).remove()}}function Xl(){const e=xo(Jl,this,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=_o(Kl,this)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",hl,{signal:t});const n=xo(Gl,this,document.createElement("div"));return n.className="buttons",e.append(n),_o(Kl,this).hasCommentManager()&&bo(Yl,this,Zl).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{_o(Kl,this).commentSelection("floating_button")}),bo(Yl,this,Zl).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{_o(Kl,this).highlightSelection("floating_button")}),e}function Ql(e,t){let n=0,i=0;for(const s of e){const e=s.y+s.height;if(e<n)continue;const r=s.x+(t?s.width:0);e>n?(i=r,n=e):t?r>i&&(i=r):r<i&&(i=r)}return[t?1-i:i,n]}function Zl(e,t,n,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const r=document.createElement("span");s.append(r),r.className="visuallyHidden",r.setAttribute("data-l10n-id",n);const o=_o(Kl,this)._signal;o instanceof AbortSignal&&!o.aborted&&(s.addEventListener("contextmenu",hl,{signal:o}),s.addEventListener("click",i,{signal:o})),_o(Gl,this).append(s)}function ec(e,t,n){for(const i of n)t.addEventListener(i,e[i].bind(e))}class tc{static initializeAndAddPointerId(e){(ic._||(ic._=new Set)).add(e)}static setPointer(e,t){var n;nc._||(nc._=t),null!==(n=rc._)&&void 0!==n||(rc._=e)}static setTimeStamp(e){sc._=e}static isSamePointerId(e){return nc._===e}static isSamePointerIdOrRemove(e){var t;return nc._===e||(null===(t=ic._)||void 0===t||t.delete(e),!1)}static isSamePointerType(e){return rc._===e}static isInitializedAndDifferentPointerType(e){return null!==rc._&&!tc.isSamePointerType(e)}static isSameTimeStamp(e){return sc._===e}static isUsingMultiplePointers(){var e;return(null===(e=ic._)||void 0===e?void 0:e.size)>=1}static clearPointerType(){rc._=null}static clearPointerIds(){nc._=NaN,ic._=null}static clearTimeStamp(){sc._=NaN}}var nc={_:NaN},ic={_:null},sc={_:NaN},rc={_:null},oc=new WeakMap;class ac{constructor(){yo(this,oc,0)}get id(){var e,t;return"".concat(ea).concat((xo(oc,this,(e=_o(oc,this),t=e++,e)),t))}}var lc=new WeakMap,cc=new WeakMap,uc=new WeakMap,dc=new WeakSet;class hc{constructor(){vo(this,dc),yo(this,lc,Xa()),yo(this,cc,0),yo(this,uc,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return Oa(this,"_isSVGFittingCanvas",t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0])))}async getFromFile(e){const{lastModified:t,name:n,size:i,type:s}=e;return bo(dc,this,pc).call(this,"".concat(t,"_").concat(n,"_").concat(i,"_").concat(s),e)}async getFromUrl(e){return bo(dc,this,pc).call(this,e,e)}async getFromBlob(e,t){const n=await t;return bo(dc,this,pc).call(this,e,n)}async getFromId(e){_o(uc,this)||xo(uc,this,new Map);const t=_o(uc,this).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){var n,i,s;_o(uc,this)||xo(uc,this,new Map);let r=_o(uc,this).get(e);if(null!==(s=r)&&void 0!==s&&s.bitmap)return r.refCounter+=1,r;const o=new OffscreenCanvas(t.width,t.height);return o.getContext("2d").drawImage(t,0,0),r={bitmap:o.transferToImageBitmap(),id:"image_".concat(_o(lc,this),"_").concat((xo(cc,this,(n=_o(cc,this),i=n++,n)),i)),refCounter:1,isSvg:!1},_o(uc,this).set(e,r),_o(uc,this).set(r.id,r),r}getSvgUrl(e){const t=_o(uc,this).get(e);return null!==t&&void 0!==t&&t.isSvg?t.svgUrl:null}deleteId(e){var t;_o(uc,this)||xo(uc,this,new Map);const n=_o(uc,this).get(e);if(!n)return;if(n.refCounter-=1,0!==n.refCounter)return;const{bitmap:i}=n;if(!n.url&&!n.file){const e=new OffscreenCanvas(i.width,i.height);e.getContext("bitmaprenderer").transferFromImageBitmap(i),n.blobPromise=e.convertToBlob()}null===(t=i.close)||void 0===t||t.call(i),n.bitmap=null}isValidId(e){return e.startsWith("image_".concat(_o(lc,this),"_"))}}async function pc(e,t){var n;_o(uc,this)||xo(uc,this,new Map);let i=_o(uc,this).get(e);if(null===i)return null;if(null!==(n=i)&&void 0!==n&&n.bitmap)return i.refCounter+=1,i;try{var s,r;let e;if(i||(i={bitmap:null,id:"image_".concat(_o(lc,this),"_").concat((xo(cc,this,(s=_o(cc,this),r=s++,s)),r)),refCounter:0,isSvg:!1}),"string"===typeof t?(i.url=t,e=await rl(t,"blob")):t instanceof File?e=i.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=Co._isSVGFittingCanvas,n=new FileReader,s=new Image,r=new Promise((e,r)=>{s.onload=()=>{i.bitmap=s,i.isSvg=!0,e()},n.onload=async()=>{const e=i.svgUrl=n.result;s.src=await t?"".concat(e,"#svgView(preserveAspectRatio(none))"):e},s.onerror=n.onerror=r});n.readAsDataURL(e),await r}else i.bitmap=await createImageBitmap(e);i.refCounter=1}catch(o){Ia(o),i=null}return _o(uc,this).set(e,i),i&&_o(uc,this).set(i.id,i),i}Co=hc;var fc=new WeakMap,mc=new WeakMap,gc=new WeakMap,vc=new WeakMap;class yc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;yo(this,fc,[]),yo(this,mc,!1),yo(this,gc,void 0),yo(this,vc,-1),xo(gc,this,e)}add(e){let{cmd:t,undo:n,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}=e;if(s&&t(),_o(mc,this))return;const l={cmd:t,undo:n,post:i,type:r};if(-1===_o(vc,this))return _o(fc,this).length>0&&(_o(fc,this).length=0),xo(vc,this,0),void _o(fc,this).push(l);if(o&&_o(fc,this)[_o(vc,this)].type===r)return a&&(l.undo=_o(fc,this)[_o(vc,this)].undo),void(_o(fc,this)[_o(vc,this)]=l);const c=_o(vc,this)+1;c===_o(gc,this)?_o(fc,this).splice(0,1):(xo(vc,this,c),c<_o(fc,this).length&&_o(fc,this).splice(c)),_o(fc,this).push(l)}undo(){if(-1===_o(vc,this))return;xo(mc,this,!0);const{undo:e,post:t}=_o(fc,this)[_o(vc,this)];e(),null===t||void 0===t||t(),xo(mc,this,!1),xo(vc,this,_o(vc,this)-1)}redo(){if(_o(vc,this)<_o(fc,this).length-1){xo(vc,this,_o(vc,this)+1),xo(mc,this,!0);const{cmd:e,post:t}=_o(fc,this)[_o(vc,this)];e(),null===t||void 0===t||t(),xo(mc,this,!1)}}hasSomethingToUndo(){return-1!==_o(vc,this)}hasSomethingToRedo(){return _o(vc,this)<_o(fc,this).length-1}cleanType(e){if(-1!==_o(vc,this)){for(let t=_o(vc,this);t>=0;t--)if(_o(fc,this)[t].type!==e)return _o(fc,this).splice(t+1,_o(vc,this)-t),void xo(vc,this,t);_o(fc,this).length=0,xo(vc,this,-1)}}destroy(){xo(fc,this,null)}}var bc=new WeakSet;class wc{constructor(e){vo(this,bc),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=qa.platform;for(const[n,i,s={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:i,options:s}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:i,options:s}),this.allKeys.add(e.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(bo(bc,this,_c).call(this,t));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:r=[],checker:o=null}}=n;o&&!o(e,t)||(i.bind(e,...r,t)(),s||pl(t))}}function _c(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}class xc{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const n of e.keys()){t.style.color=n;const i=window.getComputedStyle(t).color;e.set(n,gl(i))}t.remove()}(e),Oa(this,"_colors",e)}convert(e){const t=gl(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((e,n)=>e===t[n]))return xc._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Ga.makeHexColor(...t):e}}r(xc,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var Ec=new WeakMap,Sc=new WeakMap,Ac=new WeakMap,Cc=new WeakMap,Tc=new WeakMap,kc=new WeakMap,Ic=new WeakMap,Nc=new WeakMap,Pc=new WeakMap,Mc=new WeakMap,Rc=new WeakMap,Oc=new WeakMap,Dc=new WeakMap,Fc=new WeakMap,Lc=new WeakMap,jc=new WeakMap,Uc=new WeakMap,Bc=new WeakMap,Wc=new WeakMap,Hc=new WeakMap,Vc=new WeakMap,qc=new WeakMap,zc=new WeakMap,Gc=new WeakMap,Jc=new WeakMap,Kc=new WeakMap,Yc=new WeakMap,$c=new WeakMap,Xc=new WeakMap,Qc=new WeakMap,Zc=new WeakMap,eu=new WeakMap,tu=new WeakMap,nu=new WeakMap,iu=new WeakMap,su=new WeakMap,ru=new WeakMap,ou=new WeakMap,au=new WeakMap,lu=new WeakMap,cu=new WeakMap,uu=new WeakMap,du=new WeakMap,hu=new WeakMap,pu=new WeakMap,fu=new WeakMap,mu=new WeakMap,gu=new WeakMap,vu=new WeakMap,yu=new WeakSet;class bu{static get _keyboardManager(){const e=bu.prototype,t=e=>_o(fu,e).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),n=(e,t)=>{let{target:n}=t;if(n instanceof HTMLInputElement){const{type:e}=n;return"text"!==e&&"number"!==e}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Oa(this,"_keyboardManager",new wc([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&_o(fu,e).contains(n)&&!e.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&_o(fu,e).contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}constructor(e,t,n,i,s,o,a,l,c,u,d,h,p,f,m,g){vo(this,yu),yo(this,Ec,new AbortController),yo(this,Sc,null),yo(this,Ac,null),yo(this,Cc,new Map),yo(this,Tc,new Map),yo(this,kc,null),yo(this,Ic,null),yo(this,Nc,null),yo(this,Pc,new yc),yo(this,Mc,null),yo(this,Rc,null),yo(this,Oc,null),yo(this,Dc,0),yo(this,Fc,new Set),yo(this,Lc,null),yo(this,jc,null),yo(this,Uc,new Set),r(this,"_editorUndoBar",null),yo(this,Bc,!1),yo(this,Wc,!1),yo(this,Hc,!1),yo(this,Vc,null),yo(this,qc,null),yo(this,zc,null),yo(this,Gc,null),yo(this,Jc,!1),yo(this,Kc,null),yo(this,Yc,new ac),yo(this,$c,!1),yo(this,Xc,!1),yo(this,Qc,!1),yo(this,Zc,null),yo(this,eu,null),yo(this,tu,null),yo(this,nu,null),yo(this,iu,null),yo(this,su,ta.NONE),yo(this,ru,new Set),yo(this,ou,null),yo(this,au,null),yo(this,lu,null),yo(this,cu,null),yo(this,uu,null),yo(this,du,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),yo(this,hu,[0,0]),yo(this,pu,null),yo(this,fu,null),yo(this,mu,null),yo(this,gu,null),yo(this,vu,null);const v=this._signal=_o(Ec,this).signal;xo(fu,this,e),xo(mu,this,t),xo(gu,this,n),xo(kc,this,i),xo(Mc,this,s),xo(au,this,o),xo(uu,this,l),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:v}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),a._on("setpreference",this.onSetPreference.bind(this),{signal:v}),a._on("switchannotationeditorparams",e=>this.updateParams(e.type,e.value),{signal:v}),window.addEventListener("pointerdown",()=>{xo(Xc,this,!0)},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{xo(Xc,this,!1)},{capture:!0,signal:v}),bo(yu,this,Au).call(this),bo(yu,this,Mu).call(this),bo(yu,this,ku).call(this),xo(Ic,this,l.annotationStorage),xo(Vc,this,l.filterFactory),xo(lu,this,c),xo(Gc,this,u||null),xo(Bc,this,d),xo(Wc,this,h),xo(Hc,this,p),xo(iu,this,f||null),this.viewParameters={realScale:sl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=!1!==g,null===s||void 0===s||s.setSidebarUiManager(this)}destroy(){var e,t,n,i,s,r,o,a,l;null===(e=_o(vu,this))||void 0===e||e.resolve(),xo(vu,this,null),null===(t=_o(Ec,this))||void 0===t||t.abort(),xo(Ec,this,null),this._signal=null;for(const c of _o(Tc,this).values())c.destroy();_o(Tc,this).clear(),_o(Cc,this).clear(),_o(Uc,this).clear(),null===(n=_o(nu,this))||void 0===n||n.clear(),xo(Sc,this,null),_o(ru,this).clear(),_o(Pc,this).destroy(),null===(i=_o(kc,this))||void 0===i||i.destroy(),null===(s=_o(Mc,this))||void 0===s||s.destroy(),null===(r=_o(au,this))||void 0===r||r.destroy(),null===(o=_o(Kc,this))||void 0===o||o.hide(),xo(Kc,this,null),null===(a=_o(tu,this))||void 0===a||a.destroy(),xo(tu,this,null),xo(Ac,this,null),_o(qc,this)&&(clearTimeout(_o(qc,this)),xo(qc,this,null)),_o(pu,this)&&(clearTimeout(_o(pu,this)),xo(pu,this,null)),null===(l=this._editorUndoBar)||void 0===l||l.destroy(),xo(uu,this,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return _o(iu,this)}get useNewAltTextFlow(){return _o(Wc,this)}get useNewAltTextWhenAddingImage(){return _o(Hc,this)}get hcmFilter(){return Oa(this,"hcmFilter",_o(lu,this)?_o(Vc,this).addHCMFilter(_o(lu,this).foreground,_o(lu,this).background):"none")}get direction(){return Oa(this,"direction",getComputedStyle(_o(fu,this)).direction)}get _highlightColors(){return Oa(this,"_highlightColors",_o(Gc,this)?new Map(_o(Gc,this).split(",").map(e=>((e=e.split("=").map(e=>e.trim()))[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Oa(this,"highlightColors",null);const t=new Map,n=!!_o(lu,this);for(const[i,s]of e){const e=i.endsWith("_HCM");n&&e?t.set(i.replace("_HCM",""),s):n||e||t.set(i,s)}return Oa(this,"highlightColors",t)}get highlightColorNames(){return Oa(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),xo(Oc,this,e)}setMainHighlightColorPicker(e){xo(tu,this,e)}editAltText(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=_o(kc,this))||void 0===t||t.editAltText(this,e,n)}hasCommentManager(){return!!_o(Mc,this)}editComment(e,t,n,i){var s;null===(s=_o(Mc,this))||void 0===s||s.showDialog(this,e,t,n,i)}selectComment(e,t){const n=_o(Tc,this).get(e),i=null===n||void 0===n?void 0:n.getEditorByUID(t);null===i||void 0===i||i.toggleComment(!0,!0)}updateComment(e){var t;null===(t=_o(Mc,this))||void 0===t||t.updateComment(e.getData())}updatePopupColor(e){var t;null===(t=_o(Mc,this))||void 0===t||t.updatePopupColor(e)}removeComment(e){var t;null===(t=_o(Mc,this))||void 0===t||t.removeComments([e.uid])}toggleComment(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;null===(n=_o(Mc,this))||void 0===n||n.toggleCommentPopup(e,t,i)}makeCommentColor(e,t){var n;return e&&(null===(n=_o(Mc,this))||void 0===n?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return(null===(e=_o(Mc,this))||void 0===e?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(_o(Tc,this).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=n=>{n.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){var t;null===(t=_o(au,this))||void 0===t||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return _o(au,this)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference(e){let{name:t,value:n}=e;if("enableNewAltTextWhenAddingImage"===t)xo(Hc,this,n)}onPageChanging(e){let{pageNumber:t}=e;xo(Dc,this,t-1)}focusMainContainer(){_o(fu,this).focus()}findParent(e,t){for(const n of _o(Tc,this).values()){const{x:i,y:s,width:r,height:o}=n.div.getBoundingClientRect();if(e>=i&&e<=i+r&&t>=s&&t<=s+o)return n}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_o(mu,this).classList.toggle("noUserSelect",e)}addShouldRescale(e){_o(Uc,this).add(e)}removeShouldRescale(e){_o(Uc,this).delete(e)}onScaleChanging(e){var t;let{scale:n}=e;this.commitOrRemove(),this.viewParameters.realScale=n*sl.PDF_TO_CSS_UNITS;for(const i of _o(Uc,this))i.onScaleChanging();null===(t=_o(Oc,this))||void 0===t||t.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o}=n,a=n.toString(),l=bo(yu,this,wu).call(this,n).closest(".textLayer"),c=this.getSelectionBoxes(l);if(!c)return;n.empty();const u=bo(yu,this,_u).call(this,l),d=_o(su,this)===ta.NONE,h=()=>{const n=null===u||void 0===u?void 0:u.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:c,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o,text:a});d&&this.showAllEditors("highlight",!0,!0),t&&(null===n||void 0===n||n.editComment())};d?this.switchToMode(ta.HIGHLIGHT,h):h()}commentSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!_o(Ic,this))return null;const t="".concat(ea).concat(e),n=_o(Ic,this).getRawValue(t);return n&&_o(Ic,this).remove(t),n}addToAnnotationStorage(e){e.isEmpty()||!_o(Ic,this)||_o(Ic,this).has(e.id)||_o(Ic,this).setValue(e.id,e)}a11yAlert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=_o(gu,this);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,_o(Jc,this)&&(xo(Jc,this,!1),bo(yu,this,Su).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of _o(ru,this))if(t.div.contains(e)){xo(eu,this,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!_o(eu,this))return;const[e,t]=_o(eu,this);xo(eu,this,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){bo(yu,this,ku).call(this),this.setEditingState(!0)}removeEditListeners(){bo(yu,this,Iu).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of _o(jc,this))if(n.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const n of _o(jc,this))if(n.isHandlingMimeForPasting(t.type))return n.paste(t,this.currentLayer),void e.preventDefault()}copy(e){var t;if(e.preventDefault(),null===(t=_o(Sc,this))||void 0===t||t.commitOrRemove(),!this.hasSelection)return;const n=[];for(const i of _o(ru,this)){const e=i.serialize(!0);e&&n.push(e)}0!==n.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const e of _o(jc,this))if(e.isHandlingMimeForPasting(r.type))return void e.paste(r,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){return void Ia('paste: "'.concat(s.message,'".'))}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const e=[];for(const r of n){const t=await i.deserialize(r);if(!t)return;e.push(t)}const t=()=>{for(const t of e)bo(yu,this,Lu).call(this,t);bo(yu,this,Bu).call(this,e)},s=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:s,mustExec:!0})}catch(s){Ia('paste: "'.concat(s.message,'".'))}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),_o(su,this)===ta.NONE||this.isEditorHandlingKeyboard||bu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,_o(Jc,this)&&(xo(Jc,this,!1),bo(yu,this,Su).call(this,"main_toolbar")))}onEditingAction(e){let{name:t}=e;switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu")}}setEditingState(e){e?(bo(yu,this,Cu).call(this),bo(yu,this,Nu).call(this),bo(yu,this,Ru).call(this,{isEditing:_o(su,this)!==ta.NONE,isEmpty:bo(yu,this,Uu).call(this),hasSomethingToUndo:_o(Pc,this).hasSomethingToUndo(),hasSomethingToRedo:_o(Pc,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(bo(yu,this,Tu).call(this),bo(yu,this,Pu).call(this),bo(yu,this,Ru).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!_o(jc,this)){xo(jc,this,e);for(const e of _o(jc,this))bo(yu,this,Ou).call(this,e.defaultPropertiesToUpdate)}}getId(){return _o(Yc,this).id}get currentLayer(){return _o(Tc,this).get(_o(Dc,this))}getLayer(e){return _o(Tc,this).get(e)}get currentPageIndex(){return _o(Dc,this)}addLayer(e){_o(Tc,this).set(e.pageIndex,e),_o($c,this)?e.enable():e.disable()}removeLayer(e){_o(Tc,this).delete(e.pageIndex)}async updateMode(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(_o(su,this)!==e&&(!_o(vu,this)||(await _o(vu,this).promise,_o(vu,this)))){var l,c;if(xo(vu,this,Promise.withResolvers()),null===(t=_o(Oc,this))||void 0===t||t.commitOrRemove(),_o(su,this)===ta.POPUP)null===(l=_o(Mc,this))||void 0===l||l.hideSidebar();if(null===(n=_o(Mc,this))||void 0===n||n.destroyPopup(),xo(su,this,e),e===ta.NONE){var u;this.setEditingState(!1),bo(yu,this,Fu).call(this);for(const e of _o(Cc,this).values())e.hideStandaloneCommentButton();return null===(u=this._editorUndoBar)||void 0===u||u.hide(),this.toggleComment(null),void _o(vu,this).resolve()}for(const e of _o(Cc,this).values())e.addStandaloneCommentButton();if(e===ta.SIGNATURE)await(null===(c=_o(au,this))||void 0===c?void 0:c.loadSignatures());s&&tc.clearPointerType(),this.setEditingState(!0),await bo(yu,this,Du).call(this),this.unselectAll();for(const t of _o(Tc,this).values())t.updateMode(e);if(e===ta.POPUP){var d;_o(Ac,this)||xo(Ac,this,await _o(uu,this).getAnnotationsByType(new Set(_o(jc,this).map(e=>e._editorType))));const e=new Set,t=[];for(const n of _o(Cc,this).values()){const{annotationElementId:i,hasComment:s,deleted:r}=n;i&&e.add(i),s&&!r&&t.push(n.getData())}for(const n of _o(Ac,this)){const{id:i,popupRef:s,contentsObj:r}=n;s&&null!==r&&void 0!==r&&r.str&&!e.has(i)&&!_o(Fc,this).has(i)&&t.push(n)}null===(d=_o(Mc,this))||void 0===d||d.showSidebar(t)}if(!i)return r&&this.addNewEditorFromKeyboard(),void _o(vu,this).resolve();for(const e of _o(Cc,this).values())e.uid===i?(this.setSelected(e),a?e.editComment():o?e.enterInEditMode():e.focus()):e.unselect();_o(vu,this).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==_o(su,this)&&this._eventBus.dispatch("switchannotationeditormode",a({source:this},e))}updateParams(e,t){if(_o(jc,this)){switch(e){case na.CREATE:return void this.currentLayer.addNewEditor(t);case na.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(_o(cu,this)||xo(cu,this,new Map)).set(e,t),this.showAllEditors("highlight",t)}if(this.hasSelection)for(const n of _o(ru,this))n.updateParams(e,t);else for(const n of _o(jc,this))n.updateDefaultParams(e,t)}}showAllEditors(e,t){var n,i;for(const s of _o(Cc,this).values())s.editorType===e&&s.show(t);(null===(n=null===(i=_o(cu,this))||void 0===i?void 0:i.get(na.HIGHLIGHT_SHOW_ALL))||void 0===n||n)!==t&&bo(yu,this,Ou).call(this,[[na.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(_o(Qc,this)!==e){xo(Qc,this,e);for(const t of _o(Tc,this).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of _o(Cc,this).values())t.pageIndex===e&&(yield t)}getEditor(e){return _o(Cc,this).get(e)}addEditor(e){_o(Cc,this).set(e.id,e)}removeEditor(e){var t,n;(e.div.contains(document.activeElement)&&(_o(qc,this)&&clearTimeout(_o(qc,this)),xo(qc,this,setTimeout(()=>{this.focusMainContainer(),xo(qc,this,null)},0))),_o(Cc,this).delete(e.id),e.annotationElementId)&&(null===(t=_o(nu,this))||void 0===t||t.delete(e.annotationElementId));(this.unselect(e),e.annotationElementId&&_o(Fc,this).has(e.annotationElementId))||(null===(n=_o(Ic,this))||void 0===n||n.remove(e.id))}addDeletedAnnotationElement(e){_o(Fc,this).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return _o(Fc,this).has(e)}removeDeletedAnnotationElement(e){_o(Fc,this).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){_o(Sc,this)!==e&&(xo(Sc,this,e),e&&bo(yu,this,Ou).call(this,e.propertiesToUpdate))}updateUI(e){wo(yu,this,ju)===e&&bo(yu,this,Ou).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){bo(yu,this,Ou).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(_o(ru,this).has(e))return _o(ru,this).delete(e),e.unselect(),void bo(yu,this,Ru).call(this,{hasSelectedEditor:this.hasSelection});_o(ru,this).add(e),e.select(),bo(yu,this,Ou).call(this,e.propertiesToUpdate),bo(yu,this,Ru).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),null===(t=_o(Oc,this))||void 0===t||t.commitOrRemove();for(const n of _o(ru,this))n!==e&&n.unselect();_o(ru,this).clear(),_o(ru,this).add(e),e.select(),bo(yu,this,Ou).call(this,e.propertiesToUpdate),bo(yu,this,Ru).call(this,{hasSelectedEditor:!0})}isSelected(e){return _o(ru,this).has(e)}get firstSelectedEditor(){return _o(ru,this).values().next().value}unselect(e){e.unselect(),_o(ru,this).delete(e),bo(yu,this,Ru).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==_o(ru,this).size}get isEnterHandled(){return 1===_o(ru,this).size&&this.firstSelectedEditor.isEnterHandled}undo(){var e;_o(Pc,this).undo(),bo(yu,this,Ru).call(this,{hasSomethingToUndo:_o(Pc,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:bo(yu,this,Uu).call(this)}),null===(e=this._editorUndoBar)||void 0===e||e.hide()}redo(){_o(Pc,this).redo(),bo(yu,this,Ru).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:_o(Pc,this).hasSomethingToRedo(),isEmpty:bo(yu,this,Uu).call(this)})}addCommands(e){_o(Pc,this).add(e),bo(yu,this,Ru).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:bo(yu,this,Uu).call(this)})}cleanUndoStack(e){_o(Pc,this).cleanType(e)}delete(){var e;this.commitOrRemove();const t=null===(e=this.currentLayer)||void 0===e?void 0:e.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const n=t?[t]:[..._o(ru,this)],i=()=>{for(const e of n)bo(yu,this,Lu).call(this,e)};this.addCommands({cmd:()=>{var e;null===(e=this._editorUndoBar)||void 0===e||e.show(i,1===n.length?n[0].editorType:n.length);for(const t of n)t.remove()},undo:i,mustExec:!0})}commitOrRemove(){var e;null===(e=_o(Sc,this))||void 0===e||e.commitOrRemove()}hasSomethingToControl(){return _o(Sc,this)||this.hasSelection}selectAll(){for(const e of _o(ru,this))e.commit();bo(yu,this,Bu).call(this,_o(Cc,this).values())}unselectAll(){var e;if((!_o(Sc,this)||(_o(Sc,this).commitOrRemove(),_o(su,this)===ta.NONE))&&(null===(e=_o(Oc,this))||void 0===e||!e.commitOrRemove())&&this.hasSelection){for(const e of _o(ru,this))e.unselect();_o(ru,this).clear(),bo(yu,this,Ru).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;_o(hu,this)[0]+=e,_o(hu,this)[1]+=t;const[n,i]=_o(hu,this),s=[..._o(ru,this)];_o(pu,this)&&clearTimeout(_o(pu,this)),xo(pu,this,setTimeout(()=>{xo(pu,this,null),_o(hu,this)[0]=_o(hu,this)[1]=0,this.addCommands({cmd:()=>{for(const e of s)_o(Cc,this).has(e.id)&&(e.translateInPage(n,i),e.translationDone())},undo:()=>{for(const e of s)_o(Cc,this).has(e.id)&&(e.translateInPage(-n,-i),e.translationDone())},mustExec:!1})},1e3));for(const r of s)r.translateInPage(e,t),r.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),xo(Lc,this,new Map);for(const e of _o(ru,this))_o(Lc,this).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!_o(Lc,this))return!1;this.disableUserSelect(!1);const e=_o(Lc,this);xo(Lc,this,null);let t=!1;for(const[{x:i,y:s,pageIndex:r},o]of e)o.newX=i,o.newY=s,o.newPageIndex=r,t||(t=i!==o.savedX||s!==o.savedY||r!==o.savedPageIndex);if(!t)return!1;const n=(e,t,n,i)=>{if(_o(Cc,this).has(e.id)){const s=_o(Tc,this).get(i);s?e._setParentAndPosition(s,t,n):(e.pageIndex=i,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:i,newY:s,newPageIndex:r}]of e)n(t,i,s,r)},undo:()=>{for(const[t,{savedX:i,savedY:s,savedPageIndex:r}]of e)n(t,i,s,r)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(_o(Lc,this))for(const n of _o(Lc,this).keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return(null===(e=this.getActive())||void 0===e?void 0:e.shouldGetKeyboardEvents())||1===_o(ru,this).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return _o(Sc,this)===e}getActive(){return _o(Sc,this)}getMode(){return _o(su,this)}isEditingMode(){return _o(su,this)!==ta.NONE}get imageManager(){return Oa(this,"imageManager",new hc)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:r}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(e,t,o,a)=>({x:(t-i)/r,y:1-(e+o-n)/s,width:a/r,height:o/s});break;case"180":o=(e,t,o,a)=>({x:1-(e+o-n)/s,y:1-(t+a-i)/r,width:o/s,height:a/r});break;case"270":o=(e,t,o,a)=>({x:1-(t+a-i)/r,y:(e-n)/s,width:a/r,height:o/s});break;default:o=(e,t,o,a)=>({x:(e-n)/s,y:(t-i)/r,width:o/s,height:a/r})}const a=[];for(let l=0,c=t.rangeCount;l<c;l++){const e=t.getRangeAt(l);if(!e.collapsed)for(const{x:t,y:n,width:i,height:s}of e.getClientRects())0!==i&&0!==s&&a.push(o(t,n,i,s))}return 0===a.length?null:a}addChangedExistingAnnotation(e){let{annotationElementId:t,id:n}=e;(_o(Nc,this)||xo(Nc,this,new Map)).set(t,n)}removeChangedExistingAnnotation(e){var t;let{annotationElementId:n}=e;null===(t=_o(Nc,this))||void 0===t||t.delete(n)}renderAnnotationElement(e){var t;const n=null===(t=_o(Nc,this))||void 0===t?void 0:t.get(e.data.id);if(!n)return;const i=_o(Ic,this).getRawValue(n);i&&(_o(su,this)!==ta.NONE||i.hasBeenModified)&&i.renderAnnotationElement(e)}setMissingCanvas(e,t,n){var i;const s=null===(i=_o(nu,this))||void 0===i?void 0:i.get(e);s&&(s.setCanvas(t,n),_o(nu,this).delete(e))}addMissingCanvas(e,t){(_o(nu,this)||xo(nu,this,new Map)).set(e,t)}}function wu(e){let{anchorNode:t}=e;return t.nodeType===Node.TEXT_NODE?t.parentElement:t}function _u(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of _o(Tc,this).values())if(n.hasTextLayer(e))return n;return null}function xu(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=bo(yu,this,wu).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(t);n&&(_o(Kc,this)||xo(Kc,this,new $l(this)),_o(Kc,this).show(t,n,"ltr"===this.direction))}function Eu(){var e;const t=document.getSelection();if(!t||t.isCollapsed){var n;if(_o(ou,this))null===(n=_o(Kc,this))||void 0===n||n.hide(),xo(ou,this,null),bo(yu,this,Ru).call(this,{hasSelectedText:!1});return}const{anchorNode:i}=t;if(i===_o(ou,this))return;const s=bo(yu,this,wu).call(this,t).closest(".textLayer");var r;if(s){if(null===(e=_o(Kc,this))||void 0===e||e.hide(),xo(ou,this,i),bo(yu,this,Ru).call(this,{hasSelectedText:!0}),(_o(su,this)===ta.HIGHLIGHT||_o(su,this)===ta.NONE)&&(_o(su,this)===ta.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),xo(Jc,this,this.isShiftKeyDown),!this.isShiftKeyDown)){const e=_o(su,this)===ta.HIGHLIGHT?bo(yu,this,_u).call(this,s):null;if(null===e||void 0===e||e.toggleDrawing(),_o(Xc,this)){const t=new AbortController,n=this.combinedSignal(t),i=n=>{"pointerup"===n.type&&0!==n.button||(t.abort(),null===e||void 0===e||e.toggleDrawing(!0),"pointerup"===n.type&&bo(yu,this,Su).call(this,"main_toolbar"))};window.addEventListener("pointerup",i,{signal:n}),window.addEventListener("blur",i,{signal:n})}else null===e||void 0===e||e.toggleDrawing(!0),bo(yu,this,Su).call(this,"main_toolbar")}}else _o(ou,this)&&(null===(r=_o(Kc,this))||void 0===r||r.hide(),xo(ou,this,null),bo(yu,this,Ru).call(this,{hasSelectedText:!1}))}function Su(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";_o(su,this)===ta.HIGHLIGHT?this.highlightSelection(e):_o(Bc,this)&&bo(yu,this,xu).call(this)}function Au(){document.addEventListener("selectionchange",bo(yu,this,Eu).bind(this),{signal:this._signal})}function Cu(){if(_o(zc,this))return;xo(zc,this,new AbortController);const e=this.combinedSignal(_o(zc,this));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}function Tu(){var e;null===(e=_o(zc,this))||void 0===e||e.abort(),xo(zc,this,null)}function ku(){if(_o(Zc,this))return;xo(Zc,this,new AbortController);const e=this.combinedSignal(_o(Zc,this));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}function Iu(){var e;null===(e=_o(Zc,this))||void 0===e||e.abort(),xo(Zc,this,null)}function Nu(){if(_o(Rc,this))return;xo(Rc,this,new AbortController);const e=this.combinedSignal(_o(Rc,this));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}function Pu(){var e;null===(e=_o(Rc,this))||void 0===e||e.abort(),xo(Rc,this,null)}function Mu(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}function Ru(e){Object.entries(e).some(e=>{let[t,n]=e;return _o(du,this)[t]!==n})&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(_o(du,this),e)}),_o(su,this)===ta.HIGHLIGHT&&!1===e.hasSelectedEditor&&bo(yu,this,Ou).call(this,[[na.HIGHLIGHT_FREE,!0]]))}function Ou(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}async function Du(){if(!_o($c,this)){xo($c,this,!0);const e=[];for(const t of _o(Tc,this).values())e.push(t.enable());await Promise.all(e);for(const t of _o(Cc,this).values())t.enable()}}function Fu(){if(this.unselectAll(),_o($c,this)){xo($c,this,!1);for(const e of _o(Tc,this).values())e.disable();for(const e of _o(Cc,this).values())e.disable()}}function Lu(e){const t=_o(Tc,this).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}function ju(e){let t=null;for(t of _o(ru,e));return t}function Uu(){if(0===_o(Cc,this).size)return!0;if(1===_o(Cc,this).size)for(const e of _o(Cc,this).values())return e.isEmpty();return!1}function Bu(e){for(const t of _o(ru,this))t.unselect();_o(ru,this).clear();for(const t of e)t.isEmpty()||(_o(ru,this).add(t),t.select());bo(yu,this,Ru).call(this,{hasSelectedEditor:this.hasSelection})}r(bu,"TRANSLATE_SMALL",1),r(bu,"TRANSLATE_BIG",10);var Wu=new WeakMap,Hu=new WeakMap,Vu=new WeakMap,qu=new WeakMap,zu=new WeakMap,Gu=new WeakMap,Ju=new WeakMap,Ku=new WeakMap,Yu=new WeakMap,$u=new WeakMap,Xu=new WeakMap,Qu=new WeakMap,Zu=new WeakSet;class ed{constructor(e){vo(this,Zu),yo(this,Wu,null),yo(this,Hu,!1),yo(this,Vu,null),yo(this,qu,null),yo(this,zu,null),yo(this,Gu,null),yo(this,Ju,!1),yo(this,Ku,null),yo(this,Yu,null),yo(this,$u,null),yo(this,Xu,null),yo(this,Qu,!1),xo(Yu,this,e),xo(Qu,this,e._uiManager.useNewAltTextFlow),id._||(id._=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){var t;null!==(t=ed._l10n)&&void 0!==t||(ed._l10n=e)}async render(){const e=xo(Vu,this,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=xo(qu,this,document.createElement("span"));e.append(t),_o(Qu,this)?(e.classList.add("new"),e.setAttribute("data-l10n-id",id._.missing),t.setAttribute("data-l10n-id",id._["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=_o(Yu,this)._uiManager._signal;e.addEventListener("contextmenu",hl,{signal:n}),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const i=e=>{e.preventDefault(),_o(Yu,this)._uiManager.editAltText(_o(Yu,this)),_o(Qu,this)&&_o(Yu,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:wo(Zu,this,td)}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(xo(Ju,this,!0),i(t))},{signal:n}),await bo(Zu,this,nd).call(this),e}finish(){_o(Vu,this)&&(_o(Vu,this).focus({focusVisible:_o(Ju,this)}),xo(Ju,this,!1))}isEmpty(){return _o(Qu,this)?null===_o(Wu,this):!_o(Wu,this)&&!_o(Hu,this)}hasData(){return _o(Qu,this)?null!==_o(Wu,this)||!!_o($u,this):this.isEmpty()}get guessedText(){return _o($u,this)}async setGuessedText(e){null===_o(Wu,this)&&(xo($u,this,e),xo(Xu,this,await ed._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),bo(Zu,this,nd).call(this))}toggleAltTextBadge(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(!_o(Qu,this)||_o(Wu,this))return null===(t=_o(Ku,this))||void 0===t||t.remove(),void xo(Ku,this,null);if(!_o(Ku,this)){const e=xo(Ku,this,document.createElement("div"));e.className="noAltTextBadge",_o(Yu,this).div.append(e)}_o(Ku,this).classList.toggle("hidden",!e)}serialize(e){let t=_o(Wu,this);return e||_o($u,this)!==t||(t=_o(Xu,this)),{altText:t,decorative:_o(Hu,this),guessedText:_o($u,this),textWithDisclaimer:_o(Xu,this)}}get data(){return{altText:_o(Wu,this),decorative:_o(Hu,this)}}set data(e){let{altText:t,decorative:n,guessedText:i,textWithDisclaimer:s,cancel:r=!1}=e;i&&(xo($u,this,i),xo(Xu,this,s)),_o(Wu,this)===t&&_o(Hu,this)===n||(r||(xo(Wu,this,t),xo(Hu,this,n)),bo(Zu,this,nd).call(this))}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_o(Vu,this)&&(!e&&_o(Gu,this)&&(clearTimeout(_o(Gu,this)),xo(Gu,this,null)),_o(Vu,this).disabled=!e)}shown(){_o(Yu,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:wo(Zu,this,td)}})}destroy(){var e,t;null===(e=_o(Vu,this))||void 0===e||e.remove(),xo(Vu,this,null),xo(qu,this,null),xo(zu,this,null),null===(t=_o(Ku,this))||void 0===t||t.remove(),xo(Ku,this,null)}}function td(e){return(_o(Wu,e)?"added":null===_o(Wu,e)&&e.guessedText&&"review")||"missing"}async function nd(){const e=_o(Vu,this);if(!e)return;if(_o(Qu,this)){var t,n;if(e.classList.toggle("done",!!_o(Wu,this)),e.setAttribute("data-l10n-id",id._[wo(Zu,this,td)]),null===(t=_o(qu,this))||void 0===t||t.setAttribute("data-l10n-id",id._["".concat(wo(Zu,this,td),"-label")]),!_o(Wu,this))return void(null===(n=_o(zu,this))||void 0===n||n.remove())}else{var i;if(!_o(Wu,this)&&!_o(Hu,this))return e.classList.remove("done"),void(null===(i=_o(zu,this))||void 0===i||i.remove());e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let s=_o(zu,this);if(!s){xo(zu,this,s=document.createElement("span")),s.className="tooltip",s.setAttribute("role","tooltip"),s.id="alt-text-tooltip-".concat(_o(Yu,this).id);const t=100,n=_o(Yu,this)._uiManager._signal;n.addEventListener("abort",()=>{clearTimeout(_o(Gu,this)),xo(Gu,this,null)},{once:!0}),e.addEventListener("mouseenter",()=>{xo(Gu,this,setTimeout(()=>{xo(Gu,this,null),_o(zu,this).classList.add("show"),_o(Yu,this)._reportTelemetry({action:"alt_text_tooltip"})},t))},{signal:n}),e.addEventListener("mouseleave",()=>{var e;_o(Gu,this)&&(clearTimeout(_o(Gu,this)),xo(Gu,this,null)),null===(e=_o(zu,this))||void 0===e||e.classList.remove("show")},{signal:n})}_o(Hu,this)?s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(s.removeAttribute("data-l10n-id"),s.textContent=_o(Wu,this)),s.parentNode||e.append(s);const r=_o(Yu,this).getElementForAltText();null===r||void 0===r||r.setAttribute("aria-describedby",s.id)}var id={_:null};r(ed,"_l10n",null);var sd=new WeakMap,rd=new WeakMap,od=new WeakMap,ad=new WeakMap,ld=new WeakMap,cd=new WeakMap,ud=new WeakMap,dd=new WeakMap,hd=new WeakMap,pd=new WeakMap,fd=new WeakSet;class md{constructor(e){vo(this,fd),yo(this,sd,null),yo(this,rd,null),yo(this,od,!1),yo(this,ad,null),yo(this,ld,null),yo(this,cd,null),yo(this,ud,null),yo(this,dd,null),yo(this,hd,!1),yo(this,pd,null),xo(ad,this,e)}renderForToolbar(){const e=xo(rd,this,document.createElement("button"));return e.className="comment",bo(fd,this,gd).call(this,e,!1)}renderForStandalone(){const e=xo(sd,this,document.createElement("button"));e.className="annotationCommentButton";const t=_o(ad,this).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd="calc(".concat(100*("ltr"===_o(ad,this)._uiManager.direction?1-t[0]:t[0]),"% - var(--comment-button-dim))"),n.top="calc(".concat(100*t[1],"% - var(--comment-button-dim))");const i=_o(ad,this).commentButtonColor;i&&(n.backgroundColor=i)}return bo(fd,this,gd).call(this,e,!0)}focusButton(){setTimeout(()=>{var e,t;null===(e=null!==(t=_o(sd,this))&&void 0!==t?t:_o(rd,this))||void 0===e||e.focus()},0)}onUpdatedColor(){if(!_o(sd,this))return;const e=_o(ad,this).commentButtonColor;e&&(_o(sd,this).style.backgroundColor=e),_o(ad,this)._uiManager.updatePopupColor(_o(ad,this))}get commentButtonWidth(){var e,t;return(null!==(e=null===(t=_o(sd,this))||void 0===t?void 0:t.getBoundingClientRect().width)&&void 0!==e?e:0)/_o(ad,this).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(_o(pd,this))return _o(pd,this);if(!_o(sd,this))return null;const{x:e,y:t,height:n}=_o(sd,this).getBoundingClientRect(),{x:i,y:s,width:r,height:o}=_o(ad,this).parent.boundingClientRect;return[(e-i)/r,(t+n-s)/o]}set commentPopupPositionInLayer(e){xo(pd,this,e)}hasDefaultPopupPosition(){return null===_o(pd,this)}removeStandaloneCommentButton(){var e;null===(e=_o(sd,this))||void 0===e||e.remove(),xo(sd,this,null)}removeToolbarCommentButton(){var e;null===(e=_o(rd,this))||void 0===e||e.remove(),xo(rd,this,null)}setCommentButtonStates(e){let{selected:t,hasPopup:n}=e;_o(sd,this)&&(_o(sd,this).classList.toggle("selected",t),_o(sd,this).ariaExpanded=n)}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=_o(ad,this).commentButtonPosition;const{width:e,height:t,x:s,y:r}=_o(ad,this);n=s+n*e,i=r+i*t}const s=_o(ad,this).parent.boundingClientRect,{x:r,y:o,width:l,height:c}=s;_o(ad,this)._uiManager.editComment(_o(ad,this),r+n*l,o+i*c,a(a({},e),{},{parentDimensions:s}))}finish(){_o(rd,this)&&(_o(rd,this).focus({focusVisible:_o(od,this)}),xo(od,this,!1))}isDeleted(){return _o(hd,this)||""===_o(ud,this)}isEmpty(){return null===_o(ud,this)}hasBeenEdited(){return this.isDeleted()||_o(ud,this)!==_o(ld,this)}serialize(){return this.data}get data(){return{text:_o(ud,this),richText:_o(cd,this),date:_o(dd,this),deleted:this.isDeleted()}}set data(e){if(e!==_o(ud,this)&&xo(cd,this,null),null===e)return xo(ud,this,""),void xo(hd,this,!0);xo(ud,this,e),xo(dd,this,new Date),xo(hd,this,!1)}setInitialText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;xo(ld,this,e),this.data=e,xo(dd,this,null),xo(cd,this,t)}shown(){}destroy(){var e,t;null===(e=_o(rd,this))||void 0===e||e.remove(),xo(rd,this,null),null===(t=_o(sd,this))||void 0===t||t.remove(),xo(sd,this,null),xo(ud,this,""),xo(cd,this,null),xo(dd,this,null),xo(ad,this,null),xo(od,this,!1),xo(hd,this,!1)}}function gd(e,t){if(!_o(ad,this)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[_o(ad,this)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=_o(ad,this)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",hl,{signal:n}),t&&(e.addEventListener("focusin",e=>{_o(ad,this)._focusEventsAllowed=!1,pl(e)},{capture:!0,signal:n}),e.addEventListener("focusout",e=>{_o(ad,this)._focusEventsAllowed=!0,pl(e)},{capture:!0,signal:n})),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const i=t=>{t.preventDefault(),e===_o(rd,this)?this.edit():_o(ad,this).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(xo(od,this,!0),i(t))},{signal:n}),e.addEventListener("pointerenter",()=>{_o(ad,this).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{_o(ad,this).toggleComment(!1,!1)},{signal:n}),e}var vd=new WeakMap,yd=new WeakMap,bd=new WeakMap,wd=new WeakMap,_d=new WeakMap,xd=new WeakMap,Ed=new WeakMap,Sd=new WeakMap,Ad=new WeakMap,Cd=new WeakMap,Td=new WeakMap,kd=new WeakMap,Id=new WeakSet;class Nd{constructor(e){let{container:t,isPinchingDisabled:n=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:o=null,signal:a}=e;vo(this,Id),yo(this,vd,void 0),yo(this,yd,!1),yo(this,bd,null),yo(this,wd,void 0),yo(this,_d,void 0),yo(this,xd,void 0),yo(this,Ed,void 0),yo(this,Sd,null),yo(this,Ad,void 0),yo(this,Cd,null),yo(this,Td,void 0),yo(this,kd,null),xo(vd,this,t),xo(bd,this,i),xo(wd,this,n),xo(_d,this,s),xo(xd,this,r),xo(Ed,this,o),xo(Td,this,new AbortController),xo(Ad,this,AbortSignal.any([a,_o(Td,this).signal])),t.addEventListener("touchstart",bo(Id,this,Pd).bind(this),{passive:!1,signal:_o(Ad,this)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/wl.pixelRatio}destroy(){var e,t;null===(e=_o(Td,this))||void 0===e||e.abort(),xo(Td,this,null),null===(t=_o(Sd,this))||void 0===t||t.abort(),xo(Sd,this,null)}}function Pd(e){var t,n;if(null!==(t=_o(wd,this))&&void 0!==t&&t.call(this))return;if(1===e.touches.length){if(_o(Sd,this))return;const e=xo(Sd,this,new AbortController),t=AbortSignal.any([_o(Ad,this),e.signal]),n=_o(vd,this),i={capture:!0,signal:t,passive:!1},s=e=>{var t;"touch"===e.pointerType&&(null===(t=_o(Sd,this))||void 0===t||t.abort(),xo(Sd,this,null))};return n.addEventListener("pointerdown",e=>{"touch"===e.pointerType&&(pl(e),s(e))},i),n.addEventListener("pointerup",s,i),void n.addEventListener("pointercancel",s,i)}if(!_o(kd,this)){var i;xo(kd,this,new AbortController);const e=AbortSignal.any([_o(Ad,this),_o(kd,this).signal]),t=_o(vd,this),n={signal:e,capture:!1,passive:!1};t.addEventListener("touchmove",bo(Id,this,Md).bind(this),n);const s=bo(Id,this,Rd).bind(this);t.addEventListener("touchend",s,n),t.addEventListener("touchcancel",s,n),n.capture=!0,t.addEventListener("pointerdown",pl,n),t.addEventListener("pointermove",pl,n),t.addEventListener("pointercancel",pl,n),t.addEventListener("pointerup",pl,n),null===(i=_o(_d,this))||void 0===i||i.call(this)}if(pl(e),2!==e.touches.length||null!==(n=_o(bd,this))&&void 0!==n&&n.call(this))return void xo(Cd,this,null);let[s,r]=e.touches;s.identifier>r.identifier&&([s,r]=[r,s]),xo(Cd,this,{touch0X:s.screenX,touch0Y:s.screenY,touch1X:r.screenX,touch1Y:r.screenY})}function Md(e){var t;if(!_o(Cd,this)||2!==e.touches.length)return;pl(e);let[n,i]=e.touches;n.identifier>i.identifier&&([n,i]=[i,n]);const{screenX:s,screenY:r}=n,{screenX:o,screenY:a}=i,l=_o(Cd,this),{touch0X:c,touch0Y:u,touch1X:d,touch1Y:h}=l,p=d-c,f=h-u,m=o-s,g=a-r,v=Math.hypot(m,g)||1,y=Math.hypot(p,f)||1;if(!_o(yd,this)&&Math.abs(y-v)<=To.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=o,l.touch1Y=a,!_o(yd,this))return void xo(yd,this,!0);const b=[(s+o)/2,(r+a)/2];null===(t=_o(xd,this))||void 0===t||t.call(this,b,y,v)}function Rd(e){if(!(e.touches.length>=2)){var t;if(_o(kd,this))_o(kd,this).abort(),xo(kd,this,null),null===(t=_o(Ed,this))||void 0===t||t.call(this);_o(Cd,this)&&(pl(e),xo(Cd,this,null),xo(yd,this,!1))}}To=Nd;var Od=new WeakMap,Dd=new WeakMap,Fd=new WeakMap,Ld=new WeakMap,jd=new WeakMap,Ud=new WeakMap,Bd=new WeakMap,Wd=new WeakMap,Hd=new WeakMap,Vd=new WeakMap,qd=new WeakMap,zd=new WeakMap,Gd=new WeakMap,Jd=new WeakMap,Kd=new WeakMap,Yd=new WeakMap,$d=new WeakMap,Xd=new WeakMap,Qd=new WeakMap,Zd=new WeakMap,eh=new WeakMap,th=new WeakMap,nh=new WeakMap,ih=new WeakMap,sh=new WeakMap,rh=new WeakMap,oh=new WeakSet;class ah{static get _resizerKeyboardManager(){const e=ah.prototype._resizeWithKeyboard,t=bu.TRANSLATE_SMALL,n=bu.TRANSLATE_BIG;return Oa(this,"_resizerKeyboardManager",new wc([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],ah.prototype._stopResizingWithKeyboard]]))}constructor(e){vo(this,oh),yo(this,Od,null),yo(this,Dd,null),yo(this,Fd,null),yo(this,Ld,null),yo(this,jd,null),yo(this,Ud,!1),yo(this,Bd,null),yo(this,Wd,""),yo(this,Hd,null),yo(this,Vd,null),yo(this,qd,null),yo(this,zd,null),yo(this,Gd,null),yo(this,Jd,""),yo(this,Kd,!1),yo(this,Yd,null),yo(this,$d,!1),yo(this,Xd,!1),yo(this,Qd,!1),yo(this,Zd,null),yo(this,eh,0),yo(this,th,0),yo(this,nh,null),yo(this,ih,null),r(this,"isSelected",!1),r(this,"_isCopy",!1),r(this,"_editToolbar",null),r(this,"_initialOptions",Object.create(null)),r(this,"_initialData",null),r(this,"_isVisible",!0),r(this,"_uiManager",null),r(this,"_focusEventsAllowed",!0),yo(this,sh,!1),yo(this,rh,ah._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Oa(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Th({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){var n;if(null!==(n=ah._l10n)&&void 0!==n||(ah._l10n=e),ah._l10nResizer||(ah._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==ah._borderLineWidth)return;const i=getComputedStyle(document.documentElement);ah._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Na("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return _o(sh,this)}set _isDraggable(e){var t;xo(sh,this,e),null===(t=this.div)||void 0===t||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=_o(rh,this)}setParent(e){var t;null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(bo(oh,this,Ch).call(this),null===(t=_o(zd,this))||void 0===t||t.remove(),xo(zd,this,null));this.parent=e}focusin(e){this._focusEventsAllowed&&(_o(Kd,this)?xo(Kd,this,!1):this.parent.setSelected(this))}focusout(e){var t;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=e.relatedTarget;null!==n&&void 0!==n&&n.closest("#".concat(this.id))||(e.preventDefault(),null!==(t=this.parent)&&void 0!==t&&t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[s,r]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/s,this.y=(t+i)/r,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}translate(e,t){bo(oh,this,lh).call(this,this.parentDimensions,e,t)}translateInPage(e,t){_o(Yd,this)||xo(Yd,this,[this.x,this.y,this.width,this.height]),bo(oh,this,lh).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){_o(Yd,this)||xo(Yd,this,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:o}=this;const[a,l]=this.getBaseTranslation();r+=a,o+=l;const{style:c}=n;c.left="".concat((100*r).toFixed(2),"%"),c.top="".concat((100*o).toFixed(2),"%"),this._onTranslating(r,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!_o(Yd,this)&&(_o(Yd,this)[0]!==this.x||_o(Yd,this)[1]!==this.y)}get _hasBeenResized(){return!!_o(Yd,this)&&(_o(Yd,this)[2]!==this.width||_o(Yd,this)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=ah,i=n/e,s=n/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:t},pageDimensions:[n,i]}=this;let{x:s,y:r,width:o,height:a}=this;if(o*=n,a*=i,s*=n,r*=i,this._mustFixPosition)switch(e){case 0:s=Za(s,0,n-o),r=Za(r,0,i-a);break;case 90:s=Za(s,0,n-a),r=Za(r,o,i);break;case 180:s=Za(s,o,n),r=Za(r,a,i);break;case 270:s=Za(s,a,n),r=Za(r,0,i-o)}this.x=s/=n,this.y=r/=i;const[l,c]=this.getBaseTranslation();s+=l,r+=c,t.left="".concat((100*s).toFixed(2),"%"),t.top="".concat((100*r).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(e,t){return ch.call(ah,e,t,this.parentRotation)}pageTranslationToScreen(e,t){return ch.call(ah,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width="".concat((100*t).toFixed(2),"%"),e.height="".concat((100*n).toFixed(2),"%")}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(1e4*e)/1e4}_onResizing(){}altTextFinish(){var e;null===(e=_o(Fd,this))||void 0===e||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||_o(Xd,this))return this._editToolbar;this._editToolbar=new Ul(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;null===(e=this._editToolbar)||void 0===e||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;null===(e=this._editToolbar)||void 0===e||e.removeButton("comment")}removeEditToolbar(){var e,t;null===(e=this._editToolbar)||void 0===e||e.remove(),this._editToolbar=null,null===(t=_o(Fd,this))||void 0===t||t.destroy()}addContainer(e){var t;const n=null===(t=this._editToolbar)||void 0===t?void 0:t.div;n?n.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return _o(Fd,this)||(ed.initialize(ah._l10n),xo(Fd,this,new ed(this)),_o(Od,this)&&(_o(Fd,this).data=_o(Od,this),xo(Od,this,null))),_o(Fd,this)}get altTextData(){var e;return null===(e=_o(Fd,this))||void 0===e?void 0:e.data}set altTextData(e){_o(Fd,this)&&(_o(Fd,this).data=e)}get guessedAltText(){var e;return null===(e=_o(Fd,this))||void 0===e?void 0:e.guessedText}async setGuessedAltText(e){var t;await(null===(t=_o(Fd,this))||void 0===t?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return null===(t=_o(Fd,this))||void 0===t?void 0:t.serialize(e)}hasAltText(){return!!_o(Fd,this)&&!_o(Fd,this).isEmpty()}hasAltTextData(){var e,t;return null!==(e=null===(t=_o(Fd,this))||void 0===t?void 0:t.hasData())&&void 0!==e&&e}focusCommentButton(){var e;null===(e=_o(Ld,this))||void 0===e||e.focusButton()}addCommentButton(){return this.canAddComment?_o(Ld,this)||xo(Ld,this,new md(this)):null}addStandaloneCommentButton(){this._uiManager.hasCommentManager()&&(_o(jd,this)?this._uiManager.isEditingMode()&&_o(jd,this).classList.remove("hidden"):this.hasComment&&(xo(jd,this,_o(Ld,this).renderForStandalone()),this.div.append(_o(jd,this))))}removeStandaloneCommentButton(){_o(Ld,this).removeStandaloneCommentButton(),xo(jd,this,null)}hideStandaloneCommentButton(){var e;null===(e=_o(jd,this))||void 0===e||e.classList.add("hidden")}get comment(){var e;const{data:{richText:t,text:n,date:i,deleted:s}}=_o(Ld,this);return{text:n,richText:t,date:i,deleted:s,color:this.getNonHCMColor(),opacity:null!==(e=this.opacity)&&void 0!==e?e:1}}set comment(e){_o(Ld,this)||xo(Ld,this,new md(this)),_o(Ld,this).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData(e){let{comment:t,popupRef:n,richText:i}=e;if(!n)return;if(_o(Ld,this)||xo(Ld,this,new md(this)),_o(Ld,this).setInitialText(t,i),!this.annotationElementId)return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return null===(e=_o(Ld,this))||void 0===e?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return null===(e=_o(Ld,this))||void 0===e?void 0:e.isDeleted()}get hasComment(){return!!_o(Ld,this)&&!_o(Ld,this).isEmpty()&&!_o(Ld,this).isDeleted()}async editComment(e){_o(Ld,this)||xo(Ld,this,new md(this)),_o(Ld,this).edit(e)}toggleComment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){_o(Ld,this).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const t=180,n=100,[,,,i]=e.rect,[s]=this.pageDimensions,[r]=this.pageTranslation,o=r+s+1,a=i-n,l=o+t;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,a,l,i]}}}updateFromAnnotationLayer(e){let{popup:{contents:t,deleted:n}}=e;_o(Ld,this).data=n?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var e;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=_o(Ud,this)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),bo(oh,this,_h).call(this);const[n,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth="".concat((100*i/n).toFixed(2),"%"),t.style.maxHeight="".concat((100*n/i).toFixed(2),"%"));const[s,r]=this.getInitialTranslation();return this.translate(s,r),ec(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(_o(ih,this)||xo(ih,this,new Nd({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:bo(oh,this,gh).bind(this),onPinching:bo(oh,this,vh).bind(this),onPinchEnd:bo(oh,this,yh).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),null===(e=this._uiManager._editorUndoBar)||void 0===e||e.hide(),t}pointerdown(e){const{isMac:t}=qa.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(xo(Kd,this,!0),this._isDraggable?bo(oh,this,wh).call(this,e):bo(oh,this,bh).call(this,e))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){_o(Zd,this)&&clearTimeout(_o(Zd,this)),xo(Zd,this,setTimeout(()=>{var e;xo(Zd,this,null),null===(e=this.parent)||void 0===e||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const i=this.parentScale,[s,r]=this.pageDimensions,[o,a]=this.pageTranslation,l=e/i,c=t/i,u=this.x*s,d=this.y*r,h=this.width*s,p=this.height*r;switch(n){case 0:return[u+l+o,r-d-c-p+a,u+l+h+o,r-d-c+a];case 90:return[u+c+o,r-d+l+a,u+c+p+o,r-d+l+h+a];case 180:return[u-l-h+o,r-d+c+a,u-l+o,r-d+c+p+a];case 270:return[u-c-p+o,r-d-l-h+a,u-c+o,r-d-l+a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,s,r]=e,o=s-n,a=r-i;switch(this.rotation){case 0:return[n,t-r,o,a];case 90:return[n,t-i,a,o];case 180:return[s,t-i,o,a];case 270:return[s,t-r,a,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ah._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;null===(e=_o(Ld,this))||void 0===e||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:s,richText:r},uid:o,pageIndex:a,creationDate:l,modificationDate:c}=this;return{id:o,pageIndex:a,rect:this.getPDFRect(),richText:r,contentsObj:{str:e},creationDate:l,modificationDate:n||c,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),xo(Xd,this,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),xo(Xd,this,!1),!0)}isInEditMode(){return _o(Xd,this)}shouldGetKeyboardEvents(){return _o(Qd,this)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:r}=window;return t<r&&i>0&&e<s&&n>0}rebuild(){bo(oh,this,_h).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}serialize(){var e;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,xo(Od,i,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,r]=i.pageDimensions,[o,a,l,c]=i.getRectInCurrentCoords(e.rect,r);return i.x=o/s,i.y=a/r,i.width=l/s,i.height=c/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){var e,t,n;if(null===(e=_o(Gd,this))||void 0===e||e.abort(),xo(Gd,this,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),_o(Zd,this)&&(clearTimeout(_o(Zd,this)),xo(Zd,this,null)),bo(oh,this,Ch).call(this),this.removeEditToolbar(),_o(nh,this)){for(const e of _o(nh,this).values())clearTimeout(e);xo(nh,this,null)}this.parent=null,null===(t=_o(ih,this))||void 0===t||t.destroy(),xo(ih,this,null),null===(n=_o(zd,this))||void 0===n||n.remove(),xo(zd,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(bo(oh,this,dh).call(this),_o(Hd,this).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return"ltr"===this._uiManager.direction?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,s,r]=this.getPDFRect();return[ah._round(n+(s-n)*e),ah._round(i+(r-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return _o(Ld,this).commentPopupPositionInLayer}set commentPopupPosition(e){_o(Ld,this).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return _o(Ld,this).hasDefaultPopupPosition()}get commentButtonWidth(){return _o(Ld,this).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;null===(t=_o(Ld,this))||void 0===t||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),xo(qd,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=_o(Hd,this).children;if(!_o(Dd,this)){xo(Dd,this,Array.from(t));const e=bo(oh,this,xh).bind(this),n=bo(oh,this,Eh).bind(this),i=this._uiManager._signal;for(const t of _o(Dd,this)){const s=t.getAttribute("data-resizer-name");t.setAttribute("role","spinbutton"),t.addEventListener("keydown",e,{signal:i}),t.addEventListener("blur",n,{signal:i}),t.addEventListener("focus",bo(oh,this,Sh).bind(this,s),{signal:i}),t.setAttribute("data-l10n-id",ah._l10nResizer[s])}}const n=_o(Dd,this)[0];let i=0;for(const r of t){if(r===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(_o(Dd,this).length/4);if(s!==i){if(s<i)for(let t=0;t<i-s;t++)_o(Hd,this).append(_o(Hd,this).firstElementChild);else if(s>i)for(let t=0;t<s-i;t++)_o(Hd,this).firstElementChild.before(_o(Hd,this).lastElementChild);let e=0;for(const n of t){const t=_o(Dd,this)[e++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",ah._l10nResizer[t])}}bo(oh,this,Ah).call(this,0),xo(Qd,this,!0),_o(Hd,this).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){_o(Qd,this)&&bo(oh,this,mh).call(this,_o(Jd,this),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){bo(oh,this,Ch).call(this),this.div.focus()}select(){var e,t,n;this.isSelected&&this._editToolbar?this._editToolbar.show():(this.isSelected=!0,this.makeResizable(),null===(e=this.div)||void 0===e||e.classList.add("selectedEditor"),this._editToolbar?(null===(t=this._editToolbar)||void 0===t||t.show(),null===(n=_o(Fd,this))||void 0===n||n.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{var e,t;null!==(e=this.div)&&void 0!==e&&e.classList.contains("selectedEditor")&&(null===(t=this._editToolbar)||void 0===t||t.show())}))}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return null===(e=this.div)||void 0===e?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,i,s;this.isSelected&&(this.isSelected=!1,null===(e=_o(Hd,this))||void 0===e||e.classList.add("hidden"),null===(t=this.div)||void 0===t||t.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null===(i=this._editToolbar)||void 0===i||i.hide(),null===(s=_o(Fd,this))||void 0===s||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){"BUTTON"!==e.target.nodeName&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return _o($d,this)}set isEditing(e){xo($d,this,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){_o(nh,this)||xo(nh,this,new Map);const{action:t}=e;let n=_o(nh,this).get(t);return n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),_o(nh,this).delete(t),0===_o(nh,this).size&&xo(nh,this,null)},ah._telemetryTimeout),void _o(nh,this).set(t,n)}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),xo(Ud,this,!1)}disable(){this.div&&(this.div.tabIndex=-1),xo(Ud,this,!0)}updateFakeAnnotationElement(e){if(_o(zd,this)||this.deleted)return this.deleted?(_o(zd,this).remove(),void xo(zd,this,null)):void((this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&_o(zd,this).updateEdited({rect:this.getPDFRect(),popup:this.comment}));xo(zd,this,e.addFakeAnnotation(this))}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;"DIV"===(null===t||void 0===t?void 0:t.nodeName)&&t.classList.contains("annotationContent")&&t.remove()}}function lh(e,t,n){let[i,s]=e;[t,n]=this.screenToPageTranslation(t,n),this.x+=t/i,this.y+=n/s,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}function ch(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}function uh(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}function dh(){if(_o(Hd,this))return;xo(Hd,this,document.createElement("div")),_o(Hd,this).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const e=document.createElement("div");_o(Hd,this).append(e),e.classList.add("resizer",n),e.setAttribute("data-resizer-name",n),e.addEventListener("pointerdown",bo(oh,this,hh).bind(this,n),{signal:t}),e.addEventListener("contextmenu",hl,{signal:t}),e.tabIndex=-1}this.div.prepend(_o(Hd,this))}function hh(e,t){var n;t.preventDefault();const{isMac:i}=qa.platform;if(0!==t.button||t.ctrlKey&&i)return;null===(n=_o(Fd,this))||void 0===n||n.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,xo(Vd,this,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",bo(oh,this,mh).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",pl,{passive:!1,signal:o}),window.addEventListener("contextmenu",hl,{signal:o}),xo(qd,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var e;r.abort(),this.parent.togglePointerEvents(!0),null===(e=_o(Fd,this))||void 0===e||e.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=l,bo(oh,this,fh).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})}function ph(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}function fh(){if(!_o(qd,this))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=_o(qd,this);xo(qd,this,null);const s=this.x,r=this.y,o=this.width,a=this.height;s===e&&r===t&&o===n&&a===i||this.addCommands({cmd:bo(oh,this,ph).bind(this,s,r,o,a),undo:bo(oh,this,ph).bind(this,e,t,n,i),mustExec:!0})}function mh(e,t){const[n,i]=this.parentDimensions,s=this.x,r=this.y,o=this.width,a=this.height,l=ko.MIN_SIZE/n,c=ko.MIN_SIZE/i,u=bo(oh,this,uh).call(this,this.rotation),d=(e,t)=>[u[0]*e+u[2]*t,u[1]*e+u[3]*t],h=bo(oh,this,uh).call(this,360-this.rotation);let p,f,m=!1,g=!1;switch(e){case"topLeft":m=!0,p=(e,t)=>[0,0],f=(e,t)=>[e,t];break;case"topMiddle":p=(e,t)=>[e/2,0],f=(e,t)=>[e/2,t];break;case"topRight":m=!0,p=(e,t)=>[e,0],f=(e,t)=>[0,t];break;case"middleRight":g=!0,p=(e,t)=>[e,t/2],f=(e,t)=>[0,t/2];break;case"bottomRight":m=!0,p=(e,t)=>[e,t],f=(e,t)=>[0,0];break;case"bottomMiddle":p=(e,t)=>[e/2,t],f=(e,t)=>[e/2,0];break;case"bottomLeft":m=!0,p=(e,t)=>[0,t],f=(e,t)=>[e,0];break;case"middleLeft":g=!0,p=(e,t)=>[0,t/2],f=(e,t)=>[e,t/2]}const v=p(o,a),y=f(o,a);let b=d(...y);const w=ko._round(s+b[0]),_=ko._round(r+b[1]);let x,E,S=1,A=1;if(t.fromKeyboard)({deltaX:x,deltaY:E}=t);else{const{screenX:e,screenY:n}=t,[i,s]=_o(Vd,this);[x,E]=this.screenToPageTranslation(e-i,n-s),_o(Vd,this)[0]=e,_o(Vd,this)[1]=n}var C,T;if([x,E]=(C=x/n,T=E/i,[h[0]*C+h[2]*T,h[1]*C+h[3]*T]),m){const e=Math.hypot(o,a);S=A=Math.max(Math.min(Math.hypot(y[0]-v[0]-x,y[1]-v[1]-E)/e,1/o,1/a),l/o,c/a)}else g?S=Za(Math.abs(y[0]-v[0]-x),l,1)/o:A=Za(Math.abs(y[1]-v[1]-E),c,1)/a;const k=ko._round(o*S),I=ko._round(a*A);b=d(...f(k,I));const N=w-b[0],P=_-b[1];_o(Yd,this)||xo(Yd,this,[this.x,this.y,this.width,this.height]),this.width=k,this.height=I,this.x=N,this.y=P,this.setDims(),this.fixAndSetPosition(),this._onResizing()}function gh(){var e;xo(qd,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null===(e=_o(Fd,this))||void 0===e||e.toggle(!1),this.parent.togglePointerEvents(!1)}function vh(e,t,n){let i=n/t*.7+1-.7;if(1===i)return;const s=bo(oh,this,uh).call(this,this.rotation),r=(e,t)=>[s[0]*e+s[2]*t,s[1]*e+s[3]*t],[o,a]=this.parentDimensions,l=this.x,c=this.y,u=this.width,d=this.height,h=ko.MIN_SIZE/o,p=ko.MIN_SIZE/a;i=Math.max(Math.min(i,1/u,1/d),h/u,p/d);const f=ko._round(u*i),m=ko._round(d*i);if(f===u&&m===d)return;_o(Yd,this)||xo(Yd,this,[l,c,u,d]);const g=r(u/2,d/2),v=ko._round(l+g[0]),y=ko._round(c+g[1]),b=r(f/2,m/2);this.x=v-b[0],this.y=y-b[1],this.width=f,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()}function yh(){var e;null===(e=_o(Fd,this))||void 0===e||e.toggle(!0),this.parent.togglePointerEvents(!0),bo(oh,this,fh).call(this)}function bh(e){const{isMac:t}=qa.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}function wh(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),r={capture:!0,passive:!1,signal:s},o=e=>{i.abort(),xo(Bd,this,null),xo(Kd,this,!1),this._uiManager.endDragSession()||bo(oh,this,bh).call(this,e),n&&this._onStopDragging()};t&&(xo(eh,this,e.clientX),xo(th,this,e.clientY),xo(Bd,this,e.pointerId),xo(Wd,this,e.pointerType),window.addEventListener("pointermove",e=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:t,clientY:i,pointerId:s}=e;if(s!==_o(Bd,this))return void pl(e);const[r,o]=this.screenToPageTranslation(t-_o(eh,this),i-_o(th,this));xo(eh,this,t),xo(th,this,i),this._uiManager.dragSelectedEditors(r,o)},r),window.addEventListener("touchmove",pl,r),window.addEventListener("pointerdown",e=>{e.pointerType===_o(Wd,this)&&(_o(ih,this)||e.isPrimary)&&o(e),pl(e)},r));const a=e=>{_o(Bd,this)&&_o(Bd,this)!==e.pointerId?pl(e):o(e)};window.addEventListener("pointerup",a,{signal:s}),window.addEventListener("blur",a,{signal:s})}function _h(){if(_o(Gd,this)||!this.div)return;xo(Gd,this,new AbortController);const e=this._uiManager.combinedSignal(_o(Gd,this));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}function xh(e){ko._resizerKeyboardManager.exec(this,e)}function Eh(e){var t;_o(Qd,this)&&(null===(t=e.relatedTarget)||void 0===t?void 0:t.parentNode)!==_o(Hd,this)&&bo(oh,this,Ch).call(this)}function Sh(e){xo(Jd,this,_o(Qd,this)?e:"")}function Ah(e){if(_o(Dd,this))for(const t of _o(Dd,this))t.tabIndex=e}function Ch(){xo(Qd,this,!1),bo(oh,this,Ah).call(this,-1),bo(oh,this,fh).call(this)}ko=ah,r(ah,"_l10n",null),r(ah,"_l10nResizer",null),r(ah,"_borderLineWidth",-1),r(ah,"_colorManager",new xc),r(ah,"_zIndex",1),r(ah,"_telemetryTimeout",1e3);class Th extends ah{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const kh=3285377520,Ih=4294901760,Nh=65535;class Ph{constructor(e){this.h1=e?4294967295&e:kh,this.h2=e?4294967295&e:kh}update(e){let t,n;if("string"===typeof e){t=new Uint8Array(2*e.length),n=0;for(let i=0,s=e.length;i<s;i++){const s=e.charCodeAt(i);s<=255?t[n++]=s:(t[n++]=s>>>8,t[n++]=255&s)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),n=t.byteLength}const i=n>>2,s=n-4*i,r=new Uint32Array(t.buffer,0,i);let o=0,a=0,l=this.h1,c=this.h2;const u=3432918353,d=461845907,h=11601,p=13715;for(let f=0;f<i;f++)1&f?(o=r[f],o=o*u&Ih|o*h&Nh,o=o<<15|o>>>17,o=o*d&Ih|o*p&Nh,l^=o,l=l<<13|l>>>19,l=5*l+3864292196):(a=r[f],a=a*u&Ih|a*h&Nh,a=a<<15|a>>>17,a=a*d&Ih|a*p&Nh,c^=a,c=c<<13|c>>>19,c=5*c+3864292196);switch(o=0,s){case 3:o^=t[4*i+2]<<16;case 2:o^=t[4*i+1]<<8;case 1:o^=t[4*i],o=o*u&Ih|o*h&Nh,o=o<<15|o>>>17,o=o*d&Ih|o*p&Nh,1&i?l^=o:c^=o}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&Ih|36045*e&Nh,t=4283543511*t&Ih|(2950163797*(t<<16|e>>>16)&Ih)>>>16,e^=t>>>1,e=444984403*e&Ih|60499*e&Nh,t=3301882366*t&Ih|(3120437893*(t<<16|e>>>16)&Ih)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Mh=Object.freeze({map:null,hash:"",transfer:void 0});var Rh=new WeakMap,Oh=new WeakMap,Dh=new WeakMap,Fh=new WeakMap,Lh=new WeakSet;class jh{constructor(){vo(this,Lh),yo(this,Rh,!1),yo(this,Oh,null),yo(this,Dh,null),yo(this,Fh,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=_o(Fh,this).get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return _o(Fh,this).get(e)}remove(e){const t=_o(Fh,this).get(e);if(void 0!==t&&(t instanceof ah&&_o(Dh,this).delete(t.annotationElementId),_o(Fh,this).delete(e),0===_o(Fh,this).size&&this.resetModified(),"function"===typeof this.onAnnotationEditor)){for(const e of _o(Fh,this).values())if(e instanceof ah)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=_o(Fh,this).get(e);let i=!1;if(void 0!==n)for(const[s,r]of Object.entries(t))n[s]!==r&&(i=!0,n[s]=r);else i=!0,_o(Fh,this).set(e,t);i&&bo(Lh,this,Uh).call(this),t instanceof ah&&((_o(Dh,this)||xo(Dh,this,new Map)).set(t.annotationElementId,t),"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type))}has(e){return _o(Fh,this).has(e)}get size(){return _o(Fh,this).size}resetModified(){_o(Rh,this)&&(xo(Rh,this,!1),"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new Wh(this)}get serializable(){if(0===_o(Fh,this).size)return Mh;const e=new Map,t=new Ph,n=[],i=Object.create(null);let s=!1;for(const[r,o]of _o(Fh,this)){const n=o instanceof ah?o.serialize(!1,i):o;n&&(e.set(r,n),t.update("".concat(r,":").concat(JSON.stringify(n))),s||(s=!!n.bitmap))}if(s)for(const r of e.values())r.bitmap&&n.push(r.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Mh}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const o of _o(Fh,this).values()){var s;if(!(o instanceof ah)){o.popup&&(o.popup.deleted?i+=1:n+=1);continue}o.isCommentDeleted?i+=1:o.hasEditedComment&&(n+=1);const a=o.telemetryFinalData;if(!a)continue;const{type:l}=a;t.has(l)||t.set(l,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const c=(s=e)[l]||(s[l]=new Map);for(const[e,t]of Object.entries(a)){var r;if("type"===e)continue;let n=c.get(e);n||(n=new Map,c.set(e,n));const i=null!==(r=n.get(t))&&void 0!==r?r:0;n.set(t,i+1)}}if((i>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:n}),!e)return null;for(const[o,a]of t)e[o]=a.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){xo(Oh,this,null)}updateEditor(e,t){var n;const i=null===(n=_o(Dh,this))||void 0===n?void 0:n.get(e);return!!i&&(i.updateFromAnnotationLayer(t),!0)}getEditor(e){var t;return(null===(t=_o(Dh,this))||void 0===t?void 0:t.get(e))||null}get modifiedIds(){if(_o(Oh,this))return _o(Oh,this);const e=[];if(_o(Dh,this))for(const t of _o(Dh,this).values())t.serialize()&&e.push(t.annotationElementId);return xo(Oh,this,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return _o(Fh,this).entries()}}function Uh(){_o(Rh,this)||(xo(Rh,this,!0),"function"===typeof this.onSetModified&&this.onSetModified())}var Bh=new WeakMap;class Wh extends jh{constructor(e){super(),yo(this,Bh,void 0);const{map:t,hash:n,transfer:i}=e.serializable,s=structuredClone(t,i?{transfer:i}:null);xo(Bh,this,{map:s,hash:n,transfer:i})}get print(){Na("Should not call PrintAnnotationStorage.print")}get serializable(){return _o(Bh,this)}get modifiedIds(){return Oa(this,"modifiedIds",{ids:new Set,hash:""})}}var Hh=new WeakMap;class Vh{constructor(e){let{ownerDocument:t=globalThis.document,styleElement:n=null}=e;yo(this,Hh,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),_o(Hh,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){let{systemFontInfo:t,disableFontFace:n,_inspectFont:i}=e;if(t&&!_o(Hh,this).has(t.loadedName)){if(Pa(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:n,style:r}=t,o=new FontFace(e,n,r);this.addNativeFontFace(o);try{await o.load(),_o(Hh,this).add(e),null===i||void 0===i||i(t)}catch(s){Ia("Cannot load system font: ".concat(t.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(o)}return}Na("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw Ia("Failed to load font '".concat(t.family,"': '").concat(n,"'.")),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var e;return Oa(this,"isFontLoadingAPISupported",!(null===(e=this._document)||void 0===e||!e.fonts))}get isSyncFontLoadingSupported(){return Oa(this,"isSyncFontLoadingSupported",Ho||qa.platform.isFirefox)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for(Pa(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){return Oa(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function i(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}let s,r;const o=this._document.createElement("canvas");o.width=1,o.height=1;const a=o.getContext("2d");let l=0;const c="lt".concat(Date.now()).concat(this.loadTestFontId++);let u=this._loadTestFont;u=i(u,976,c.length,c);const d=1482184792;let h=n(u,16);for(s=0,r=c.length-3;s<r;s+=4)h=h-d+n(c,s)|0;var p;s<c.length&&(h=h-d+n(c+"XXX",s)|0),u=i(u,16,4,(p=h,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f="url(data:font/opentype;base64,".concat(btoa(u),");"),m='@font-face {font-family:"'.concat(c,'";src:').concat(f,"}");this.insertRule(m);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const v of[e.loadedName,c]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=v,g.append(e)}this._document.body.append(g),function e(t,n){if(++l>30)return Ia("Load test font never loaded."),void n();a.font="30px "+t,a.fillText(".",0,20),a.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(c,()=>{g.remove(),t.complete()})}}var qh=new WeakMap;class zh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;yo(this,qh,void 0),this.compiledGlyphs=Object.create(null),xo(qh,this,e),this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return null===(e=this._inspectFont)||void 0===e||e.call(this,this),t}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const t="url(data:".concat(this.mimetype,";base64,").concat(el(this.data),");");let n;if(this.cssFontInfo){let e="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(e+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),n='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(e,"src:").concat(t,"}")}else n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return null===(e=this._inspectFont)||void 0===e||e.call(this,this,t),n}getPathGenerator(e,t){var n;if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(o){Ia('getPathGenerator - ignoring character: "'.concat(o,'".'))}const r=Il(null===(n=s)||void 0===n?void 0:n.path);return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}get black(){return _o(qh,this).black}get bold(){return _o(qh,this).bold}get disableFontFace(){var e;return null!==(e=_o(qh,this).disableFontFace)&&void 0!==e&&e}set disableFontFace(e){Oa(this,"disableFontFace",!!e)}get fontExtraProperties(){var e;return null!==(e=_o(qh,this).fontExtraProperties)&&void 0!==e&&e}get isInvalidPDFjsFont(){return _o(qh,this).isInvalidPDFjsFont}get isType3Font(){return _o(qh,this).isType3Font}get italic(){return _o(qh,this).italic}get missingFile(){return _o(qh,this).missingFile}get remeasure(){return _o(qh,this).remeasure}get vertical(){return _o(qh,this).vertical}get ascent(){return _o(qh,this).ascent}get defaultWidth(){return _o(qh,this).defaultWidth}get descent(){return _o(qh,this).descent}get bbox(){return _o(qh,this).bbox}set bbox(e){Oa(this,"bbox",e)}get fontMatrix(){return _o(qh,this).fontMatrix}get fallbackName(){return _o(qh,this).fallbackName}get loadedName(){return _o(qh,this).loadedName}get mimetype(){return _o(qh,this).mimetype}get name(){return _o(qh,this).name}get data(){return _o(qh,this).data}clearData(){_o(qh,this).clearData()}get cssFontInfo(){return _o(qh,this).cssFontInfo}get systemFontInfo(){return _o(qh,this).systemFontInfo}get defaultVMetrics(){return _o(qh,this).defaultVMetrics}}var Gh=new WeakMap,Jh=new WeakMap,Kh=new WeakMap,Yh=new WeakSet;class $h{static write(e){const t=new TextEncoder,n={};let i=0;for(const l of $h.strings){const s=t.encode(e[l]);n[l]=s,i+=4+s.length}const s=new ArrayBuffer(i),r=new Uint8Array(s),o=new DataView(s);let a=0;for(const l of $h.strings){const e=n[l],t=e.length;o.setUint32(a,t),r.set(e,a+4),a+=4+t}return Pa(a===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}constructor(e){vo(this,Yh),yo(this,Gh,void 0),yo(this,Jh,void 0),yo(this,Kh,void 0),xo(Gh,this,e),xo(Jh,this,new DataView(_o(Gh,this))),xo(Kh,this,new TextDecoder)}get fontFamily(){return bo(Yh,this,Xh).call(this,0)}get fontWeight(){return bo(Yh,this,Xh).call(this,1)}get italicAngle(){return bo(Yh,this,Xh).call(this,2)}}function Xh(e){Pa(e<Io.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=_o(Jh,this).getUint32(t)+4;const n=_o(Jh,this).getUint32(t);return _o(Kh,this).decode(new Uint8Array(_o(Gh,this),t+4,n))}Io=$h,r($h,"strings",["fontFamily","fontWeight","italicAngle"]);var Qh=new WeakMap,Zh=new WeakMap,ep=new WeakMap,tp=new WeakSet;class np{static write(e){const t=new TextEncoder,n={};let i=0;for(const d of np.strings){const s=t.encode(e[d]);n[d]=s,i+=4+s.length}i+=4;let s,r,o=1+i;e.style&&(s=t.encode(e.style.style),r=t.encode(e.style.weight),o+=4+s.length+4+r.length);const a=new ArrayBuffer(o),l=new Uint8Array(a),c=new DataView(a);let u=0;c.setUint8(u++,e.guessFallback?1:0),c.setUint32(u,0),u+=4,i=0;for(const d of np.strings){const e=n[d],t=e.length;i+=4+t,c.setUint32(u,t),l.set(e,u+4),u+=4+t}return c.setUint32(u-i-4,i),e.style&&(c.setUint32(u,s.length),l.set(s,u+4),u+=4+s.length,c.setUint32(u,r.length),l.set(r,u+4),u+=4+r.length),Pa(u<=a.byteLength,"SubstitionInfo.write: Buffer overflow"),a.transferToFixedLength(u)}constructor(e){vo(this,tp),yo(this,Qh,void 0),yo(this,Zh,void 0),yo(this,ep,void 0),xo(Qh,this,e),xo(Zh,this,new DataView(_o(Qh,this))),xo(ep,this,new TextDecoder)}get guessFallback(){return 0!==_o(Zh,this).getUint8(0)}get css(){return bo(tp,this,ip).call(this,0)}get loadedName(){return bo(tp,this,ip).call(this,1)}get baseFontName(){return bo(tp,this,ip).call(this,2)}get src(){return bo(tp,this,ip).call(this,3)}get style(){let e=1;e+=4+_o(Zh,this).getUint32(e);const t=_o(Zh,this).getUint32(e),n=_o(ep,this).decode(new Uint8Array(_o(Qh,this),e+4,t));e+=4+t;const i=_o(Zh,this).getUint32(e);return{style:n,weight:_o(ep,this).decode(new Uint8Array(_o(Qh,this),e+4,i))}}}function ip(e){Pa(e<No.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=_o(Zh,this).getUint32(t)+4;const n=_o(Zh,this).getUint32(t);return _o(ep,this).decode(new Uint8Array(_o(Qh,this),t+4,n))}No=np,r(np,"strings",["css","loadedName","baseFontName","src"]);var sp=new WeakMap,rp=new WeakMap,op=new WeakMap,ap=new WeakSet;class lp{constructor(e){let{data:t,extra:n}=e;vo(this,ap),yo(this,sp,void 0),yo(this,rp,void 0),yo(this,op,void 0),xo(sp,this,t),xo(rp,this,new TextDecoder),xo(op,this,new DataView(_o(sp,this))),n&&Object.assign(this,n)}get black(){return bo(ap,this,cp).call(this,0)}get bold(){return bo(ap,this,cp).call(this,1)}get disableFontFace(){return bo(ap,this,cp).call(this,2)}get fontExtraProperties(){return bo(ap,this,cp).call(this,3)}get isInvalidPDFjsFont(){return bo(ap,this,cp).call(this,4)}get isType3Font(){return bo(ap,this,cp).call(this,5)}get italic(){return bo(ap,this,cp).call(this,6)}get missingFile(){return bo(ap,this,cp).call(this,7)}get remeasure(){return bo(ap,this,cp).call(this,8)}get vertical(){return bo(ap,this,cp).call(this,9)}get ascent(){return bo(ap,this,up).call(this,0)}get defaultWidth(){return bo(ap,this,up).call(this,1)}get descent(){return bo(ap,this,up).call(this,2)}get bbox(){let e=pp._;if(0===_o(op,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<4;n++)t.push(_o(op,this).getInt16(e,!0)),e+=2;return t}get fontMatrix(){let e=fp._;if(0===_o(op,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<6;n++)t.push(_o(op,this).getFloat64(e,!0)),e+=8;return t}get defaultVMetrics(){let e=mp._;if(0===_o(op,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<3;n++)t.push(_o(op,this).getInt16(e,!0)),e+=2;return t}get fallbackName(){return bo(ap,this,dp).call(this,0)}get loadedName(){return bo(ap,this,dp).call(this,1)}get mimetype(){return bo(ap,this,dp).call(this,2)}get name(){return bo(ap,this,dp).call(this,3)}get data(){let e=gp._;e+=4+_o(op,this).getUint32(e);e+=4+_o(op,this).getUint32(e);e+=4+_o(op,this).getUint32(e);const t=_o(op,this).getUint32(e);if(0!==t)return new Uint8Array(_o(sp,this),e+4,t)}clearData(){let e=gp._;e+=4+_o(op,this).getUint32(e);e+=4+_o(op,this).getUint32(e);e+=4+_o(op,this).getUint32(e);const t=_o(op,this).getUint32(e);new Uint8Array(_o(sp,this),e+4,t).fill(0),_o(op,this).setUint32(e,0)}get cssFontInfo(){let e=gp._;e+=4+_o(op,this).getUint32(e);e+=4+_o(op,this).getUint32(e);const t=_o(op,this).getUint32(e);if(0===t)return null;const n=new Uint8Array(t);return n.set(new Uint8Array(_o(sp,this),e+4,t)),new $h(n.buffer)}get systemFontInfo(){let e=gp._;e+=4+_o(op,this).getUint32(e);const t=_o(op,this).getUint32(e);if(0===t)return null;const n=new Uint8Array(t);return n.set(new Uint8Array(_o(sp,this),e+4,t)),new np(n.buffer)}static write(e){const t=e.systemFontInfo?np.write(e.systemFontInfo):null,n=e.cssFontInfo?$h.write(e.cssFontInfo):null,i=new TextEncoder,s={};let r=0;for(const f of lp.strings)s[f]=i.encode(e[f]),r+=4+s[f].length;const o=gp._+4+r+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),a=new ArrayBuffer(o),l=new Uint8Array(a),c=new DataView(a);let u=0;const d=lp.bools.length;let h=0,p=0;for(let f=0;f<d;f++){const t=e[lp.bools[f]];h|=(void 0===t?0:t?2:1)<<p,p+=2,8!==p&&f!==d-1||(c.setUint8(u++,h),h=0,p=0)}Pa(u===hp._,"FontInfo.write: Boolean properties offset mismatch");for(const f of lp.numbers)c.setFloat64(u,e[f]),u+=8;if(Pa(u===pp._,"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(u++,4);for(const t of e.bbox)c.setInt16(u,t,!0),u+=2}else c.setUint8(u++,0),u+=8;if(Pa(u===fp._,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(u++,6);for(const t of e.fontMatrix)c.setFloat64(u,t,!0),u+=8}else c.setUint8(u++,0),u+=48;if(Pa(u===mp._,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(u++,1);for(const t of e.defaultVMetrics)c.setInt16(u,t,!0),u+=2}else c.setUint8(u++,0),u+=6;Pa(u===gp._,"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(gp._,0),u+=4;for(const f of lp.strings){const e=s[f],t=e.length;c.setUint32(u,t),l.set(e,u+4),u+=4+t}if(c.setUint32(gp._,u-gp._-4),t){const e=t.byteLength;c.setUint32(u,e),Pa(u+4+e<=a.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),l.set(new Uint8Array(t),u+4),u+=4+e}else c.setUint32(u,0),u+=4;if(n){const e=n.byteLength;c.setUint32(u,e),Pa(u+4+e<=a.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),l.set(new Uint8Array(n),u+4),u+=4+e}else c.setUint32(u,0),u+=4;return void 0===e.data?(c.setUint32(u,0),u+=4):(c.setUint32(u,e.data.length),l.set(e.data,u+4),u+=4+e.data.length),Pa(u<=a.byteLength,"FontInfo.write: Buffer overflow"),a.transferToFixedLength(u)}}function cp(e){Pa(e<Po.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=2*e%8,i=_o(op,this).getUint8(t)>>n&3;return 0===i?void 0:2===i}function up(e){return Pa(e<Po.numbers.length,"Invalid number index"),_o(op,this).getFloat64(hp._+8*e)}function dp(e){Pa(e<Po.strings.length,"Invalid string index");let t=gp._+4;for(let s=0;s<e;s++)t+=_o(op,this).getUint32(t)+4;const n=_o(op,this).getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(_o(sp,this),t+4,n)),_o(rp,this).decode(i)}Po=lp,r(lp,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),r(lp,"numbers",["ascent","defaultWidth","descent"]),r(lp,"strings",["fallbackName","loadedName","mimetype","name"]);var hp={_:Math.ceil(2*Po.bools.length/8)},pp={_:bo(Po,Po,hp)._+8*Po.numbers.length},fp={_:bo(Po,Po,pp)._+1+8},mp={_:bo(Po,Po,fp)._+1+48},gp={_:bo(Po,Po,mp)._+1+6};class vp{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,i=[],s=[],r=[],o=[],a=null,l=null;switch(e[0]){case"RadialAxial":t="axial"===e[1]?1:2,n=e[2],r=e[3],1===t?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,a=e[1],i=e[2],s=e[3],o=e[4]||[],n=e[6],l=e[7];break;default:throw new Error("Unsupported pattern type: ".concat(e[0]))}const c=Math.floor(i.length/2),u=Math.floor(s.length/3),d=r.length,h=o.length;let p=0;for(const y of o)p+=1,p=4*Math.ceil(p/4),p+=4+4*y.coords.length,p+=4+4*y.colors.length,void 0!==y.verticesPerRow&&(p+=4);const f=new ArrayBuffer(20+8*c+3*u+8*d+(n?16:0)+(l?3:0)+p),m=new DataView(f),g=new Uint8Array(f);m.setUint8(yp._,t),m.setUint8(bp._,n?1:0),m.setUint8(wp._,l?1:0),m.setUint8(_p._,a),m.setUint32(xp._,c,!0),m.setUint32(Ep._,u,!0),m.setUint32(Sp._,d,!0),m.setUint32(Ap._,h,!0);let v=20;new Float32Array(f,v,2*c).set(i),v+=8*c,g.set(s,v),v+=3*u;for(const[y,b]of r)m.setFloat32(v,y,!0),v+=4,m.setUint32(v,parseInt(b.slice(1),16),!0),v+=4;if(n)for(const y of n)m.setFloat32(v,y,!0),v+=4;l&&(g.set(l,v),v+=3);for(let y=0;y<o.length;y++){const e=o[y];m.setUint8(v,e.type),v+=1,v=4*Math.ceil(v/4),m.setUint32(v,e.coords.length,!0),v+=4;new Int32Array(f,v,e.coords.length).set(e.coords),v+=4*e.coords.length,m.setUint32(v,e.colors.length,!0),v+=4;new Int32Array(f,v,e.colors.length).set(e.colors),v+=4*e.colors.length,void 0!==e.verticesPerRow&&(m.setUint32(v,e.verticesPerRow,!0),v+=4)}return f}getIR(){const e=this.view,t=this.data[yp._],n=!!this.data[bp._],i=!!this.data[wp._],s=e.getUint32(xp._,!0),r=e.getUint32(Ep._,!0),o=e.getUint32(Sp._,!0),a=e.getUint32(Ap._,!0);let l=20;const c=new Float32Array(this.buffer,l,2*s);l+=8*s;const u=new Uint8Array(this.buffer,l,3*r);l+=3*r;const d=[];for(let m=0;m<o;++m){const t=e.getFloat32(l,!0);l+=4;const n=e.getUint32(l,!0);l+=4,d.push([t,"#".concat(n.toString(16).padStart(6,"0"))])}let h=null;if(n){h=[];for(let t=0;t<4;++t)h.push(e.getFloat32(l,!0)),l+=4}let p=null;i&&(p=new Uint8Array(this.buffer,l,3),l+=3);const f=[];for(let m=0;m<a;++m){const t=e.getUint8(l);l+=1,l=4*Math.ceil(l/4);const n=e.getUint32(l,!0);l+=4;const i=new Int32Array(this.buffer,l,n);l+=4*n;const s=e.getUint32(l,!0);l+=4;const r=new Int32Array(this.buffer,l,s);l+=4*s;const o={type:t,coords:i,colors:r};t===sa&&(o.verticesPerRow=e.getUint32(l,!0),l+=4),f.push(o)}if(1===t)return["RadialAxial","axial",h,d,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(2===t)return["RadialAxial","radial",h,d,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(3===t){const e=this.data[_p._];let t=null;if(c.length>0){let e=c[0],n=c[0],i=c[1],s=c[1];for(let t=0;t<c.length;t+=2){const r=c[t],o=c[t+1];e=e>r?r:e,i=i>o?o:i,n=n<r?r:n,s=s<o?o:s}t=[e,i,n,s]}return["Mesh",e,c,u,f,t,h,p]}throw new Error("Unsupported pattern kind: ".concat(t))}}var yp={_:0},bp={_:1},wp={_:2},_p={_:3},xp={_:4},Ep={_:8},Sp={_:12},Ap={_:16},Cp=new WeakMap;class Tp{static write(e){let t,n;return qa.isFloat16ArraySupported?(n=new ArrayBuffer(2*e.length),t=new Float16Array(n)):(n=new ArrayBuffer(4*e.length),t=new Float32Array(n)),t.set(e),n}constructor(e){yo(this,Cp,void 0),xo(Cp,this,e)}get path(){return qa.isFloat16ArraySupported?new Float16Array(_o(Cp,this)):new Float32Array(_o(Cp,this))}}function kp(e){if("string"!==typeof e)return null;if(e.endsWith("/"))return e;throw new Error('Invalid factory url: "'.concat(e,'" must include trailing slash.'))}const Ip=e=>"object"===typeof e&&Number.isInteger(null===e||void 0===e?void 0:e.num)&&e.num>=0&&Number.isInteger(null===e||void 0===e?void 0:e.gen)&&e.gen>=0,Np=function(e,t,n){if(!Array.isArray(n)||n.length<2)return!1;const[i,s,...r]=n;if(!e(i)&&!Number.isInteger(i))return!1;if(!t(s))return!1;const o=r.length;let a=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return 0===o;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(4!==o)return!1;a=!1;break;default:return!1}for(const l of r)if(!("number"===typeof l||a&&null===l))return!1;return!0}.bind(null,Ip,e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name));var Pp=new WeakMap,Mp=new WeakMap;class Rp{constructor(){yo(this,Pp,new Map),yo(this,Mp,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};_o(Mp,this).then(()=>{for(const[e]of _o(Pp,this))e.call(this,n)})}addEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;if((null===n||void 0===n?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted)return void Ia("LoopbackPort - cannot use an `aborted` signal.");const r=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",r),s.addEventListener("abort",r)}_o(Pp,this).set(t,i)}removeEventListener(e,t){const n=_o(Pp,this).get(t);null===n||void 0===n||n(),_o(Pp,this).delete(t)}terminate(){for(const[,e]of _o(Pp,this))null===e||void 0===e||e();_o(Pp,this).clear()}}const Op=1,Dp=2,Fp=1,Lp=2,jp=3,Up=4,Bp=5,Wp=6,Hp=7,Vp=8;function qp(){}function zp(e){if(e instanceof Wa||e instanceof ja||e instanceof Fa||e instanceof Ua||e instanceof La)return e;switch(e instanceof Error||"object"===typeof e&&null!==e||Na('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new Wa(e.message);case"InvalidPDFException":return new ja(e.message);case"PasswordException":return new Fa(e.message,e.code);case"ResponseException":return new Ua(e.message,e.status,e.missing);case"UnknownErrorException":return new La(e.message,e.details)}return new La(e.message,e.toString())}var Gp=new WeakMap,Jp=new WeakSet;class Kp{constructor(e,t,n){vo(this,Jp),yo(this,Gp,new AbortController),this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",bo(Jp,this,Yp).bind(this),{signal:_o(Gp,this).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error('There is already an actionName called "'.concat(e,'"'));n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(r){s.reject(r)}return s.promise}sendWithStream(e,t,n,i){const s=this.streamId++,r=this.sourceName,o=this.targetName,a=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[s]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:r,targetName:o,action:e,streamId:s,data:t,desiredSize:n.desiredSize},i),l.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[s].pullCall=t,a.postMessage({sourceName:r,targetName:o,stream:Wp,streamId:s,desiredSize:e.desiredSize}),t.promise},cancel:e=>{Pa(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[s].cancelCall=t,this.streamControllers[s].isClosed=!0,a.postMessage({sourceName:r,targetName:o,stream:Fp,streamId:s,reason:zp(e)}),t.promise}},n)}destroy(){var e;null===(e=_o(Gp,this))||void 0===e||e.abort(),xo(Gp,this,null)}}function Yp(e){let{data:t}=e;if(t.targetName!==this.sourceName)return;if(t.stream)return void bo(Jp,this,Xp).call(this,t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error("Cannot resolve callback ".concat(e));if(delete this.callbackCapabilities[e],t.callback===Op)n.resolve(t.data);else{if(t.callback!==Dp)throw new Error("Unexpected callback case");n.reject(zp(t.reason))}return}const n=this.actionHandler[t.action];if(!n)throw new Error("Unknown action from worker: ".concat(t.action));if(t.callbackId){const e=this.sourceName,i=t.sourceName,s=this.comObj;return void Promise.try(n,t.data).then(function(n){s.postMessage({sourceName:e,targetName:i,callback:Op,callbackId:t.callbackId,data:n})},function(n){s.postMessage({sourceName:e,targetName:i,callback:Dp,callbackId:t.callbackId,reason:zp(n)})})}t.streamId?bo(Jp,this,$p).call(this,t):n(t.data)}function $p(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,r=this,o=this.actionHandler[e.action],a={enqueue(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const a=this.desiredSize;this.desiredSize-=r,a>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:Up,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:jp,streamId:t}),delete r.streamSinks[t])},error(e){Pa(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:Bp,streamId:t,reason:zp(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[t]=a,Promise.try(o,e.data,a).then(function(){s.postMessage({sourceName:n,targetName:i,stream:Vp,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:Vp,streamId:t,reason:zp(e)})})}function Xp(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,r=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Vp:e.success?r.startCall.resolve():r.startCall.reject(zp(e.reason));break;case Hp:e.success?r.pullCall.resolve():r.pullCall.reject(zp(e.reason));break;case Wp:if(!o){s.postMessage({sourceName:n,targetName:i,stream:Hp,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||qp).then(function(){s.postMessage({sourceName:n,targetName:i,stream:Hp,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:Hp,streamId:t,reason:zp(e)})});break;case Up:if(Pa(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(e.chunk);break;case jp:if(Pa(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),bo(Jp,this,Qp).call(this,r,t);break;case Bp:Pa(r,"error should have stream controller"),r.controller.error(zp(e.reason)),bo(Jp,this,Qp).call(this,r,t);break;case Lp:e.success?r.cancelCall.resolve():r.cancelCall.reject(zp(e.reason)),bo(Jp,this,Qp).call(this,r,t);break;case Fp:if(!o)break;const a=zp(e.reason);Promise.try(o.onCancel||qp,a).then(function(){s.postMessage({sourceName:n,targetName:i,stream:Lp,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:Lp,streamId:t,reason:zp(e)})}),o.sinkCapability.reject(a),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async function Qp(e,t){var n,i,s;await Promise.allSettled([null===(n=e.startCall)||void 0===n?void 0:n.promise,null===(i=e.pullCall)||void 0===i?void 0:i.promise,null===(s=e.cancelCall)||void 0===s?void 0:s.promise]),delete this.streamControllers[t]}var Zp=new WeakMap;class ef{constructor(e){let{enableHWA:t=!1}=e;yo(this,Zp,!1),xo(Zp,this,t)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!_o(Zp,this)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Na("Abstract method `_createCanvas` called.")}}class tf extends ef{constructor(e){let{ownerDocument:t=globalThis.document,enableHWA:n=!1}=e;super({enableHWA:n}),this._document=t}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class nf{constructor(e){let{baseUrl:t=null,isCompressed:n=!0}=e;this.baseUrl=t,this.isCompressed=n}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const n=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(n).then(e=>({cMapData:e,isCompressed:this.isCompressed})).catch(e=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(n))})}async _fetch(e){Na("Abstract method `_fetch` called.")}}class sf extends nf{async _fetch(e){const t=await rl(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Va(t)}}class rf{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,s){return"none"}destroy(){}}var of=new WeakMap,af=new WeakMap,lf=new WeakMap,cf=new WeakMap,uf=new WeakMap,df=new WeakMap,hf=new WeakMap,pf=new WeakSet;class ff extends rf{constructor(e){let{docId:t,ownerDocument:n=globalThis.document}=e;super(),vo(this,pf),yo(this,of,void 0),yo(this,af,void 0),yo(this,lf,void 0),yo(this,cf,void 0),yo(this,uf,void 0),yo(this,df,void 0),yo(this,hf,0),xo(cf,this,t),xo(uf,this,n)}addFilter(e){var t,n;if(!e)return"none";let i=wo(pf,this,mf).get(e);if(i)return i;const[s,r,o]=bo(pf,this,yf).call(this,e),a=1===e.length?s:"".concat(s).concat(r).concat(o);if(i=wo(pf,this,mf).get(a),i)return wo(pf,this,mf).set(e,i),i;const l="g_".concat(_o(cf,this),"_transfer_map_").concat((xo(hf,this,(t=_o(hf,this),n=t++,t)),n)),c=bo(pf,this,bf).call(this,l);wo(pf,this,mf).set(e,c),wo(pf,this,mf).set(a,c);const u=bo(pf,this,xf).call(this,l);return bo(pf,this,Sf).call(this,s,r,o,u),c}addHCMFilter(e,t){var n;const i="".concat(e,"-").concat(t),s="base";let r=wo(pf,this,gf).get(s);if((null===(n=r)||void 0===n?void 0:n.key)===i)return r.url;var o;r?(null===(o=r.filter)||void 0===o||o.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},wo(pf,this,gf).set(s,r));if(!e||!t)return r.url;const a=bo(pf,this,Cf).call(this,e);e=Ga.makeHexColor(...a);const l=bo(pf,this,Cf).call(this,t);if(t=Ga.makeHexColor(...l),wo(pf,this,vf).style.color="","#000000"===e&&"#ffffff"===t||e===t)return r.url;const c=new Array(256);for(let f=0;f<=255;f++){const e=f/255;c[f]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const u=c.join(","),d="g_".concat(_o(cf,this),"_hcm_filter"),h=r.filter=bo(pf,this,xf).call(this,d);bo(pf,this,Sf).call(this,u,u,u,h),bo(pf,this,_f).call(this,h);const p=(e,t)=>{const n=a[e]/255,i=l[e]/255,s=new Array(t+1);for(let r=0;r<=t;r++)s[r]=n+r/t*(i-n);return s.join(",")};return bo(pf,this,Sf).call(this,p(0,5),p(1,5),p(2,5),h),r.url=bo(pf,this,bf).call(this,d),r.url}addAlphaFilter(e){var t,n;let i=wo(pf,this,mf).get(e);if(i)return i;const[s]=bo(pf,this,yf).call(this,[e]),r="alpha_".concat(s);if(i=wo(pf,this,mf).get(r),i)return wo(pf,this,mf).set(e,i),i;const o="g_".concat(_o(cf,this),"_alpha_map_").concat((xo(hf,this,(t=_o(hf,this),n=t++,t)),n)),a=bo(pf,this,bf).call(this,o);wo(pf,this,mf).set(e,a),wo(pf,this,mf).set(r,a);const l=bo(pf,this,xf).call(this,o);return bo(pf,this,Af).call(this,s,l),a}addLuminosityFilter(e){var t,n;let i,s,r=wo(pf,this,mf).get(e||"luminosity");if(r)return r;if(e?([i]=bo(pf,this,yf).call(this,[e]),s="luminosity_".concat(i)):s="luminosity",r=wo(pf,this,mf).get(s),r)return wo(pf,this,mf).set(e,r),r;const o="g_".concat(_o(cf,this),"_luminosity_map_").concat((xo(hf,this,(t=_o(hf,this),n=t++,t)),n)),a=bo(pf,this,bf).call(this,o);wo(pf,this,mf).set(e,a),wo(pf,this,mf).set(s,a);const l=bo(pf,this,xf).call(this,o);return bo(pf,this,wf).call(this,l),e&&bo(pf,this,Af).call(this,i,l),a}addHighlightHCMFilter(e,t,n,i,s){var r;const o="".concat(t,"-").concat(n,"-").concat(i,"-").concat(s);let a=wo(pf,this,gf).get(e);if((null===(r=a)||void 0===r?void 0:r.key)===o)return a.url;var l;a?(null===(l=a.filter)||void 0===l||l.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},wo(pf,this,gf).set(e,a));if(!t||!n)return a.url;const[c,u]=[t,n].map(bo(pf,this,Cf).bind(this));let d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[p,f]=[i,s].map(bo(pf,this,Cf).bind(this));h<d&&([d,h,p,f]=[h,d,f,p]),wo(pf,this,vf).style.color="";const m=(e,t,n)=>{const i=new Array(256),s=(h-d)/n,r=e/255,o=(t-e)/(255*n);let a=0;for(let l=0;l<=n;l++){const e=Math.round(d+l*s),t=r+l*o;for(let n=a;n<=e;n++)i[n]=t;a=e+1}for(let l=a;l<256;l++)i[l]=i[a-1];return i.join(",")},g="g_".concat(_o(cf,this),"_hcm_").concat(e,"_filter"),v=a.filter=bo(pf,this,xf).call(this,g);return bo(pf,this,_f).call(this,v),bo(pf,this,Sf).call(this,m(p[0],f[0],5),m(p[1],f[1],5),m(p[2],f[2],5),v),a.url=bo(pf,this,bf).call(this,g),a.url}destroy(){var e,t,n,i;arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&null!==(e=_o(df,this))&&void 0!==e&&e.size||(null===(t=_o(lf,this))||void 0===t||t.parentNode.parentNode.remove(),xo(lf,this,null),null===(n=_o(af,this))||void 0===n||n.clear(),xo(af,this,null),null===(i=_o(df,this))||void 0===i||i.clear(),xo(df,this,null),xo(hf,this,0))}}function mf(e){return _o(af,e)||xo(af,e,new Map)}function gf(e){return _o(df,e)||xo(df,e,new Map)}function vf(e){if(!_o(lf,e)){const t=_o(uf,e).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=_o(uf,e).createElementNS(il,"svg");i.setAttribute("width",0),i.setAttribute("height",0),xo(lf,e,_o(uf,e).createElementNS(il,"defs")),t.append(i),i.append(_o(lf,e)),_o(uf,e).body.append(t)}return _o(lf,e)}function yf(e){if(1===e.length){const t=e[0],n=new Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;const i=n.join(",");return[i,i,i]}const[t,n,i]=e,s=new Array(256),r=new Array(256),o=new Array(256);for(let a=0;a<256;a++)s[a]=t[a]/255,r[a]=n[a]/255,o[a]=i[a]/255;return[s.join(","),r.join(","),o.join(",")]}function bf(e){if(void 0===_o(of,this)){xo(of,this,"");const e=_o(uf,this).URL;e!==_o(uf,this).baseURI&&(ll(e)?Ia('#createUrl: ignore "data:"-URL for performance reasons.'):xo(of,this,Ra(e,"")))}return"url(".concat(_o(of,this),"#").concat(e,")")}function wf(e){const t=_o(uf,this).createElementNS(il,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}function _f(e){const t=_o(uf,this).createElementNS(il,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}function xf(e){const t=_o(uf,this).createElementNS(il,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),wo(pf,this,vf).append(t),t}function Ef(e,t,n){const i=_o(uf,this).createElementNS(il,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}function Sf(e,t,n,i){const s=_o(uf,this).createElementNS(il,"feComponentTransfer");i.append(s),bo(pf,this,Ef).call(this,s,"feFuncR",e),bo(pf,this,Ef).call(this,s,"feFuncG",t),bo(pf,this,Ef).call(this,s,"feFuncB",n)}function Af(e,t){const n=_o(uf,this).createElementNS(il,"feComponentTransfer");t.append(n),bo(pf,this,Ef).call(this,n,"feFuncA",e)}function Cf(e){return wo(pf,this,vf).style.color=e,gl(getComputedStyle(wo(pf,this,vf)).getPropertyValue("color"))}class Tf{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load font data at: ".concat(n))})}async _fetch(e){Na("Abstract method `_fetch` called.")}}class kf extends Tf{async _fetch(e){const t=await rl(e,"arraybuffer");return new Uint8Array(t)}}class If{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load wasm data at: ".concat(n))})}async _fetch(e){Na("Abstract method `_fetch` called.")}}class Nf extends If{async _fetch(e){const t=await rl(e,"arraybuffer");return new Uint8Array(t)}}async function Pf(e){const t=process.getBuiltinModule("fs"),n=await t.promises.readFile(e);return new Uint8Array(n)}Ho&&Ia("Please use the `legacy` build in Node.js environments.");class Mf extends rf{}class Rf extends ef{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///workspaces/audesp/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(e,t)}}class Of extends nf{async _fetch(e){return Pf(e)}}class Df extends Tf{async _fetch(e){return Pf(e)}}class Ff extends If{async _fetch(e){return Pf(e)}}const Lf="__forcedDependency",{floor:jf,ceil:Uf}=Math;function Bf(e,t,n,i,s,r){e[4*t+0]=Math.min(e[4*t+0],n),e[4*t+1]=Math.min(e[4*t+1],i),e[4*t+2]=Math.max(e[4*t+2],s),e[4*t+3]=Math.max(e[4*t+3],r)}const Wf=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Hf=new WeakMap,Vf=new WeakMap;class qf{constructor(e,t){yo(this,Hf,void 0),yo(this,Vf,void 0),xo(Hf,this,e),xo(Vf,this,t)}get length(){return _o(Hf,this).length}isEmpty(e){return _o(Hf,this)[e]===Wf}minX(e){return _o(Vf,this)[4*e+0]/256}minY(e){return _o(Vf,this)[4*e+1]/256}maxX(e){return(_o(Vf,this)[4*e+2]+1)/256}maxY(e){return(_o(Vf,this)[4*e+3]+1)/256}}const zf=(e,t)=>{if(!e)return;let n=e.get(t);return n||(n={dependencies:new Set,isRenderingOperation:!1},e.set(t,n)),n};var Gf=new WeakMap,Jf=new WeakMap,Kf=new WeakMap,Yf=new WeakMap,$f=new WeakMap,Xf=new WeakMap,Qf=new WeakMap,Zf=new WeakMap,em=new WeakMap,tm=new WeakMap,nm=new WeakMap,im=new WeakMap,sm=new WeakMap,rm=new WeakMap,om=new WeakMap,am=new WeakMap,lm=new WeakMap,cm=new WeakSet;class um{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];vo(this,cm),yo(this,Gf,{__proto__:null}),yo(this,Jf,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Lf]:[]}),yo(this,Kf,new Map),yo(this,Yf,[]),yo(this,$f,[]),yo(this,Xf,[[1,0,0,1,0,0]]),yo(this,Qf,[-1/0,-1/0,1/0,1/0]),yo(this,Zf,new Float64Array([1/0,1/0,-1/0,-1/0])),yo(this,em,-1),yo(this,tm,new Set),yo(this,nm,new Map),yo(this,im,new Map),yo(this,sm,void 0),yo(this,rm,void 0),yo(this,om,void 0),yo(this,am,void 0),yo(this,lm,void 0),xo(sm,this,e.width),xo(rm,this,e.height),bo(cm,this,dm).call(this,t),n&&xo(lm,this,new Map)}growOperationsCount(e){e>=_o(am,this).length&&bo(cm,this,dm).call(this,e,_o(am,this))}save(e){return xo(Gf,this,{__proto__:_o(Gf,this)}),xo(Jf,this,{__proto__:_o(Jf,this),transform:{__proto__:_o(Jf,this).transform},moveText:{__proto__:_o(Jf,this).moveText},sameLineText:{__proto__:_o(Jf,this).sameLineText},[Lf]:{__proto__:_o(Jf,this)[Lf]}}),xo(Qf,this,{__proto__:_o(Qf,this)}),_o(Yf,this).push(e),this}restore(e){const t=Object.getPrototypeOf(_o(Gf,this));if(null===t)return this;xo(Gf,this,t),xo(Jf,this,Object.getPrototypeOf(_o(Jf,this))),xo(Qf,this,Object.getPrototypeOf(_o(Qf,this)));const n=_o(Yf,this).pop();var i;void 0!==n&&(null===(i=zf(_o(lm,this),e))||void 0===i||i.dependencies.add(n),_o(am,this)[e]=_o(am,this)[n]);return this}recordOpenMarker(e){return _o(Yf,this).push(e),this}getOpenMarker(){return 0===_o(Yf,this).length?null:_o(Yf,this).at(-1)}recordCloseMarker(e){const t=_o(Yf,this).pop();var n;void 0!==t&&(null===(n=zf(_o(lm,this),e))||void 0===n||n.dependencies.add(t),_o(am,this)[e]=_o(am,this)[t]);return this}beginMarkedContent(e){return _o($f,this).push(e),this}endMarkedContent(e){const t=_o($f,this).pop();var n;void 0!==t&&(null===(n=zf(_o(lm,this),e))||void 0===n||n.dependencies.add(t),_o(am,this)[e]=_o(am,this)[t]);return this}pushBaseTransform(e){return _o(Xf,this).push(Ga.multiplyByDOMMatrix(_o(Xf,this).at(-1),e.getTransform())),this}popBaseTransform(){return _o(Xf,this).length>1&&_o(Xf,this).pop(),this}recordSimpleData(e,t){return _o(Gf,this)[e]=t,this}recordIncrementalData(e,t){return _o(Jf,this)[e].push(t),this}resetIncrementalData(e,t){return _o(Jf,this)[e].length=0,this}recordNamedData(e,t){return _o(Kf,this).set(e,t),this}recordSimpleDataFromNamed(e,t,n){var i;_o(Gf,this)[e]=null!==(i=_o(Kf,this).get(t))&&void 0!==i?i:n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Lf,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in _o(Gf,this)&&this.recordFutureForcedDependency(t,_o(Gf,this)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of _o(tm,this))this.recordFutureForcedDependency(Lf,e);return this}resetBBox(e){return _o(em,this)!==e&&(xo(em,this,e),_o(Zf,this)[0]=1/0,_o(Zf,this)[1]=1/0,_o(Zf,this)[2]=-1/0,_o(Zf,this)[3]=-1/0),this}recordClipBox(e,t,n,i,s,r){const o=Ga.multiplyByDOMMatrix(_o(Xf,this).at(-1),t.getTransform()),a=[1/0,1/0,-1/0,-1/0];Ga.axialAlignedBoundingBox([n,s,i,r],o,a);const l=Ga.intersect(_o(Qf,this),a);return l?(_o(Qf,this)[0]=l[0],_o(Qf,this)[1]=l[1],_o(Qf,this)[2]=l[2],_o(Qf,this)[3]=l[3]):(_o(Qf,this)[0]=_o(Qf,this)[1]=1/0,_o(Qf,this)[2]=_o(Qf,this)[3]=-1/0),this}recordBBox(e,t,n,i,s,r){const o=_o(Qf,this);if(o[0]===1/0)return this;const a=Ga.multiplyByDOMMatrix(_o(Xf,this).at(-1),t.getTransform());if(o[0]===-1/0)return Ga.axialAlignedBoundingBox([n,s,i,r],a,_o(Zf,this)),this;const l=[1/0,1/0,-1/0,-1/0];return Ga.axialAlignedBoundingBox([n,s,i,r],a,l),_o(Zf,this)[0]=Math.min(_o(Zf,this)[0],Math.max(l[0],o[0])),_o(Zf,this)[1]=Math.min(_o(Zf,this)[1],Math.max(l[1],o[1])),_o(Zf,this)[2]=Math.max(_o(Zf,this)[2],Math.min(l[2],o[2])),_o(Zf,this)[3]=Math.max(_o(Zf,this)[3],Math.min(l[3],o[3])),this}recordCharacterBBox(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;const a=n.bbox;let l,c;if(a&&(l=a[2]!==a[0]&&a[3]!==a[1]&&_o(im,this).get(n),!1!==l&&(c=[0,0,0,0],Ga.axialAlignedBoundingBox(a,n.fontMatrix,c),1===i&&0===s&&0===r||Ga.scaleMinMax([i,0,0,-i,s,r],c),l)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!o)return this.recordFullPageBBox(e);const u=o();return a&&c&&void 0===l&&(l=c[0]<=s-u.actualBoundingBoxLeft&&c[2]>=s+u.actualBoundingBoxRight&&c[1]<=r-u.actualBoundingBoxAscent&&c[3]>=r+u.actualBoundingBoxDescent,_o(im,this).set(n,l),l)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,s-u.actualBoundingBoxLeft,s+u.actualBoundingBoxRight,r-u.actualBoundingBoxAscent,r+u.actualBoundingBoxDescent)}recordFullPageBBox(e){return _o(Zf,this)[0]=Math.max(0,_o(Qf,this)[0]),_o(Zf,this)[1]=Math.max(0,_o(Qf,this)[1]),_o(Zf,this)[2]=Math.min(_o(sm,this),_o(Qf,this)[2]),_o(Zf,this)[3]=Math.min(_o(rm,this),_o(Qf,this)[3]),this}getSimpleIndex(e){return _o(Gf,this)[e]}recordDependencies(e,t){const n=_o(tm,this),i=_o(Gf,this),s=_o(Jf,this);for(const r of t)r in _o(Gf,this)?n.add(i[r]):r in s&&s[r].forEach(n.add,n);return this}recordNamedDependency(e,t){return _o(Kf,this).has(t)&&_o(tm,this).add(_o(Kf,this).get(t)),this}recordOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.recordDependencies(e,[Lf]),_o(lm,this)){const t=zf(_o(lm,this),e),{dependencies:n}=t;_o(tm,this).forEach(n.add,n),_o(Yf,this).forEach(n.add,n),_o($f,this).forEach(n.add,n),n.delete(e),t.isRenderingOperation=!0}if(_o(em,this)===e){const n=jf(256*_o(Zf,this)[0]/_o(sm,this)),i=jf(256*_o(Zf,this)[1]/_o(rm,this)),s=Uf(256*_o(Zf,this)[2]/_o(sm,this)),r=Uf(256*_o(Zf,this)[3]/_o(rm,this));Bf(_o(om,this),e,n,i,s,r);for(const t of _o(tm,this))t!==e&&Bf(_o(om,this),t,n,i,s,r);for(const t of _o(Yf,this))t!==e&&Bf(_o(om,this),t,n,i,s,r);for(const t of _o($f,this))t!==e&&Bf(_o(om,this),t,n,i,s,r);t||(_o(tm,this).clear(),xo(em,this,-1))}return this}recordShowTextOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Array.from(_o(tm,this));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _o(em,this)===e&&(xo(em,this,-1),_o(Qf,this)[0]=Math.max(_o(Qf,this)[0],_o(Zf,this)[0]),_o(Qf,this)[1]=Math.max(_o(Qf,this)[1],_o(Zf,this)[1]),_o(Qf,this)[2]=Math.min(_o(Qf,this)[2],_o(Zf,this)[2]),_o(Qf,this)[3]=Math.min(_o(Qf,this)[3],_o(Zf,this)[3]),t||_o(tm,this).clear()),this}_takePendingDependencies(){const e=_o(tm,this);return xo(tm,this,new Set),e}_extractOperation(e){const t=_o(nm,this).get(e);return _o(nm,this).delete(e),t}_pushPendingDependencies(e){for(const t of e)_o(tm,this).add(t)}take(){return _o(im,this).clear(),new qf(_o(am,this),_o(om,this))}takeDebugMetadata(){return _o(lm,this)}}function dm(e,t){const n=new ArrayBuffer(4*e);xo(om,this,new Uint8ClampedArray(n)),xo(am,this,new Uint32Array(n)),t&&t.length>0?(_o(am,this).set(t),_o(am,this).fill(Wf,t.length)):_o(am,this).fill(Wf)}var hm=new WeakMap,pm=new WeakMap,fm=new WeakMap,mm=new WeakMap,gm=new WeakMap;class vm{constructor(e,t,n){if(yo(this,hm,void 0),yo(this,pm,void 0),yo(this,fm,void 0),yo(this,mm,0),yo(this,gm,0),e instanceof vm&&_o(fm,e)===!!n)return e;xo(hm,this,e),xo(pm,this,t),xo(fm,this,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){var t;return xo(gm,this,(t=_o(gm,this),t++,t)),_o(hm,this).save(_o(pm,this)),this}restore(e){var t;_o(gm,this)>0&&(_o(hm,this).restore(_o(pm,this)),xo(gm,this,(t=_o(gm,this),t--,t)));return this}recordOpenMarker(e){var t;return xo(mm,this,(t=_o(mm,this),t++,t)),this}getOpenMarker(){return _o(mm,this)>0?_o(pm,this):_o(hm,this).getOpenMarker()}recordCloseMarker(e){var t;return xo(mm,this,(t=_o(mm,this),t--,t)),this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return _o(hm,this).pushBaseTransform(e),this}popBaseTransform(){return _o(hm,this).popBaseTransform(),this}recordSimpleData(e,t){return _o(hm,this).recordSimpleData(e,_o(pm,this)),this}recordIncrementalData(e,t){return _o(hm,this).recordIncrementalData(e,_o(pm,this)),this}resetIncrementalData(e,t){return _o(hm,this).resetIncrementalData(e,_o(pm,this)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return _o(hm,this).recordSimpleDataFromNamed(e,t,_o(pm,this)),this}recordFutureForcedDependency(e,t){return _o(hm,this).recordFutureForcedDependency(e,_o(pm,this)),this}inheritSimpleDataAsFutureForcedDependencies(e){return _o(hm,this).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return _o(hm,this).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return _o(fm,this)||_o(hm,this).resetBBox(_o(pm,this)),this}recordClipBox(e,t,n,i,s,r){return _o(fm,this)||_o(hm,this).recordClipBox(_o(pm,this),t,n,i,s,r),this}recordBBox(e,t,n,i,s,r){return _o(fm,this)||_o(hm,this).recordBBox(_o(pm,this),t,n,i,s,r),this}recordCharacterBBox(e,t,n,i,s,r,o){return _o(fm,this)||_o(hm,this).recordCharacterBBox(_o(pm,this),t,n,i,s,r,o),this}recordFullPageBBox(e){return _o(fm,this)||_o(hm,this).recordFullPageBBox(_o(pm,this)),this}getSimpleIndex(e){return _o(hm,this).getSimpleIndex(e)}recordDependencies(e,t){return _o(hm,this).recordDependencies(_o(pm,this),t),this}recordNamedDependency(e,t){return _o(hm,this).recordNamedDependency(_o(pm,this),t),this}recordOperation(e){return _o(hm,this).recordOperation(_o(pm,this),!0),this}recordShowTextOperation(e){return _o(hm,this).recordShowTextOperation(_o(pm,this),!0),this}bboxToClipBoxDropOperation(e){return _o(fm,this)||_o(hm,this).bboxToClipBoxDropOperation(_o(pm,this),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const ym=["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],bm=["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],wm=["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],_m=["filter","fillColor","fillAlpha"],xm=["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],Em=["transform"],Sm=["transform","fillColor"],Am="Fill",Cm="Stroke",Tm="Shading";function km(e,t){if(!t)return;const n=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],n,i),e.clip(s)}class Im{isModifyingCurrentTransform(){return!1}getPattern(){Na("Abstract method `getPattern` called.")}}class Nm extends Im{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return 0===this._p0[0]&&0===this._p0[1]&&(!this.isRadial()||0===this._p1[0]&&0===this._p1[1])}isRadial(){return"radial"===this._type}_createGradient(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this._p0,s=this._p1;if(n&&(i=i.slice(),s=s.slice(),Ga.applyTransform(i,n),Ga.applyTransform(s,n)),"axial"===this._type)t=e.createLinearGradient(i[0],i[1],s[0],s[1]);else if("radial"===this._type){let r=this._r0,o=this._r1;if(n){const e=new Float32Array(2);Ga.singularValueDecompose2dScale(n,e),r*=e[0],o*=e[0]}t=e.createRadialGradient(i[0],i[1],r,s[0],s[1],o)}for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,n,i){let s;if(i===Cm||i===Am){if(this.isOriginBased()){let i=Ga.transform(n,t.baseTransform);this.matrix&&(i=Ga.transform(i,this.matrix));const s=.001,r=Math.hypot(i[0],i[1]),o=Math.hypot(i[2],i[3]),a=(i[0]*i[2]+i[1]*i[3])/(r*o);if(Math.abs(a)<s){if(!this.isRadial())return this._createGradient(e,i);if(Math.abs(r-o)<s)return this._createGradient(e,i)}}const r=t.current.getClippedPathBoundingBox(i,vl(e))||[0,0,0,0],o=Math.ceil(r[2]-r[0])||1,a=Math.ceil(r[3]-r[1])||1,l=t.cachedCanvases.getCanvas("pattern",o,a),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),n=Ga.transform(n,[1,0,0,1,r[0],r[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),km(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=e.createPattern(l.canvas,"no-repeat");const u=new DOMMatrix(n);s.setTransform(u)}else km(e,this._bbox),s=this._createGradient(e);return s}}function Pm(e,t,n,i,s,r,o,a){const l=t.coords,c=t.colors,u=e.data,d=4*e.width;let h;l[n+1]>l[i+1]&&(h=n,n=i,i=h,h=r,r=o,o=h),l[i+1]>l[s+1]&&(h=i,i=s,s=h,h=o,o=a,a=h),l[n+1]>l[i+1]&&(h=n,n=i,i=h,h=r,r=o,o=h);const p=(l[n]+t.offsetX)*t.scaleX,f=(l[n+1]+t.offsetY)*t.scaleY,m=(l[i]+t.offsetX)*t.scaleX,g=(l[i+1]+t.offsetY)*t.scaleY,v=(l[s]+t.offsetX)*t.scaleX,y=(l[s+1]+t.offsetY)*t.scaleY;if(f>=y)return;const b=c[r],w=c[r+1],_=c[r+2],x=c[o],E=c[o+1],S=c[o+2],A=c[a],C=c[a+1],T=c[a+2],k=Math.round(f),I=Math.round(y);let N,P,M,R,O,D,F,L;for(let j=k;j<=I;j++){if(j<g){const e=j<f?0:(f-j)/(f-g);N=p-(p-m)*e,P=b-(b-x)*e,M=w-(w-E)*e,R=_-(_-S)*e}else{let e;e=j>y?1:g===y?0:(g-j)/(g-y),N=m-(m-v)*e,P=x-(x-A)*e,M=E-(E-C)*e,R=S-(S-T)*e}let e;e=j<f?0:j>y?1:(f-j)/(f-y),O=p-(p-v)*e,D=b-(b-A)*e,F=w-(w-C)*e,L=_-(_-T)*e;const t=Math.round(Math.min(N,O)),n=Math.round(Math.max(N,O));let i=d*j+4*t;for(let s=t;s<=n;s++)e=(N-s)/(N-O),e<0?e=0:e>1&&(e=1),u[i++]=P-(P-D)*e|0,u[i++]=M-(M-F)*e|0,u[i++]=R-(R-L)*e|0,u[i++]=255}}function Mm(e,t,n){const i=t.coords,s=t.colors;let r,o;switch(t.type){case sa:const a=t.verticesPerRow,l=Math.floor(i.length/a)-1,c=a-1;for(r=0;r<l;r++){let t=r*a;for(let r=0;r<c;r++,t++)Pm(e,n,i[t],i[t+1],i[t+a],s[t],s[t+1],s[t+a]),Pm(e,n,i[t+a+1],i[t+1],i[t+a],s[t+a+1],s[t+1],s[t+a])}break;case ia:for(r=0,o=i.length;r<o;r+=3)Pm(e,n,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class Rm extends Im{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const i=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,o=Math.ceil(this._bounds[3])-s,a=Math.min(Math.ceil(Math.abs(r*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(o*e[1]*1.1)),3e3),c=r/a,u=o/l,d={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-s,scaleX:1/c,scaleY:1/u},h=a+4,p=l+4,f=n.getCanvas("mesh",h,p),m=f.context,g=m.createImageData(a,l);if(t){const e=g.data;for(let n=0,i=e.length;n<i;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const v of this._figures)Mm(g,v,d);m.putImageData(g,2,2);return{canvas:f.canvas,offsetX:i-2*c,offsetY:s-2*u,scaleX:c,scaleY:u}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){km(e,this._bbox);const s=new Float32Array(2);if(i===Tm)Ga.singularValueDecompose2dScale(vl(e),s);else if(this.matrix){Ga.singularValueDecompose2dScale(this.matrix,s);const[e,n]=s;Ga.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=e,s[1]*=n}else Ga.singularValueDecompose2dScale(t.baseTransform,s);const r=this._createMeshCanvas(s,i===Tm?null:this._background,t.cachedCanvases);return i!==Tm&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class Om extends Im{getPattern(){return"hotpink"}}const Dm=1,Fm=2;class Lm{constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){var n,i;const{bbox:s,operatorList:r,paintType:o,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:d}=this;u=Math.abs(u),d=Math.abs(d),ka("TilingType: "+a);const h=s[0],p=s[1],f=s[2],m=s[3],g=f-h,v=m-p,y=new Float32Array(2);Ga.singularValueDecompose2dScale(this.matrix,y);const[b,w]=y;Ga.singularValueDecompose2dScale(this.baseTransform,y);const _=b*y[0],x=w*y[1];let E=g,S=v,A=!1,C=!1;const T=Math.ceil(u*_),k=Math.ceil(d*x);T>=Math.ceil(g*_)?E=u:A=!0,k>=Math.ceil(v*x)?S=d:C=!0;const I=this.getSizeAndScale(E,this.ctx.canvas.width,_),N=this.getSizeAndScale(S,this.ctx.canvas.height,x),P=e.cachedCanvases.getCanvas("pattern",I.size,N.size),M=P.context,R=c.createCanvasGraphics(M,t);if(R.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(R,o,l),M.translate(-I.scale*h,-N.scale*p),R.transform(0,I.scale,0,0,N.scale,0,0),M.save(),null===(n=R.dependencyTracker)||void 0===n||n.save(),this.clipBbox(R,h,p,f,m),R.baseTransform=vl(R.ctx),R.executeOperatorList(r),R.endDrawing(),null===(i=R.dependencyTracker)||void 0===i||i.restore(),M.restore(),A||C){const t=P.canvas;A&&(E=u),C&&(S=d);const n=this.getSizeAndScale(E,this.ctx.canvas.width,_),i=this.getSizeAndScale(S,this.ctx.canvas.height,x),s=n.size,r=i.size,o=e.cachedCanvases.getCanvas("pattern-workaround",s,r),a=o.context,l=A?Math.floor(g/u):0,c=C?Math.floor(v/d):0;for(let e=0;e<=l;e++)for(let n=0;n<=c;n++)a.drawImage(t,s*e,r*n,s,r,0,0,s,r);return{canvas:o.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:h,offsetY:p}}return{canvas:P.canvas,scaleX:I.scale,scaleY:N.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,n){const i=Math.max(Lm.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*n);return s>=i?s=i:n=s/e,{scale:n,size:s}}clipBbox(e,t,n,i,s){const r=i-t,o=s-n;e.ctx.rect(t,n,r,o),Ga.axialAlignedBoundingBox([t,n,i,s],vl(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,s=e.current;switch(t){case Dm:const{fillStyle:e,strokeStyle:r}=this.ctx;i.fillStyle=s.fillColor=e,i.strokeStyle=s.strokeColor=r;break;case Fm:i.fillStyle=i.strokeStyle=n,s.fillColor=s.strokeColor=n;break;default:throw new Ba("Unsupported paint type: ".concat(t))}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,s){let r=n;i!==Tm&&(r=Ga.transform(r,t.baseTransform),this.matrix&&(r=Ga.transform(r,this.matrix)));const o=this.createPatternCanvas(t,s);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}}function jm(e){let{src:t,srcPos:n=0,dest:i,width:s,height:r,nonBlackColor:o=4294967295,inverseDecode:a=!1}=e;const l=qa.isLittleEndian?4278190080:255,[c,u]=a?[o,l]:[l,o],d=s>>3,h=7&s,p=t.length;i=new Uint32Array(i.buffer);let f=0;for(let m=0;m<r;m++){for(const s=n+d;n<s;n++){const e=n<p?t[n]:255;i[f++]=128&e?u:c,i[f++]=64&e?u:c,i[f++]=32&e?u:c,i[f++]=16&e?u:c,i[f++]=8&e?u:c,i[f++]=4&e?u:c,i[f++]=2&e?u:c,i[f++]=1&e?u:c}if(0===h)continue;const e=n<p?t[n++]:255;for(let t=0;t<h;t++)i[f++]=e&1<<7-t?u:c}return{srcPos:n,destPos:f}}r(Lm,"MAX_PATTERN_SIZE",3e3);const Um=16,Bm=new DOMMatrix,Wm=new Float32Array(2),Hm=new Float32Array([1/0,1/0,-1/0,-1/0]);class Vm{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function qm(e,t,n,i,s,r,o,a,l,c){const[u,d,h,p,f,m]=vl(e);if(0===d&&0===h){const g=o*u+f,v=Math.round(g),y=a*p+m,b=Math.round(y),w=(o+l)*u+f,_=Math.abs(Math.round(w)-v)||1,x=(a+c)*p+m,E=Math.abs(Math.round(x)-b)||1;return e.setTransform(Math.sign(u),0,0,Math.sign(p),v,b),e.drawImage(t,n,i,s,r,0,0,_,E),e.setTransform(u,d,h,p,f,m),[_,E]}if(0===u&&0===p){const g=a*h+f,v=Math.round(g),y=o*d+m,b=Math.round(y),w=(a+c)*h+f,_=Math.abs(Math.round(w)-v)||1,x=(o+l)*d+m,E=Math.abs(Math.round(x)-b)||1;return e.setTransform(0,Math.sign(d),Math.sign(h),0,v,b),e.drawImage(t,n,i,s,r,0,0,E,_),e.setTransform(u,d,h,p,f,m),[E,_]}e.drawImage(t,n,i,s,r,o,a,l,c);return[Math.hypot(u,d)*l,Math.hypot(h,p)*c]}class zm{constructor(e,t,n){r(this,"alphaIsShape",!1),r(this,"fontSize",0),r(this,"fontSizeScale",1),r(this,"textMatrix",null),r(this,"textMatrixScale",1),r(this,"fontMatrix",Vo),r(this,"leading",0),r(this,"x",0),r(this,"y",0),r(this,"lineX",0),r(this,"lineY",0),r(this,"charSpacing",0),r(this,"wordSpacing",0),r(this,"textHScale",1),r(this,"textRenderingMode",ra),r(this,"textRise",0),r(this,"fillColor","#000000"),r(this,"strokeColor","#000000"),r(this,"patternFill",!1),r(this,"patternStroke",!1),r(this,"fillAlpha",1),r(this,"strokeAlpha",1),r(this,"lineWidth",1),r(this,"activeSMask",null),r(this,"transferMaps","none"),null===n||void 0===n||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Hm.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Am,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.minMax.slice();if(e===Cm){t||Na("Stroke bounding box must include transform."),Ga.singularValueDecompose2dScale(t,Wm);const e=Wm[0]*this.lineWidth/2,i=Wm[1]*this.lineWidth/2;n[0]-=e,n[1]-=i,n[2]+=e,n[3]+=i}return n}updateClipFromPath(){const e=Ga.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Hm,0)}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Am,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ga.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Gm(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,i=t.width,s=n%Um,r=(n-s)/Um,o=0===s?r:r+1,a=e.createImageData(i,Um);let l,c=0;const u=t.data,d=a.data;let h,p,f,m;if(t.kind===da.GRAYSCALE_1BPP){const t=u.byteLength,n=new Uint32Array(d.buffer,0,d.byteLength>>2),m=n.length,g=i+7>>3,v=4294967295,y=qa.isLittleEndian?4278190080:255;for(h=0;h<o;h++){for(f=h<r?Um:s,l=0,p=0;p<f;p++){const e=t-c;let s=0;const r=e>g?i:8*e-7,o=-8&r;let a=0,d=0;for(;s<o;s+=8)d=u[c++],n[l++]=128&d?v:y,n[l++]=64&d?v:y,n[l++]=32&d?v:y,n[l++]=16&d?v:y,n[l++]=8&d?v:y,n[l++]=4&d?v:y,n[l++]=2&d?v:y,n[l++]=1&d?v:y;for(;s<r;s++)0===a&&(d=u[c++],a=128),n[l++]=d&a?v:y,a>>=1}for(;l<m;)n[l++]=0;e.putImageData(a,0,h*Um)}}else if(t.kind===da.RGBA_32BPP){for(p=0,m=i*Um*4,h=0;h<r;h++)d.set(u.subarray(c,c+m)),c+=m,e.putImageData(a,0,p),p+=Um;h<o&&(m=i*s*4,d.set(u.subarray(c,c+m)),e.putImageData(a,0,p))}else{if(t.kind!==da.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(f=Um,m=i*f,h=0;h<o;h++){for(h>=r&&(f=s,m=i*f),l=0,p=m;p--;)d[l++]=u[c++],d[l++]=u[c++],d[l++]=u[c++],d[l++]=255;e.putImageData(a,0,h*Um)}}}function Jm(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,i=t.width,s=n%Um,r=(n-s)/Um,o=0===s?r:r+1,a=e.createImageData(i,Um);let l=0;const c=t.data,u=a.data;for(let d=0;d<o;d++){const t=d<r?Um:s;({srcPos:l}=jm({src:c,srcPos:l,dest:u,width:i,height:t,nonBlackColor:0})),e.putImageData(a,0,d*Um)}}function Km(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==e[i]&&(t[i]=e[i]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function Ym(e){e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0);const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}function $m(e,t){if(t)return!0;Ga.singularValueDecompose2dScale(e,Wm);const n=Math.fround(wl.pixelRatio*sl.PDF_TO_CSS_UNITS);return Wm[0]<=n&&Wm[1]<=n}const Xm=["butt","round","square"],Qm=["miter","round","bevel"],Zm={},eg={};var tg=new WeakSet;class ng{constructor(e,t,n,i,s,r,o,a,l){let{optionalContentConfig:c,markedContentStack:u=null}=r;vo(this,tg),this.ctx=e,this.current=new zm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new Vm(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=a,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=null!==l&&void 0!==l?l:null}getObject(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var i;return"string"===typeof t?(null===(i=this.dependencyTracker)||void 0===i||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing(e){let{transform:t,viewport:n,transparency:i=!1,background:s=null}=e;const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,i){const e=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...vl(this.compositeCtx))}this.ctx.save(),Ym(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=vl(this.ctx)}executeOperatorList(e,t,n,i,s){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const c=l-a>10&&"function"===typeof n,u=c?Date.now()+15:0;let d=0;const h=this.commonObjs,p=this.objs;let f,m;for(;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;var g;if(!s||s(a))if(f=o[a],m=null!==(g=r[a])&&void 0!==g?g:null,f!==ba.dependency)null===m?this[f](a):this[f](a,...m);else for(const e of m){var v;null===(v=this.dependencyTracker)||void 0===v||v.recordNamedData(e,a);const t=e.startsWith("g_")?h:p;if(!t.has(e))return t.get(e,n),a}if(a++,a===l)return a;if(c&&++d>10){if(Date.now()>u)return n(),a;d=0}}}endDrawing(){bo(tg,this,ig).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),bo(tg,this,sg).call(this)}_scaleImage(e,t){var n,i;const s=null!==(n=e.width)&&void 0!==n?n:e.displayWidth,r=null!==(i=e.height)&&void 0!==i?i:e.displayHeight;let o,a,l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),u=s,d=r,h="prescale1";for(;l>2&&u>1||c>2&&d>1;){let t=u,n=d;l>2&&u>1&&(t=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/t),c>2&&d>1&&(n=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/n),o=this.cachedCanvases.getCanvas(h,t,n),a=o.context,a.clearRect(0,0,t,n),a.drawImage(e,0,0,u,d,0,0,t,n),e=o.canvas,u=t,d=n,h="prescale1"===h?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:d}}_createMaskCanvas(e,t){var n;const i=this.ctx,{width:s,height:r}=t,o=this.current.fillColor,a=this.current.patternFill,l=vl(i);let c,u,d,h;if((t.bitmap||t.data)&&t.count>1){const n=t.bitmap||t.data.buffer;u=JSON.stringify(a?l:[l.slice(0,4),o]),c=this._cachedBitmapsMap.get(n),c||(c=new Map,this._cachedBitmapsMap.set(n,c));const i=c.get(u);if(i&&!a){var p;const t=Math.round(Math.min(l[0],l[2])+l[4]),n=Math.round(Math.min(l[1],l[3])+l[5]);return null===(p=this.dependencyTracker)||void 0===p||p.recordDependencies(e,Sm),{canvas:i,offsetX:t,offsetY:n}}d=i}d||(h=this.cachedCanvases.getCanvas("maskCanvas",s,r),Jm(h.context,t));let f=Ga.transform(l,[1/s,0,0,-1/r,0,0]);f=Ga.transform(f,[1,0,0,1,0,-r]);const m=Hm.slice();Ga.axialAlignedBoundingBox([0,0,s,r],f,m);const[g,v,y,b]=m,w=Math.round(y-g)||1,_=Math.round(b-v)||1,x=this.cachedCanvases.getCanvas("fillCanvas",w,_),E=x.context,S=g,A=v;E.translate(-S,-A),E.transform(...f),d||(d=this._scaleImage(h.canvas,yl(E)),d=d.img,c&&a&&c.set(u,d)),E.imageSmoothingEnabled=$m(vl(E),t.interpolate),qm(E,d,0,0,d.width,d.height,0,0,s,r),E.globalCompositeOperation="source-in";const C=Ga.transform(yl(E),[1,0,0,1,-S,-A]);return E.fillStyle=a?o.getPattern(i,this,C,Am,e):o,E.fillRect(0,0,s,r),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,x.canvas)),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,Sm),{canvas:x.canvas,offsetX:Math.round(S),offsetY:Math.round(A)}}setLineWidth(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineCap",e),this.ctx.lineCap=Xm[t]}setLineJoin(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Qm[t]}setMiterLimit(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var i;null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("dash",e);const s=this.ctx;void 0!==s.setLineDash&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,i,s,r,o;for(const[a,l]of t)switch(a){case"LW":this.setLineWidth(e,l);break;case"LC":this.setLineCap(e,l);break;case"LJ":this.setLineJoin(e,l);break;case"ML":this.setMiterLimit(e,l);break;case"D":this.setDash(e,l[0],l[1]);break;case"RI":this.setRenderingIntent(e,l);break;case"FL":this.setFlatness(e,l);break;case"Font":this.setFont(e,l[0],l[1]);break;case"CA":null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=l;break;case"ca":null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=l;break;case"BM":null===(s=this.dependencyTracker)||void 0===s||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=l;break;case"SMask":null===(r=this.dependencyTracker)||void 0===r||r.recordSimpleData("SMask",e),this.current.activeSMask=l?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":null===(o=this.dependencyTracker)||void 0===o||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(l)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const r=this.ctx=s.context;r.setTransform(this.suspendedCtx.getTransform()),Km(this.suspendedCtx,r),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,i,s,r,o){t.transform(e,n,i,s,r,o),this.__originalTransform(e,n,i,s,r,o)},e.setTransform=function(e,n,i,s,r,o){t.setTransform(e,n,i,s,r,o),this.__originalSetTransform(e,n,i,s,r,o)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,i,s,r,o){t.bezierCurveTo(e,n,i,s,r,o),this.__originalBezierCurveTo(e,n,i,s,r,o)},e.rect=function(e,n,i,s){t.rect(e,n,i,s),this.__originalRect(e,n,i,s)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Km(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const s=i[0],r=i[1],o=i[2]-s,a=i[3]-r;0!==o&&0!==a&&(this.genericComposeSMask(t.context,n,o,a,t.subtype,t.backdrop,t.transferMap,s,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,s,r,o,a,l,c,u){let d=e.canvas,h=a-c,p=l-u;if(r)if(h<0||p<0||h+n>d.width||p+i>d.height){const e=this.cachedCanvases.getCanvas("maskExtension",n,i),t=e.context;t.drawImage(d,-h,-p),t.globalCompositeOperation="destination-atop",t.fillStyle=r,t.fillRect(0,0,n,i),t.globalCompositeOperation="source-over",d=e.canvas,h=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const t=new Path2D;t.rect(h,p,n,i),e.clip(t),e.globalCompositeOperation="destination-atop",e.fillStyle=r,e.fillRect(h,p,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===s&&o?t.filter=this.filterFactory.addAlphaFilter(o):"Luminosity"===s&&(t.filter=this.filterFactory.addLuminosityFilter(o));const f=new Path2D;f.rect(a,l,n,i),t.clip(f),t.globalCompositeOperation="destination-in",t.drawImage(d,h,p,n,i,a,l,n,i),t.restore()}save(e){var t;this.inSMaskMode&&Km(this.ctx,this.suspendedCtx),this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone(),null===(t=this.dependencyTracker)||void 0===t||t.save(e)}restore(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.restore(e),0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Km(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(e,t,n,i,s,r,o){var a;null===(a=this.dependencyTracker)||void 0===a||a.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,s,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[s]=n;if(!i)return s||(s=n[0]=new Path2D),void this[t](e,s);if(null!==this.dependencyTracker){const n=t===ba.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-n,i[2]+n,i[1]-n,i[3]+n).recordDependencies(e,["transform"])}s instanceof Path2D||(s=n[0]=Il(s)),Ga.axialAlignedBoundingBox(i,vl(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t){var n;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=this.ctx,r=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"===typeof r&&null!==r&&void 0!==r&&r.getPattern){const n=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=r.getPattern(s,this,yl(s),Cm,e),n){const e=new Path2D;e.addPath(t,s.getTransform().invertSelf().multiplySelf(n)),t=e}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,ym),i&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Cm,vl(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t){var n;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=this.ctx,r=this.current.fillColor;let o=!1;if(this.current.patternFill){var a;const n=r.isModifyingCurrentTransform()?s.getTransform():null;if(null===(a=this.dependencyTracker)||void 0===a||a.save(e),s.save(),s.fillStyle=r.getPattern(s,this,yl(s),Am,e),n){const e=new Path2D;e.addPath(t,s.getTransform().invertSelf().multiplySelf(n)),t=e}o=!0}const l=this.current.getClippedPathBoundingBox();var c;(this.contentVisible&&null!==l&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,bm),o)&&(s.restore(),null===(c=this.dependencyTracker)||void 0===c||c.restore(e));i&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,_m).recordOperation(e)}clip(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Zm}eoClip(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=eg}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,null===(t=this.dependencyTracker)||void 0===t||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;void 0!==t&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",e),n.recordCloseMarker(e)}if(void 0!==t){const e=new Path2D,i=n.getTransform().invertSelf();for(const{transform:n,x:s,y:r,fontSize:o,path:a}of t)a&&e.addPath(a,new DOMMatrix(n).preMultiplySelf(i).translate(s,r).scale(o,-o));n.clip(e)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var i,s;null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),o=this.current;if(!r)throw new Error("Can't find font for ".concat(t));if(o.fontMatrix=r.fontMatrix||Vo,0!==o.fontMatrix[0]&&0!==o.fontMatrix[3]||Ia("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const a=r.loadedName||"sans-serif",l=(null===(s=r.systemFontInfo)||void 0===s?void 0:s.css)||'"'.concat(a,'", ').concat(r.fallbackName);let c="normal";r.black?c="900":r.bold&&(c="bold");const u=r.italic?"italic":"normal";let d=n;n<16?d=16:n>100&&(d=100),this.current.fontSizeScale=n/d,this.ctx.font="".concat(u," ").concat(c," ").concat(d,"px ").concat(l)}setTextRenderingMode(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var i;null===(i=this.dependencyTracker)||void 0===i||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(e){var t,n;this.moveText(e,0,this.current.leading),null===(t=this.dependencyTracker)||void 0===t||t.recordIncrementalData("moveText",null!==(n=this.dependencyTracker.getSimpleIndex("leading"))&&void 0!==n?n:e)}paintChar(e,t,n,i,s,r){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,d=c&ca,h=!!(c&ua),p=a.patternFill&&!l.missingFile,f=a.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||h||p||f)&&!l.missingFile&&(m=l.getPathGenerator(this.commonObjs,t)),m&&(l.disableFontFace||p||f)){var g;let t;if(o.save(),o.translate(n,i),o.scale(u,-u),null===(g=this.dependencyTracker)||void 0===g||g.recordCharacterBBox(e,o,l),d===ra||d===aa)if(s){t=o.getTransform(),o.setTransform(...s);const e=bo(tg,this,rg).call(this,m,t,s);o.fill(e)}else o.fill(m);if(d===oa||d===aa)if(r){t||(t=o.getTransform()),o.setTransform(...r);const{a:e,b:n,c:i,d:s}=t,a=Ga.inverseTransform(r),l=Ga.transform([e,n,i,s,0,0],a);Ga.singularValueDecompose2dScale(l,Wm),o.lineWidth*=Math.max(Wm[0],Wm[1])/u,o.stroke(bo(tg,this,rg).call(this,m,t,r))}else o.lineWidth/=u,o.stroke(m);o.restore()}else{var v;if(d===ra||d===aa)o.fillText(t,n,i),null===(v=this.dependencyTracker)||void 0===v||v.recordCharacterBBox(e,o,l,u,n,i,()=>o.measureText(t));if(d===oa||d===aa){var y;if(this.dependencyTracker)null===(y=this.dependencyTracker)||void 0===y||y.recordCharacterBBox(e,o,l,u,n,i,()=>o.measureText(t)).recordDependencies(e,ym);o.strokeText(t,n,i)}}if(h){var b;(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:vl(o),x:n,y:i,fontSize:u,path:m}),null===(b=this.dependencyTracker)||void 0===b||b.recordCharacterBBox(e,o,l,u,n,i)}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Oa(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var n;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,xm).resetBBox(e),this.current.textRenderingMode&ua&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;var r;if(s.isType3Font)return this.showType3Text(e,t),void(null===(r=this.dependencyTracker)||void 0===r||r.recordShowTextOperation(e));const o=i.fontSize;var a;if(0===o)return void(null===(a=this.dependencyTracker)||void 0===a||a.recordOperation(e));const l=this.ctx,c=i.fontSizeScale,u=i.charSpacing,d=i.wordSpacing,h=i.fontDirection,p=i.textHScale*h,f=t.length,m=s.vertical,g=m?1:-1,v=s.defaultVMetrics,y=o*i.fontMatrix[0],b=i.textRenderingMode===ra&&!s.disableFontFace&&!i.patternFill;let w,_;l.save(),i.textMatrix&&l.transform(...i.textMatrix),l.translate(i.x,i.y+i.textRise),h>0?l.scale(p,-1):l.scale(p,1);const x=i.textRenderingMode&ca,E=x===oa||x===aa;if((x===ra||x===aa)&&i.patternFill){l.save();const t=i.fillColor.getPattern(l,this,yl(l),Am,e);w=vl(l),l.restore(),l.fillStyle=t}if(E&&i.patternStroke){l.save();const t=i.strokeColor.getPattern(l,this,yl(l),Cm,e);_=vl(l),l.restore(),l.strokeStyle=t}let S=i.lineWidth;const A=i.textMatrixScale;if(0===A||0===S?E&&(S=this.getSinglePixelWidth()):S/=A,1!==c&&(l.scale(c,c),S/=c),l.lineWidth=S,s.isInvalidPDFjsFont){const n=[];let s=0;for(const e of t)n.push(e.unicode),s+=e.width;const r=n.join("");if(l.fillText(r,0,0),null!==this.dependencyTracker){const t=l.measureText(r);this.dependencyTracker.recordBBox(e,this.ctx,-t.actualBoundingBoxLeft,t.actualBoundingBoxRight,-t.actualBoundingBoxAscent,t.actualBoundingBoxDescent).recordShowTextOperation(e)}return i.x+=s*y*p,l.restore(),void this.compose()}let C,T=0;for(C=0;C<f;++C){const n=t[C];if("number"===typeof n){T+=g*n*o/1e3;continue}let i=!1;const r=(n.isSpace?d:0)+u,a=n.fontChar,p=n.accent;let f,x,E,S=n.width;if(m){const e=n.vmetric||v,t=-(n.vmetric?e[1]:.5*S)*y,i=e[2]*y;S=e?-e[0]:S,f=t/c,x=(T+i)/c}else f=T/c,x=0;if(s.remeasure&&S>0){E=l.measureText(a);const e=1e3*E.width/o*c;if(S<e&&this.isFontSubpixelAAEnabled){const t=S/e;i=!0,l.save(),l.scale(t,1),f/=t}else S!==e&&(f+=(S-e)/2e3*o/c)}var k;if(this.contentVisible&&(n.isInFont||s.missingFile))if(b&&!p)l.fillText(a,f,x),null===(k=this.dependencyTracker)||void 0===k||k.recordCharacterBBox(e,l,E?{bbox:null}:s,o/c,f,x,()=>null!==E&&void 0!==E?E:l.measureText(a));else if(this.paintChar(e,a,f,x,w,_),p){const t=f+o*p.offset.x/c,n=x-o*p.offset.y/c;this.paintChar(e,p.fontChar,t,n,w,_)}T+=m?S*y-r*h:S*y+r*h,i&&l.restore()}m?i.y-=T:i.x+=T*p,l.restore(),this.compose(),null===(n=this.dependencyTracker)||void 0===n||n.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,s=i.font,r=i.fontSize,o=i.fontDirection,a=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,u=i.textHScale*o,d=i.fontMatrix||Vo,h=t.length;let p,f,m,g;if(i.textRenderingMode===la||0===r)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(u,o);const v=this.dependencyTracker;for(this.dependencyTracker=v?new vm(v,e):null,p=0;p<h;++p){if(f=t[p],"number"===typeof f){g=a*f*r/1e3,this.ctx.translate(g,0),i.x+=g*u;continue}const e=(f.isSpace?c:0)+l,o=s.charProcOperatorList[f.operatorListId];o?this.contentVisible&&(this.save(),n.scale(r,r),n.transform(...d),this.executeOperatorList(o),this.restore()):Ia('Type3 character "'.concat(f.operatorListId,'" is not available.'));const h=[f.width,0];Ga.applyTransform(h,d),m=h[0]*r+e,n.translate(m,0),i.x+=m*u}n.restore(),v&&(this.dependencyTracker=v)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,s,r,o){var a;const l=new Path2D;l.rect(i,s,r-i,o-s),this.ctx.clip(l),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,this.ctx,i,r,s,o).recordClipBox(e,this.ctx,i,r,s,o),this.endPath(e)}getColorN_Pattern(e,t){let n;if("TilingPattern"===t[0]){const e=this.baseTransform||vl(this.ctx),i={createCanvasGraphics:(e,t)=>new ng(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new vm(this.dependencyTracker,t,!0):null)};n=new Lm(t,this.ctx,i,e)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("strokeColor",e);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];this.current.strokeColor=this.getColorN_Pattern(e,i),this.current.patternStroke=!0}setFillColorN(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("fillColor",e);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];this.current.fillColor=this.getColorN_Pattern(e,i),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=function(e){switch(e[0]){case"RadialAxial":return new Nm(e);case"Mesh":return new Rm(e);case"Dummy":return new Om}throw new Error("Unknown IR type: ".concat(e[0]))}(this.getObject(e,t)),this.cachedPatterns.set(t,n)),i&&(n.matrix=i),n}shadingFill(e,t){var n;if(!this.contentVisible)return;const i=this.ctx;this.save(e);const s=this._getPattern(e,t);i.fillStyle=s.getPattern(i,this,yl(i),Tm,e);const r=yl(i);if(r){const{width:e,height:t}=i.canvas,n=Hm.slice();Ga.axialAlignedBoundingBox([0,0,e,t],r,n);const[s,o,a,l]=n;this.ctx.fillRect(s,o,a-s,l-o)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Em).recordDependencies(e,bm).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Na("Should not call beginInlineImage")}beginImageData(){Na("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=vl(this.ctx),n)){var i;Ga.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[t,s,r,o]=n,a=new Path2D;a.rect(t,s,r-t,o-s),this.ctx.clip(a),null===(i=this.dependencyTracker)||void 0===i||i.recordClipBox(e,this.ctx,t,r,s,o),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var n;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||ka("TODO: Support non-isolated groups."),t.knockout&&Ia("Knockout groups not supported.");const s=vl(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Hm.slice();Ga.axialAlignedBoundingBox(t.bbox,vl(i),r);const o=[0,0,i.canvas.width,i.canvas.height];r=Ga.intersect(r,o)||[0,0,0,0];const a=Math.floor(r[0]),l=Math.floor(r[1]),c=Math.max(Math.ceil(r[2])-a,1),u=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,u]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(d,c,u),p=h.context;p.translate(-a,-l),p.transform(...s);let f=new Path2D;const[m,g,v,y]=t.bbox;if(f.rect(m,g,v-m,y-g),t.matrix){const e=new Path2D;e.addPath(f,new DOMMatrix(t.matrix)),f=e}p.clip(f),t.smask&&this.smaskStack.push({canvas:h.canvas,context:p,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),t.smask&&!this.dependencyTracker||(i.setTransform(1,0,0,1,0,0),i.translate(a,l),i.save()),Km(i,p),this.ctx=p,null===(n=this.dependencyTracker)||void 0===n||n.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(e,t){var n;if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,null===(n=this.dependencyTracker)||void 0===n||n.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const t=vl(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...t);const n=Hm.slice();Ga.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],t,n),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,i,s,r){if(bo(tg,this,ig).call(this),Ym(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const s=n[2]-n[0],o=n[3]-n[1];if(r&&this.annotationCanvasMap){(i=i.slice())[4]-=n[0],i[5]-=n[1],(n=n.slice())[0]=n[1]=0,n[2]=s,n[3]=o,Ga.singularValueDecompose2dScale(vl(this.ctx),Wm);const{viewportScale:e}=this,r=Math.ceil(s*this.outputScaleX*e),a=Math.ceil(o*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(r,a);const{canvas:l,context:c}=this.annotationCanvas;this.annotationCanvasMap.set(t,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=c,this.ctx.save(),this.ctx.setTransform(Wm[0],0,0,-Wm[1],0,o*Wm[1]),Ym(this.ctx)}else{Ym(this.ctx),this.endPath(e);const t=new Path2D;t.rect(n[0],n[1],s,o),this.ctx.clip(t)}}this.current=new zm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),bo(tg,this,sg).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var n;if(!this.contentVisible)return;const i=t.count;(t=this.getObject(e,t.data,t)).count=i;const s=this.ctx,r=this._createMaskCanvas(e,t),o=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,r.offsetX,r.offsetY),null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+o.width,r.offsetY,r.offsetY+o.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n){var i,s;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const u=vl(c);c.transform(n,r,o,a,0,0);const d=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,d.offsetX-u[4],d.offsetY-u[5]),null===(i=this.dependencyTracker)||void 0===i||i.resetBBox(e);for(let p=0,f=l.length;p<f;p+=2){var h;const t=Ga.transform(u,[n,r,o,a,l[p],l[p+1]]);c.drawImage(d.canvas,t[4],t[5]),null===(h=this.dependencyTracker)||void 0===h||h.recordBBox(e,this.ctx,t[4],t[4]+d.canvas.width,t[5],t[5]+d.canvas.height)}c.restore(),this.compose(),null===(s=this.dependencyTracker)||void 0===s||s.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var n,i;if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,o=this.current.patternFill;null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordDependencies(e,Sm);for(const l of t){var a;const{data:t,width:n,height:i,transform:c}=l,u=this.cachedCanvases.getCanvas("maskCanvas",n,i),d=u.context;d.save();Jm(d,this.getObject(e,t,l)),d.globalCompositeOperation="source-in",d.fillStyle=o?r.getPattern(d,this,yl(s),Am,e):r,d.fillRect(0,0,n,i),d.restore(),s.save(),s.transform(...c),s.scale(1,-1),qm(s,u.canvas,0,0,n,i,0,-1,1,1),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,s,0,n,0,i),s.restore()}this.compose(),null===(i=this.dependencyTracker)||void 0===i||i.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);n?this.paintInlineImageXObject(e,n):Ia("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,i,s){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r)return void Ia("Dependent image isn't ready yet");const o=r.width,a=r.height,l=[];for(let c=0,u=s.length;c<u;c+=2)l.push({transform:[n,0,0,i,s[c],s[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(e,r,l)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,i),r=s.context;return r.filter=this.current.transferMaps,r.drawImage(t,0,0),r.filter="none",s.canvas}paintInlineImageXObject(e,t){var n;if(!this.contentVisible)return;const i=t.width,s=t.height,r=this.ctx;this.save(e);const{filter:o}=r;let a;if("none"!==o&&""!==o&&(r.filter="none"),r.scale(1/i,-1/s),t.bitmap)a=this.applyTransferMapsToBitmap(t);else if("function"===typeof HTMLElement&&t instanceof HTMLElement||!t.data)a=t;else{const e=this.cachedCanvases.getCanvas("inlineImage",i,s).context;Gm(e,t),a=this.applyTransferMapsToCanvas(e)}const l=this._scaleImage(a,yl(r));r.imageSmoothingEnabled=$m(vl(r),t.interpolate),null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordBBox(e,r,0,i,-s,0).recordDependencies(e,wm).recordOperation(e),qm(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-s,i,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var i,s;if(!this.contentVisible)return;const r=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const e=t.width,n=t.height,i=this.cachedCanvases.getCanvas("inlineImage",e,n).context;Gm(i,t),o=this.applyTransferMapsToCanvas(i)}null===(i=this.dependencyTracker)||void 0===i||i.resetBBox(e);for(const l of n){var a;r.save(),r.transform(...l.transform),r.scale(1,-1),qm(r,o,l.x,l.y,l.w,l.h,0,-1,1,1),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,r,0,1,-1,0),r.restore()}null===(s=this.dependencyTracker)||void 0===s||s.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&(null===(t=this.dependencyTracker)||void 0===t||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,bm).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var i;null===(i=this.dependencyTracker)||void 0===i||i.beginMarkedContent(e),"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const s=this.ctx;var r,o;this.pendingClip?(i||(this.pendingClip===eg?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,null===(r=this.dependencyTracker)||void 0===r||r.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):null===(o=this.dependencyTracker)||void 0===o||o.recordOperation(e);this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=vl(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:s}=this.ctx.getTransform();let r,o;if(0===n&&0===i){const n=Math.abs(t),i=Math.abs(s);if(n===i)if(0===e)r=o=1/n;else{const t=n*e;r=o=t<1?1/t:1}else if(0===e)r=1/n,o=1/i;else{const t=n*e,s=i*e;r=t<1?1/t:1,o=s<1?1/s:1}}else{const a=Math.abs(t*s-n*i),l=Math.hypot(t,n),c=Math.hypot(i,s);if(0===e)r=c/a,o=l/a;else{const t=e*a;r=c>t?c/t:1,o=l>t?l/t:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[s,r]=this.getScaleForStroking();if(s===r)return n.lineWidth=(i||1)*s,void n.stroke(e);const o=n.getLineDash();t&&n.save(),n.scale(s,r),Bm.a=1/s,Bm.d=1/r;const a=new Path2D;if(a.addPath(e,Bm),o.length>0){const e=Math.max(s,r);n.setLineDash(o.map(t=>t/e)),n.lineDashOffset/=e}n.lineWidth=i||1,n.stroke(a),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}function ig(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function sg(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}function rg(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}for(const n in ba)void 0!==ng.prototype[n]&&(ng.prototype[ba[n]]=ng.prototype[n]);class og{static get workerPort(){return bo(og,this,ag)._}static set workerPort(e){if(!("undefined"!==typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");ag._=bo(og,this,e)}static get workerSrc(){return bo(og,this,lg)._}static set workerSrc(e){if("string"!==typeof e)throw new Error("Invalid `workerSrc` type.");lg._=bo(og,this,e)}}var ag={_:null},lg={_:""},cg=new WeakMap,ug=new WeakMap;class dg{constructor(e){let{parsedData:t,rawData:n}=e;yo(this,cg,void 0),yo(this,ug,void 0),xo(cg,this,t),xo(ug,this,n)}getRaw(){return _o(ug,this)}get(e){var t;return null!==(t=_o(cg,this).get(e))&&void 0!==t?t:null}[Symbol.iterator](){return _o(cg,this).entries()}}const hg=Symbol("INTERNAL");var pg=new WeakMap,fg=new WeakMap,mg=new WeakMap,gg=new WeakMap;class vg{constructor(e,t){let{name:n,intent:i,usage:s,rbGroups:r}=t;yo(this,pg,!1),yo(this,fg,!1),yo(this,mg,!1),yo(this,gg,!0),xo(pg,this,!!(e&Go)),xo(fg,this,!!(e&Jo)),this.name=n,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(_o(mg,this))return _o(gg,this);if(!_o(gg,this))return!1;const{print:e,view:t}=this.usage;return _o(pg,this)?"OFF"!==(null===t||void 0===t?void 0:t.viewState):!_o(fg,this)||"OFF"!==(null===e||void 0===e?void 0:e.printState)}_setVisible(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==hg&&Na("Internal method `_setVisible` called."),xo(mg,this,n),xo(gg,this,t)}}var yg=new WeakMap,bg=new WeakMap,wg=new WeakMap,_g=new WeakMap,xg=new WeakSet;class Eg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Go;if(vo(this,xg),yo(this,yg,null),yo(this,bg,new Map),yo(this,wg,null),yo(this,_g,null),this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,xo(_g,this,e.order);for(const n of e.groups)_o(bg,this).set(n.id,new vg(t,n));if("OFF"===e.baseState)for(const e of _o(bg,this).values())e._setVisible(hg,!1);for(const t of e.on)_o(bg,this).get(t)._setVisible(hg,!0);for(const t of e.off)_o(bg,this).get(t)._setVisible(hg,!1);xo(wg,this,this.getHash())}}isVisible(e){if(0===_o(bg,this).size)return!0;if(!e)return ka("Optional content group not defined."),!0;if("OCG"===e.type)return _o(bg,this).has(e.id)?_o(bg,this).get(e.id).visible:(Ia("Optional content group not found: ".concat(e.id)),!0);if("OCMD"===e.type){if(e.expression)return bo(xg,this,Sg).call(this,e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!_o(bg,this).has(t))return Ia("Optional content group not found: ".concat(t)),!0;if(_o(bg,this).get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!_o(bg,this).has(t))return Ia("Optional content group not found: ".concat(t)),!0;if(!_o(bg,this).get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!_o(bg,this).has(t))return Ia("Optional content group not found: ".concat(t)),!0;if(!_o(bg,this).get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!_o(bg,this).has(t))return Ia("Optional content group not found: ".concat(t)),!0;if(_o(bg,this).get(t).visible)return!1}return!0}return Ia("Unknown optional content policy ".concat(e.policy,".")),!0}return Ia("Unknown group type ".concat(e.type,".")),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=_o(bg,this).get(e);if(i){if(n&&t&&i.rbGroups.length)for(const t of i.rbGroups)for(const n of t){var s;if(n!==e)null===(s=_o(bg,this).get(n))||void 0===s||s._setVisible(hg,!1,!0)}i._setVisible(hg,!!t,!0),xo(yg,this,null)}else Ia("Optional content group not found: ".concat(e))}setOCGState(e){let t,{state:n,preserveRB:i}=e;for(const s of n){switch(s){case"ON":case"OFF":case"Toggle":t=s;continue}const e=_o(bg,this).get(s);if(e)switch(t){case"ON":this.setVisibility(s,!0,i);break;case"OFF":this.setVisibility(s,!1,i);break;case"Toggle":this.setVisibility(s,!e.visible,i)}}xo(yg,this,null)}get hasInitialVisibility(){return null===_o(wg,this)||this.getHash()===_o(wg,this)}getOrder(){return _o(bg,this).size?_o(_g,this)?_o(_g,this).slice():[..._o(bg,this).keys()]:null}getGroup(e){return _o(bg,this).get(e)||null}getHash(){if(null!==_o(yg,this))return _o(yg,this);const e=new Ph;for(const[t,n]of _o(bg,this))e.update("".concat(t,":").concat(n.visible));return xo(yg,this,e.hexdigest())}[Symbol.iterator](){return _o(bg,this).entries()}}function Sg(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const t=e[i];let s;if(Array.isArray(t))s=bo(xg,this,Sg).call(this,t);else{if(!_o(bg,this).has(t))return Ia("Optional content group not found: ".concat(t)),!0;s=_o(bg,this).get(t).visible}switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===n}class Ag{constructor(e,t){let{disableRange:n=!1,disableStream:i=!1}=t;Pa(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(null===r||void 0===r?void 0:r.length)>0){const e=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!n,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),e.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),e.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData(e){let{begin:t,chunk:n}=e;const i=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{Pa(this._rangeReaders.some(function(e){return e._begin===t&&(e._enqueue(i),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}_onProgress(e){var t,n,i,s;void 0===e.total?null===(t=this._rangeReaders[0])||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded}):null===(i=this._fullRequestReader)||void 0===i||null===(s=i.onProgress)||void 0===s||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;null===(e=this._fullRequestReader)||void 0===e||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Pa(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Cg(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Tg(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class Cg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=e,this._done=n||!1,this._filename=cl(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Tg{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function kg(e,t){const n=new Headers;if(!e||!t||"object"!==typeof t)return n;for(const i in t){const e=t[i];void 0!==e&&n.append(i,e)}return n}function Ig(e){var t,n;return null!==(t=null===(n=URL.parse(e))||void 0===n?void 0:n.origin)&&void 0!==t?t:null}function Ng(e){let{responseHeaders:t,isHttp:n,rangeChunkSize:i,disableRange:s}=e;const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(t.get("Content-Length"),10);if(!Number.isInteger(o))return r;if(r.suggestedLength=o,o<=2*i)return r;if(s||!n)return r;if("bytes"!==t.get("Accept-Ranges"))return r;return"identity"!==(t.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r}function Pg(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,n=i("filename\\*","i").exec(e);if(n){n=n[1];let e=o(n);return e=unescape(e),e=a(e),e=l(e),r(e)}if(n=function(e){const t=[];let n;const s=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=s.exec(e));){let[,e,i,s]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,s]}const r=[];for(let i=0;i<t.length&&i in t;++i){let[e,n]=t[i];n=o(n),e&&(n=unescape(n),0===i&&(n=a(n))),r.push(n)}return r.join("")}(e),n)return r(l(n));if(n=i("filename","i").exec(e),n){n=n[1];let e=o(n);return e=l(e),r(e)}function i(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function s(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(e,{fatal:!0}),s=Va(n);n=i.decode(s),t=!1}catch(i){}}return n}function r(e){return t&&/[\x80-\xff]/.test(e)&&(e=s("utf-8",e),t&&(e=s("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function a(e){const t=e.indexOf("'");return-1===t?e:s(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,i){if("q"===n||"Q"===n)return s(t,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{i=atob(i)}catch(r){}return s(t,i)})}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(n){}if(cl(e))return e}return null}function Mg(e,t){return new Ua("Unexpected server response (".concat(e,') while retrieving PDF "').concat(t,'".'),e,404===e||0===e&&t.startsWith("file:"))}function Rg(e){return 200===e||206===e}function Og(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Dg(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(Ia("getArrayBuffer - unexpected data format: ".concat(e)),new Uint8Array(e).buffer)}class Fg{constructor(e){r(this,"_responseOrigin",null),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=kg(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return Pa(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Lg(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new jg(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Lg{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,Og(n,this._withCredentials,this._abortController)).then(t=>{if(e._responseOrigin=Ig(t.url),!Rg(t.status))throw Mg(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const n=t.headers,{allowRangeRequests:s,suggestedLength:r}=Ng({responseHeaders:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=r||this._contentLength,this._filename=Pg(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Dg(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class jg{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range","bytes=".concat(t,"-").concat(n-1));const r=i.url;fetch(r,Og(s,this._withCredentials,this._abortController)).then(t=>{const n=Ig(t.url);if(n!==e._responseOrigin)throw new Error('Expected range response-origin "'.concat(n,'" to match "').concat(e._responseOrigin,'".'));if(!Rg(t.status))throw Mg(t.status,r);this._readCapability.resolve(),this._reader=t.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded}),{value:Dg(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class Ug{constructor(e){let{url:t,httpHeaders:n,withCredentials:i}=e;r(this,"_responseOrigin",null),this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=kg(this.isHttp,n),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,r]of this.headers)t.setRequestHeader(s,r);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",Pa(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var n;const i=this.pendingRequests[e];i&&(null===(n=i.onProgress)||void 0===n||n.call(i,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===i.status&&this.isHttp)return void n.onError(i.status);const s=i.status||200;if(!(200===s&&206===n.expectedStatus)&&s!==n.expectedStatus)return void n.onError(i.status);const r=function(e){const t=e.response;return"string"!==typeof t?t:Va(t).buffer}(i);if(206===s){const e=i.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?n.onDone({begin:parseInt(t[1],10),chunk:r}):(Ia('Missing or invalid "Content-Range" header.'),n.onError(0))}else r?n.onDone({begin:0,chunk:r}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Bg{constructor(e){this._source=e,this._manager=new Ug(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Pa(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Wg(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new Hg(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Wg{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ig(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(e=>{const[t,...n]=e.split(": ");return[t,n.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:r}=Ng({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Pg(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e)if(this._requests.length>0){this._requests.shift().resolve({value:e.chunk,done:!1})}else this._cachedChunks.push(e.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Mg(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Hg{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=Ig(null===(e=this._manager.getRequestXhr(this._requestId))||void 0===e?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error('Expected range response-origin "'.concat(t,'" to match "').concat(this._manager._responseOrigin,'".')),this._onError(0))}_close(){var e;null===(e=this.onClosed)||void 0===e||e.call(this,this)}_onDone(e){const t=e.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunk=t;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){var t;null!==(t=this._storedError)&&void 0!==t||(this._storedError=Mg(e,this._url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Vg=/^[a-z][a-z0-9\-+.]+:/i;class qg{constructor(e){this.source=e,this.url=function(e){if(Vg.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),Pa("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return Pa(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new zg(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Gg(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class zg{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(e=>{this._contentLength=e.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},e=>{"ENOENT"===e.code&&(e=Mg(0,this._url.href)),this._storedError=e,this._headersCapability.reject(e)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Gg{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Jg=Symbol("INITIAL_DATA");var Kg=new WeakMap,Yg=new WeakSet;class $g{constructor(){vo(this,Yg),yo(this,Kg,Object.create(null))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const n=bo(Yg,this,Xg).call(this,e);return n.promise.then(()=>t(n.data)),null}const n=_o(Kg,this)[e];if(!n||n.data===Jg)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}has(e){const t=_o(Kg,this)[e];return!!t&&t.data!==Jg}delete(e){const t=_o(Kg,this)[e];return!(!t||t.data===Jg)&&(delete _o(Kg,this)[e],!0)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=bo(Yg,this,Xg).call(this,e);n.data=t,n.resolve()}clear(){for(const t in _o(Kg,this)){var e;const{data:n}=_o(Kg,this)[t];null===n||void 0===n||null===(e=n.bitmap)||void 0===e||e.close()}xo(Kg,this,Object.create(null))}*[Symbol.iterator](){for(const e in _o(Kg,this)){const{data:t}=_o(Kg,this)[e];t!==Jg&&(yield[e,t])}}}function Xg(e){var t;return(t=_o(Kg,this))[e]||(t[e]=a(a({},Promise.withResolvers()),{},{data:Jg}))}var Qg=new WeakMap,Zg=new WeakMap,ev=new WeakMap,tv=new WeakMap,nv=new WeakMap,iv=new WeakMap,sv=new WeakMap,rv=new WeakMap,ov=new WeakMap,av=new WeakMap,lv=new WeakMap,cv=new WeakMap,uv=new WeakMap,dv=new WeakMap,hv=new WeakMap,pv=new WeakMap,fv=new WeakMap,mv=new WeakMap,gv=new WeakSet;class vv{constructor(e){var t;let{textContentSource:n,container:i,viewport:s}=e;if(vo(this,gv),yo(this,Qg,Promise.withResolvers()),yo(this,Zg,null),yo(this,ev,!1),yo(this,tv,!(null===(t=globalThis.FontInspector)||void 0===t||!t.enabled)),yo(this,nv,null),yo(this,iv,null),yo(this,sv,0),yo(this,rv,0),yo(this,ov,null),yo(this,av,null),yo(this,lv,0),yo(this,cv,0),yo(this,uv,Object.create(null)),yo(this,dv,[]),yo(this,hv,null),yo(this,pv,[]),yo(this,fv,new WeakMap),yo(this,mv,null),n instanceof ReadableStream)xo(hv,this,n);else{if("object"!==typeof n)throw new Error('No "textContentSource" parameter specified.');xo(hv,this,new ReadableStream({start(e){e.enqueue(n),e.close()}}))}xo(Zg,this,xo(av,this,i)),xo(cv,this,s.scale*wl.pixelRatio),xo(lv,this,s.rotation),xo(iv,this,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:o,pageX:a,pageY:l}=s.rawDims;xo(mv,this,[1,0,0,-1,-a,l+o]),xo(rv,this,r),xo(sv,this,o),Ev.call(vv),i.style.setProperty("--min-font-size",kv._),bl(i,s),_o(Qg,this).promise.finally(()=>{Iv._.delete(this),xo(iv,this,null),xo(uv,this,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=qa.platform;return Oa(this,"fontFamilyMap",new Map([["sans-serif","".concat(e&&t?"Calibri, ":"","sans-serif")],["monospace","".concat(e&&t?"Lucida Console, ":"","monospace")]]))}render(){const e=()=>{_o(ov,this).read().then(t=>{var n;let{value:i,done:s}=t;s?_o(Qg,this).resolve():(null!==(n=_o(nv,this))&&void 0!==n||xo(nv,this,i.lang),Object.assign(_o(uv,this),i.styles),bo(gv,this,yv).call(this,i.items),e())},_o(Qg,this).reject)};return xo(ov,this,_o(hv,this).getReader()),Iv._.add(this),e(),_o(Qg,this).promise}update(e){let{viewport:t,onBefore:n=null}=e;const i=t.scale*wl.pixelRatio,s=t.rotation;if(s!==_o(lv,this)&&(null===n||void 0===n||n(),xo(lv,this,s),bl(_o(av,this),{rotation:s})),i!==_o(cv,this)){null===n||void 0===n||n(),xo(cv,this,i);const e={div:null,properties:null,ctx:_v.call(vv,_o(nv,this))};for(const t of _o(pv,this))e.properties=_o(fv,this).get(t),e.div=t,bo(gv,this,wv).call(this,e)}}cancel(){var e;const t=new Wa("TextLayer task cancelled.");null===(e=_o(ov,this))||void 0===e||e.cancel(t).catch(()=>{}),xo(ov,this,null),_o(Qg,this).reject(t)}get textDivs(){return _o(pv,this)}get textContentItemsStr(){return _o(dv,this)}static cleanup(){if(!(bo(vv,this,Iv)._.size>0)){bo(vv,this,Av)._.clear();for(const{canvas:e}of bo(vv,this,Cv)._.values())e.remove();bo(vv,this,Cv)._.clear()}}}function yv(e){var t,n;if(_o(ev,this))return;null!==(n=(t=_o(iv,this)).ctx)&&void 0!==n||(t.ctx=_v.call(Mo,_o(nv,this)));const i=_o(pv,this),s=_o(dv,this);for(const r of e){if(i.length>1e5)return Ia("Ignoring additional textDivs for performance reasons."),void xo(ev,this,!0);if(void 0!==r.str)s.push(r.str),bo(gv,this,bv).call(this,r);else if("beginMarkedContentProps"===r.type||"beginMarkedContent"===r.type){const e=_o(Zg,this);xo(Zg,this,document.createElement("span")),_o(Zg,this).classList.add("markedContent"),r.id&&_o(Zg,this).setAttribute("id","".concat(r.id)),e.append(_o(Zg,this))}else"endMarkedContent"===r.type&&xo(Zg,this,_o(Zg,this).parentNode)}}function bv(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};_o(pv,this).push(t);const i=Ga.transform(_o(mv,this),e.transform);let s=Math.atan2(i[1],i[0]);const r=_o(uv,this)[e.fontName];r.vertical&&(s+=Math.PI/2);let o=_o(tv,this)&&r.fontSubstitution||r.fontFamily;o=Mo.fontFamilyMap.get(o)||o;const a=Math.hypot(i[2],i[3]),l=a*Sv.call(Mo,o,r,_o(nv,this));let c,u;0===s?(c=i[4],u=i[5]-l):(c=i[4]+l*Math.sin(s),u=i[5]-l*Math.cos(s));const d=t.style;d.left="".concat((100*c/_o(rv,this)).toFixed(2),"%"),d.top="".concat((100*u/_o(sv,this)).toFixed(2),"%"),d.setProperty("--font-height","".concat(a.toFixed(2),"px")),d.fontFamily=o,n.fontSize=a,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,_o(tv,this)&&(t.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),0!==s&&(n.angle=s*(180/Math.PI));let h=!1;if(e.str.length>1)h=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),n=Math.abs(e.transform[3]);t!==n&&Math.max(t,n)/Math.min(t,n)>1.5&&(h=!0)}if(h&&(n.canvasWidth=r.vertical?e.height:e.width),_o(fv,this).set(t,n),_o(iv,this).div=t,_o(iv,this).properties=n,bo(gv,this,wv).call(this,_o(iv,this)),n.hasText&&_o(Zg,this).append(t),n.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),_o(Zg,this).append(e)}}function wv(e){const{div:t,properties:n,ctx:i}=e,{style:s}=t;if(0!==n.canvasWidth&&n.hasText){const{fontFamily:e}=s,{canvasWidth:r,fontSize:o}=n;xv.call(Mo,i,o*_o(cv,this),e);const{width:a}=i.measureText(t.textContent);a>0&&s.setProperty("--scale-x",r*_o(cv,this)/a)}0!==n.angle&&s.setProperty("--rotate","".concat(n.angle,"deg"))}function _v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=bo(Mo,this,Cv)._.get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),bo(Mo,this,Cv)._.set(e,t),bo(Mo,this,Tv)._.set(t,{size:0,family:""})}return t}function xv(e,t,n){const i=bo(Mo,this,Tv)._.get(e);t===i.size&&n===i.family||(e.font="".concat(t,"px ").concat(n),i.size=t,i.family=n)}function Ev(){if(null!==bo(Mo,this,kv)._)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),kv._=bo(Mo,this,e.getBoundingClientRect().height),e.remove()}function Sv(e,t,n){const i=bo(Mo,this,Av)._.get(e);if(i)return i;const s=bo(Mo,this,_v).call(this,n);s.canvas.width=s.canvas.height=30,bo(Mo,this,xv).call(this,s,30,e);const r=s.measureText(""),o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let l=.8;return o?l=o/(o+a):(qa.platform.isFirefox&&Ia("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?l=t.ascent:t.descent&&(l=1+t.descent)),bo(Mo,this,Av)._.set(e,l),l}Mo=vv;var Av={_:new Map},Cv={_:new Map},Tv={_:new WeakMap},kv={_:null},Iv={_:new Set};function Nv(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof n||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const i=new Pv,{docId:s}=i,r=n.url?function(e){if(e instanceof URL)return e.href;if("string"===typeof e){if(Ho)return e;const t=URL.parse(e,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(n.url):null,o=n.data?function(e){if(Ho&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return Va(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"===typeof e&&!isNaN(null===e||void 0===e?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(n.data):null,a=n.httpHeaders||null,l=!0===n.withCredentials,c=null!==(e=n.password)&&void 0!==e?e:null,u=n.range instanceof jv?n.range:null,d=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:65536;let h=n.worker instanceof Yv?n.worker:null;const p=n.verbosity,f="string"!==typeof n.docBaseUrl||ll(n.docBaseUrl)?null:n.docBaseUrl,m=kp(n.cMapUrl),g=!1!==n.cMapPacked,v=n.CMapReaderFactory||(Ho?Of:sf),y=kp(n.iccUrl),b=kp(n.standardFontDataUrl),w=n.StandardFontDataFactory||(Ho?Df:kf),_=kp(n.wasmUrl),x=n.WasmFactory||(Ho?Ff:Nf),E=!0!==n.stopAtErrors,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,A=!1!==n.isEvalSupported,C="boolean"===typeof n.isOffscreenCanvasSupported?n.isOffscreenCanvasSupported:!Ho,T="boolean"===typeof n.isImageDecoderSupported?n.isImageDecoderSupported:!Ho&&(qa.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,I="boolean"===typeof n.disableFontFace?n.disableFontFace:Ho,N=!0===n.fontExtraProperties,P=!0===n.enableXfa,M=n.ownerDocument||globalThis.document,R=!0===n.disableRange,O=!0===n.disableStream,D=!0===n.disableAutoFetch,F=!0===n.pdfBug,L=n.CanvasFactory||(Ho?Rf:tf),j=n.FilterFactory||(Ho?Mf:ff),U=!0===n.enableHWA,B=!1!==n.useWasm,W=u?u.length:null!==(t=n.length)&&void 0!==t?t:NaN,H="boolean"===typeof n.useSystemFonts?n.useSystemFonts:!Ho&&!I,V="boolean"===typeof n.useWorkerFetch?n.useWorkerFetch:!!(v===sf&&w===kf&&x===Nf&&m&&b&&_&&dl(m,document.baseURI)&&dl(b,document.baseURI)&&dl(_,document.baseURI));Ca(p);const q={canvasFactory:new L({ownerDocument:M,enableHWA:U}),filterFactory:new j({docId:s,ownerDocument:M}),cMapReaderFactory:V?null:new v({baseUrl:m,isCompressed:g}),standardFontDataFactory:V?null:new w({baseUrl:b}),wasmFactory:V?null:new x({baseUrl:_})};h||(h=Yv.create({verbosity:p,port:og.workerPort}),i._worker=h);const z={docId:s,apiVersion:"5.4.530",data:o,password:c,disableAutoFetch:D,rangeChunkSize:d,length:W,docBaseUrl:f,enableXfa:P,evaluatorOptions:{maxImageSize:S,disableFontFace:I,ignoreErrors:E,isEvalSupported:A,isOffscreenCanvasSupported:C,isImageDecoderSupported:T,canvasMaxAreaInBytes:k,fontExtraProperties:N,useSystemFonts:H,useWasm:B,useWorkerFetch:V,cMapUrl:m,iccUrl:y,standardFontDataUrl:b,wasmUrl:_}},G={ownerDocument:M,pdfBug:F,styleElement:null,loadingParams:{disableAutoFetch:D,enableXfa:P}};return h.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const e=h.messageHandler.sendWithPromise("GetDocRequest",z,o?[o.buffer]:null);let t;if(u)t=new Ag(u,{disableRange:R,disableStream:O});else if(!o){if(!r)throw new Error("getDocument - no `url` parameter provided.");const e=dl(r)?Fg:Ho?qg:Bg;t=new e({url:r,length:W,httpHeaders:a,withCredentials:l,rangeChunkSize:d,disableRange:R,disableStream:O})}return e.then(e=>{if(i.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const n=new Kp(s,e,h.port),r=new uy(n,i,t,G,q,U);i._transport=r,n.send("Ready",null)})}).catch(i._capability.reject),i}class Pv{constructor(){r(this,"_capability",Promise.withResolvers()),r(this,"_transport",null),r(this,"_worker",null),r(this,"docId","d".concat((Mv._=(Ro=Mv._,Oo=Ro++,Ro),Oo))),r(this,"destroyed",!1),r(this,"onPassword",null),r(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0;try{var t,n;null!==(t=this._worker)&&void 0!==t&&t.port&&(this._worker._pendingDestroy=!0),await(null===(n=this._transport)||void 0===n?void 0:n.destroy())}catch(s){var i;throw null!==(i=this._worker)&&void 0!==i&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,null===(e=this._worker)||void 0===e||e.destroy(),this._worker=null}async getData(){return this._transport.getData()}}var Mv={_:0},Rv=new WeakMap,Ov=new WeakMap,Dv=new WeakMap,Fv=new WeakMap,Lv=new WeakMap;class jv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;yo(this,Rv,Promise.withResolvers()),yo(this,Ov,[]),yo(this,Dv,[]),yo(this,Fv,[]),yo(this,Lv,[]),this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){_o(Lv,this).push(e)}addProgressListener(e){_o(Fv,this).push(e)}addProgressiveReadListener(e){_o(Dv,this).push(e)}addProgressiveDoneListener(e){_o(Ov,this).push(e)}onDataRange(e,t){for(const n of _o(Lv,this))n(e,t)}onDataProgress(e,t){_o(Rv,this).promise.then(()=>{for(const n of _o(Fv,this))n(e,t)})}onDataProgressiveRead(e){_o(Rv,this).promise.then(()=>{for(const t of _o(Dv,this))t(e)})}onDataProgressiveDone(){_o(Rv,this).promise.then(()=>{for(const e of _o(Ov,this))e()})}transportReady(){_o(Rv,this).resolve()}requestDataRange(e,t){Na("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Uv{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Oa(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Bv=new WeakMap,Wv=new WeakSet;class Hv{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];vo(this,Wv),yo(this,Bv,!1),this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new ul:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new $g,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ol({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Oa(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return(null===(e=this._transport._htmlForXfa)||void 0===e?void 0:e.children[this._pageIndex])||null}render(e){var t,n,i;let{canvasContext:s,canvas:r=s.canvas,viewport:o,intent:a="display",annotationMode:l=Zo.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:h=null,pageColors:p=null,printAnnotationStorage:f=null,isEditing:m=!1,recordOperations:g=!1,operationsFilter:v=null}=e;null===(t=this._stats)||void 0===t||t.time("Overall");const y=this._transport.getRenderingIntent(a,l,f,m),{renderingIntent:b,cacheKey:w}=y;xo(Bv,this,!1),d||(d=this._transport.getOptionalContentConfig(b));let _=this._intentStates.get(w);_||(_=Object.create(null),this._intentStates.set(w,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const x=!!(b&Jo);var E;_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(E=this._stats)||void 0===E||E.time("Page Request"),this._pumpOperatorList(y));const S=Boolean(this._pdfBug&&(null===(n=globalThis.StepperManager)||void 0===n?void 0:n.enabled)),A=!this.recordedBBoxes&&(g||S),C=e=>{if(_.renderTasks.delete(T),A){var t;const e=null===(t=T.gfx)||void 0===t?void 0:t.dependencyTracker.take();e&&(T.stepper&&T.stepper.setOperatorBBoxes(e,T.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=e))}var n;(x&&xo(Bv,this,!0),bo(Wv,this,Vv).call(this),e?(T.capability.reject(e),this._abortOperatorList({intentState:_,reason:e instanceof Error?e:new Error(e)})):T.capability.resolve(),this._stats)&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),null!==(n=globalThis.Stats)&&void 0!==n&&n.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new my({callback:C,params:{canvas:r,canvasContext:s,dependencyTracker:A?new um(r,_.operatorList.length,S):null,viewport:o,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:v});((i=_).renderTasks||(i.renderTasks=new Set)).add(T);const k=T.task;return Promise.all([_.displayReadyCapability.promise,d]).then(e=>{var t;let[n,i]=e;if(this.destroyed)C();else{if(null===(t=this._stats)||void 0===t||t.time("Rendering"),!(i.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:n,optionalContentConfig:i}),T.operatorListChanged()}}).catch(C),k}getOperatorList(){let{intent:e="display",annotationMode:t=Zo.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=this._transport.getRenderingIntent(e,t,n,i,!0);let r,o=this._intentStates.get(s.cacheKey);var a,l;(o||(o=Object.create(null),this._intentStates.set(s.cacheKey,o)),o.opListReadCapability)||(r=Object.create(null),r.operatorListChanged=function(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(r))},o.opListReadCapability=Promise.withResolvers(),((a=o).renderTasks||(a.renderTasks=new Set)).add(r),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(l=this._stats)||void 0===l||l.time("Page Request"),this._pumpOperatorList(s));return o.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(e=>tl.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const i=t.getReader(),s={items:[],styles:Object.create(null),lang:null};!function t(){i.read().then(function(n){var i;let{value:r,done:o}=n;o?e(s):(null!==(i=s.lang)&&void 0!==i||(s.lang=r.lang),Object.assign(s.styles,r.styles),s.items.push(...r.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),xo(Bv,this,!1),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];xo(Bv,this,!0);const t=bo(Wv,this,Vv).call(this);return e&&t&&this._stats&&(this._stats=new ul),t}_startRenderPage(e,t){var n,i;const s=this._intentStates.get(t);s&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(i=s.displayReadyCapability)||void 0===i||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&bo(Wv,this,Vv).call(this)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:n,annotationStorageSerializable:i,modifiedIds:s}=e;const{map:r,transfer:o}=i,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:r,modifiedIds:s},o).getReader(),l=this._intentStates.get(n);l.streamReader=a;const c=()=>{a.read().then(e=>{let{value:t,done:n}=e;n?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,l),c())},e=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const e of l.renderTasks)e.operatorListChanged();bo(Wv,this,Vv).call(this)}if(l.displayReadyCapability)l.displayReadyCapability.reject(e);else{if(!l.opListReadCapability)throw e;l.opListReadCapability.reject(e)}}})};c()}_abortOperatorList(e){let{intentState:t,reason:n,force:i=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(n instanceof al){let e=100;return n.extraDelay>0&&n.extraDelay<1e3&&(e+=n.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:n,force:!0})},e))}}if(t.streamReader.cancel(new Wa(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}function Vv(){if(!_o(Bv,this)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),xo(Bv,this,!1),!0}var qv=new WeakMap,zv=new WeakMap,Gv=new WeakMap,Jv=new WeakMap,Kv=new WeakSet;class Yv{constructor(){let{name:e=null,port:t=null,verbosity:n=Ta()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(vo(this,Kv),yo(this,qv,Promise.withResolvers()),yo(this,zv,null),yo(this,Gv,null),yo(this,Jv,null),this.name=e,this.destroyed=!1,this.verbosity=n,t){if(iy._.has(t))throw new Error("Cannot use more than one PDFWorker per port.");iy._.set(t,this),bo(Kv,this,Xv).call(this,t)}else bo(Kv,this,Qv).call(this)}get promise(){return _o(qv,this).promise}get port(){return _o(Gv,this)}get messageHandler(){return _o(zv,this)}destroy(){var e,t;this.destroyed=!0,null===(e=_o(Jv,this))||void 0===e||e.terminate(),xo(Jv,this,null),iy._.delete(_o(Gv,this)),xo(Gv,this,null),null===(t=_o(zv,this))||void 0===t||t.destroy(),xo(zv,this,null)}static create(e){const t=bo(Yv,this,iy)._.get(null===e||void 0===e?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Yv(e)}static get workerSrc(){if(og.workerSrc)return og.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Oa(this,"_setupFakeWorkerGlobal",(async()=>{if(wo(Yv,this,ey))return wo(Yv,this,ey);return(await import(this.workerSrc)).WorkerMessageHandler})())}}function $v(){_o(qv,this).resolve(),_o(zv,this).send("configure",{verbosity:this.verbosity})}function Xv(e){xo(Gv,this,e),xo(zv,this,new Kp("main","worker",e)),_o(zv,this).on("ready",()=>{}),bo(Kv,this,$v).call(this)}function Qv(){if(ny._||ey(Do))return void bo(Kv,this,Zv).call(this);let{workerSrc:e}=Do;try{Do._isSameOrigin(window.location,e)||(e=Do._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Kp("main","worker",t),i=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?_o(qv,this).reject(new Error("Worker was destroyed")):bo(Kv,this,Zv).call(this)},s=new AbortController;t.addEventListener("error",()=>{_o(Jv,this)||i()},{signal:s.signal}),n.on("test",e=>{s.abort(),!this.destroyed&&e?(xo(zv,this,n),xo(Gv,this,t),xo(Jv,this,t),bo(Kv,this,$v).call(this)):i()}),n.on("ready",e=>{if(s.abort(),this.destroyed)i();else try{r()}catch(t){bo(Kv,this,Zv).call(this)}});const r=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void r()}catch(t){ka("The worker has been disabled.")}bo(Kv,this,Zv).call(this)}function Zv(){ny._||(Ia("Setting up fake worker."),ny._=!0),Do._setupFakeWorkerGlobal.then(e=>{var t,n;if(this.destroyed)return void _o(qv,this).reject(new Error("Worker was destroyed"));const i=new Rp;xo(Gv,this,i);const s="fake".concat((ty._=(t=ty._,n=t++,t),n)),r=new Kp(s+"_worker",s,i);e.setup(r,i),xo(zv,this,new Kp(s,s+"_worker",i)),bo(Kv,this,$v).call(this)}).catch(e=>{_o(qv,this).reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))})}function ey(e){try{var t;return(null===(t=globalThis.pdfjsWorker)||void 0===t?void 0:t.WorkerMessageHandler)||null}catch(n){return null}}Do=Yv;var ty={_:0},ny={_:!1},iy={_:new WeakMap};Ho&&(ny._=bo(Do,Do,!0),og.workerSrc||(og.workerSrc="./pdf.worker.mjs")),Do._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(null===n||void 0===n||!n.origin||"null"===n.origin)return!1;const i=new URL(t,n);return n.origin===i.origin},Do._createCDNWrapper=e=>{const t='await import("'.concat(e,'");');return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Do.fromPort=e=>{var t;if(t="`PDFWorker.fromPort` - please use `PDFWorker.create` instead.",console.log("Deprecated API usage: "+t),null===e||void 0===e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Do.create(e)};var sy=new WeakMap,ry=new WeakMap,oy=new WeakMap,ay=new WeakMap,ly=new WeakMap,cy=new WeakSet;class uy{constructor(e,t,n,i,s,r){vo(this,cy),yo(this,sy,new Map),yo(this,ry,new Map),yo(this,oy,new Map),yo(this,ay,new Map),yo(this,ly,null),this.messageHandler=e,this.loadingTask=t,this.commonObjs=new $g,this.fontLoader=new Vh({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=r,this.setupMessageHandler()}get annotationStorage(){return Oa(this,"annotationStorage",new jh)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zo.ENABLE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=Go,o=Mh;switch(e){case"any":r=zo;break;case"display":break;case"print":r=Jo;break;default:Ia("getRenderingIntent - invalid intent: ".concat(e))}const a=r&Jo&&n instanceof Wh?n:this.annotationStorage;switch(t){case Zo.DISABLE:r+=$o;break;case Zo.ENABLE:break;case Zo.ENABLE_FORMS:r+=Ko;break;case Zo.ENABLE_STORAGE:r+=Yo,o=a.serializable;break;default:Ia("getRenderingIntent - invalid annotationMode: ".concat(t))}i&&(r+=Xo),s&&(r+=Qo);const{ids:l,hash:c}=a.modifiedIds;return{renderingIntent:r,cacheKey:[r,o.hash,c].join("_"),annotationStorageSerializable:o,modifiedIds:l}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null===(e=_o(ly,this))||void 0===e||e.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of _o(ry,this).values())t.push(i._destroy());_o(ry,this).clear(),_o(oy,this).clear(),_o(ay,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{var e,t;this.commonObjs.clear(),this.fontLoader.clear(),_o(sy,this).clear(),this.filterFactory.destroy(),vv.cleanup(),null===(e=this._networkStream)||void 0===e||e.cancelAllRequests(new Wa("Worker was terminated.")),null===(t=this.messageHandler)||void 0===t||t.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{Pa(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function(e){let{value:n,done:i}=e;i?t.close():(Pa(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",async e=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:s}=this._fullReader;if(!n||!i){var r;if(this._lastProgress)null===(r=t.onProgress)||void 0===r||r.call(t,this._lastProgress);this._fullReader.onProgress=e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}}return{isStreamingSupported:n,isRangeSupported:i,contentLength:s}}),e.on("GetRangeReader",(e,t)=>{Pa(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function(e){let{value:n,done:i}=e;i?t.close():(Pa(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",e=>{let{pdfInfo:n}=e;this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Uv(n,this))}),e.on("DocException",e=>{t._capability.reject(zp(e))}),e.on("PasswordRequest",e=>{xo(ly,this,Promise.withResolvers());try{if(!t.onPassword)throw zp(e);const n=e=>{e instanceof Error?_o(ly,this).reject(e):_o(ly,this).resolve({password:e})};t.onPassword(n,e.code)}catch(n){_o(ly,this).reject(n)}return _o(ly,this).promise}),e.on("DataLoaded",e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{if(this.destroyed)return;_o(ry,this).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",t=>{var n;let[i,s,r]=t;if(this.destroyed)return null;if(this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const e=r.error;Ia("Error during font loading: ".concat(e)),this.commonObjs.resolve(i,e);break}const t=new lp(r),o=this._params.pdfBug&&null!==(n=globalThis.FontInspector)&&void 0!==n&&n.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,a=new zh(t,o,r.extra,r.charProcOperatorList);this.fontLoader.bind(a).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!a.fontExtraProperties&&a.data&&a.clearData(),this.commonObjs.resolve(i,a)});break;case"CopyLocalImage":const{imageRef:l}=r;Pa(l,"The imageRef must be defined.");for(const e of _o(ry,this).values())for(const[,t]of e.objs)if((null===t||void 0===t?void 0:t.ref)===l)return t.dataLen?(this.commonObjs.resolve(i,structuredClone(t)),t.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new Tp(r));break;case"Image":this.commonObjs.resolve(i,r);break;case"Pattern":const c=new vp(r);this.commonObjs.resolve(i,c.getIR());break;default:throw new Error("Got unknown common object type ".concat(s))}return null}),e.on("obj",e=>{let[t,n,i,s]=e;if(this.destroyed)return;const r=_o(ry,this).get(n);var o;if(!r.objs.has(t))if(0!==r._intentStates.size)switch(i){case"Image":case"Pattern":r.objs.resolve(t,s);break;default:throw new Error("Got unknown object type ".concat(i))}else null===s||void 0===s||null===(o=s.bitmap)||void 0===o||o.close()}),e.on("DocProgress",e=>{var n;this.destroyed||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}),e.on("FetchBinaryData",async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");const t=this[e.type];if(!t)throw new Error("".concat(e.type," not initialized, see the `useWorkerFetch` parameter."));return t.fetch(e)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e,t;this.annotationStorage.size<=0&&Ia("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:null!==(e=null===(t=this._fullReader)||void 0===t?void 0:t.filename)&&void 0!==e?e:null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=_o(oy,this).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&_o(ay,this).set(n.refStr,e);const i=new Hv(t,n,this,this._params.pdfBug);return _o(ry,this).set(t,i),i});return _o(oy,this).set(t,i),i}getPageIndex(e){return Ip(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return bo(cy,this,dy).call(this,"GetFieldObjects")}hasJSActions(){return bo(cy,this,dy).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return bo(cy,this,dy).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return bo(cy,this,dy).call(this,"GetOptionalContentConfig").then(t=>new Eg(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=_o(sy,this).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>{var t,n,i,s;return{info:e[0],metadata:e[1]?new dg(e[1]):null,contentDispositionFilename:null!==(t=null===(n=this._fullReader)||void 0===n?void 0:n.filename)&&void 0!==t?t:null,contentLength:null!==(i=null===(s=this._fullReader)||void 0===s?void 0:s.contentLength)&&void 0!==i?i:null,hasStructTree:e[2]}});return _o(sy,this).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of _o(ry,this).values()){if(!e.cleanup())throw new Error("startCleanup: Page ".concat(e.pageNumber," is currently rendering."))}this.commonObjs.clear(),e||this.fontLoader.clear(),_o(sy,this).clear(),this.filterFactory.destroy(!0),vv.cleanup()}}cachedPageNumber(e){var t;if(!Ip(e))return null;const n=0===e.gen?"".concat(e.num,"R"):"".concat(e.num,"R").concat(e.gen);return null!==(t=_o(ay,this).get(n))&&void 0!==t?t:null}}function dy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=_o(sy,this).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return _o(sy,this).set(e,i),i}var hy=new WeakMap;class py{constructor(e){yo(this,hy,null),r(this,"onContinue",null),r(this,"onError",null),xo(hy,this,e)}get promise(){return _o(hy,this).capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;_o(hy,this).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=_o(hy,this).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=_o(hy,this);return e.form||e.canvas&&(null===t||void 0===t?void 0:t.size)>0}}var fy=new WeakMap;class my{constructor(e){let{callback:t,params:n,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:d=!1,pageColors:h=null,enableHWA:p=!1,operationsFilter:f=null}=e;yo(this,fy,null),this.callback=t,this.params=n,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===u&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new py(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvas,this._canvasContext=n.canvas?null:n.canvasContext,this._enableHWA=p,this._dependencyTracker=n.dependencyTracker,this._operationsFilter=f}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(e){var t,n;let{transparency:i=!1,optionalContentConfig:s}=e;if(this.cancelled)return;if(this._canvas){if(gy._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");gy._.add(this._canvas)}this._pdfBug&&null!==(t=globalThis.StepperManager)&&void 0!==t&&t.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:o,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ng(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:o,viewport:r,transparency:i,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}cancel(){var e,t,n;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(e=this.gfx)||void 0===e||e.endDrawing(),_o(fy,this)&&(window.cancelAnimationFrame(_o(fy,this)),xo(fy,this,null)),gy._.delete(this._canvas),i||(i=new al("Rendering cancelled, page ".concat(this._pageIndex+1),s)),this.callback(i),null===(t=(n=this.task).onError)||void 0===t||t.call(n,i)}operatorListChanged(){var e,t;this.graphicsReady?(null===(e=this.gfx.dependencyTracker)||void 0===e||e.growOperationsCount(this.operatorList.fnArray.length),null===(t=this.stepper)||void 0===t||t.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?xo(fy,this,window.requestAnimationFrame(()=>{xo(fy,this,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),gy._.delete(this._canvas),this.callback())))}}var gy={_:new WeakSet};const vy="5.4.530";var yy=new WeakMap,by=new WeakMap,wy=new WeakMap,_y=new WeakMap,xy=new WeakMap,Ey=new WeakMap,Sy=new WeakMap,Ay=new WeakMap,Cy=new WeakMap,Ty=new WeakMap,ky=new WeakSet;class Iy{static get _keyboardManager(){return Oa(this,"_keyboardManager",new wc([[["Escape","mac+Escape"],Iy.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Iy.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Iy.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Iy.prototype._moveToPrevious],[["Home","mac+Home"],Iy.prototype._moveToBeginning],[["End","mac+End"],Iy.prototype._moveToEnd]]))}constructor(e){var t,n;let{editor:i=null,uiManager:s=null}=e;vo(this,ky),yo(this,yy,null),yo(this,by,null),yo(this,wy,void 0),yo(this,_y,null),yo(this,xy,!1),yo(this,Ey,!1),yo(this,Sy,null),yo(this,Ay,void 0),yo(this,Cy,null),yo(this,Ty,null),i?(xo(Ey,this,!1),xo(Sy,this,i)):xo(Ey,this,!0),xo(Ty,this,(null===i||void 0===i?void 0:i._uiManager)||s),xo(Ay,this,_o(Ty,this)._eventBus),xo(wy,this,(null===i||void 0===i||null===(t=i.color)||void 0===t?void 0:t.toUpperCase())||(null===(n=_o(Ty,this))||void 0===n?void 0:n.highlightColors.values().next().value)||"#FFFF98"),Fy._||(Fy._=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}renderButton(){const e=xo(yy,this,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",_o(Sy,this)&&(e.ariaControls="".concat(_o(Sy,this).id,"_colorpicker_dropdown"));const t=_o(Ty,this)._signal;e.addEventListener("click",bo(ky,this,Ry).bind(this),{signal:t}),e.addEventListener("keydown",bo(ky,this,My).bind(this),{signal:t});const n=xo(by,this,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=_o(wy,this),e.append(n),e}renderMainDropdown(){const e=xo(_y,this,bo(ky,this,Ny).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===_o(yy,this))return void bo(ky,this,Ry).call(this,e);const t=e.target.getAttribute("data-color");t&&bo(ky,this,Py).call(this,t,e)}_moveToNext(e){var t,n;wo(ky,this,Dy)?e.target!==_o(yy,this)?null===(t=e.target.nextSibling)||void 0===t||t.focus():null===(n=_o(_y,this).firstElementChild)||void 0===n||n.focus():bo(ky,this,Ry).call(this,e)}_moveToPrevious(e){var t,n;e.target!==(null===(t=_o(_y,this))||void 0===t?void 0:t.firstElementChild)&&e.target!==_o(yy,this)?(wo(ky,this,Dy)||bo(ky,this,Ry).call(this,e),null===(n=e.target.previousSibling)||void 0===n||n.focus()):wo(ky,this,Dy)&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){var t;wo(ky,this,Dy)?null===(t=_o(_y,this).firstElementChild)||void 0===t||t.focus():bo(ky,this,Ry).call(this,e)}_moveToEnd(e){var t;wo(ky,this,Dy)?null===(t=_o(_y,this).lastElementChild)||void 0===t||t.focus():bo(ky,this,Ry).call(this,e)}hideDropdown(){var e,t;null===(e=_o(_y,this))||void 0===e||e.classList.add("hidden"),_o(yy,this).ariaExpanded="false",null===(t=_o(Cy,this))||void 0===t||t.abort(),xo(Cy,this,null)}_hideDropdownFromKeyboard(){var e;_o(Ey,this)||(wo(ky,this,Dy)?(this.hideDropdown(),_o(yy,this).focus({preventScroll:!0,focusVisible:_o(xy,this)})):null===(e=_o(Sy,this))||void 0===e||e.unselect())}updateColor(e){if(_o(by,this)&&(_o(by,this).style.backgroundColor=e),!_o(_y,this))return;const t=_o(Ty,this).highlightColors.values();for(const n of _o(_y,this).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;null===(e=_o(yy,this))||void 0===e||e.remove(),xo(yy,this,null),xo(by,this,null),null===(t=_o(_y,this))||void 0===t||t.remove(),xo(_y,this,null)}}function Ny(){const e=document.createElement("div"),t=_o(Ty,this)._signal;e.addEventListener("contextmenu",hl,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),_o(Sy,this)&&(e.id="".concat(_o(Sy,this).id,"_colorpicker_dropdown"));for(const[n,i]of _o(Ty,this).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",Fy._[n]);const r=document.createElement("span");s.append(r),r.className="swatch",r.style.backgroundColor=i,s.ariaSelected=i===_o(wy,this),s.addEventListener("click",bo(ky,this,Py).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",bo(ky,this,My).bind(this),{signal:t}),e}function Py(e,t){t.stopPropagation(),_o(Ay,this).dispatch("switchannotationeditorparams",{source:this,type:na.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}function My(e){Fo._keyboardManager.exec(this,e)}function Ry(e){if(wo(ky,this,Dy))return void this.hideDropdown();if(xo(xy,this,0===e.detail),_o(Cy,this)||(xo(Cy,this,new AbortController),window.addEventListener("pointerdown",bo(ky,this,Oy).bind(this),{signal:_o(Ty,this).combinedSignal(_o(Cy,this))})),_o(yy,this).ariaExpanded="true",_o(_y,this))return void _o(_y,this).classList.remove("hidden");const t=xo(_y,this,bo(ky,this,Ny).call(this));_o(yy,this).append(t)}function Oy(e){var t;null!==(t=_o(_y,this))&&void 0!==t&&t.contains(e.target)||this.hideDropdown()}function Dy(e){return _o(_y,e)&&!_o(_y,e).classList.contains("hidden")}Fo=Iy;var Fy={_:null},Ly=new WeakMap,jy=new WeakMap,Uy=new WeakMap;class By{constructor(e){yo(this,Ly,null),yo(this,jy,null),yo(this,Uy,null),xo(jy,this,e),xo(Uy,this,e._uiManager),Wy._||(Wy._=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(_o(Ly,this))return _o(Ly,this);const{editorType:e,colorType:t,color:n}=_o(jy,this),i=xo(Ly,this,document.createElement("input"));return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",Wy._[e]),i.addEventListener("input",()=>{_o(Uy,this).updateParams(t,i.value)},{signal:_o(Uy,this)._signal}),i}update(e){_o(Ly,this)&&(_o(Ly,this).value=e)}destroy(){var e;null===(e=_o(Ly,this))||void 0===e||e.remove(),xo(Ly,this,null)}hideDropdown(){}}var Wy={_:null};function Hy(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function Vy(e){return Math.max(0,Math.min(255,255*e))}class qy{static CMYK_G(e){let[t,n,i,s]=e;return["G",1-Math.min(1,.3*t+.59*i+.11*n+s)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=Vy(t),[t,t,t]}static G_HTML(e){let[t]=e;const n=Hy(t);return"#".concat(n).concat(n).concat(n)}static RGB_G(e){let[t,n,i]=e;return["G",.3*t+.59*n+.11*i]}static RGB_rgb(e){return e.map(Vy)}static RGB_HTML(e){return"#".concat(e.map(Hy).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,n,i,s]=e;return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,n+s)]}static CMYK_rgb(e){let[t,n,i,s]=e;return[Vy(1-Math.min(1,t+s)),Vy(1-Math.min(1,i+s)),Vy(1-Math.min(1,n+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,n,i]=e;const s=1-t,r=1-n,o=1-i;return["CMYK",s,r,o,Math.min(s,r,o)]}}class zy{create(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width","".concat(e,"px")),i.setAttribute("height","".concat(t,"px"))),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox","0 0 ".concat(e," ").concat(t)),i}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Na("Abstract method `_createSVG` called.")}}class Gy extends zy{_createSVG(e){return document.createElementNS(il,e)}}const Jy=new WeakSet,Ky=60*(new Date).getTimezoneOffset()*1e3;class Yy{static create(e){switch(e.data.annotationType){case ha.LINK:return new sb(e);case ha.TEXT:return new lb(e);case ha.WIDGET:switch(e.data.fieldType){case"Tx":return new ub(e);case"Btn":return e.data.radioButton?new pb(e):e.data.checkBox?new hb(e):new fb(e);case"Ch":return new mb(e);case"Sig":return new db(e)}return new cb(e);case ha.POPUP:return new vb(e);case ha.FREETEXT:return new ow(e);case ha.LINE:return new lw(e);case ha.SQUARE:return new uw(e);case ha.CIRCLE:return new hw(e);case ha.POLYLINE:return new fw(e);case ha.CARET:return new gw(e);case ha.INK:return new ww(e);case ha.POLYGON:return new mw(e);case ha.HIGHLIGHT:return new xw(e);case ha.UNDERLINE:return new Ew(e);case ha.SQUIGGLY:return new Sw(e);case ha.STRIKEOUT:return new Aw(e);case ha.STAMP:return new Cw(e);case ha.FILEATTACHMENT:return new Iw(e);default:return new eb(e)}}}var $y=new WeakMap,Xy=new WeakMap,Qy=new WeakMap,Zy=new WeakSet;class eb{constructor(e){let{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vo(this,Zy),yo(this,$y,null),yo(this,Xy,!1),yo(this,Qy,null),this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData(e){let{contentsObj:t,richText:n}=e;return!!(null!==t&&void 0!==t&&t.str||null!==n&&void 0!==n&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return eb._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var e;const{data:t}=this,n=null===(e=this.annotationStorage)||void 0===e?void 0:e.getEditor(t.id);return n?n.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var e;const t=null===(e=this.annotationStorage)||void 0===e?void 0:e.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:n,inkLists:i,rect:s}=this.data;let r=-1/0,o=-1/0;if((null===n||void 0===n?void 0:n.length)>=8){for(let e=0;e<n.length;e+=8)n[e+1]>o?(o=n[e+1],r=n[e+2]):n[e+1]===o&&(r=Math.max(r,n[e+2]));return[r,o]}if((null===i||void 0===i?void 0:i.length)>=1){for(const e of i)for(let t=0,n=e.length;t<n;t+=2)e[t+1]>o?(o=e[t+1],r=e[t]):e[t+1]===o&&(r=Math.max(r,e[t]));if(r!==1/0)return[r,o]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:r}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/n,e[1]=100*(e[1]-r)/i,e}get commentText(){var e,t;const{data:n}=this;return(null===(e=this.annotationStorage.getRawValue("".concat(ea).concat(n.id)))||void 0===e||null===(e=e.popup)||void 0===e?void 0:e.contents)||(null===(t=n.contentsObj)||void 0===t?void 0:t.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue("".concat(ea).concat(t.id),{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;null===(e=(null===(t=_o(Qy,this))||void 0===t?void 0:t.popup)||this.popup)||void 0===e||e.remove(),xo(Qy,this,this.popup=null)}updateEdited(e){var t;if(!this.container)return;e.rect&&(_o($y,this)||xo($y,this,{rect:this.data.rect.slice(0)}));const{rect:n,popup:i}=e;n&&bo(Zy,this,tb).call(this,n);let s=(null===(t=_o(Qy,this))||void 0===t?void 0:t.popup)||this.popup;!s&&null!==i&&void 0!==i&&i.text&&(this._createPopup(i),s=_o(Qy,this).popup),s&&(s.updateEdited(e),null!==i&&void 0!==i&&i.deleted&&(s.remove(),xo(Qy,this,null),this.popup=null))}resetEdited(){var e;_o($y,this)&&(bo(Zy,this,tb).call(this,_o($y,this).rect),null===(e=_o(Qy,this))||void 0===e||e.popup.resetEdited(),xo($y,this,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof cb||this instanceof sb||(s.tabIndex=0);const{style:r}=s;if(r.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof vb){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,s),s}const{width:o,height:a}=this;if(!e&&t.borderStyle.width>0){r.borderWidth="".concat(t.borderStyle.width,"px");const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t="calc(".concat(e,"px * var(--total-scale-factor)) / calc(").concat(n,"px * var(--total-scale-factor))");r.borderRadius=t}else if(this instanceof pb){const e="calc(".concat(o,"px * var(--total-scale-factor)) / calc(").concat(a,"px * var(--total-scale-factor))");r.borderRadius=e}switch(t.borderStyle.style){case pa:r.borderStyle="solid";break;case fa:r.borderStyle="dashed";break;case ma:Ia("Unimplemented border style: beveled");break;case ga:Ia("Unimplemented border style: inset");break;case va:r.borderBottomStyle="solid"}const i=t.borderColor||null;i?(xo(Xy,this,!0),r.borderColor=Ga.makeHexColor(0|i[0],0|i[1],0|i[2])):r.borderWidth=0}const l=Ga.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:u,pageX:d,pageY:h}=i.rawDims;r.left="".concat(100*(l[0]-d)/c,"%"),r.top="".concat(100*(l[1]-h)/u,"%");const{rotation:p}=t;return t.hasOwnCanvas||0===p?(r.width="".concat(100*o/c,"%"),r.height="".concat(100*a/u,"%")):this.setRotation(p,s),s}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:r}=this;e%180!==0&&([s,r]=[r,s]),t.style.width="".concat(100*s/n,"%"),t.style.height="".concat(100*r/i,"%"),t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const i=n.detail[e],s=i[0],r=i.slice(1);n.target.style[t]=qy["".concat(s,"_HTML")](r),this.annotationStorage.setValue(this.data.id,{[t]:qy["".concat(s,"_rgb")](r)})};return Oa(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||n[i];null===s||void 0===s||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,s]of Object.entries(t)){const r=n[i];if(r){r({detail:{[i]:s},target:e}),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,s]=this.data.rect.map(e=>Math.fround(e));if(8===e.length){const[r,o,a,l]=e.subarray(2,6);if(i===r&&s===o&&t===a&&n===l)return}const{style:r}=this.container;let o;if(_o(Xy,this)){const{borderColor:e,borderWidth:t}=r;r.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(e,'" stroke-width="').concat(t,'">')],this.container.classList.add("hasBorder")}const a=i-t,l=s-n,{svgFactory:c}=this,u=c.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const d=c.createElement("defs");u.append(d);const h=c.createElement("clipPath"),p="clippath_".concat(this.data.id);h.setAttribute("id",p),h.setAttribute("clipPathUnits","objectBoundingBox"),d.append(h);for(let m=2,g=e.length;m<g;m+=8){var f;const n=e[m],i=e[m+1],r=e[m+2],u=e[m+3],d=c.createElement("rect"),p=(r-t)/a,g=(s-i)/l,v=(n-r)/a,y=(i-u)/l;d.setAttribute("x",p),d.setAttribute("y",g),d.setAttribute("width",v),d.setAttribute("height",y),h.append(d),null===(f=o)||void 0===f||f.push('<rect vector-effect="non-scaling-stroke" x="'.concat(p,'" y="').concat(g,'" width="').concat(v,'" height="').concat(y,'"/>'))}_o(Xy,this)&&(o.push("</g></svg>')"),r.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath="url(#".concat(p,")")}_createPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate),xo(Qy,this,new vb({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:"popup_".concat(t.id),rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(_o(Qy,this)||this.popup||this.data.popupRef)}get extraPopupElement(){return _o(Qy,this)}render(){Na("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:e,id:s,exportValues:r}of i){if(-1===e)continue;if(s===t)continue;const i="string"===typeof r?r:null,o=document.querySelector('[data-element-id="'.concat(s,'"]'));!o||Jy.has(o)?n.push({id:s,exportValue:i,domElement:o}):Ia("_getElementsByName - element not allowed: ".concat(s))}return n}for(const i of document.getElementsByName(e)){const{exportValue:e}=i,s=i.getAttribute("data-element-id");s!==t&&(Jy.has(i)&&n.push({id:s,exportValue:e,domElement:i}))}return n}show(){var e;this.container&&(this.container.hidden=!1),null===(e=this.popup)||void 0===e||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),null===(e=this.popup)||void 0===e||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}function tb(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:a}}}}=this;null===n||void 0===n||n.splice(0,4,...e),t.left="".concat(100*(e[0]-o)/s,"%"),t.top="".concat(100*(r-e[3]+a)/r,"%"),0===i?(t.width="".concat(100*(e[2]-e[0])/s,"%"),t.height="".concat(100*(e[3]-e[1])/r,"%")):this.setRotation(i)}class nb extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var ib=new WeakSet;class sb extends eb{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!(null===t||void 0===t||!t.ignoreBorder),createQuadrilaterals:!0}),vo(this,ib),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(bo(ib,this,ob).call(this,n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(bo(ib,this,ab).call(this,n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=n,this.container.append(n)),this.container}_bindLink(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&bo(ib,this,rb).call(this),n&&(e.title=n)}_bindNamedAction(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),bo(ib,this,rb).call(this)}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const s=n.get(i);s&&(e[s]=()=>{var e;return null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1})}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),bo(ib,this,rb).call(this)}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),bo(ib,this,rb).call(this),!this._fieldObjects)return Ia('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{null===n||void 0===n||n();const{fields:e,refs:i,include:s}=t,r=[];if(0!==e.length||0!==i.length){const t=new Set(i);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===s&&r.push(n)}else for(const t of Object.values(this._fieldObjects))r.push(...t);const o=this.annotationStorage,a=[];for(const t of r){const{id:e}=t;switch(a.push(e),t.type){case"text":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;o.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}default:continue}const n=document.querySelector('[data-element-id="'.concat(e,'"]'));n&&(Jy.has(n)?n.dispatchEvent(new Event("resetform")):Ia("_bindResetFormAction - element not allowed: ".concat(e)))}var l;this.enableScripting&&(null===(l=this.linkService.eventBus)||void 0===l||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:a,name:"ResetForm"}}));return!1}}}function rb(){this.container.setAttribute("data-internal-link","")}function ob(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>{var e;return null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(t.content,t.filename,i),!1},bo(ib,this,rb).call(this)}function ab(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),bo(ib,this,rb).call(this)}class lb extends eb{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class cb extends eb{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&("CANVAS"===(null===(t=e.previousSibling)||void 0===t?void 0:t.nodeName)&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return qa.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,s){n.includes("mouse")?e.addEventListener(n,e=>{var t;null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{var r;if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}s&&(null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(e)}}))})}_setEventListeners(e,t,n,i){for(const[a,l]of n){var s,r,o;if("Action"===l||null!==(s=this.data.actions)&&void 0!==s&&s[l])"Focus"!==l&&"Blur"!==l||t||(t={focused:!1}),this._setEventListener(e,t,a,l,i),"Focus"!==l||null!==(r=this.data.actions)&&void 0!==r&&r.Blur?"Blur"!==l||null!==(o=this.data.actions)&&void 0!==o&&o.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null)}}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":Ga.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,s=e.style;let r;const o=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(qo*i))||1);r=Math.min(i,o(t/qo))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(i,o(e/qo))}s.fontSize="calc(".concat(r,"px * var(--total-scale-factor))"),s.color=Ga.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class ub extends cb{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,i){const s=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=n),s.setValue(r.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){var i;const r=e.getValue(t,{value:this.data.fieldValue});let o=r.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&o.length>a&&(o=o.slice(0,a));let l=r.formattedValue||(null===(i=this.data.textContent)||void 0===i?void 0:i.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=null!==l&&void 0!==l?l:o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",null!==l&&void 0!==l?l:o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Jy.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:u,datetimeType:d,timeStep:h}=this.data,p=!!d&&this.enableScripting;u&&(n.title=u),this._setRequired(n,this.data.required),a&&(n.maxLength=a),n.addEventListener("input",i=>{e.setValue(t,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),c.formattedValue=null}),n.addEventListener("resetform",e=>{var t;const i=null!==(t=this.data.defaultFieldValue)&&void 0!==t?t:"";n.value=c.userValue=i,c.formattedValue=null});let f=e=>{const{formattedValue:t}=c;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var s;n.addEventListener("focus",e=>{var t;if(c.focused)return;const{target:n}=e;if(p&&(n.type=d,h&&(n.step=h)),c.userValue){const e=c.userValue;if(p)if("time"===d){const t=new Date(e),i=[t.getHours(),t.getMinutes(),t.getSeconds()];n.value=i.map(e=>e.toString().padStart(2,"0")).join(":")}else n.value=new Date(e-Ky).toISOString().split("date"===d?"T":".",1)[0];else n.value=e}c.lastCommittedValue=n.value,c.commitKey=1,null!==(t=this.data.actions)&&void 0!==t&&t.Focus||(c.focused=!0)}),n.addEventListener("updatefromsandbox",n=>{this.showElementAndHideCanvas(n.target);const i={value(n){var i;c.userValue=null!==(i=n.detail.value)&&void 0!==i?i:"",p||e.setValue(t,{value:c.userValue.toString()}),n.target.value=c.userValue},formattedValue(n){const{formattedValue:i}=n.detail;c.formattedValue=i,null!==i&&void 0!==i&&n.target!==document.activeElement&&(n.target.value=i);const s={formattedValue:i};p&&(s.value=i),e.setValue(t,s)},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{var i;const{charLimit:s}=n.detail,{target:r}=n;if(0===s)return void r.removeAttribute("maxLength");r.setAttribute("maxLength",s);let o=c.userValue;!o||o.length<=s||(o=o.slice(0,s),r.value=c.userValue=o,e.setValue(t,{value:o}),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,willCommit:!0,commitKey:1,selStart:r.selectionStart,selEnd:r.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)}),n.addEventListener("keydown",e=>{var n;c.commitKey=1;let i=-1;if("Escape"===e.key?i=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(c.commitKey=3):i=2,-1===i)return;const{value:s}=e.target;c.lastCommittedValue!==s&&(c.lastCommittedValue=s,c.userValue=s,null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:i,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const i=f;f=null,n.addEventListener("blur",e=>{var n;if(!c.focused||!e.relatedTarget)return;null!==(n=this.data.actions)&&void 0!==n&&n.Blur||(c.focused=!1);const{target:s}=e;let{value:r}=s;if(p){if(r&&"time"===d){const e=r.split(":").map(e=>parseInt(e,10));r=new Date(2e3,0,1,e[0],e[1],e[2]||0).valueOf(),s.step=""}else r.includes("T")||(r="".concat(r,"T00:00")),r=new Date(r).valueOf();s.type="text"}var o;(c.userValue=r,c.lastCommittedValue!==r)&&(null===(o=this.linkService.eventBus)||void 0===o||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:c.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}));i(e)}),null!==(s=this.data.actions)&&void 0!==s&&s.Keystroke&&n.addEventListener("beforeinput",e=>{var n;c.lastCommittedValue=null;const{data:i,target:s}=e,{value:r,selectionStart:o,selectionEnd:a}=s;let l=o,u=a;switch(e.inputType){case"deleteWordBackward":{const e=r.substring(0,o).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=r.substring(o).match(/^[^\w]*\w*/);e&&(u+=e[0].length);break}case"deleteContentBackward":o===a&&(l-=1);break;case"deleteContentForward":o===a&&(u+=1)}e.preventDefault(),null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,change:i||"",willCommit:!1,selStart:l,selEnd:u}})}),this._setEventListeners(n,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(f&&n.addEventListener("blur",f),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/a;n.classList.add("comb"),n.style.letterSpacing="calc(".concat(e,"px * var(--total-scale-factor) - 1ch)")}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class db extends cb{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class hb extends cb{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"===typeof i&&(i="Off"!==i,e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Jy.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",i=>{const{name:s,checked:r}=i.target;for(const o of this._getElementsByName(s,n)){const n=r&&o.exportValue===t.exportValue;o.domElement&&(o.domElement.checked=n),e.setValue(o.id,{value:n})}e.setValue(n,{value:r})}),s.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class pb extends cb{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if("string"===typeof i&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const r of this._getElementsByName(t.fieldName,n))e.setValue(r.id,{value:!1});const s=document.createElement("input");if(Jy.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",t=>{const{name:i,checked:s}=t.target;for(const r of this._getElementsByName(i,n))e.setValue(r.id,{value:!1});e.setValue(n,{value:s})}),s.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!==n&&void 0!==n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;s.addEventListener("updatefromsandbox",t=>{const s={value:t=>{const s=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=s&&i.id===n;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(s,t)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class fb extends sb{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class mb extends cb{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Jy.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const n of i.options)n.selected=n.value===t});for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,n.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),s=!1),i.append(e)}let r=null;if(s){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),r=()=>{e.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const o=e=>{const t=e?"value":"textContent",{options:n,multiple:s}=i;return s?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let a=o(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",n=>{const s={value(n){var s;null===(s=r)||void 0===s||s();const l=n.detail.value,c=new Set(Array.isArray(l)?l:[l]);for(const e of i.options)e.selected=c.has(e.value);e.setValue(t,{value:o(!0)}),a=o(!1)},multipleSelection(e){i.multiple=!0},remove(n){const s=i.options,r=n.detail.remove;if(s[r].selected=!1,i.remove(r),s.length>0){-1===Array.prototype.findIndex.call(s,e=>e.selected)&&(s[0].selected=!0)}e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},clear(n){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]}),a=o(!1)},insert(n){const{index:s,displayValue:r,exportValue:c}=n.detail.insert,u=i.children[s],d=document.createElement("option");d.textContent=r,d.value=c,u?u.before(d):i.append(d),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},items(n){const{items:s}=n.detail;for(;0!==i.length;)i.remove(0);for(const e of s){const{displayValue:t,exportValue:n}=e,s=document.createElement("option");s.textContent=t,s.value=n,i.append(s)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},indices(n){const i=new Set(n.detail.indices);for(const e of n.target.options)e.selected=i.has(e.index);e.setValue(t,{value:o(!0)}),a=o(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(s,n)}),i.addEventListener("input",n=>{var i;const s=o(!0),r=o(!1);e.setValue(t,{value:s}),n.preventDefault(),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,change:r,changeEx:s,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):i.addEventListener("input",function(n){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var gb=new WeakSet;class vb extends eb{constructor(e){const{data:t,elements:n,parent:i}=e,s=!!i._commentManager;if(super(e,{isRenderable:!s&&eb._hasPopupData(t)}),vo(this,gb),this.elements=n,s&&eb._hasPopupData(t)){const e=this.popup=bo(gb,this,yb).call(this);for(const t of n)t.popup=e}else this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=bo(gb,this,yb).call(this),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(e=>"".concat(Qa).concat(e)).join(",")),this.container}}function yb(){return new Gb({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}var bb=new WeakMap,wb=new WeakMap,_b=new WeakMap,xb=new WeakMap,Eb=new WeakMap,Sb=new WeakMap,Ab=new WeakMap,Cb=new WeakMap,Tb=new WeakMap,kb=new WeakMap,Ib=new WeakMap,Nb=new WeakMap,Pb=new WeakMap,Mb=new WeakMap,Rb=new WeakMap,Ob=new WeakMap,Db=new WeakMap,Fb=new WeakMap,Lb=new WeakMap,jb=new WeakMap,Ub=new WeakMap,Bb=new WeakMap,Wb=new WeakMap,Hb=new WeakMap,Vb=new WeakMap,qb=new WeakMap,zb=new WeakSet;class Gb{constructor(e){let{container:t,color:n,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:c,parentRect:u,open:d,commentManager:h=null}=e;vo(this,zb),yo(this,bb,null),yo(this,wb,bo(zb,this,tw).bind(this)),yo(this,_b,bo(zb,this,rw).bind(this)),yo(this,xb,bo(zb,this,sw).bind(this)),yo(this,Eb,bo(zb,this,iw).bind(this)),yo(this,Sb,null),yo(this,Ab,null),yo(this,Cb,null),yo(this,Tb,null),yo(this,kb,null),yo(this,Ib,null),yo(this,Nb,null),yo(this,Pb,!1),yo(this,Mb,null),yo(this,Rb,null),yo(this,Ob,null),yo(this,Db,null),yo(this,Fb,null),yo(this,Lb,null),yo(this,jb,null),yo(this,Ub,null),yo(this,Bb,null),yo(this,Wb,null),yo(this,Hb,!1),yo(this,Vb,null),yo(this,qb,null),xo(Ab,this,t),xo(Bb,this,s),xo(Cb,this,o),xo(Ub,this,a),xo(Ib,this,l),xo(Sb,this,n),xo(jb,this,c),xo(Nb,this,u),xo(kb,this,i),xo(bb,this,h),xo(Vb,this,i[0]),xo(Tb,this,fl.toDateObject(r)),this.trigger=i.flatMap(e=>e.getElementsToTriggerPopup()),h||(bo(zb,this,Jb).call(this),_o(Ab,this).hidden=!0,d&&bo(zb,this,iw).call(this))}renderCommentButton(){if(_o(Db,this))return void(_o(Db,this).parentNode||_o(Vb,this).container.after(_o(Db,this)));if(_o(Fb,this)||bo(zb,this,Kb).call(this),!_o(Fb,this))return;const{signal:e}=xo(Rb,this,new AbortController),t=_o(Vb,this).hasOwnCommentButton,n=()=>{_o(bb,this).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{_o(bb,this).toggleCommentPopup(this,!1,!0,!t)},s=()=>{_o(bb,this).toggleCommentPopup(this,!1,!1)};if(t){xo(Db,this,_o(Vb,this).container);for(const t of this.trigger)t.ariaHasPopup="dialog",t.ariaControls="commentPopup",t.addEventListener("keydown",_o(wb,this),{signal:e}),t.addEventListener("click",n,{signal:e}),t.addEventListener("pointerenter",i,{signal:e}),t.addEventListener("pointerleave",s,{signal:e}),t.classList.add("popupTriggerArea")}else{const t=xo(Db,this,document.createElement("button"));t.className="annotationCommentButton";const r=_o(Vb,this).container;t.style.zIndex=r.style.zIndex+1,t.tabIndex=0,t.ariaHasPopup="dialog",t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button"),bo(zb,this,$b).call(this),bo(zb,this,Yb).call(this),t.addEventListener("keydown",_o(wb,this),{signal:e}),t.addEventListener("click",n,{signal:e}),t.addEventListener("pointerenter",i,{signal:e}),t.addEventListener("pointerleave",s,{signal:e}),r.after(t)}}get commentButtonColor(){const{color:e,opacity:t}=_o(Vb,this).commentData;return e?_o(Ib,this)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;null===(e=_o(Db,this))||void 0===e||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:s}=_o(Vb,this).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:s}}get elementBeforePopup(){return _o(Db,this)}get comment(){return _o(qb,this)||xo(qb,this,_o(Vb,this).commentText),_o(qb,this)}set comment(e){e!==this.comment&&(_o(Vb,this).commentText=xo(qb,this,e))}focus(){var e;null===(e=_o(Vb,this).container)||void 0===e||e.focus()}get parentBoundingClientRect(){return _o(Vb,this).layer.getBoundingClientRect()}setCommentButtonStates(e){let{selected:t,hasPopup:n}=e;_o(Db,this)&&(_o(Db,this).classList.toggle("selected",t),_o(Db,this).ariaExpanded=n)}setSelectedCommentButton(e){_o(Db,this).classList.toggle("selected",e)}get commentPopupPosition(){if(_o(Lb,this))return _o(Lb,this);const{x:e,y:t,height:n}=_o(Db,this).getBoundingClientRect(),{x:i,y:s,width:r,height:o}=_o(Vb,this).layer.getBoundingClientRect();return[(e-i)/r,(t+n-s)/o]}set commentPopupPosition(e){xo(Lb,this,e)}hasDefaultPopupPosition(){return null===_o(Lb,this)}get commentButtonPosition(){return _o(Fb,this)}get commentButtonWidth(){return _o(Db,this).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=_o(Lb,this)||this.commentButtonPosition.map(e=>e/100),i=this.parentBoundingClientRect,{x:s,y:r,width:o,height:l}=i;_o(bb,this).showDialog(null,this,s+t*o,r+n*l,a(a({},e),{},{parentDimensions:i}))}render(){var e,t;if(_o(Mb,this))return;const n=xo(Mb,this,document.createElement("div"));if(n.className="popup",_o(Sb,this)){const e=n.style.outlineColor=Ga.makeHexColor(..._o(Sb,this));n.style.backgroundColor="color-mix(in srgb, ".concat(e," 30%, white)")}const i=document.createElement("span");if(i.className="header",null!==(e=_o(Bb,this))&&void 0!==e&&e.str){const e=document.createElement("span");e.className="title",i.append(e),({dir:e.dir,str:e.textContent}=_o(Bb,this))}if(n.append(i),_o(Tb,this)){const e=document.createElement("time");e.className="popupDate",e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:_o(Tb,this).valueOf()})),e.dateTime=_o(Tb,this).toISOString(),i.append(e)}kl({html:wo(zb,this,Xb)||_o(Cb,this).str,dir:null===(t=_o(Cb,this))||void 0===t?void 0:t.dir,className:"popupContent"},n),_o(Ab,this).append(n)}updateEdited(e){var t;let{rect:n,popup:i,deleted:s}=e;if(_o(bb,this))return s?(this.remove(),xo(qb,this,null)):i&&(i.deleted?this.remove():(bo(zb,this,$b).call(this),xo(qb,this,i.text))),void(n&&(xo(Fb,this,null),bo(zb,this,Kb).call(this),bo(zb,this,Yb).call(this)));s||null!==i&&void 0!==i&&i.deleted?this.remove():(bo(zb,this,Jb).call(this),_o(Wb,this)||xo(Wb,this,{contentsObj:_o(Cb,this),richText:_o(Ub,this)}),n&&xo(Ob,this,null),i&&i.text&&(xo(Ub,this,bo(zb,this,ew).call(this,i.text)),xo(Tb,this,fl.toDateObject(i.date)),xo(Cb,this,null)),null===(t=_o(Mb,this))||void 0===t||t.remove(),xo(Mb,this,null))}resetEdited(){var e;_o(Wb,this)&&(({contentsObj:mo(xo,[Cb,this])._,richText:mo(xo,[Ub,this])._}=_o(Wb,this)),xo(Wb,this,null),null===(e=_o(Mb,this))||void 0===e||e.remove(),xo(Mb,this,null),xo(Ob,this,null))}remove(){var e,t,n;if(null===(e=_o(Rb,this))||void 0===e||e.abort(),xo(Rb,this,null),null===(t=_o(Mb,this))||void 0===t||t.remove(),xo(Mb,this,null),xo(Hb,this,!1),xo(Pb,this,!1),null===(n=_o(Db,this))||void 0===n||n.remove(),xo(Db,this,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){xo(Hb,this,this.isVisible),_o(Hb,this)&&(_o(Ab,this).hidden=!0)}maybeShow(){_o(bb,this)||(bo(zb,this,Jb).call(this),_o(Hb,this)&&(_o(Mb,this)||bo(zb,this,sw).call(this),xo(Hb,this,!1),_o(Ab,this).hidden=!1))}get isVisible(){return!_o(bb,this)&&!1===_o(Ab,this).hidden}}function Jb(){if(_o(Rb,this))return;xo(Rb,this,new AbortController);const{signal:e}=_o(Rb,this);for(const n of this.trigger)n.addEventListener("click",_o(Eb,this),{signal:e}),n.addEventListener("pointerenter",_o(xb,this),{signal:e}),n.addEventListener("pointerleave",_o(_b,this),{signal:e}),n.classList.add("popupTriggerArea");for(const n of _o(kb,this)){var t;null===(t=n.container)||void 0===t||t.addEventListener("keydown",_o(wb,this),{signal:e})}}function Kb(){const e=_o(kb,this).find(e=>e.hasCommentButton);e&&xo(Fb,this,e._normalizePoint(e.commentButtonPosition))}function Yb(){if(_o(Vb,this).extraPopupElement&&!_o(Vb,this).editor)return;_o(Db,this)||this.renderCommentButton();const[e,t]=_o(Fb,this),{style:n}=_o(Db,this);n.left="calc(".concat(e,"%)"),n.top="calc(".concat(t,"% - var(--comment-button-dim))")}function $b(){_o(Vb,this).extraPopupElement||(_o(Db,this)||this.renderCommentButton(),_o(Db,this).style.backgroundColor=this.commentButtonColor||"")}function Xb(e){const t=_o(Ub,e),n=_o(Cb,e);return null===t||void 0===t||!t.str||null!==n&&void 0!==n&&n.str&&n.str!==t.str?null:_o(Ub,e).html||null}function Qb(e){var t;return(null===(t=wo(zb,e,Xb))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.fontSize)||0}function Zb(e){var t;return(null===(t=wo(zb,e,Xb))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.color)||null}function ew(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:wo(zb,this,Zb),fontSize:wo(zb,this,Qb)?"calc(".concat(wo(zb,this,Qb),"px * var(--total-scale-factor))"):""}};for(const s of e.split("\n"))t.push({name:"span",value:s,attributes:i});return n}function tw(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&_o(Pb,this))&&bo(zb,this,iw).call(this)}function nw(){if(null!==_o(Ob,this))return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:s}}}=_o(Ib,this);let r=!!_o(Nb,this),o=_o(r?Nb:jb,this);for(const h of _o(kb,this))if(!o||null!==Ga.intersect(h.data.rect,o)){o=h.data.rect,r=!0;break}const a=Ga.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),l=r?o[2]-o[0]+5:0,c=a[0]+l,u=a[1];xo(Ob,this,[100*(c-i)/t,100*(u-s)/n]);const{style:d}=_o(Ab,this);d.left="".concat(_o(Ob,this)[0],"%"),d.top="".concat(_o(Ob,this)[1],"%")}function iw(){_o(bb,this)?_o(bb,this).toggleCommentPopup(this,!1):(xo(Pb,this,!_o(Pb,this)),_o(Pb,this)?(bo(zb,this,sw).call(this),_o(Ab,this).addEventListener("click",_o(Eb,this)),_o(Ab,this).addEventListener("keydown",_o(wb,this))):(bo(zb,this,rw).call(this),_o(Ab,this).removeEventListener("click",_o(Eb,this)),_o(Ab,this).removeEventListener("keydown",_o(wb,this))))}function sw(){_o(Mb,this)||this.render(),this.isVisible?_o(Pb,this)&&_o(Ab,this).classList.add("focused"):(bo(zb,this,nw).call(this),_o(Ab,this).hidden=!1,_o(Ab,this).style.zIndex=parseInt(_o(Ab,this).style.zIndex)+1e3)}function rw(){_o(Ab,this).classList.remove("focused"),!_o(Pb,this)&&this.isVisible&&(_o(Ab,this).hidden=!0,_o(Ab,this).style.zIndex=parseInt(_o(Ab,this).style.zIndex)-1e3)}class ow extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ta.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var aw=new WeakMap;class lw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),yo(this,aw,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=xo(aw,this,this.svgFactory.createElement("svg:line"));return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return _o(aw,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var cw=new WeakMap;class uw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),yo(this,cw,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,r=xo(cw,this,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",s/2),r.setAttribute("y",s/2),r.setAttribute("width",t-s),r.setAttribute("height",n-s),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return _o(cw,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var dw=new WeakMap;class hw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),yo(this,dw,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,r=xo(dw,this,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",t/2),r.setAttribute("cy",n/2),r.setAttribute("rx",t/2-s/2),r.setAttribute("ry",n/2-s/2),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return _o(dw,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var pw=new WeakMap;class fw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),yo(this,pw,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:s,height:r}=this;if(!t)return this.container;const o=this.svgFactory.create(s,r,!0);let a=[];for(let c=0,u=t.length;c<u;c+=2){const n=t[c]-e[0],i=e[3]-t[c+1];a.push("".concat(n,",").concat(i))}a=a.join(" ");const l=xo(pw,this,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",a),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return _o(pw,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class mw extends fw{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class gw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var vw=new WeakMap,yw=new WeakMap,bw=new WeakSet;class ww extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),vo(this,bw),yo(this,vw,null),yo(this,yw,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?ta.HIGHLIGHT:ta.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:s}}=this,{transform:r,width:o,height:a}=bo(bw,this,_w).call(this,t,e),l=this.svgFactory.create(o,a,!0),c=xo(vw,this,this.svgFactory.createElement("svg:g"));l.append(c),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",r);for(let u=0,d=n.length;u<d;u++){const e=this.svgFactory.createElement(this.svgElementName);_o(yw,this).push(e),e.setAttribute("points",n[u].join(",")),c.append(e)}return!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,s=_o(vw,this);if(t>=0&&s.setAttribute("stroke-width",t||1),n)for(let r=0,o=_o(yw,this).length;r<o;r++)_o(yw,this)[r].setAttribute("points",n[r].join(","));if(i){const{transform:e,width:t,height:n}=bo(bw,this,_w).call(this,this.data.rotation,i);s.parentElement.setAttribute("viewBox","0 0 ".concat(t," ").concat(n)),s.setAttribute("transform",e)}}getElementsToTriggerPopup(){return _o(yw,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function _w(e,t){switch(e){case 90:return{transform:"rotate(90) translate(".concat(-t[0],",").concat(t[1],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:"rotate(180) translate(".concat(-t[2],",").concat(t[1],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:"rotate(270) translate(".concat(-t[2],",").concat(t[3],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:"translate(".concat(-t[0],",").concat(t[3],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]}}}class xw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ta.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const t=document.createElement("mark");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Ew extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Sw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Aw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const t=document.createElement("s");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Cw extends eb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ta.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Tw=new WeakMap,kw=new WeakSet;class Iw extends eb{constructor(e){var t;super(e,{isRenderable:!0}),vo(this,kw),yo(this,Tw,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("fileattachmentannotation",a({source:this},n))}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(t.name)?"paperclip":"pushpin",".svg"),t.fillAlpha&&t.fillAlpha<1&&(n.style="filter: opacity(".concat(Math.round(100*t.fillAlpha),"%);"))),n.addEventListener("dblclick",bo(kw,this,Nw).bind(this)),xo(Tw,this,n);const{isMac:i}=qa.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(i?e.metaKey:e.ctrlKey)&&bo(kw,this,Nw).call(this)}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return _o(Tw,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function Nw(){var e;null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(this.content,this.filename)}var Pw=new WeakMap,Mw=new WeakMap,Rw=new WeakMap,Ow=new WeakMap,Dw=new WeakMap,Fw=new WeakMap,Lw=new WeakMap,jw=new WeakMap,Uw=new WeakSet;class Bw{constructor(e){let{div:t,accessibilityManager:n,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:a,commentManager:l,linkService:c,annotationStorage:u}=e;vo(this,Uw),yo(this,Pw,null),yo(this,Mw,null),yo(this,Rw,null),yo(this,Ow,new Map),yo(this,Dw,null),yo(this,Fw,null),yo(this,Lw,[]),yo(this,jw,!1),this.div=t,xo(Pw,this,n),xo(Mw,this,i),xo(Dw,this,a||null),xo(Fw,this,c||null),xo(Rw,this,u||new jh),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=l||null}hasEditableAnnotations(){return _o(Ow,this).size>0}async render(e){const{annotations:t}=e,n=this.div;bl(n,this.viewport);const i=new Map,s=[],r={data:null,layer:n,linkService:_o(Fw,this),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new Gy,annotationStorage:_o(Rw,this),enableComment:!0===e.enableComment,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const e=a.annotationType===ha.POPUP;if(e){const e=i.get(a.id);if(!e)continue;if(!this._commentManager){s.push(a);continue}r.elements=e}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const t=Yy.create(r);if(!t.isRenderable)continue;if(!e&&(_o(Lw,this).push(t),a.popupRef)){const e=i.get(a.popupRef);e?e.push(t):i.set(a.popupRef,[t])}const n=t.render();var o;if(a.hidden&&(n.style.visibility="hidden"),t._isEditable)_o(Ow,this).set(t.data.id,t),null===(o=this._annotationEditorUIManager)||void 0===o||o.renderAnnotationElement(t)}await bo(Uw,this,Ww).call(this);for(const a of s){const e=r.elements=i.get(a.id);r.data=a;const t=Yy.create(r);if(!t.isRenderable)continue;const n=t.render();t.contentElement.id="".concat(Qa).concat(a.id),a.hidden&&(n.style.visibility="hidden"),e.at(-1).container.after(n)}bo(Uw,this,Hw).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:_o(Fw,this),svgFactory:new Gy,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=Bw._defaultBorderStyle),t.data=n;const e=Yy.create(t);e.isRenderable&&(e.render(),e.contentElement.id="".concat(Qa).concat(n.id),_o(Lw,this).push(e))}await bo(Uw,this,Ww).call(this)}update(e){let{viewport:t}=e;const n=this.div;this.viewport=t,bl(n,{rotation:t.rotation}),bo(Uw,this,Hw).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(_o(Ow,this).values())}getEditableAnnotation(e){return _o(Ow,this).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,s=new nb({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:_o(Fw,this),annotationStorage:_o(Rw,this)});return s.render(),s.contentElement.id="".concat(Qa).concat(n),s.createOrUpdatePopup(),_o(Lw,this).push(s),s}removeAnnotation(e){var t;const n=_o(Lw,this).findIndex(t=>t.data.id===e);if(n<0)return;const[i]=_o(Lw,this).splice(n,1);null===(t=_o(Pw,this))||void 0===t||t.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(e){if(0!==e.length){for(const t of e)t.updateFakeAnnotationElement(this);bo(Uw,this,Ww).call(this)}}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Oa(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:pa,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}async function Ww(){if(0===_o(Lw,this).length)return;this.div.replaceChildren();const e=[];if(!_o(jw,this)){xo(jw,this,!0);for(const{contentElement:n,data:{id:i}}of _o(Lw,this)){var t;const s=n.id="".concat(Qa).concat(i);e.push(null===(t=_o(Dw,this))||void 0===t?void 0:t.getAriaAttributes(s).then(e=>{if(e)for(const[t,i]of e)n.setAttribute(t,i)}))}}_o(Lw,this).sort((e,t)=>{let{data:{rect:[n,i,s,r]}}=e,{data:{rect:[o,a,l,c]}}=t;if(n===s&&i===r)return 1;if(o===l&&a===c)return-1;const u=(i+r)/2,d=(a+c)/2;if(u>=c&&d<=i)return-1;if(d>=r&&u<=a)return 1;return(n+s)/2-(o+l)/2});const n=document.createDocumentFragment();for(const r of _o(Lw,this)){var i,s;if(n.append(r.container),this._commentManager)null===(i=(null===(s=r.extraPopupElement)||void 0===s?void 0:s.popup)||r.popup)||void 0===i||i.renderCommentButton();else r.extraPopupElement&&n.append(r.extraPopupElement.render())}if(this.div.append(n),await Promise.all(e),_o(Pw,this))for(const r of _o(Lw,this))_o(Pw,this).addPointerInTextLayer(r.contentElement,!1)}function Hw(){if(!_o(Mw,this))return;const e=this.div;for(const[n,i]of _o(Mw,this)){const s=e.querySelector('[data-annotation-id="'.concat(n,'"]'));if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?"CANVAS"===r.nodeName?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i);const o=_o(Ow,this).get(n);var t;if(o)if(o._hasNoCanvas)null===(t=this._annotationEditorUIManager)||void 0===t||t.setMissingCanvas(n,s.id,i),o._hasNoCanvas=!1;else o.canvas=i}_o(Mw,this).clear()}const Vw=/\r\n?|\n/g;var qw=new WeakMap,zw=new WeakMap,Gw=new WeakMap,Jw=new WeakMap,Kw=new WeakSet;class Yw extends ah{static get _keyboardManager(){const e=Yw.prototype,t=e=>e.isEmpty(),n=bu.TRANSLATE_SMALL,i=bu.TRANSLATE_BIG;return Oa(this,"_keyboardManager",new wc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}constructor(e){super(a(a({},e),{},{name:"freeTextEditor"})),vo(this,Kw),yo(this,qw,""),yo(this,zw,"".concat(this.id,"-editor")),yo(this,Gw,null),yo(this,Jw,void 0),r(this,"_colorPicker",null),this.color=e.color||Yw._defaultColor||ah._defaultLineColor,xo(Jw,this,e.fontSize||Yw._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){ah.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case na.FREETEXT_SIZE:Yw._defaultFontSize=t;break;case na.FREETEXT_COLOR:Yw._defaultColor=t}}updateParams(e,t){switch(e){case na.FREETEXT_SIZE:bo(Kw,this,$w).call(this,t);break;case na.FREETEXT_COLOR:bo(Kw,this,Xw).call(this,t)}}static get defaultPropertiesToUpdate(){return[[na.FREETEXT_SIZE,Yw._defaultFontSize],[na.FREETEXT_COLOR,Yw._defaultColor||ah._defaultLineColor]]}get propertiesToUpdate(){return[[na.FREETEXT_SIZE,_o(Jw,this)],[na.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new By(this)),[["colorPicker",this._colorPicker]]}get colorType(){return na.FREETEXT_COLOR}onUpdatedColor(){var e;this.editorDiv.style.color=this.color,null===(e=this._colorPicker)||void 0===e||e.update(this.color),super.onUpdatedColor()}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Yw._internalPadding*e,-(Yw._internalPadding+_o(Jw,this))*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),xo(Gw,this,new AbortController);const e=this._uiManager.combinedSignal(_o(Gw,this));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",_o(zw,this)),this._isDraggable=!0,null===(e=_o(Gw,this))||void 0===e||e.abort(),xo(Gw,this,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var t;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),null!==(t=this._initialOptions)&&void 0!==t&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=_o(qw,this),t=xo(qw,this,bo(Kw,this,Qw).call(this).trimEnd());if(e===t)return;const n=e=>{xo(qw,this,e),e?(bo(Kw,this,t_).call(this),this._uiManager.rebuild(this),bo(Kw,this,Zw).call(this)):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),bo(Kw,this,Zw).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Yw._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",_o(zw,this)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize="calc(".concat(_o(Jw,this),"px * var(--total-scale-factor))"),n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this._initialData;let[r,o]=this.getInitialTranslation();[r,o]=this.pageTranslationToScreen(r,o);const[a,l]=this.pageDimensions,[c,u]=this.pageTranslation;let d,h;switch(this.rotation){case 0:d=e+(s[0]-c)/a,h=t+this.height-(s[1]-u)/l;break;case 90:d=e+(s[0]-c)/a,h=t-(s[1]-u)/l,[r,o]=[o,-r];break;case 180:d=e-this.width+(s[0]-c)/a,h=t-(s[1]-u)/l,[r,o]=[-r,-o];break;case 270:d=e+(s[0]-c-this.height*l)/a,h=t+(s[1]-u-this.width*a)/l,[r,o]=[-o,r]}this.setAt(d*n,h*i,r,o)}else this._moveAfterPaste(e,t);bo(Kw,this,t_).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(1===n.length&&"text/plain"===n[0])return;e.preventDefault();const i=i_.call(Yw,t.getData("text")||"").replaceAll(Vw,"\n");if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const r=s.getRangeAt(0);if(!i.includes("\n"))return r.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void s.collapseToStart();const{startContainer:o,startOffset:a}=r,l=[],c=[];if(o.nodeType===Node.TEXT_NODE){const e=o.parentElement;if(c.push(o.nodeValue.slice(a).replaceAll(Vw,"")),e!==this.editorDiv){let t=l;for(const n of this.editorDiv.childNodes)n!==e?t.push(e_.call(Yw,n)):t=c}l.push(o.nodeValue.slice(0,a).replaceAll(Vw,""))}else if(o===this.editorDiv){let e=l,t=0;for(const n of this.editorDiv.childNodes)t++===a&&(e=c),e.push(e_.call(Yw,n))}xo(qw,this,"".concat(l.join("\n")).concat(i).concat(c.join("\n"))),bo(Kw,this,t_).call(this);const u=new Range;let d=Math.sumPrecise(l.map(e=>e.length));for(const{firstChild:h}of this.editorDiv.childNodes)if(h.nodeType===Node.TEXT_NODE){const e=h.nodeValue.length;if(d<=e){u.setStart(h,d),u.setEnd(h,d);break}d-=e}s.removeAllRanges(),s.addRange(u)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=Yw._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let i=null;if(e instanceof ow){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:s,rotation:r,id:o,popupRef:a,richText:l,contentsObj:c,creationDate:u,modificationDate:d},textContent:h,textPosition:p,parent:{page:{pageNumber:f}}}=e;if(!h||0===h.length)return null;i=e={annotationType:ta.FREETEXT,color:Array.from(n),fontSize:t,value:h.join("\n"),position:p,pageIndex:f-1,rect:s.slice(0),rotation:r,annotationElementId:o,id:o,deleted:!1,popupRef:a,comment:(null===c||void 0===c?void 0:c.str)||null,richText:l,creationDate:u,modificationDate:d}}const s=await super.deserialize(e,t,n);return xo(Jw,s,e.fontSize),s.color=Ga.makeHexColor(...e.color),xo(qw,s,i_.call(Yw,e.value)),s._initialData=i,e.comment&&s.setCommentData(e),s}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=ah._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:_o(Jw,this),value:bo(Kw,this,n_).call(this)});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!bo(Kw,this,s_).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize="calc(".concat(_o(Jw,this),"px * var(--total-scale-factor))"),n.color=this.color,t.replaceChildren();for(const i of _o(qw,this).split("\n")){const e=document.createElement("div");e.append(i?document.createTextNode(i):document.createElement("br")),t.append(e)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:_o(qw,this)}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}function $w(e){const t=e=>{this.editorDiv.style.fontSize="calc(".concat(e,"px * var(--total-scale-factor))"),this.translate(0,-(e-_o(Jw,this))*this.parentScale),xo(Jw,this,e),bo(Kw,this,Zw).call(this)},n=_o(Jw,this);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:na.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function Xw(e){const t=e=>{this.color=e,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:na.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function Qw(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes){var n;(null===(n=t)||void 0===n?void 0:n.nodeType)===Node.TEXT_NODE&&"BR"===i.nodeName||(e.push(e_.call(Lo,i)),t=i)}return e.join("\n")}function Zw(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,i=t.style.display,s=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=i,t.classList.toggle("hidden",s)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}function e_(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Vw,"")}function t_(){if(this.editorDiv.replaceChildren(),_o(qw,this))for(const e of _o(qw,this).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}function n_(){return _o(qw,this).replaceAll("\xa0"," ")}function i_(e){return e.replaceAll(" ","\xa0")}function s_(e){const{value:t,fontSize:n,color:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((e,t)=>e!==i[t])||e.pageIndex!==s}Lo=Yw,r(Yw,"_freeTextDefaultContent",""),r(Yw,"_internalPadding",0),r(Yw,"_defaultColor",null),r(Yw,"_defaultFontSize",10),r(Yw,"_type","freetext"),r(Yw,"_editorType",ta.FREETEXT);class r_{toSVGPath(){Na("Abstract method `toSVGPath` must be implemented.")}get box(){Na("Abstract getter `box` must be implemented.")}serialize(e,t){Na("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,s,r){r||(r=new Float32Array(e.length));for(let o=0,a=e.length;o<a;o+=2)r[o]=t+e[o]*i,r[o+1]=n+e[o+1]*s;return r}static _rescaleAndSwap(e,t,n,i,s,r){r||(r=new Float32Array(e.length));for(let o=0,a=e.length;o<a;o+=2)r[o]=t+e[o+1]*i,r[o+1]=n+e[o]*s;return r}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let s=0,r=e.length;s<r;s+=2)i[s]=t+e[s],i[s+1]=n+e[s+1];return i}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,n,i,s){switch(s){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,s,r){return[(e+5*n)/6,(t+5*i)/6,(5*n+s)/6,(5*i+r)/6,(n+s)/2,(i+r)/2]}}r(r_,"PRECISION",1e-4);var o_=new WeakMap,a_=new WeakMap,l_=new WeakMap,c_=new WeakMap,u_=new WeakMap,d_=new WeakMap,h_=new WeakMap,p_=new WeakMap,f_=new WeakMap,m_=new WeakMap,g_=new WeakMap,v_=new WeakMap,y_=new WeakMap,b_=new WeakSet;class w_{constructor(e,t,n,i,s){let{x:r,y:o}=e,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;vo(this,b_),yo(this,o_,void 0),yo(this,a_,[]),yo(this,l_,void 0),yo(this,c_,void 0),yo(this,u_,[]),yo(this,d_,new Float32Array(18)),yo(this,h_,void 0),yo(this,p_,void 0),yo(this,f_,void 0),yo(this,m_,void 0),yo(this,g_,void 0),yo(this,v_,void 0),yo(this,y_,[]),xo(o_,this,t),xo(v_,this,i*n),xo(c_,this,s),_o(d_,this).set([NaN,NaN,NaN,NaN,r,o],6),xo(l_,this,a),xo(m_,this,k_._*n),xo(f_,this,I_._*n),xo(g_,this,n),_o(y_,this).push(r,o)}isEmpty(){return isNaN(_o(d_,this)[8])}add(e){var t;let{x:n,y:i}=e;xo(h_,this,n),xo(p_,this,i);const[s,r,o,a]=_o(o_,this);let[l,c,u,d]=_o(d_,this).subarray(8,12);const h=n-u,p=i-d,f=Math.hypot(h,p);if(f<_o(f_,this))return!1;const m=f-_o(m_,this),g=m/f,v=g*h,y=g*p;let b=l,w=c;l=u,c=d,u+=v,d+=y,null===(t=_o(y_,this))||void 0===t||t.push(n,i);const _=v/m,x=-y/m*_o(v_,this),E=_*_o(v_,this);if(_o(d_,this).set(_o(d_,this).subarray(2,8),0),_o(d_,this).set([u+x,d+E],4),_o(d_,this).set(_o(d_,this).subarray(14,18),12),_o(d_,this).set([u-x,d-E],16),isNaN(_o(d_,this)[6]))return 0===_o(u_,this).length&&(_o(d_,this).set([l+x,c+E],2),_o(u_,this).push(NaN,NaN,NaN,NaN,(l+x-s)/o,(c+E-r)/a),_o(d_,this).set([l-x,c-E],14),_o(a_,this).push(NaN,NaN,NaN,NaN,(l-x-s)/o,(c-E-r)/a)),_o(d_,this).set([b,w,l,c,u,d],6),!this.isEmpty();_o(d_,this).set([b,w,l,c,u,d],6);return Math.abs(Math.atan2(w-c,b-l)-Math.atan2(y,v))<Math.PI/2?([l,c,u,d]=_o(d_,this).subarray(2,6),_o(u_,this).push(NaN,NaN,NaN,NaN,((l+u)/2-s)/o,((c+d)/2-r)/a),[l,c,b,w]=_o(d_,this).subarray(14,18),_o(a_,this).push(NaN,NaN,NaN,NaN,((b+l)/2-s)/o,((w+c)/2-r)/a),!0):([b,w,l,c,u,d]=_o(d_,this).subarray(0,6),_o(u_,this).push(((b+5*l)/6-s)/o,((w+5*c)/6-r)/a,((5*l+u)/6-s)/o,((5*c+d)/6-r)/a,((l+u)/2-s)/o,((c+d)/2-r)/a),[u,d,l,c,b,w]=_o(d_,this).subarray(12,18),_o(a_,this).push(((b+5*l)/6-s)/o,((w+5*c)/6-r)/a,((5*l+u)/6-s)/o,((5*c+d)/6-r)/a,((l+u)/2-s)/o,((c+d)/2-r)/a),!0)}toSVGPath(){if(this.isEmpty())return"";const e=_o(u_,this),t=_o(a_,this);if(isNaN(_o(d_,this)[6])&&!this.isEmpty())return bo(b_,this,x_).call(this);const n=[];n.push("M".concat(e[4]," ").concat(e[5]));for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push("L".concat(e[i+4]," ").concat(e[i+5])):n.push("C".concat(e[i]," ").concat(e[i+1]," ").concat(e[i+2]," ").concat(e[i+3]," ").concat(e[i+4]," ").concat(e[i+5]));bo(b_,this,S_).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push("L".concat(t[i+4]," ").concat(t[i+5])):n.push("C".concat(t[i]," ").concat(t[i+1]," ").concat(t[i+2]," ").concat(t[i+3]," ").concat(t[i+4]," ").concat(t[i+5]));return bo(b_,this,E_).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,s,r){return new j_(e,t,n,i,s,r)}getOutlines(){var e,t;const n=_o(u_,this),i=_o(a_,this),s=_o(d_,this),[r,o,a,l]=_o(o_,this),c=new Float32Array((null!==(e=null===(t=_o(y_,this))||void 0===t?void 0:t.length)&&void 0!==e?e:0)+2);for(let h=0,p=c.length-2;h<p;h+=2)c[h]=(_o(y_,this)[h]-r)/a,c[h+1]=(_o(y_,this)[h+1]-o)/l;if(c[c.length-2]=(_o(h_,this)-r)/a,c[c.length-1]=(_o(p_,this)-o)/l,isNaN(s[6])&&!this.isEmpty())return bo(b_,this,A_).call(this,c);const u=new Float32Array(_o(u_,this).length+24+_o(a_,this).length);let d=n.length;for(let h=0;h<d;h+=2)isNaN(n[h])?u[h]=u[h+1]=NaN:(u[h]=n[h],u[h+1]=n[h+1]);d=bo(b_,this,T_).call(this,u,d);for(let h=i.length-6;h>=6;h-=6)for(let e=0;e<6;e+=2)isNaN(i[h+e])?(u[d]=u[d+1]=NaN,d+=2):(u[d]=i[h+e],u[d+1]=i[h+e+1],d+=2);return bo(b_,this,C_).call(this,u,d),this.newFreeDrawOutline(u,c,_o(o_,this),_o(g_,this),_o(l_,this),_o(c_,this))}}function __(){const e=_o(d_,this).subarray(4,6),t=_o(d_,this).subarray(16,18),[n,i,s,r]=_o(o_,this);return[(_o(h_,this)+(e[0]-t[0])/2-n)/s,(_o(p_,this)+(e[1]-t[1])/2-i)/r,(_o(h_,this)+(t[0]-e[0])/2-n)/s,(_o(p_,this)+(t[1]-e[1])/2-i)/r]}function x_(){const[e,t,n,i]=_o(o_,this),[s,r,o,a]=bo(b_,this,__).call(this);return"M".concat((_o(d_,this)[2]-e)/n," ").concat((_o(d_,this)[3]-t)/i," L").concat((_o(d_,this)[4]-e)/n," ").concat((_o(d_,this)[5]-t)/i," L").concat(s," ").concat(r," L").concat(o," ").concat(a," L").concat((_o(d_,this)[16]-e)/n," ").concat((_o(d_,this)[17]-t)/i," L").concat((_o(d_,this)[14]-e)/n," ").concat((_o(d_,this)[15]-t)/i," Z")}function E_(e){const t=_o(a_,this);e.push("L".concat(t[4]," ").concat(t[5]," Z"))}function S_(e){const[t,n,i,s]=_o(o_,this),r=_o(d_,this).subarray(4,6),o=_o(d_,this).subarray(16,18),[a,l,c,u]=bo(b_,this,__).call(this);e.push("L".concat((r[0]-t)/i," ").concat((r[1]-n)/s," L").concat(a," ").concat(l," L").concat(c," ").concat(u," L").concat((o[0]-t)/i," ").concat((o[1]-n)/s))}function A_(e){const t=_o(d_,this),[n,i,s,r]=_o(o_,this),[o,a,l,c]=bo(b_,this,__).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-n)/s,(t[3]-i)/r,NaN,NaN,NaN,NaN,(t[4]-n)/s,(t[5]-i)/r,NaN,NaN,NaN,NaN,o,a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-n)/s,(t[17]-i)/r,NaN,NaN,NaN,NaN,(t[14]-n)/s,(t[15]-i)/r],0),this.newFreeDrawOutline(u,e,_o(o_,this),_o(g_,this),_o(l_,this),_o(c_,this))}function C_(e,t){const n=_o(a_,this);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+6}function T_(e,t){const n=_o(d_,this).subarray(4,6),i=_o(d_,this).subarray(16,18),[s,r,o,a]=_o(o_,this),[l,c,u,d]=bo(b_,this,__).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-s)/o,(n[1]-r)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-r)/a],t),t+24}var k_={_:8},I_={_:k_._+2},N_=new WeakMap,P_=new WeakMap,M_=new WeakMap,R_=new WeakMap,O_=new WeakMap,D_=new WeakMap,F_=new WeakMap,L_=new WeakSet;class j_ extends r_{constructor(e,t,n,i,s,r){super(),vo(this,L_),yo(this,N_,void 0),yo(this,P_,new Float32Array(4)),yo(this,M_,void 0),yo(this,R_,void 0),yo(this,O_,void 0),yo(this,D_,void 0),yo(this,F_,void 0),xo(F_,this,e),xo(O_,this,t),xo(N_,this,n),xo(D_,this,i),xo(M_,this,s),xo(R_,this,r),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],bo(L_,this,U_).call(this,r);const[o,a,l,c]=_o(P_,this);for(let u=0,d=e.length;u<d;u+=2)e[u]=(e[u]-o)/l,e[u+1]=(e[u+1]-a)/c;for(let u=0,d=t.length;u<d;u+=2)t[u]=(t[u]-o)/l,t[u+1]=(t[u+1]-a)/c}toSVGPath(){const e=["M".concat(_o(F_,this)[4]," ").concat(_o(F_,this)[5])];for(let t=6,n=_o(F_,this).length;t<n;t+=6)isNaN(_o(F_,this)[t])?e.push("L".concat(_o(F_,this)[t+4]," ").concat(_o(F_,this)[t+5])):e.push("C".concat(_o(F_,this)[t]," ").concat(_o(F_,this)[t+1]," ").concat(_o(F_,this)[t+2]," ").concat(_o(F_,this)[t+3]," ").concat(_o(F_,this)[t+4]," ").concat(_o(F_,this)[t+5]));return e.push("Z"),e.join(" ")}serialize(e,t){let[n,i,s,r]=e;const o=s-n,a=r-i;let l,c;switch(t){case 0:l=r_._rescale(_o(F_,this),n,r,o,-a),c=r_._rescale(_o(O_,this),n,r,o,-a);break;case 90:l=r_._rescaleAndSwap(_o(F_,this),n,i,o,a),c=r_._rescaleAndSwap(_o(O_,this),n,i,o,a);break;case 180:l=r_._rescale(_o(F_,this),s,i,-o,a),c=r_._rescale(_o(O_,this),s,i,-o,a);break;case 270:l=r_._rescaleAndSwap(_o(F_,this),s,r,-o,-a),c=r_._rescaleAndSwap(_o(O_,this),s,r,-o,-a)}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return _o(P_,this)}newOutliner(e,t,n,i,s){return new w_(e,t,n,i,s,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(e,t){const[n,i,s,r]=_o(P_,this),[o,a,l,c]=_o(N_,this),u=s*l,d=r*c,h=n*l+o,p=i*c+a,f=this.newOutliner({x:_o(O_,this)[0]*u+h,y:_o(O_,this)[1]*d+p},_o(N_,this),_o(D_,this),e,_o(R_,this),null!==t&&void 0!==t?t:_o(M_,this));for(let m=2;m<_o(O_,this).length;m+=2)f.add({x:_o(O_,this)[m]*u+h,y:_o(O_,this)[m+1]*d+p});return f.getOutlines()}}function U_(e){const t=_o(F_,this);let n=t[4],i=t[5];const s=[n,i,n,i];let r=n,o=i,a=n,l=i;const c=e?Math.max:Math.min,u=new Float32Array(4);for(let h=6,p=t.length;h<p;h+=6){const e=t[h+4],d=t[h+5];isNaN(t[h])?(Ga.pointBoundingBox(e,d,s),o>d?(r=e,o=d):o===d&&(r=c(r,e)),l<d?(a=e,l=d):l===d&&(a=c(a,e))):(u[0]=u[1]=1/0,u[2]=u[3]=-1/0,Ga.bezierBoundingBox(n,i,...t.slice(h,h+6),u),Ga.rectBoundingBox(u[0],u[1],u[2],u[3],s),o>u[1]?(r=u[0],o=u[1]):o===u[1]&&(r=c(r,u[0])),l<u[3]?(a=u[2],l=u[3]):l===u[3]&&(a=c(a,u[2]))),n=e,i=d}const d=_o(P_,this);d[0]=s[0]-_o(M_,this),d[1]=s[1]-_o(M_,this),d[2]=s[2]-s[0]+2*_o(M_,this),d[3]=s[3]-s[1]+2*_o(M_,this),this.firstPoint=[r,o],this.lastPoint=[a,l]}var B_=new WeakMap,W_=new WeakMap,H_=new WeakMap,V_=new WeakMap,q_=new WeakMap,z_=new WeakSet;class G_{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];vo(this,z_),yo(this,B_,void 0),yo(this,W_,void 0),yo(this,H_,void 0),yo(this,V_,[]),yo(this,q_,[]);const s=[1/0,1/0,-1/0,-1/0],r=1e-4;for(const{x:f,y:m,width:g,height:v}of e){const e=Math.floor((f-t)/r)*r,n=Math.ceil((f+g+t)/r)*r,i=Math.floor((m-t)/r)*r,o=Math.ceil((m+v+t)/r)*r,a=[e,i,o,!0],l=[n,i,o,!1];_o(V_,this).push(a,l),Ga.rectBoundingBox(e,i,n,o,s)}const o=s[2]-s[0]+2*n,a=s[3]-s[1]+2*n,l=s[0]-n,c=s[1]-n;let u=i?-1/0:1/0,d=1/0;const h=_o(V_,this).at(i?-1:-2),p=[h[0],h[2]];for(const f of _o(V_,this)){const[e,t,n,s]=f;!s&&i?t<d?(d=t,u=e):t===d&&(u=Math.max(u,e)):s&&!i&&(t<d?(d=t,u=e):t===d&&(u=Math.min(u,e))),f[0]=(e-l)/o,f[1]=(t-c)/a,f[2]=(n-c)/a}xo(B_,this,new Float32Array([l,c,o,a])),xo(W_,this,[u,d]),xo(H_,this,p)}getOutlines(){_o(V_,this).sort((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]);const e=[];for(const t of _o(V_,this))t[3]?(e.push(...bo(z_,this,X_).call(this,t)),bo(z_,this,Y_).call(this,t)):(bo(z_,this,$_).call(this,t),e.push(...bo(z_,this,X_).call(this,t)));return bo(z_,this,J_).call(this,e)}}function J_(e){const t=[],n=new Set;for(const r of e){const[e,n,i]=r;t.push([e,n,r],[e,i,r])}t.sort((e,t)=>e[1]-t[1]||e[0]-t[0]);for(let r=0,o=t.length;r<o;r+=2){const e=t[r][2],i=t[r+1][2];e.push(i),i.push(e),n.add(e),n.add(i)}const i=[];let s;for(;n.size>0;){const e=n.values().next().value;let[t,r,o,a,l]=e;n.delete(e);let c=t,u=r;for(s=[t,o],i.push(s);;){let e;if(n.has(a))e=a;else{if(!n.has(l))break;e=l}n.delete(e),[t,r,o,a,l]=e,c!==t&&(s.push(c,u,t,u===r?r:o),c=t),u=u===r?o:r}s.push(c,u)}return new ex(i,_o(B_,this),_o(W_,this),_o(H_,this))}function K_(e){const t=_o(q_,this);let n=0,i=t.length-1;for(;n<=i;){const s=n+i>>1,r=t[s][0];if(r===e)return s;r<e?n=s+1:i=s-1}return i+1}function Y_(e){let[,t,n]=e;const i=bo(z_,this,K_).call(this,t);_o(q_,this).splice(i,0,[t,n])}function $_(e){let[,t,n]=e;const i=bo(z_,this,K_).call(this,t);for(let s=i;s<_o(q_,this).length;s++){const[e,i]=_o(q_,this)[s];if(e!==t)break;if(e===t&&i===n)return void _o(q_,this).splice(s,1)}for(let s=i-1;s>=0;s--){const[e,i]=_o(q_,this)[s];if(e!==t)break;if(e===t&&i===n)return void _o(q_,this).splice(s,1)}}function X_(e){const[t,n,i]=e,s=[[t,n,i]],r=bo(z_,this,K_).call(this,i);for(let o=0;o<r;o++){const[e,n]=_o(q_,this)[o];for(let i=0,r=s.length;i<r;i++){const[,o,a]=s[i];if(!(n<=o||a<=e))if(o>=e)if(a>n)s[i][1]=n;else{if(1===r)return[];s.splice(i,1),i--,r--}else s[i][2]=e,a>n&&s.push([t,n,a])}}return s}var Q_=new WeakMap,Z_=new WeakMap;class ex extends r_{constructor(e,t,n,i){super(),yo(this,Q_,void 0),yo(this,Z_,void 0),xo(Z_,this,e),xo(Q_,this,t),this.firstPoint=n,this.lastPoint=i}toSVGPath(){const e=[];for(const t of _o(Z_,this)){let[n,i]=t;e.push("M".concat(n," ").concat(i));for(let s=2;s<t.length;s+=2){const r=t[s],o=t[s+1];r===n?(e.push("V".concat(o)),i=o):o===i&&(e.push("H".concat(r)),n=r)}e.push("Z")}return e.join(" ")}serialize(e,t){let[n,i,s,r]=e;const o=[],a=s-n,l=r-i;for(const c of _o(Z_,this)){const e=new Array(c.length);for(let t=0;t<c.length;t+=2)e[t]=n+c[t]*a,e[t+1]=r-c[t+1]*l;o.push(e)}return o}get box(){return _o(Q_,this)}get classNamesForOutlining(){return["highlightOutline"]}}class tx extends w_{newFreeDrawOutline(e,t,n,i,s,r){return new nx(e,t,n,i,s,r)}}class nx extends j_{newOutliner(e,t,n,i,s){return new tx(e,t,n,i,s,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}var ix=new WeakMap,sx=new WeakMap,rx=new WeakMap,ox=new WeakMap,ax=new WeakMap,lx=new WeakMap,cx=new WeakMap,ux=new WeakMap,dx=new WeakMap,hx=new WeakMap,px=new WeakMap,fx=new WeakMap,mx=new WeakMap,gx=new WeakMap,vx=new WeakMap,yx=new WeakMap,bx=new WeakMap,wx=new WeakMap,_x=new WeakSet;class xx extends ah{static get _keyboardManager(){const e=xx.prototype;return Oa(this,"_keyboardManager",new wc([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(a(a({},e),{},{name:"highlightEditor"})),vo(this,_x),yo(this,ix,null),yo(this,sx,0),yo(this,rx,void 0),yo(this,ox,null),yo(this,ax,null),yo(this,lx,null),yo(this,cx,null),yo(this,ux,0),yo(this,dx,null),yo(this,hx,null),yo(this,px,null),yo(this,fx,!1),yo(this,mx,null),yo(this,gx,null),yo(this,vx,null),yo(this,yx,""),yo(this,bx,void 0),yo(this,wx,""),this.color=e.color||xx._defaultColor,xo(bx,this,e.thickness||xx._defaultThickness),this.opacity=e.opacity||xx._defaultOpacity,xo(rx,this,e.boxes||null),xo(wx,this,e.methodOfCreation||""),xo(yx,this,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(xo(fx,this,!0),bo(_x,this,Sx).call(this,e),bo(_x,this,Ix).call(this)):_o(rx,this)&&(xo(ix,this,e.anchorNode),xo(sx,this,e.anchorOffset),xo(cx,this,e.focusNode),xo(ux,this,e.focusOffset),bo(_x,this,Ex).call(this),bo(_x,this,Ix).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:_o(fx,this)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:_o(bx,this),methodOfCreation:_o(wx,this)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,t){var n;ah.initialize(e,t),xx._defaultColor||(xx._defaultColor=(null===(n=t.highlightColors)||void 0===n?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,t){switch(e){case na.HIGHLIGHT_COLOR:xx._defaultColor=t;break;case na.HIGHLIGHT_THICKNESS:xx._defaultThickness=t}}translateInPage(e,t){}get toolbarPosition(){return _o(gx,this)}get commentButtonPosition(){return _o(mx,this)}updateParams(e,t){switch(e){case na.HIGHLIGHT_COLOR:bo(_x,this,Ax).call(this,t);break;case na.HIGHLIGHT_THICKNESS:bo(_x,this,Cx).call(this,t)}}static get defaultPropertiesToUpdate(){return[[na.HIGHLIGHT_COLOR,xx._defaultColor],[na.HIGHLIGHT_THICKNESS,xx._defaultThickness]]}get propertiesToUpdate(){return[[na.HIGHLIGHT_COLOR,this.color||xx._defaultColor],[na.HIGHLIGHT_THICKNESS,_o(bx,this)||xx._defaultThickness],[na.HIGHLIGHT_FREE,_o(fx,this)]]}onUpdatedColor(){var e,t;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(_o(px,this),{root:{fill:this.color,"fill-opacity":this.opacity}}),null===(t=_o(ax,this))||void 0===t||t.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){if(this._uiManager.highlightColors){return[["colorPicker",xo(ax,this,new Iy({editor:this}))]]}return super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(bo(_x,this,Rx).call(this))}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,bo(_x,this,Rx).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){bo(_x,this,kx).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(bo(_x,this,Ix).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)bo(_x,this,kx).call(this);else if(e){var n;bo(_x,this,Ix).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),this.show(this._isVisible),t&&this.select()}rotate(e){const{drawLayer:t}=this.parent;let n;_o(fx,this)?(e=(e-this.rotation+360)%360,n=Nx.call(xx,_o(hx,this).box,e)):n=Nx.call(xx,[this.x,this.y,this.width,this.height],e),t.updateProperties(_o(px,this),{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(_o(vx,this),{bbox:Nx.call(xx,_o(lx,this).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();_o(yx,this)&&(e.setAttribute("aria-label",_o(yx,this)),e.setAttribute("role","mark")),_o(fx,this)?e.classList.add("free"):this.div.addEventListener("keydown",bo(_x,this,Px).bind(this),{signal:this._uiManager._signal});const t=xo(dx,this,document.createElement("div"));return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=_o(ox,this),this.setDims(),ec(this,_o(dx,this),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(_o(vx,this),{rootClass:{hovered:!0}}))}pointerleave(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(_o(vx,this),{rootClass:{hovered:!1}}))}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:bo(_x,this,Mx).call(this,!0);break;case 1:case 3:bo(_x,this,Mx).call(this,!1)}}select(){var e;super.select(),_o(vx,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(_o(vx,this),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),_o(vx,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(_o(vx,this),{rootClass:{selected:!1}}),_o(fx,this)||bo(_x,this,Mx).call(this,!1))}get _mustFixPosition(){return!_o(fx,this)}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(_o(px,this),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(_o(vx,this),{rootClass:{hidden:!e}}))}static startHighlighting(e,t,n){let{target:i,x:s,y:r}=n;const{x:o,y:a,width:l,height:c}=i.getBoundingClientRect(),u=new AbortController,d=e.combinedSignal(u),h=t=>{u.abort(),bo(xx,this,Lx).call(this,e,t)};window.addEventListener("blur",h,{signal:d}),window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("pointerdown",pl,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",hl,{signal:d}),i.addEventListener("pointermove",bo(xx,this,Fx).bind(this,e),{signal:d}),this._freeHighlight=new tx({x:s,y:r},[o,a,l,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(e,t,n){let i=null;if(e instanceof xw){const{data:{quadPoints:t,rect:n,rotation:s,id:r,color:o,opacity:a,popupRef:l,richText:c,contentsObj:u,creationDate:d,modificationDate:h},parent:{page:{pageNumber:p}}}=e;i=e={annotationType:ta.HIGHLIGHT,color:Array.from(o),opacity:a,quadPoints:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:s,annotationElementId:r,id:r,deleted:!1,popupRef:l,richText:c,comment:(null===u||void 0===u?void 0:u.str)||null,creationDate:d,modificationDate:h}}else if(e instanceof ww){const{data:{inkLists:t,rect:n,rotation:s,id:r,color:o,borderStyle:{rawWidth:a},popupRef:l,richText:c,contentsObj:u,creationDate:d,modificationDate:h},parent:{page:{pageNumber:p}}}=e;i=e={annotationType:ta.HIGHLIGHT,color:Array.from(o),thickness:a,inkLists:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:s,annotationElementId:r,id:r,deleted:!1,popupRef:l,richText:c,comment:(null===u||void 0===u?void 0:u.str)||null,creationDate:d,modificationDate:h}}const{color:s,quadPoints:r,inkLists:o,opacity:a}=e,l=await super.deserialize(e,t,n);l.color=Ga.makeHexColor(...s),l.opacity=a||1,o&&xo(bx,l,e.thickness),l._initialData=i,e.comment&&l.setCommentData(e);const[c,u]=l.pageDimensions,[d,h]=l.pageTranslation;if(r){const e=xo(rx,l,[]);for(let t=0;t<r.length;t+=8)e.push({x:(r[t]-d)/c,y:1-(r[t+1]-h)/u,width:(r[t+2]-r[t])/c,height:(r[t+1]-r[t+5])/u});bo(_x,l,Ex).call(l),bo(_x,l,Ix).call(l),l.rotate(l.rotation)}else if(o){xo(fx,l,!0);const e=o[0],n={x:e[0]-d,y:u-(e[1]-h)},i=new tx(n,[0,0,c,u],1,_o(bx,l)/2,!0,.001);for(let t=0,o=e.length;t<o;t+=2)n.x=e[t]-d,n.y=u-(e[t+1]-h),i.add(n);const{id:s,clipPathId:r}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);bo(_x,l,Sx).call(l,{highlightOutlines:i.getOutlines(),highlightId:s,clipPathId:r}),bo(_x,l,Ix).call(l),l.rotate(l.parentRotation)}return l}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=ah._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:_o(bx,this),quadPoints:bo(_x,this,Ox).call(this),outlines:bo(_x,this,Dx).call(this,n.rect)}),this.addComment(n),this.annotationElementId&&!bo(_x,this,jx).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}function Ex(){const e=new G_(_o(rx,this),.001);xo(hx,this,e.getOutlines()),[this.x,this.y,this.width,this.height]=_o(hx,this).box;const t=new G_(_o(rx,this),.0025,.001,"ltr"===this._uiManager.direction);xo(lx,this,t.getOutlines());const{firstPoint:n}=_o(hx,this);xo(mx,this,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]);const{lastPoint:i}=_o(lx,this);xo(gx,this,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])}function Sx(e){let{highlightOutlines:t,highlightId:n,clipPathId:i}=e;xo(hx,this,t);if(xo(lx,this,t.getNewOutline(_o(bx,this)/2+1.5,.0025)),n>=0)xo(px,this,n),xo(ox,this,i),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),xo(vx,this,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:_o(lx,this).box,path:{d:_o(lx,this).toSVGPath()}},!0));else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(_o(px,this),{bbox:Nx.call(jo,_o(hx,this).box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(_o(vx,this),{bbox:Nx.call(jo,_o(lx,this).box,e),path:{d:_o(lx,this).toSVGPath()}})}const[s,r,o,a]=t.box;switch(this.rotation){case 0:this.x=s,this.y=r,this.width=o,this.height=a;break;case 90:{const[e,t]=this.parentDimensions;this.x=r,this.y=1-s,this.width=o*t/e,this.height=a*e/t;break}case 180:this.x=1-s,this.y=1-r,this.width=o,this.height=a;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-r,this.y=s,this.width=o*t/e,this.height=a*e/t;break}}const{firstPoint:l}=t;xo(mx,this,[(l[0]-s)/o,(l[1]-r)/a]);const{lastPoint:c}=_o(lx,this);xo(gx,this,[(c[0]-s)/o,(c[1]-r)/a])}function Ax(e){const t=(e,t)=>{this.color=e,this.opacity=t,this.onUpdatedColor()},n=this.color,i=this.opacity;this.addCommands({cmd:t.bind(this,e,jo._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:na.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}function Cx(e){const t=_o(bx,this),n=e=>{xo(bx,this,e),bo(_x,this,Tx).call(this,e)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:na.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}function Tx(e){_o(fx,this)&&(bo(_x,this,Sx).call(this,{highlightOutlines:_o(hx,this).getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}function kx(){null!==_o(px,this)&&this.parent&&(this.parent.drawLayer.remove(_o(px,this)),xo(px,this,null),this.parent.drawLayer.remove(_o(vx,this)),xo(vx,this,null))}function Ix(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===_o(px,this)&&(({id:mo(xo,[px,this])._,clipPathId:mo(xo,[ox,this])._}=e.drawLayer.draw({bbox:_o(hx,this).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:_o(fx,this)},path:{d:_o(hx,this).toSVGPath()}},!1,!0)),xo(vx,this,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:_o(fx,this)},bbox:_o(lx,this).box,path:{d:_o(lx,this).toSVGPath()}},_o(fx,this))),_o(dx,this)&&(_o(dx,this).style.clipPath=_o(ox,this)))}function Nx(e,t){let[n,i,s,r]=e;switch(t){case 90:return[1-i-r,n,r,s];case 180:return[1-n-s,1-i-r,s,r];case 270:return[i,1-n-s,r,s]}return[n,i,s,r]}function Px(e){jo._keyboardManager.exec(this,e)}function Mx(e){if(!_o(ix,this))return;const t=window.getSelection();e?t.setPosition(_o(ix,this),_o(sx,this)):t.setPosition(_o(cx,this),_o(ux,this))}function Rx(){return _o(fx,this)?this.rotation:0}function Ox(){if(_o(fx,this))return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,s=_o(rx,this),r=new Float32Array(8*s.length);let o=0;for(const{x:a,y:l,width:c,height:u}of s){const s=a*e+n,d=(1-l)*t+i;r[o]=r[o+4]=s,r[o+1]=r[o+3]=d,r[o+2]=r[o+6]=s+c*e,r[o+5]=r[o+7]=d-u*t,o+=8}return r}function Dx(e){return _o(hx,this).serialize(e,bo(_x,this,Rx).call(this))}function Fx(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}function Lx(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}function jx(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((e,n)=>e!==t[n])}jo=xx,r(xx,"_defaultColor",null),r(xx,"_defaultOpacity",1),r(xx,"_defaultThickness",12),r(xx,"_type","highlight"),r(xx,"_editorType",ta.HIGHLIGHT),r(xx,"_freeHighlightId",-1),r(xx,"_freeHighlight",null),r(xx,"_freeHighlightClipId","");var Ux=new WeakMap;class Bx{constructor(){yo(this,Ux,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){_o(Ux,this)[e]=t}toSVGProperties(){const e=_o(Ux,this);return xo(Ux,this,Object.create(null)),{root:e}}reset(){xo(Ux,this,Object.create(null))}updateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(e)}clone(){Na("Not implemented")}}var Wx=new WeakMap,Hx=new WeakMap,Vx=new WeakSet;class qx extends ah{constructor(e){super(e),vo(this,Vx),yo(this,Wx,null),yo(this,Hx,void 0),r(this,"_colorPicker",null),r(this,"_drawId",null),xo(Hx,this,e.mustBeCommitted||!1),this._addOutlines(e)}onUpdatedColor(){var e;null===(e=this._colorPicker)||void 0===e||e.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(bo(Vx,this,zx).call(this,e),bo(Vx,this,Kx).call(this))}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,s]of Object.entries(t))n.has(i)?Object.assign(e[i],s):e[i]=s;return e}static getDefaultDrawingOptions(e){Na("Not implemented")}static get typesMap(){Na("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(Zx._.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,s=i[t],r=n=>{var s;i.updateProperty(t,n);const r=_o(Wx,this).updateProperty(t,n);r&&bo(Vx,this,Xx).call(this,r),null===(s=this.parent)||void 0===s||s.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:r.bind(this,n),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,qx._mergeSVGProperties(_o(Wx,this).getPathResizingSVGProperties(bo(Vx,this,$x).call(this)),{bbox:bo(Vx,this,Qx).call(this)}))}_onResized(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,qx._mergeSVGProperties(_o(Wx,this).getPathResizedSVGProperties(bo(Vx,this,$x).call(this)),{bbox:bo(Vx,this,Qx).call(this)}))}_onTranslating(e,t){var n;null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,{bbox:bo(Vx,this,Qx).call(this)})}_onTranslated(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,qx._mergeSVGProperties(_o(Wx,this).getPathTranslatedSVGProperties(bo(Vx,this,$x).call(this),this.parentDimensions),{bbox:bo(Vx,this,Qx).call(this)}))}_onStartDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,_o(Hx,this)&&(xo(Hx,this,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){bo(Vx,this,Jx).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(bo(Vx,this,Kx).call(this),bo(Vx,this,Xx).call(this,_o(Wx,this).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)this._uiManager.removeShouldRescale(this),bo(Vx,this,Jx).call(this);else if(e){var n;this._uiManager.addShouldRescale(this),bo(Vx,this,Kx).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),t&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,qx._mergeSVGProperties({bbox:bo(Vx,this,Qx).call(this)},_o(Wx,this).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&bo(Vx,this,Xx).call(this,_o(Wx,this).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");return n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,s){Na("Not implemented")}static startDrawing(e,t,n,i){var s;const{target:r,offsetX:o,offsetY:a,pointerId:l,pointerType:c}=i;if(tc.isInitializedAndDifferentPointerType(c))return;const{viewport:{rotation:u}}=e,{width:d,height:h}=r.getBoundingClientRect(),p=eE._=new AbortController,f=e.combinedSignal(p);tc.setPointer(c,l),window.addEventListener("pointerup",e=>{tc.isSamePointerIdOrRemove(e.pointerId)&&this._endDraw(e)},{signal:f}),window.addEventListener("pointercancel",e=>{tc.isSamePointerIdOrRemove(e.pointerId)&&this._currentParent.endDrawingSession()},{signal:f}),window.addEventListener("pointerdown",e=>{tc.isSamePointerType(e.pointerType)&&(tc.initializeAndAddPointerId(e.pointerId),Zx._.isCancellable()&&(Zx._.removeLastElement(),Zx._.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",hl,{signal:f}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:f}),r.addEventListener("touchmove",e=>{tc.isSameTimeStamp(e.timeStamp)&&pl(e)},{signal:f}),e.toggleDrawing(),null===(s=t._editorUndoBar)||void 0===s||s.hide(),Zx._?e.drawLayer.updateProperties(this._currentDrawId,Zx._.startNew(o,a,d,h,u)):(t.updateUIForDefaultProperties(this),Zx._=this.createDrawerInstance(o,a,d,h,u),tE._=this.getDefaultDrawingOptions(),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(tE._.toSVGProperties(),Zx._.defaultSVGProperties),!0,!1)))}static _drawMove(e){if(tc.isSameTimeStamp(e.timeStamp),!Zx._)return;const{offsetX:t,offsetY:n,pointerId:i}=e;tc.isSamePointerId(i)&&(tc.isUsingMultiplePointers()?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,Zx._.add(t,n)),tc.setTimeStamp(e.timeStamp),pl(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Zx._=null,tE._=null,tc.clearTimeStamp()),eE._&&(eE._.abort(),eE._=null,tc.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),(null===e||void 0===e?void 0:e.target)===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Zx._.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=Zx._,n=this._currentDrawId,i=e.getLastElement();return void t.addCommands({cmd:()=>{t.drawLayer.updateProperties(n,e.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(n,e.removeLastElement())},mustExec:!1,type:na.DRAW_STEP})}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(na.DRAW_STEP),!Zx._.isEmpty()){const{pageDimensions:[n,i],scale:s}=t,r=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Zx._.getOutlines(n*s,i*s,s,this._INNER_MARGIN),drawingOptions:tE._,mustBeCommitted:!e});return this._cleanup(!0),r}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,s,r){Na("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=t.viewport,a=this.deserializeDraw(r,o,i,s,this._INNER_MARGIN,e),l=await super.deserialize(e,t,n);return l.createDrawingOptions(e),bo(Vx,l,zx).call(l,{drawOutlines:a}),bo(Vx,l,Kx).call(l),l.onScaleChanging(),l.rotate(),l}serializeDraw(e){const[t,n]=this.pageTranslation,[i,s]=this.pageDimensions;return _o(Wx,this).serialize([t,n,i,s],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}function zx(e){let{drawOutlines:t,drawId:n,drawingOptions:i}=e;xo(Wx,this,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-".concat(this.editorType,"-added-alert")),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=bo(Vx,this,Gx).call(this,t,this.parent),bo(Vx,this,Xx).call(this,t.box)}function Gx(e,t){const{id:n}=t.drawLayer.draw(Uo._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}function Jx(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}function Kx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=bo(Vx,this,Gx).call(this,_o(Wx,this),e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))}function Yx(e){let[t,n,i,s]=e;const{parentDimensions:[r,o],rotation:a}=this;switch(a){case 90:return[n,1-t,i*(o/r),s*(r/o)];case 180:return[1-t,1-n,i,s];case 270:return[1-n,t,i*(o/r),s*(r/o)];default:return[t,n,i,s]}}function $x(){const{x:e,y:t,width:n,height:i,parentDimensions:[s,r],rotation:o}=this;switch(o){case 90:return[1-t,e,n*(s/r),i*(r/s)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(s/r),i*(r/s)];default:return[e,t,n,i]}}function Xx(e){[this.x,this.y,this.width,this.height]=bo(Vx,this,Yx).call(this,e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}function Qx(){const{x:e,y:t,width:n,height:i,rotation:s,parentRotation:r,parentDimensions:[o,a]}=this;switch((4*s+r)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(o/a),i*(a/o),n*(o/a)];case 5:return[1-t,e,n*(o/a),i*(a/o)];case 6:return[1-e-i*(a/o),1-t,i*(a/o),n*(o/a)];case 7:return[t-n*(o/a),1-e-i*(a/o),n*(o/a),i*(a/o)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(a/o),t,i*(a/o),n*(o/a)];case 13:return[1-t-n*(o/a),e-i*(a/o),n*(o/a),i*(a/o)];case 14:return[1-e,1-t-n*(o/a),i*(a/o),n*(o/a)];case 15:return[t,1-e,n*(o/a),i*(a/o)];default:return[e,t,n,i]}}Uo=qx,r(qx,"_currentDrawId",-1),r(qx,"_currentParent",null);var Zx={_:null},eE={_:null},tE={_:null};r(qx,"_INNER_MARGIN",3);var nE=new WeakMap,iE=new WeakMap,sE=new WeakMap,rE=new WeakMap,oE=new WeakMap,aE=new WeakMap,lE=new WeakMap,cE=new WeakMap,uE=new WeakMap,dE=new WeakMap,hE=new WeakMap,pE=new WeakSet;class fE{constructor(e,t,n,i,s,r){vo(this,pE),yo(this,nE,new Float64Array(6)),yo(this,iE,void 0),yo(this,sE,void 0),yo(this,rE,void 0),yo(this,oE,void 0),yo(this,aE,void 0),yo(this,lE,""),yo(this,cE,0),yo(this,uE,new CE),yo(this,dE,void 0),yo(this,hE,void 0),xo(dE,this,n),xo(hE,this,i),xo(rE,this,s),xo(oE,this,r),[e,t]=bo(pE,this,mE).call(this,e,t);const o=xo(iE,this,[NaN,NaN,NaN,NaN,e,t]);xo(aE,this,[e,t]),xo(sE,this,[{line:o,points:_o(aE,this)}]),_o(nE,this).set(o,0)}updateProperty(e,t){"stroke-width"===e&&xo(oE,this,t)}isEmpty(){return!_o(sE,this)||0===_o(sE,this).length}isCancellable(){return _o(aE,this).length<=10}add(e,t){[e,t]=bo(pE,this,mE).call(this,e,t);const[n,i,s,r]=_o(nE,this).subarray(2,6),o=e-s,a=t-r;return Math.hypot(_o(dE,this)*o,_o(hE,this)*a)<=2?null:(_o(aE,this).push(e,t),isNaN(n)?(_o(nE,this).set([s,r,e,t],2),_o(iE,this).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(_o(nE,this)[0])&&_o(iE,this).splice(6,6),_o(nE,this).set([n,i,s,r,e,t],0),_o(iE,this).push(...r_.createBezierPoints(n,i,s,r,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(2===_o(aE,this).length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,s){xo(dE,this,n),xo(hE,this,i),xo(rE,this,s),[e,t]=bo(pE,this,mE).call(this,e,t);const r=xo(iE,this,[NaN,NaN,NaN,NaN,e,t]);xo(aE,this,[e,t]);const o=_o(sE,this).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),_o(sE,this).push({line:r,points:_o(aE,this)}),_o(nE,this).set(r,0),xo(cE,this,0),this.toSVGPath(),null}getLastElement(){return _o(sE,this).at(-1)}setLastElement(e){return _o(sE,this)?(_o(sE,this).push(e),xo(iE,this,e.line),xo(aE,this,e.points),xo(cE,this,0),{path:{d:this.toSVGPath()}}):_o(uE,this).setLastElement(e)}removeLastElement(){if(!_o(sE,this))return _o(uE,this).removeLastElement();_o(sE,this).pop(),xo(lE,this,"");for(let e=0,t=_o(sE,this).length;e<t;e++){const{line:t,points:n}=_o(sE,this)[e];xo(iE,this,t),xo(aE,this,n),xo(cE,this,0),this.toSVGPath()}return{path:{d:_o(lE,this)}}}toSVGPath(){const e=r_.svgRound(_o(iE,this)[4]),t=r_.svgRound(_o(iE,this)[5]);if(2===_o(aE,this).length)return xo(lE,this,"".concat(_o(lE,this)," M ").concat(e," ").concat(t," Z")),_o(lE,this);if(_o(aE,this).length<=6){const n=_o(lE,this).lastIndexOf("M");xo(lE,this,"".concat(_o(lE,this).slice(0,n)," M ").concat(e," ").concat(t)),xo(cE,this,6)}if(4===_o(aE,this).length){const e=r_.svgRound(_o(iE,this)[10]),t=r_.svgRound(_o(iE,this)[11]);return xo(lE,this,"".concat(_o(lE,this)," L ").concat(e," ").concat(t)),xo(cE,this,12),_o(lE,this)}const n=[];0===_o(cE,this)&&(n.push("M ".concat(e," ").concat(t)),xo(cE,this,6));for(let i=_o(cE,this),s=_o(iE,this).length;i<s;i+=6){const[e,t,s,r,o,a]=_o(iE,this).slice(i,i+6).map(r_.svgRound);n.push("C".concat(e," ").concat(t," ").concat(s," ").concat(r," ").concat(o," ").concat(a))}return xo(lE,this,_o(lE,this)+n.join(" ")),xo(cE,this,_o(iE,this).length),_o(lE,this)}getOutlines(e,t,n,i){const s=_o(sE,this).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),_o(uE,this).build(_o(sE,this),e,t,n,_o(rE,this),_o(oE,this),i),xo(nE,this,null),xo(iE,this,null),xo(sE,this,null),xo(lE,this,null),_o(uE,this)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}function mE(e,t){return r_._normalizePoint(e,t,_o(dE,this),_o(hE,this),_o(rE,this))}var gE=new WeakMap,vE=new WeakMap,yE=new WeakMap,bE=new WeakMap,wE=new WeakMap,_E=new WeakMap,xE=new WeakMap,EE=new WeakMap,SE=new WeakMap,AE=new WeakSet;class CE extends r_{constructor(){super(...arguments),vo(this,AE),yo(this,gE,void 0),yo(this,vE,0),yo(this,yE,void 0),yo(this,bE,void 0),yo(this,wE,void 0),yo(this,_E,void 0),yo(this,xE,void 0),yo(this,EE,void 0),yo(this,SE,void 0)}build(e,t,n,i,s,r,o){xo(wE,this,t),xo(_E,this,n),xo(xE,this,i),xo(EE,this,s),xo(SE,this,r),xo(yE,this,null!==o&&void 0!==o?o:0),xo(bE,this,e),bo(AE,this,IE).call(this)}get thickness(){return _o(SE,this)}setLastElement(e){return _o(bE,this).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return _o(bE,this).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of _o(bE,this))if(e.push("M".concat(r_.svgRound(t[4])," ").concat(r_.svgRound(t[5]))),6!==t.length)if(12===t.length&&isNaN(t[6]))e.push("L".concat(r_.svgRound(t[10])," ").concat(r_.svgRound(t[11])));else for(let n=6,i=t.length;n<i;n+=6){const[i,s,r,o,a,l]=t.subarray(n,n+6).map(r_.svgRound);e.push("C".concat(i," ").concat(s," ").concat(r," ").concat(o," ").concat(a," ").concat(l))}else e.push("Z");return e.join("")}serialize(e,t){let[n,i,s,r]=e;const o=[],a=[],[l,c,u,d]=bo(AE,this,kE).call(this);let h,p,f,m,g,v,y,b,w;switch(_o(EE,this)){case 0:w=r_._rescale,h=n,p=i+r,f=s,m=-r,g=n+l*s,v=i+(1-c-d)*r,y=n+(l+u)*s,b=i+(1-c)*r;break;case 90:w=r_._rescaleAndSwap,h=n,p=i,f=s,m=r,g=n+c*s,v=i+l*r,y=n+(c+d)*s,b=i+(l+u)*r;break;case 180:w=r_._rescale,h=n+s,p=i,f=-s,m=r,g=n+(1-l-u)*s,v=i+c*r,y=n+(1-l)*s,b=i+(c+d)*r;break;case 270:w=r_._rescaleAndSwap,h=n+s,p=i+r,f=-s,m=-r,g=n+(1-c-d)*s,v=i+(1-l-u)*r,y=n+(1-c)*s,b=i+(1-l)*r}for(const{line:_,points:x}of _o(bE,this))o.push(w(_,h,p,f,m,t?new Array(_.length):null)),a.push(w(x,h,p,f,m,t?new Array(x.length):null));return{lines:o,points:a,rect:[g,v,y,b]}}static deserialize(e,t,n,i,s,r){let{paths:{lines:o,points:a},rotation:l,thickness:c}=r;const u=[];let d,h,p,f,m;switch(l){case 0:m=r_._rescale,d=-e/n,h=t/i+1,p=1/n,f=-1/i;break;case 90:m=r_._rescaleAndSwap,d=-t/i,h=-e/n,p=1/i,f=1/n;break;case 180:m=r_._rescale,d=e/n+1,h=-t/i,p=-1/n,f=1/i;break;case 270:m=r_._rescaleAndSwap,d=t/i+1,h=e/n+1,p=-1/i,f=-1/n}if(!o){o=[];for(const e of a){const t=e.length;if(2===t){o.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){o.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const n=new Float32Array(3*(t-2));o.push(n);let[i,s,r,a]=e.subarray(0,4);n.set([NaN,NaN,NaN,NaN,i,s],0);for(let o=4;o<t;o+=2){const t=e[o],l=e[o+1];n.set(r_.createBezierPoints(i,s,r,a,t,l),3*(o-2)),[i,s,r,a]=[r,a,t,l]}}}for(let v=0,y=o.length;v<y;v++)u.push({line:m(o[v].map(e=>null!==e&&void 0!==e?e:NaN),d,h,p,f),points:m(a[v].map(e=>null!==e&&void 0!==e?e:NaN),d,h,p,f)});const g=new this.prototype.constructor;return g.build(u,n,i,1,l,c,s),g}get box(){return _o(gE,this)}updateProperty(e,t){return"stroke-width"===e?bo(AE,this,NE).call(this,t):null}updateParentDimensions(e,t){let[n,i]=e;const[s,r]=bo(AE,this,TE).call(this);xo(wE,this,n),xo(_E,this,i),xo(xE,this,t);const[o,a]=bo(AE,this,TE).call(this),l=o-s,c=a-r,u=_o(gE,this);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u}updateRotation(e){return xo(vE,this,e),{path:{transform:this.rotationTransform}}}get viewBox(){return _o(gE,this).map(r_.svgRound).join(" ")}get defaultProperties(){const[e,t]=_o(gE,this);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(r_.svgRound(e)," ").concat(r_.svgRound(t))}}}get rotationTransform(){const[,,e,t]=_o(gE,this);let n=0,i=0,s=0,r=0,o=0,a=0;switch(_o(vE,this)){case 90:i=t/e,s=-e/t,o=e;break;case 180:n=-1,r=-1,o=e,a=t;break;case 270:i=-t/e,s=e/t,a=t;break;default:return""}return"matrix(".concat(n," ").concat(i," ").concat(s," ").concat(r," ").concat(r_.svgRound(o)," ").concat(r_.svgRound(a),")")}getPathResizingSVGProperties(e){let[t,n,i,s]=e;const[r,o]=bo(AE,this,TE).call(this),[a,l,c,u]=_o(gE,this);if(Math.abs(c-r)<=r_.PRECISION||Math.abs(u-o)<=r_.PRECISION){const e=t+i/2-(a+c/2),r=n+s/2-(l+u/2);return{path:{"transform-origin":"".concat(r_.svgRound(t)," ").concat(r_.svgRound(n)),transform:"".concat(this.rotationTransform," translate(").concat(e," ").concat(r,")")}}}const d=(i-2*r)/(c-2*r),h=(s-2*o)/(u-2*o),p=c/i,f=u/s;return{path:{"transform-origin":"".concat(r_.svgRound(a)," ").concat(r_.svgRound(l)),transform:"".concat(this.rotationTransform," scale(").concat(p," ").concat(f,") ")+"translate(".concat(r_.svgRound(r)," ").concat(r_.svgRound(o),") scale(").concat(d," ").concat(h,") ")+"translate(".concat(r_.svgRound(-r)," ").concat(r_.svgRound(-o),")")}}}getPathResizedSVGProperties(e){let[t,n,i,s]=e;const[r,o]=bo(AE,this,TE).call(this),a=_o(gE,this),[l,c,u,d]=a;if(a[0]=t,a[1]=n,a[2]=i,a[3]=s,Math.abs(u-r)<=r_.PRECISION||Math.abs(d-o)<=r_.PRECISION){const e=t+i/2-(l+u/2),r=n+s/2-(c+d/2);for(const{line:t,points:n}of _o(bE,this))r_._translate(t,e,r,t),r_._translate(n,e,r,n);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(r_.svgRound(t)," ").concat(r_.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}const h=(i-2*r)/(u-2*r),p=(s-2*o)/(d-2*o),f=-h*(l+r)+t+r,m=-p*(c+o)+n+o;if(1!==h||1!==p||0!==f||0!==m)for(const{line:g,points:v}of _o(bE,this))r_._rescale(g,f,m,h,p,g),r_._rescale(v,f,m,h,p,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(r_.svgRound(t)," ").concat(r_.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(e,t){let[n,i]=e;const[s,r]=t,o=_o(gE,this),a=n-o[0],l=i-o[1];if(_o(wE,this)===s&&_o(_E,this)===r)for(const{line:c,points:u}of _o(bE,this))r_._translate(c,a,l,c),r_._translate(u,a,l,u);else{const e=_o(wE,this)/s,t=_o(_E,this)/r;xo(wE,this,s),xo(_E,this,r);for(const{line:n,points:i}of _o(bE,this))r_._rescale(n,a,l,e,t,n),r_._rescale(i,a,l,e,t,i);o[2]*=e,o[3]*=t}return o[0]=n,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":"".concat(r_.svgRound(n)," ").concat(r_.svgRound(i))}}}get defaultSVGProperties(){const e=_o(gE,this);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":"".concat(r_.svgRound(e[0])," ").concat(r_.svgRound(e[1])),transform:this.rotationTransform||null},bbox:e}}}function TE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_o(SE,this);const t=_o(yE,this)+e/2*_o(xE,this);return _o(EE,this)%180===0?[t/_o(wE,this),t/_o(_E,this)]:[t/_o(_E,this),t/_o(wE,this)]}function kE(){const[e,t,n,i]=_o(gE,this),[s,r]=bo(AE,this,TE).call(this,0);return[e+s,t+r,n-2*s,i-2*r]}function IE(){const e=xo(gE,this,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of _o(bE,this)){if(i.length<=12){for(let t=4,n=i.length;t<n;t+=6)Ga.pointBoundingBox(i[t],i[t+1],e);continue}let t=i[4],n=i[5];for(let s=6,r=i.length;s<r;s+=6){const[r,o,a,l,c,u]=i.subarray(s,s+6);Ga.bezierBoundingBox(t,n,r,o,a,l,c,u,e),t=c,n=u}}const[t,n]=bo(AE,this,TE).call(this);e[0]=Za(e[0]-t,0,1),e[1]=Za(e[1]-n,0,1),e[2]=Za(e[2]+t,0,1),e[3]=Za(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}function NE(e){const[t,n]=bo(AE,this,TE).call(this);xo(SE,this,e);const[i,s]=bo(AE,this,TE).call(this),[r,o]=[i-t,s-n],a=_o(gE,this);return a[0]-=r,a[1]-=o,a[2]+=2*r,a[3]+=2*o,a}class PE extends Bx{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:ah._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(null!==t&&void 0!==t||(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new PE(this._viewParameters);return e.updateAll(this),e}}var ME=new WeakSet;class RE extends qx{constructor(e){super(a(a({},e),{},{name:"inkEditor"})),vo(this,ME),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){ah.initialize(e,t),this._defaultDrawingOptions=new PE(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Oa(this,"typesMap",new Map([[na.INK_THICKNESS,"stroke-width"],[na.INK_COLOR,"stroke"],[na.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,s){return new fE(e,t,n,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,s,r){return CE.deserialize(e,t,n,i,s,r)}static async deserialize(e,t,n){let i=null;if(e instanceof ww){const{data:{inkLists:t,rect:n,rotation:s,id:r,color:o,opacity:a,borderStyle:{rawWidth:l},popupRef:c,richText:u,contentsObj:d,creationDate:h,modificationDate:p},parent:{page:{pageNumber:f}}}=e;i=e={annotationType:ta.INK,color:Array.from(o),thickness:l,opacity:a,paths:{points:t},boxes:null,pageIndex:f-1,rect:n.slice(0),rotation:s,annotationElementId:r,id:r,deleted:!1,popupRef:c,richText:u,comment:(null===d||void 0===d?void 0:d.str)||null,creationDate:h,modificationDate:p}}const s=await super.deserialize(e,t,n);return s._initialData=i,e.comment&&s.setCommentData(e),s}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new By(this)),[["colorPicker",this._colorPicker]]}get colorType(){return na.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(e){let{color:t,thickness:n,opacity:i}=e;this._drawingOptions=RE.getDefaultDrawingOptions({stroke:Ga.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":s,"stroke-width":r}}=this,o=Object.assign(super.serialize(e),{color:ah._colorManager.convert(i),opacity:s,thickness:r,paths:{lines:t,points:n}});return this.addComment(o),e?(o.isCopy=!0,o):this.annotationElementId&&!bo(ME,this,OE).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}function OE(e){const{color:t,thickness:n,opacity:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((e,n)=>e!==t[n])||e.thickness!==n||e.opacity!==i||e.pageIndex!==s}r(RE,"_type","ink"),r(RE,"_editorType",ta.INK),r(RE,"_defaultDrawingOptions",null);class DE extends CE{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}class FE{static extractContoursFromText(e,t,n,i,s,r){let{fontFamily:o,fontStyle:a,fontWeight:l}=t,c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const d=u.font="".concat(a," ").concat(l," ").concat(200,"px ").concat(o),{actualBoundingBoxLeft:h,actualBoundingBoxRight:p,actualBoundingBoxAscent:f,actualBoundingBoxDescent:m,fontBoundingBoxAscent:g,fontBoundingBoxDescent:v,width:y}=u.measureText(e),b=1.5,w=Math.ceil(Math.max(Math.abs(h)+Math.abs(p)||0,y)*b),_=Math.ceil(Math.max(Math.abs(f)+Math.abs(m)||200,Math.abs(g)+Math.abs(v)||200)*b);c=new OffscreenCanvas(w,_),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=d,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,w,_),u.fillStyle="black",u.fillText(e,.5*w/2,1.5*_/2);const x=bo(FE,this,zE).call(this,u.getImageData(0,0,w,_).data),E=bo(FE,this,qE).call(this,x),S=bo(FE,this,GE).call(this,E),A=bo(FE,this,BE).call(this,x,w,_,S);return this.processDrawnLines({lines:{curves:A,width:w,height:_},pageWidth:n,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,s){const[r,o,a]=bo(FE,this,JE).call(this,e),[l,c]=bo(FE,this,VE).call(this,r,o,a,Math.hypot(o,a)*bo(FE,this,KE)._.sigmaSFactor,bo(FE,this,KE)._.sigmaR,bo(FE,this,KE)._.kernelSize),u=bo(FE,this,GE).call(this,c),d=bo(FE,this,BE).call(this,l,o,a,u);return this.processDrawnLines({lines:{curves:d,width:o,height:a},pageWidth:t,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines(e){var t;let{lines:n,pageWidth:i,pageHeight:s,rotation:r,innerMargin:o,mustSmooth:a,areContours:l}=e;r%180!==0&&([i,s]=[s,i]);const{curves:c,width:u,height:d}=n,h=null!==(t=n.thickness)&&void 0!==t?t:0,p=[],f=Math.min(i/u,s/d),m=f/i,g=f/s,v=[];for(const{points:b}of c){const e=a?bo(FE,this,HE).call(this,b):b;if(!e)continue;v.push(e);const t=e.length,n=new Float32Array(t),i=new Float32Array(3*(2===t?2:t-2));if(p.push({line:i,points:n}),2===t){n[0]=e[0]*m,n[1]=e[1]*g,i.set([NaN,NaN,NaN,NaN,n[0],n[1]],0);continue}let[s,r,o,l]=e;s*=m,r*=g,o*=m,l*=g,n.set([s,r,o,l],0),i.set([NaN,NaN,NaN,NaN,s,r],0);for(let a=4;a<t;a+=2){const t=n[a]=e[a]*m,c=n[a+1]=e[a+1]*g;i.set(r_.createBezierPoints(s,r,o,l,t,c),3*(a-2)),[s,r,o,l]=[o,l,t,c]}}if(0===p.length)return null;const y=l?new DE:new CE;return y.build(p,i,s,1,r,l?0:h,o),{outline:y,newCurves:v,areContours:l,thickness:h,width:u,height:d}}static async compressSignature(e){let t,{outlines:n,areContours:i,thickness:s,width:r,height:o}=e,a=1/0,l=-1/0,c=0;for(const y of n){c+=y.length;for(let e=2,t=y.length;e<t;e++){const t=y[e]-y[e-2];a=Math.min(a,t),l=Math.max(l,t)}}t=a>=-128&&l<=127?Int8Array:a>=-32768&&l<=32767?Int16Array:Int32Array;const u=n.length,d=8+3*u,h=new Uint32Array(d);let p=0;h[p++]=d*Uint32Array.BYTES_PER_ELEMENT+(c-2*u)*t.BYTES_PER_ELEMENT,h[p++]=0,h[p++]=r,h[p++]=o,h[p++]=i?0:1,h[p++]=Math.max(0,Math.floor(null!==s&&void 0!==s?s:0)),h[p++]=u,h[p++]=t.BYTES_PER_ELEMENT;for(const y of n)h[p++]=y.length-2,h[p++]=y[0],h[p++]=y[1];const f=new CompressionStream("deflate-raw"),m=f.writable.getWriter();await m.ready,m.write(h);const g=t.prototype.constructor;for(const y of n){const e=new g(y.length-2);for(let t=2,n=y.length;t<n;t++)e[t-2]=y[t]-y[t-2];m.write(e)}m.close();const v=await new Response(f.readable).arrayBuffer();return el(new Uint8Array(v))}static async decompressSignature(e){try{const l=(o=e,Uint8Array.fromBase64?Uint8Array.fromBase64(o):Va(atob(o))),{readable:c,writable:u}=new DecompressionStream("deflate-raw"),d=u.getWriter();await d.ready,d.write(l).then(async()=>{await d.ready,await d.close()}).catch(()=>{});let h=null,p=0;var t,n=!1,i=!1;try{for(var s,r=function(e){var t,n,i,s=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);s--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new Eo(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(c);n=!(s=await r.next()).done;n=!1){const e=s.value;h||(h=new Uint8Array(new Uint32Array(e.buffer,0,4)[0])),h.set(e,p),p+=e.length}}catch(a){i=!0,t=a}finally{try{n&&null!=r.return&&await r.return()}finally{if(i)throw t}}const f=new Uint32Array(h.buffer,0,h.length>>2),m=f[1];if(0!==m)throw new Error("Invalid version: ".concat(m));const g=f[2],v=f[3],y=0===f[4],b=f[5],w=f[6],_=f[7],x=[],E=(8+3*w)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(_){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(h.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(h.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(h.buffer,E)}p=0;for(let e=0;e<w;e++){const t=f[3*e+8],n=new Float32Array(t+2);x.push(n);for(let i=0;i<2;i++)n[i]=f[3*e+8+i+1];for(let e=0;e<t;e++)n[e+2]=n[e]+S[p++]}return{areContours:y,thickness:b,outlines:x,width:g,height:v}}catch(l){return Ia("decompressSignature: ".concat(l)),null}var o}}function LE(e,t,n,i){return i-=t,0===(n-=e)?i>0?0:4:1===n?i+6:2-i}function jE(e,t,n,i,s,r,o){const a=bo(Bo,this,LE).call(this,n,i,s,r);for(let l=0;l<8;l++){const s=(-l+a-o+16)%8;if(0!==e[(n+bo(Bo,this,YE)._[2*s])*t+(i+bo(Bo,this,YE)._[2*s+1])])return s}return-1}function UE(e,t,n,i,s,r,o){const a=bo(Bo,this,LE).call(this,n,i,s,r);for(let l=0;l<8;l++){const s=(l+a+o+16)%8;if(0!==e[(n+bo(Bo,this,YE)._[2*s])*t+(i+bo(Bo,this,YE)._[2*s+1])])return s}return-1}function BE(e,t,n,i){const s=e.length,r=new Int32Array(s);for(let c=0;c<s;c++)r[c]=e[c]<=i?1:0;for(let c=1;c<n-1;c++)r[c*t]=r[c*t+t-1]=0;for(let c=0;c<t;c++)r[c]=r[t*n-1-c]=0;let o,a=1;const l=[];for(let c=1;c<n-1;c++){o=1;for(let e=1;e<t-1;e++){const n=c*t+e,i=r[n];if(0===i)continue;let s=c,u=e;if(1===i&&0===r[n-1])a+=1,u-=1;else{if(!(i>=1&&0===r[n+1])){1!==i&&(o=Math.abs(i));continue}a+=1,u+=1,i>1&&(o=i)}const d=[e,c],h=u===e+1,p={isHole:h,points:d,id:a,parent:0};let f;l.push(p);for(const e of l)if(e.id===o){f=e;break}f?f.isHole?p.parent=h?f.parent:o:p.parent=h?o:f.parent:p.parent=h?o:0;const m=bo(Bo,this,jE).call(this,r,t,c,e,s,u,0);if(-1===m){r[n]=-a,1!==r[n]&&(o=Math.abs(r[n]));continue}let g=bo(Bo,this,YE)._[2*m],v=bo(Bo,this,YE)._[2*m+1];const y=c+g,b=e+v;s=y,u=b;let w=c,_=e;for(;;){const i=bo(Bo,this,UE).call(this,r,t,w,_,s,u,1);g=bo(Bo,this,YE)._[2*i],v=bo(Bo,this,YE)._[2*i+1];const l=w+g,h=_+v;d.push(h,l);const p=w*t+_;if(0===r[p+1]?r[p]=-a:1===r[p]&&(r[p]=a),l===c&&h===e&&w===y&&_===b){1!==r[n]&&(o=Math.abs(r[n]));break}s=w,u=_,w=l,_=h}}}return l}function WE(e,t,n,i){if(n-t<=4){for(let s=t;s<n-2;s+=2)i.push(e[s],e[s+1]);return}const s=e[t],r=e[t+1],o=e[n-4]-s,a=e[n-3]-r,l=Math.hypot(o,a),c=o/l,u=a/l,d=c*r-u*s,h=a/o,p=1/l,f=Math.atan(h),m=Math.cos(f),g=Math.sin(f),v=p*(Math.abs(m)+Math.abs(g)),y=p*(1-v+v**2),b=Math.max(Math.atan(Math.abs(g+m)*y),Math.atan(Math.abs(g-m)*y));let w=0,_=t;for(let x=t+2;x<n-2;x+=2){const t=Math.abs(d-c*e[x+1]+u*e[x]);t>w&&(_=x,w=t)}w>(l*b)**2?(bo(Bo,this,WE).call(this,e,t,_+2,i),bo(Bo,this,WE).call(this,e,_,n,i)):i.push(s,r)}function HE(e){const t=[],n=e.length;return bo(Bo,this,WE).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}function VE(e,t,n,i,s,r){const o=new Float32Array(r**2),a=-2*i**2,l=r>>1;for(let f=0;f<r;f++){const e=(f-l)**2;for(let t=0;t<r;t++)o[f*r+t]=Math.exp((e+(t-l)**2)/a)}const c=new Float32Array(256),u=-2*s**2;for(let f=0;f<256;f++)c[f]=Math.exp(f**2/u);const d=e.length,h=new Uint8Array(d),p=new Uint32Array(256);for(let f=0;f<n;f++)for(let i=0;i<t;i++){const s=f*t+i,a=e[s];let u=0,d=0;for(let h=0;h<r;h++){const s=f+h-l;if(!(s<0||s>=n))for(let n=0;n<r;n++){const p=i+n-l;if(p<0||p>=t)continue;const f=e[s*t+p],m=o[h*r+n]*c[Math.abs(f-a)];u+=f*m,d+=m}}p[h[s]=Math.round(u/d)]++}return[h,p]}function qE(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}function zE(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let o=0,a=n.length;o<a;o++){const t=n[o]=e[o<<2];i=Math.max(i,t),s=Math.min(s,t)}const r=255/(i-s);for(let o=0,a=n.length;o<a;o++)n[o]=(n[o]-s)*r;return n}function GE(e){let t,n=-1/0,i=-1/0;const s=e.findIndex(e=>0!==e);let r=s,o=s;for(t=s;t<256;t++){const s=e[t];s>n&&(t-r>i&&(i=t-r,o=t-1),n=s,r=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t}function JE(e){const t=e,{width:n,height:i}=e,{maxDim:s}=bo(Bo,this,KE)._;let r=n,o=i;if(n>s||i>s){let a=n,l=i,c=Math.log2(Math.max(n,i)/s);const u=Math.floor(c);c=c===u?u-1:u;for(let n=0;n<c;n++){r=Math.ceil(a/2),o=Math.ceil(l/2);const n=new OffscreenCanvas(r,o);n.getContext("2d").drawImage(e,0,0,a,l,0,0,r,o),a=r,l=o,e!==t&&e.close(),e=n.transferToImageBitmap()}const d=Math.min(s/r,s/o);r=Math.round(r*d),o=Math.round(o*d)}const a=new OffscreenCanvas(r,o).getContext("2d",{willReadFrequently:!0});a.fillStyle="white",a.fillRect(0,0,r,o),a.filter="grayscale(1)",a.drawImage(e,0,0,e.width,e.height,0,0,r,o);const l=a.getImageData(0,0,r,o).data;return[bo(Bo,this,zE).call(this,l),r,o]}Bo=FE;var KE={_:{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}},YE={_:new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])};class $E extends Bx{constructor(){super(),super.updateProperties({fill:ah._defaultLineColor,"stroke-width":0})}clone(){const e=new $E;return e.updateAll(this),e}}class XE extends PE{constructor(e){super(e),super.updateProperties({stroke:ah._defaultLineColor,"stroke-width":1})}clone(){const e=new XE(this._viewParameters);return e.updateAll(this),e}}var QE=new WeakMap,ZE=new WeakMap,eS=new WeakMap,tS=new WeakMap;class nS extends qx{constructor(e){super(a(a({},e),{},{mustBeCommitted:!0,name:"signatureEditor"})),yo(this,QE,!1),yo(this,ZE,null),yo(this,eS,null),yo(this,tS,null),this._willKeepAspectRatio=!0,xo(eS,this,e.signatureData||null),xo(ZE,this,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){ah.initialize(e,t),this._defaultDrawingOptions=new $E,this._defaultDrawnSignatureOptions=new XE(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Oa(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!_o(ZE,this)}}static computeTelemetryFinalData(e){var t,n;const i=e.get("hasDescription");return{hasAltText:null!==(t=i.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),null===this._drawId)if(_o(eS,this)){const{lines:e,mustSmooth:t,areContours:n,description:i,uuid:s,heightInPage:r}=_o(eS,this),{rawDims:{pageWidth:o,pageHeight:a},rotation:l}=this.parent.viewport,c=FE.processDrawnLines({lines:e,pageWidth:o,pageHeight:a,rotation:l,innerMargin:nS._INNER_MARGIN,mustSmooth:t,areContours:n});this.addSignature(c,r,i,s)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:_o(ZE,this)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){xo(tS,this,e),this.addEditToolbar()}getUuid(){return _o(tS,this)}get description(){return _o(ZE,this)}set description(e){xo(ZE,this,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{null===t||void 0===t||t.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:s}=_o(eS,this),r=Math.max(i,s);return{areContours:t,outline:FE.processDrawnLines({lines:{curves:e.map(e=>({points:e})),thickness:n,width:i,height:s},pageWidth:r,pageHeight:r,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t}).outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:s,y:r}=this,{outline:o}=xo(eS,this,e);let a;xo(QE,this,o instanceof DE),this.description=n,_o(QE,this)?a=nS.getDefaultDrawingOptions():(a=nS._defaultDrawnSignatureOptions.clone(),a.updateProperties({"stroke-width":o.thickness})),this._addOutlines({drawOutlines:o,drawingOptions:a});const[,l]=this.pageDimensions;let c=t/l;c=c>=1?.5:c,this.width*=c/this.height,this.width>=1&&(c*=.9/this.width,this.width=.9),this.height=c,this.setDims(),this.x=s,this.y=r,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return FE.process(e,t,n,i,nS._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:s}=this.parent.viewport;return FE.extractContoursFromText(e,t,n,i,s,nS._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return FE.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:nS._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions(e){let{areContours:t,thickness:n}=e;t?this._drawingOptions=nS.getDefaultDrawingOptions():(this._drawingOptions=nS._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,s=Object.assign(super.serialize(e),{isSignature:!0,areContours:_o(QE,this),color:[0,0,0],thickness:_o(QE,this)?0:i});return this.addComment(s),e?(s.paths={lines:t,points:n},s.uuid=_o(tS,this),s.isCopy=!0):s.lines=t,_o(ZE,this)&&(s.accessibilityData={type:"Figure",alt:_o(ZE,this)}),s}static deserializeDraw(e,t,n,i,s,r){return r.areContours?DE.deserialize(e,t,n,i,s,r):CE.deserialize(e,t,n,i,s,r)}static async deserialize(e,t,n){var i;const s=await super.deserialize(e,t,n);return xo(QE,s,e.areContours),s.description=(null===(i=e.accessibilityData)||void 0===i?void 0:i.alt)||"",xo(tS,s,e.uuid),s}}r(nS,"_type","signature"),r(nS,"_editorType",ta.SIGNATURE),r(nS,"_defaultDrawingOptions",null);var iS=new WeakMap,sS=new WeakMap,rS=new WeakMap,oS=new WeakMap,aS=new WeakMap,lS=new WeakMap,cS=new WeakMap,uS=new WeakMap,dS=new WeakMap,hS=new WeakMap,pS=new WeakMap,fS=new WeakSet;class mS extends ah{constructor(e){super(a(a({},e),{},{name:"stampEditor"})),vo(this,fS),yo(this,iS,null),yo(this,sS,null),yo(this,rS,null),yo(this,oS,null),yo(this,aS,null),yo(this,lS,""),yo(this,cS,null),yo(this,uS,!1),yo(this,dS,null),yo(this,hS,!1),yo(this,pS,!1),xo(oS,this,e.bitmapUrl),xo(aS,this,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){ah.initialize(e,t)}static isHandlingMimeForPasting(e){return _l.includes(e)}static paste(e,t){t.pasteEditor({mode:ta.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!(null===(e=this.altTextData)||void 0===e||!e.altText)}}static computeTelemetryFinalData(e){var t,n;const i=e.get("hasAltText");return{hasAltText:null!==(t=i.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}async mlGuessAltText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:r}=e||this.copyCanvas(null,null,!0).imageData,o=await n.guess({name:"altText",request:{data:i,width:s,height:r,channels:i.length/(s*r)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const a=o.output;return await this.setGuessedAltText(a),t&&!this.hasAltTextData()&&(this.altTextData={alt:a,decorative:!1}),a}remove(){var e;_o(sS,this)&&(xo(iS,this,null),this._uiManager.imageManager.deleteId(_o(sS,this)),null===(e=_o(cS,this))||void 0===e||e.remove(),xo(cS,this,null),_o(dS,this)&&(clearTimeout(_o(dS,this)),xo(dS,this,null)));super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(_o(sS,this)&&null===_o(cS,this)&&bo(fS,this,yS).call(this),this.isAttachedToDOM||this.parent.add(this))):_o(sS,this)&&bo(fS,this,yS).call(this)}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(_o(rS,this)||_o(iS,this)||_o(oS,this)||_o(aS,this)||_o(sS,this)||_o(uS,this))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),_o(uS,this)||(_o(iS,this)?bo(fS,this,bS).call(this):bo(fS,this,yS).call(this)),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(xo(sS,this,n),i&&xo(iS,this,i),xo(uS,this,!1),bo(fS,this,bS).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==_o(dS,this)&&clearTimeout(_o(dS,this));xo(dS,this,setTimeout(()=>{xo(dS,this,null),bo(fS,this,_S).call(this)},200))}copyCanvas(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=224);const{width:i,height:s}=_o(iS,this),r=new wl;let o=_o(iS,this),a=i,l=s,c=null;if(t){if(i>t||s>t){const e=Math.min(t/i,t/s);a=Math.floor(i*e),l=Math.floor(s*e)}c=document.createElement("canvas");const e=c.width=Math.ceil(a*r.sx),n=c.height=Math.ceil(l*r.sy);_o(hS,this)||(o=bo(fS,this,wS).call(this,e,n));const u=c.getContext("2d");u.filter=this._uiManager.hcmFilter;let d="white",h="#cfcfd8";"none"!==this._uiManager.hcmFilter?h="black":xl.isDarkMode&&(d="#8f8f9d",h="#42414d");const p=15,f=p*r.sx,m=p*r.sy,g=new OffscreenCanvas(2*f,2*m),v=g.getContext("2d");v.fillStyle=d,v.fillRect(0,0,2*f,2*m),v.fillStyle=h,v.fillRect(0,0,f,m),v.fillRect(f,m,f,m),u.fillStyle=u.createPattern(g,"repeat"),u.fillRect(0,0,e,n),u.drawImage(o,0,0,o.width,o.height,0,0,e,n)}let u=null;if(n){let t,n;if(r.symmetric&&o.width<e&&o.height<e)t=o.width,n=o.height;else if(o=_o(iS,this),i>e||s>e){const r=Math.min(e/i,e/s);t=Math.floor(i*r),n=Math.floor(s*r),_o(hS,this)||(o=bo(fS,this,wS).call(this,t,n))}const a=new OffscreenCanvas(t,n).getContext("2d",{willReadFrequently:!0});a.drawImage(o,0,0,o.width,o.height,0,0,t,n),u={width:t,height:n,data:a.getImageData(0,0,t,n).data}}return{canvas:c,width:a,height:l,imageData:u}}static async deserialize(e,t,n){let i=null,s=!1;if(e instanceof Cw){var r;const{data:{rect:o,rotation:a,id:l,structParent:c,popupRef:u,richText:d,contentsObj:h,creationDate:p,modificationDate:f},container:m,parent:{page:{pageNumber:g}},canvas:v}=e;let y,b;v?(delete e.canvas,({id:y,bitmap:b}=n.imageManager.getFromCanvas(m.id,v)),v.remove()):(s=!0,e._hasNoCanvas=!0);const w=(null===(r=await t._structTree.getAriaAttributes("".concat(Qa).concat(l)))||void 0===r?void 0:r.get("aria-label"))||"";i=e={annotationType:ta.STAMP,bitmapId:y,bitmap:b,pageIndex:g-1,rect:o.slice(0),rotation:a,annotationElementId:l,id:l,deleted:!1,accessibilityData:{decorative:!1,altText:w},isSvg:!1,structParent:c,popupRef:u,richText:d,comment:(null===h||void 0===h?void 0:h.str)||null,creationDate:p,modificationDate:f}}const o=await super.deserialize(e,t,n),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:d,accessibilityData:h}=e;s?(n.addMissingCanvas(e.id,o),xo(uS,o,!0)):u&&n.imageManager.isValidId(u)?(xo(sS,o,u),l&&xo(iS,o,l)):xo(oS,o,c),xo(hS,o,d);const[p,f]=o.pageDimensions;return o.width=(a[2]-a[0])/p,o.height=(a[3]-a[1])/f,h&&(o.altTextData=h),o._initialData=i,e.comment&&o.setCommentData(e),xo(pS,o,!!i),o}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:_o(sS,this),isSvg:_o(hS,this)});if(this.addComment(n),e)return n.bitmapUrl=bo(fS,this,xS).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const e=bo(fS,this,ES).call(this,n);if(e.isSame)return null;var r;if(e.isSameAltText)delete n.accessibilityData;else n.accessibilityData.structParent=null!==(r=this._initialData.structParent)&&void 0!==r?r:-1;return n.id=this.annotationElementId,delete n.bitmapId,n}if(null===t)return n;t.stamps||(t.stamps=new Map);const o=_o(hS,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(_o(sS,this))){if(_o(hS,this)){const e=t.stamps.get(_o(sS,this));o>e.area&&(e.area=o,e.serialized.bitmap.close(),e.serialized.bitmap=bo(fS,this,xS).call(this,!1))}}else t.stamps.set(_o(sS,this),{area:o,serialized:n}),n.bitmap=bo(fS,this,xS).call(this,!1);return n}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}function gS(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(xo(iS,this,e.bitmap),t||(xo(sS,this,e.id),xo(hS,this,e.isSvg)),e.file&&xo(lS,this,e.file.name),bo(fS,this,bS).call(this)):this.remove()}function vS(){if(xo(rS,this,null),this._uiManager.enableWaiting(!1),_o(cS,this))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&_o(iS,this))this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&_o(iS,this)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch(e){}}this.div.focus()}}function yS(){if(_o(sS,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(_o(sS,this)).then(e=>bo(fS,this,gS).call(this,e,!0)).finally(()=>bo(fS,this,vS).call(this));if(_o(oS,this)){const e=_o(oS,this);return xo(oS,this,null),this._uiManager.enableWaiting(!0),void xo(rS,this,this._uiManager.imageManager.getFromUrl(e).then(e=>bo(fS,this,gS).call(this,e)).finally(()=>bo(fS,this,vS).call(this)))}if(_o(aS,this)){const e=_o(aS,this);return xo(aS,this,null),this._uiManager.enableWaiting(!0),void xo(rS,this,this._uiManager.imageManager.getFromFile(e).then(e=>bo(fS,this,gS).call(this,e)).finally(()=>bo(fS,this,vS).call(this)))}const e=document.createElement("input");e.type="file",e.accept=_l.join(",");const t=this._uiManager._signal;xo(rS,this,new Promise(n=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),bo(fS,this,gS).call(this,t)}else this.remove();n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>bo(fS,this,vS).call(this))),e.click()}function bS(){var e;const{div:t}=this;let{width:n,height:i}=_o(iS,this);const[s,r]=this.pageDimensions,o=.75;if(this.width)n=this.width*s,i=this.height*r;else if(n>o*s||i>o*r){const e=Math.min(o*s/n,o*r/i);n*=e,i*=e}this._uiManager.enableWaiting(!1);const a=xo(cS,this,document.createElement("canvas"));a.setAttribute("role","img"),this.addContainer(a),this.width=n/s,this.height=i/r,this.setDims(),null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),bo(fS,this,_S).call(this),_o(pS,this)||(this.parent.addUndoableEditor(this),xo(pS,this,!0)),this._reportTelemetry({action:"inserted_image"}),_o(lS,this)&&this.div.setAttribute("aria-description",_o(lS,this)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}function wS(e,t){const{width:n,height:i}=_o(iS,this);let s=n,r=i,o=_o(iS,this);for(;s>2*e||r>2*t;){const n=s,i=r;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const a=new OffscreenCanvas(s,r);a.getContext("2d").drawImage(o,0,0,n,i,0,0,s,r),o=a.transferToImageBitmap()}return o}function _S(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,s=new wl,r=Math.ceil(n*e*s.sx),o=Math.ceil(i*t*s.sy),a=_o(cS,this);if(!a||a.width===r&&a.height===o)return;a.width=r,a.height=o;const l=_o(hS,this)?_o(iS,this):bo(fS,this,wS).call(this,r,o),c=a.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,r,o)}function xS(e){if(e){if(_o(hS,this)){const e=this._uiManager.imageManager.getSvgUrl(_o(sS,this));if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=_o(iS,this));return e.getContext("2d").drawImage(_o(iS,this),0,0),e.toDataURL()}if(_o(hS,this)){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*sl.PDF_TO_CSS_UNITS),i=Math.round(this.height*t*sl.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(n,i);return s.getContext("2d").drawImage(_o(iS,this),0,0,_o(iS,this).width,_o(iS,this).height,0,0,n,i),s.transferToImageBitmap()}return structuredClone(_o(iS,this))}function ES(e){var t;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=e.pageIndex===n,r=((null===(t=e.accessibilityData)||void 0===t?void 0:t.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&r,isSameAltText:r}}r(mS,"_type","stamp"),r(mS,"_editorType",ta.STAMP);var SS=new WeakMap,AS=new WeakMap,CS=new WeakMap,TS=new WeakMap,kS=new WeakMap,IS=new WeakMap,NS=new WeakMap,PS=new WeakMap,MS=new WeakMap,RS=new WeakMap,OS=new WeakMap,DS=new WeakMap,FS=new WeakMap,LS=new WeakMap,jS=new WeakMap,US=new WeakMap,BS=new WeakSet;class WS{constructor(e){let{uiManager:t,pageIndex:n,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:u}=e;vo(this,BS),yo(this,SS,void 0),yo(this,AS,!1),yo(this,CS,null),yo(this,TS,null),yo(this,kS,null),yo(this,IS,new Map),yo(this,NS,!1),yo(this,PS,!1),yo(this,MS,!1),yo(this,RS,null),yo(this,OS,null),yo(this,DS,null),yo(this,FS,null),yo(this,LS,null),yo(this,jS,-1),yo(this,US,void 0);const d=[...KS._.values()];if(!WS._initialized){WS._initialized=!0;for(const e of d)e.initialize(u,t)}t.registerEditorTypes(d),xo(US,this,t),this.pageIndex=n,this.div=i,xo(SS,this,r),xo(CS,this,o),this.viewport=c,xo(DS,this,l),this.drawLayer=a,this._structTree=s,_o(US,this).addLayer(this)}get isEmpty(){return 0===_o(IS,this).size}get isInvisible(){return this.isEmpty&&_o(US,this).getMode()===ta.NONE}updateToolbar(e){_o(US,this).updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_o(US,this).getMode();switch(bo(BS,this,JS).call(this),e){case ta.NONE:return this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case ta.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ta.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===ta.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of KS._.values())t.toggle("".concat(n._type,"Editing"),e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===(null===(t=_o(DS,this))||void 0===t?void 0:t.div)}setEditingState(e){_o(US,this).setEditingState(e)}addCommands(e){_o(US,this).addCommands(e)}cleanUndoStack(e){_o(US,this).cleanUndoStack(e)}toggleDrawing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!e)}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=_o(CS,this))||void 0===e||e.togglePointerEvents(t)}async enable(){var e;xo(MS,this,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),null===(e=_o(LS,this))||void 0===e||e.abort(),xo(LS,this,null);const t=new Set;for(const i of wo(BS,this,HS))i.enableEditing(),i.show(!0),i.annotationElementId&&(_o(US,this).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const n=_o(CS,this);if(n)for(const i of n.getEditableAnnotations()){if(i.hide(),_o(US,this).isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=await this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}xo(MS,this,!1),_o(US,this)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(xo(PS,this,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),_o(DS,this)&&!_o(LS,this)){xo(LS,this,new AbortController);const e=_o(US,this).combinedSignal(_o(LS,this));_o(DS,this).div.addEventListener("pointerdown",e=>{const{clientX:t,clientY:n,timeStamp:i}=e;if(i-_o(jS,this)>500)return void xo(jS,this,i);xo(jS,this,-1);const{classList:s}=this.div;s.toggle("getElements",!0);const r=document.elementsFromPoint(t,n);if(s.toggle("getElements",!1),!this.div.contains(r[0]))return;let o;const a=new RegExp("^".concat(ea,"[0-9]+$"));for(const c of r)if(a.test(c.id)){o=c.id;break}if(!o)return;const l=_o(IS,this).get(o);null===(null===l||void 0===l?void 0:l.annotationElementId)&&(e.stopPropagation(),e.preventDefault(),l.dblclick(e))},{signal:e,capture:!0})}const e=_o(CS,this),t=[];if(e){const i=new Map,s=new Map;for(const e of wo(BS,this,HS)){var n;e.disableEditing(),e.annotationElementId?null===e.serialize()?(s.set(e.annotationElementId,e),null===(n=this.getEditableAnnotation(e.annotationElementId))||void 0===n||n.show(),e.remove()):i.set(e.annotationElementId,e):t.push(e)}const r=e.getEditableAnnotations();for(const e of r){const{id:t}=e.data;if(_o(US,this).isDeletedAnnotationElement(t)){e.updateEdited({deleted:!0});continue}let n=s.get(t);n?(n.resetAnnotationElement(e),n.show(!1),e.show()):(n=i.get(t),n&&(_o(US,this).addChangedExistingAnnotation(n),n.renderAnnotationElement(e)&&n.show(!1)),e.show())}}bo(BS,this,JS).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of KS._.values())i.remove("".concat(s._type,"Editing"));this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),null===e||void 0===e||e.updateFakeAnnotations(t),xo(PS,this,!1)}getEditableAnnotation(e){var t;return(null===(t=_o(CS,this))||void 0===t?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){_o(US,this).getActive()!==e&&_o(US,this).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,null!==(e=_o(DS,this))&&void 0!==e&&e.div&&!_o(FS,this)){xo(FS,this,new AbortController);const e=_o(US,this).combinedSignal(_o(FS,this));_o(DS,this).div.addEventListener("pointerdown",bo(BS,this,VS).bind(this),{signal:e}),_o(DS,this).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,null!==(e=_o(DS,this))&&void 0!==e&&e.div&&_o(FS,this)&&(_o(FS,this).abort(),xo(FS,this,null),_o(DS,this).div.classList.remove("highlighting"))}enableClick(){if(_o(TS,this))return;xo(TS,this,new AbortController);const e=_o(US,this).combinedSignal(_o(TS,this));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;null===(e=_o(TS,this))||void 0===e||e.abort(),xo(TS,this,null)}attach(e){_o(IS,this).set(e.id,e);const{annotationElementId:t}=e;t&&_o(US,this).isDeletedAnnotationElement(t)&&_o(US,this).removeDeletedAnnotationElement(e)}detach(e){var t;_o(IS,this).delete(e.id),null===(t=_o(SS,this))||void 0===t||t.removePointerInTextLayer(e.contentDiv),!_o(PS,this)&&e.annotationElementId&&_o(US,this).addDeletedAnnotationElement(e)}remove(e){this.detach(e),_o(US,this).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(_o(US,this).addDeletedAnnotationElement(e),ah.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),null===(t=e.parent)||void 0===t||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),_o(US,this).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!_o(MS,this)),_o(US,this).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var t;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!_o(kS,this)&&(e._focusEventsAllowed=!1,xo(kS,this,setTimeout(()=>{xo(kS,this,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:_o(US,this)._signal}),n.focus())},0))),e._structTreeParentId=null===(t=_o(SS,this))||void 0===t?void 0:t.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getEditorByUID(e){for(const t of _o(IS,this).values())if(t.uid===e)return t;return null}getNextId(){return _o(US,this).getId()}combinedSignal(e){return _o(US,this).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return null===(e=wo(BS,this,qS))||void 0===e?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await _o(US,this).updateMode(e.mode);const{offsetX:n,offsetY:i}=bo(BS,this,GS).call(this),s=this.getNextId(),r=bo(BS,this,zS).call(this,a({parent:this,id:s,x:n,y:i,uiManager:_o(US,this),isCentered:!0},t));r&&this.add(r)}async deserialize(e){var t,n;return await(null===(t=KS._.get(null!==(n=e.annotationType)&&void 0!==n?n:e.annotationEditorType))||void 0===t?void 0:t.deserialize(e,this,_o(US,this)))||null}createAndAddNewEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getNextId(),s=bo(BS,this,zS).call(this,a({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:_o(US,this),isCentered:t},n));return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.createAndAddNewEditor(bo(BS,this,GS).call(this),!0,e)}setSelected(e){_o(US,this).setSelected(e)}toggleSelected(e){_o(US,this).toggleSelected(e)}unselect(e){_o(US,this).unselect(e)}pointerup(e){var t;const{isMac:n}=qa.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(!_o(NS,this))return;if(xo(NS,this,!1),null!==(t=wo(BS,this,qS))&&void 0!==t&&t.isDrawer&&wo(BS,this,qS).supportMultipleDrawings)return;if(!_o(AS,this))return void xo(AS,this,!0);const i=_o(US,this).getMode();i!==ta.STAMP&&i!==ta.SIGNATURE?this.createAndAddNewEditor(e,!1):_o(US,this).unselectAll()}pointerdown(e){var t;if(_o(US,this).getMode()===ta.HIGHLIGHT&&this.enableTextSelection(),_o(NS,this))return void xo(NS,this,!1);const{isMac:n}=qa.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(xo(NS,this,!0),null!==(t=wo(BS,this,qS))&&void 0!==t&&t.isDrawer)return void this.startDrawingSession(e);const i=_o(US,this).getActive();xo(AS,this,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),_o(RS,this))return void wo(BS,this,qS).startDrawing(this,_o(US,this),!1,e);_o(US,this).setCurrentDrawingSession(this),xo(RS,this,new AbortController);const t=_o(US,this).combinedSignal(_o(RS,this));this.div.addEventListener("blur",e=>{let{relatedTarget:t}=e;t&&!this.div.contains(t)&&(xo(OS,this,null),this.commitOrRemove())},{signal:t}),wo(BS,this,qS).startDrawing(this,_o(US,this),!1,e)}pause(e){if(e){const{activeElement:e}=document;return void(this.div.contains(e)&&xo(OS,this,e))}_o(OS,this)&&setTimeout(()=>{var e;null===(e=_o(OS,this))||void 0===e||e.focus(),xo(OS,this,null)},0)}endDrawingSession(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _o(RS,this)?(_o(US,this).setCurrentDrawingSession(null),_o(RS,this).abort(),xo(RS,this,null),xo(OS,this,null),wo(BS,this,qS).endDrawing(e)):null}findNewParent(e,t,n){const i=_o(US,this).findParent(t,n);return null!==i&&i!==this&&(i.changeParent(e),!0)}commitOrRemove(){return!!_o(RS,this)&&(this.endDrawingSession(),!0)}onScaleChanging(){_o(RS,this)&&wo(BS,this,qS).onScaleChangingWhenDrawing(this)}destroy(){var e;this.commitOrRemove(),(null===(e=_o(US,this).getActive())||void 0===e?void 0:e.parent)===this&&(_o(US,this).commitOrRemove(),_o(US,this).setActiveEditor(null)),_o(kS,this)&&(clearTimeout(_o(kS,this)),xo(kS,this,null));for(const n of _o(IS,this).values()){var t;null===(t=_o(SS,this))||void 0===t||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove()}this.div=null,_o(IS,this).clear(),_o(US,this).removeLayer(this)}render(e){let{viewport:t}=e;this.viewport=t,bl(this.div,t);for(const n of _o(US,this).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update(e){let{viewport:t}=e;_o(US,this).commitOrRemove(),bo(BS,this,JS).call(this);const n=this.viewport.rotation,i=t.rotation;if(this.viewport=t,bl(this.div,{rotation:i}),n!==i)for(const s of _o(IS,this).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return _o(US,this).viewParameters.realScale}}function HS(e){return 0!==_o(IS,e).size?_o(IS,e).values():_o(US,e).getEditors(e.pageIndex)}function VS(e){_o(US,this).unselectAll();const{target:t}=e;if(t===_o(DS,this).div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&_o(DS,this).div.contains(t)){const{isMac:t}=qa.platform;if(0!==e.button||e.ctrlKey&&t)return;_o(US,this).showAllEditors("highlight",!0,!0),_o(DS,this).div.classList.add("free"),this.toggleDrawing(),xx.startHighlighting(this,"ltr"===_o(US,this).direction,{target:_o(DS,this).div,x:e.x,y:e.y}),_o(DS,this).div.addEventListener("pointerup",()=>{_o(DS,this).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:_o(US,this)._signal}),e.preventDefault()}}function qS(e){return KS._.get(_o(US,e).getMode())}function zS(e){const t=wo(BS,this,qS);return t?new t.prototype.constructor(e):null}function GS(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,s=Math.max(0,e),r=Math.max(0,t),o=(s+Math.min(window.innerWidth,e+n))/2-e,a=(r+Math.min(window.innerHeight,t+i))/2-t,[l,c]=this.viewport.rotation%180===0?[o,a]:[a,o];return{offsetX:l,offsetY:c}}function JS(){for(const e of _o(IS,this).values())e.isEmpty()&&e.remove()}r(WS,"_initialized",!1);var KS={_:new Map([Yw,RE,mS,xx,nS].map(e=>[e._editorType,e]))},YS=new WeakMap,$S=new WeakMap,XS=new WeakMap,QS=new WeakSet;class ZS{constructor(e){let{pageIndex:t}=e;vo(this,QS),yo(this,YS,null),yo(this,$S,new Map),yo(this,XS,new Map),this.pageIndex=t}setParent(e){if(_o(YS,this)){if(_o(YS,this)!==e){if(_o($S,this).size>0)for(const t of _o($S,this).values())t.remove(),e.append(t);xo(YS,this,e)}}else xo(YS,this,e)}static get _svgFactory(){return Oa(this,"_svgFactory",new Gy)}draw(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=(sA._=(t=sA._,n=t++,t),n),o=bo(QS,this,tA).call(this),a=ZS._svgFactory.createElement("defs");o.append(a);const l=ZS._svgFactory.createElement("path");a.append(l);const c="path_p".concat(this.pageIndex,"_").concat(r);l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),i&&_o(XS,this).set(r,l);const u=s?bo(QS,this,nA).call(this,a,c):null,d=ZS._svgFactory.createElement("use");return o.append(d),d.setAttribute("href","#".concat(c)),this.updateProperties(o,e),_o($S,this).set(r,o),{id:r,clipPathId:"url(#".concat(u,")")}}drawOutline(e,t){var n,i;const s=(sA._=(n=sA._,i=n++,n),i),r=bo(QS,this,tA).call(this),o=ZS._svgFactory.createElement("defs");r.append(o);const a=ZS._svgFactory.createElement("path");o.append(a);const l="path_p".concat(this.pageIndex,"_").concat(s);let c;if(a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t){const e=ZS._svgFactory.createElement("mask");o.append(e),c="mask_p".concat(this.pageIndex,"_").concat(s),e.setAttribute("id",c),e.setAttribute("maskUnits","objectBoundingBox");const t=ZS._svgFactory.createElement("rect");e.append(t),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill","white");const n=ZS._svgFactory.createElement("use");e.append(n),n.setAttribute("href","#".concat(l)),n.setAttribute("stroke","none"),n.setAttribute("fill","black"),n.setAttribute("fill-rule","nonzero"),n.classList.add("mask")}const u=ZS._svgFactory.createElement("use");r.append(u),u.setAttribute("href","#".concat(l)),c&&u.setAttribute("mask","url(#".concat(c,")"));const d=u.cloneNode();return r.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(r,e),_o($S,this).set(s,r),s}finalizeDraw(e,t){_o(XS,this).delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:s,path:r}=t,o="number"===typeof e?_o($S,this).get(e):e;if(o){if(n&&bo(QS,this,iA).call(this,o,n),i&&eA.call(ZS,o,i),s){const{classList:e}=o;for(const[t,n]of Object.entries(s))e.toggle(t,n)}if(r){const e=o.firstElementChild.firstElementChild;bo(QS,this,iA).call(this,e,r)}}}updateParent(e,t){if(t===this)return;const n=_o($S,this).get(e);n&&(_o(YS,t).append(n),_o($S,this).delete(e),_o($S,t).set(e,n))}remove(e){_o(XS,this).delete(e),null!==_o(YS,this)&&(_o($S,this).get(e).remove(),_o($S,this).delete(e))}destroy(){xo(YS,this,null);for(const e of _o($S,this).values())e.remove();_o($S,this).clear(),_o(XS,this).clear()}}function eA(e,t){let[n,i,s,r]=t;const{style:o}=e;o.top="".concat(100*i,"%"),o.left="".concat(100*n,"%"),o.width="".concat(100*s,"%"),o.height="".concat(100*r,"%")}function tA(){const e=Wo._svgFactory.create(1,1,!0);return _o(YS,this).append(e),e.setAttribute("aria-hidden",!0),e}function nA(e,t){const n=Wo._svgFactory.createElement("clipPath");e.append(n);const i="clip_".concat(t);n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=Wo._svgFactory.createElement("use");return n.append(s),s.setAttribute("href","#".concat(t)),s.classList.add("clip"),i}function iA(e,t){for(const[n,i]of Object.entries(t))null===i?e.removeAttribute(n):e.setAttribute(n,i)}Wo=ZS;var sA={_:0};globalThis._pdfjsTestingUtils={HighlightOutliner:G_},globalThis.pdfjsLib={AbortException:Wa,AnnotationEditorLayer:WS,AnnotationEditorParamsType:na,AnnotationEditorType:ta,AnnotationEditorUIManager:bu,AnnotationLayer:Bw,AnnotationMode:Zo,AnnotationType:ha,applyOpacity:function(e,t,n,i){const s=255*(1-(i=Math.min(Math.max(null!==i&&void 0!==i?i:1,0),1)));return[e=Math.round(e*i+s),t=Math.round(t*i+s),n=Math.round(n*i+s)]},build:"50cc4adac",ColorPicker:Iy,createValidAbsoluteUrl:Ma,CSSConstants:class{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Oa(this,"commentForegroundColor",gl(n))}},DOMSVGFactory:Gy,DrawLayer:ZS,FeatureTest:qa,fetchData:rl,findContrastColor:function(e,t){const n=e[0]+256*e[1]+65536*e[2]+16777216*t[0]+4294967296*t[1]+1099511627776*t[2];let i=Tl.get(n);if(i)return i;const s=new Float32Array(9),r=s.subarray(0,3),o=s.subarray(3,6);El(e,o);const a=s.subarray(6,9);El(t,a);const l=a[2]<.5,c=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),Cl(o,a,r)<c){let e,t;l?(e=o[2],t=1):(e=0,t=o[2]);const n=.005;for(;t-e>n;){const n=o[2]=(e+t)/2;l===Cl(o,a,r)<c?e=n:t=n}o[2]=l?t:e}return Sl(o,r),i=Ga.makeHexColor(Math.round(255*r[0]),Math.round(255*r[1]),Math.round(255*r[2])),Tl.set(n,i),i},getDocument:Nv,getFilenameFromUrl:function(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)},getPdfFilenameFromUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(ll(e))return Ia('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(e=>{try{return new URL(e)}catch(t){try{return new URL(decodeURIComponent(e))}catch(n){try{return new URL(e,"https://foo.bar")}catch(i){try{return new URL(decodeURIComponent(e),"https://foo.bar")}catch(s){return null}}}}})(e);if(!n)return t;const i=e=>{try{let t=decodeURIComponent(e);return t.includes("/")?(t=t.split("/").at(-1),t.test(/^\.pdf$/i)?t:e):t}catch(t){return e}},s=/\.pdf$/i,r=n.pathname.split("/").at(-1);if(s.test(r))return i(r);if(n.searchParams.size>0){const e=Array.from(n.searchParams.values()).reverse();for(const n of e)if(s.test(n))return i(n);const t=Array.from(n.searchParams.keys()).reverse();for(const n of t)if(s.test(n))return i(n)}if(n.hash){const e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(e)return i(e[0])}return t},getRGB:gl,getUuid:Xa,getXfaPageViewport:function(e,t){let{scale:n=1,rotation:i=0}=t;const{width:s,height:r}=e.attributes.style,o=[0,0,parseInt(s),parseInt(r)];return new ol({viewBox:o,userUnit:1,scale:n,rotation:i})},GlobalWorkerOptions:og,ImageKind:da,InvalidPDFException:ja,isDataScheme:ll,isPdfFile:cl,isValidExplicitDest:Np,MathClamp:Za,noContextMenu:hl,normalizeUnicode:function(e){return Ya||(Ya=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,$a=new Map([["\ufb05","\u017ft"]])),e.replaceAll(Ya,(e,t,n)=>t?t.normalize("NFKC"):$a.get(n))},OPS:ba,OutputScale:wl,PasswordResponses:{NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PDFDataRangeTransport:jv,PDFDateString:fl,PDFWorker:Yv,PermissionFlag:{PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},PixelsPerInch:sl,RenderingCancelledException:al,renderRichText:kl,ResponseException:Ua,setLayerDimensions:bl,shadow:Oa,SignatureExtractor:FE,stopEvent:pl,SupportedImageMimeTypes:_l,TextLayer:vv,TouchManager:Nd,updateUrlHash:Ra,Util:Ga,VerbosityLevel:ya,version:vy,XfaLayer:nl},og.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(vy,"/pdf.worker.min.js");const rA=t=>{let{onOCRComplete:n,onPDFLoaded:i}=t;const[s,r]=(0,e.useState)(null),[o,a]=(0,e.useState)(!1),[l,c]=(0,e.useState)(""),[u,d]=(0,e.useState)(1),[h,p]=(0,e.useState)(0),[f,m]=(0,e.useState)(0),g=(0,e.useRef)(null),v=async(e,t)=>{try{const n=await e.getPage(t),i=n.getViewport({scale:2}),s=g.current;if(!s)return;const r=s.getContext("2d");if(!r)return;s.width=i.width,s.height=i.height,await n.render({canvasContext:r,viewport:i}).promise,d(t)}catch(n){console.error("Erro ao renderizar:",n)}},y=async e=>{if(!s)return;const t="prev"===e?u-1:u+1;if(t>=1&&t<=h){const e=await s.arrayBuffer(),n=await Nv({data:e}).promise;v(n,t)}};return(0,Qr.jsxs)("div",{className:"h-full flex flex-col bg-white",children:[(0,Qr.jsxs)("div",{className:"border-b border-slate-200 p-6 bg-gradient-to-r from-slate-50 to-slate-100",children:[(0,Qr.jsx)("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Visualizador de PDF"}),(0,Qr.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,Qr.jsxs)("label",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium cursor-pointer hover:bg-blue-700 transition text-sm",children:["Selecionar PDF",(0,Qr.jsx)("input",{type:"file",accept:".pdf",onChange:async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n&&"application/pdf"===n.type){r(n);try{const e=await n.arrayBuffer(),t=await Nv({data:e}).promise;p(t.numPages),d(1),v(t,1),i()}catch(s){console.error("Erro ao carregar PDF:",s),alert("Erro ao carregar PDF")}}},className:"hidden"})]}),s&&(0,Qr.jsxs)(Qr.Fragment,{children:[(0,Qr.jsx)("span",{className:"text-sm text-slate-700 font-medium",children:s.name}),h>0&&(0,Qr.jsx)("button",{onClick:async()=>{if(s){a(!0),m(0);try{const e=await s.arrayBuffer(),t=await Nv({data:e}).promise;let i="";for(let n=1;n<=t.numPages;n++){const e=await t.getPage(n),s=(await e.getTextContent()).items.map(e=>e.str).join(" ");i+="\n\n[P\xe1gina ".concat(n,"]\n").concat(s),m(Math.round(n/t.numPages*100))}c(i),n(i),m(100)}catch(e){console.error("Erro ao extrair texto:",e),alert("Erro ao processar PDF")}finally{a(!1)}}},disabled:o,className:"px-6 py-2 rounded-lg font-medium text-sm transition-all ".concat(o?"bg-slate-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:o?"Extraindo ".concat(f,"%..."):"Extrair Texto"})]})]})]}),(0,Qr.jsx)("div",{className:"flex-1 overflow-y-auto bg-slate-50",children:s?(0,Qr.jsxs)("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[(0,Qr.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[(0,Qr.jsx)("div",{className:"relative bg-slate-900 aspect-video flex items-center justify-center",children:(0,Qr.jsx)("canvas",{ref:g,className:"max-w-full max-h-full"})}),h>1&&(0,Qr.jsxs)("div",{className:"bg-slate-50 border-t border-slate-200 p-4 flex items-center justify-between",children:[(0,Qr.jsx)("button",{onClick:()=>y("prev"),disabled:1===u,className:"px-3 py-2 bg-slate-200 text-slate-700 rounded text-sm disabled:opacity-50",children:"Anterior"}),(0,Qr.jsxs)("span",{className:"text-sm font-medium",children:["P\xe1gina ",u," de ",h]}),(0,Qr.jsx)("button",{onClick:()=>y("next"),disabled:u===h,className:"px-3 py-2 bg-slate-200 text-slate-700 rounded text-sm disabled:opacity-50",children:"Pr\xf3ximo"})]})]}),l&&(0,Qr.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-6",children:[(0,Qr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Qr.jsx)("h3",{className:"text-lg font-bold text-slate-900",children:"Texto Extra\xeddo"}),(0,Qr.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(l),alert("Texto copiado")},className:"px-4 py-2 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200",children:"Copiar"})]}),(0,Qr.jsx)("div",{className:"bg-slate-50 p-4 rounded border border-slate-200 max-h-64 overflow-y-auto font-mono text-sm text-slate-700 whitespace-pre-wrap",children:l})]})]}):(0,Qr.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,Qr.jsx)("div",{className:"text-center",children:(0,Qr.jsx)("p",{className:"text-lg text-slate-600 font-medium",children:"Selecione um PDF"})})})})]})},oA=t=>{let{data:n,readOnly:i=!0}=t;const[s,r]=(0,e.useState)(new Set),[o,a]=(0,e.useState)(""),[l,c]=(0,e.useState)(!1),u=e=>{r(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},d=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null===t||void 0===t)return(0,Qr.jsx)("span",{className:"text-slate-400",children:String(t)});if("boolean"===typeof t)return(0,Qr.jsx)("span",{className:"text-purple-600 font-medium",children:String(t)});if("number"===typeof t)return(0,Qr.jsx)("span",{className:"text-cyan-600 font-medium",children:t});if("string"===typeof t)return t.length>50&&!o?(0,Qr.jsxs)("span",{className:"text-green-600",children:['"',t.substring(0,47),'..."']}):(0,Qr.jsxs)("span",{className:"text-green-600",children:['"',t,'"']});if(Array.isArray(t)){const i=s.has(e);return(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("span",{className:"cursor-pointer text-slate-700 hover:text-blue-600",onClick:()=>u(e),children:[i?"\u25bc":"\u25b6"," ",(0,Qr.jsxs)("span",{className:"text-slate-600",children:["[",t.length," items]"]})]}),i&&(0,Qr.jsx)("div",{className:"ml-4 mt-1 text-xs",children:t.map((t,i)=>(0,Qr.jsxs)("div",{className:"text-slate-700",children:[(0,Qr.jsxs)("span",{className:"text-orange-600",children:["[",i,"]"]}),": ",d("".concat(e,"[").concat(i,"]"),t,n+1)]},i))})]})}if("object"===typeof t){const i=s.has(e),r=Object.keys(t);return(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("span",{className:"cursor-pointer text-slate-700 hover:text-blue-600",onClick:()=>u(e),children:[i?"\u25bc":"\u25b6"," ",(0,Qr.jsxs)("span",{className:"text-slate-600",children:[r.length," keys"]})]}),i&&(0,Qr.jsx)("div",{className:"ml-4 mt-1",children:r.map(i=>(0,Qr.jsxs)("div",{className:"text-xs text-slate-700 my-1",children:[(0,Qr.jsxs)("span",{className:"text-blue-600",children:['"',i,'"']}),": ",d("".concat(e,".").concat(i),t[i],n+1)]},i))})]})}return(0,Qr.jsx)("span",{className:"text-slate-500",children:String(t)})};return(0,Qr.jsxs)("div",{className:"h-full flex flex-col bg-white",children:[(0,Qr.jsxs)("div",{className:"border-b border-slate-200 p-4",children:[(0,Qr.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Qr.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Estrutura de Dados"}),(0,Qr.jsxs)("div",{className:"flex gap-2",children:[(0,Qr.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(n,null,2)),c(!0),setTimeout(()=>c(!1),2e3)},className:"px-3 py-1 bg-slate-100 text-slate-700 rounded text-sm hover:bg-slate-200 transition",children:l?"\u2713 Copiado":"Copiar JSON"}),(0,Qr.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n,null,2))),e.setAttribute("download","prestacao-contas.json"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition",children:"Download JSON"})]})]}),(0,Qr.jsx)("input",{type:"text",placeholder:"Buscar campos...",value:o,onChange:e=>a(e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm"})]}),(0,Qr.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50",children:(0,Qr.jsx)("div",{className:"font-mono text-xs",children:(0,Qr.jsx)("div",{className:"text-slate-700 bg-white p-4 rounded border border-slate-200 max-w-3xl",children:(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("span",{className:"text-slate-600",children:"{"}),(0,Qr.jsx)("div",{className:"ml-4",children:Object.entries(n).map((e,t)=>{let[n,i]=e;return(0,Qr.jsxs)("div",{className:"text-slate-700 my-1",children:[(0,Qr.jsxs)("span",{className:"text-blue-600",children:['"',n,'"']}),(0,Qr.jsx)("span",{className:"text-slate-600",children:": "}),d(n,i),(0,Qr.jsx)("span",{className:"text-slate-600",children:","})]},n)})}),(0,Qr.jsx)("span",{className:"text-slate-600",children:"}"})]})})})}),(0,Qr.jsxs)("div",{className:"border-t border-slate-200 bg-slate-50 px-4 py-2 text-xs text-slate-600",children:[Object.keys(n).length," campos \u2022 \xdaltima atualiza\xe7\xe3o: ",(new Date).toLocaleTimeString()]})]})};var aA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lA=["color","size","strokeWidth","absoluteStrokeWidth","children"];var cA=(t,n)=>{const i=(0,e.forwardRef)((i,s)=>{let{color:r="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:c,children:u}=i,d=function(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}(i,lA);return(0,e.createElement)("svg",a(a({ref:s},aA),{},{width:o,height:o,stroke:r,strokeWidth:c?24*Number(l)/Number(o):l,className:"lucide lucide-".concat((h=t,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},d),[...n.map(t=>{let[n,i]=t;return(0,e.createElement)(n,i)}),...(Array.isArray(u)?u:[u])||[]]);var h});return i.displayName="".concat(t),i};const uA=cA("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),dA=cA("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),hA=cA("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),pA=cA("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),fA=()=>{const[t,n]=(0,e.useState)({}),[i,s]=(0,e.useState)({1:!0}),[r]=(0,e.useState)({}),o=(0,e.useCallback)(e=>{s(t=>a(a({},t),{},{[e]:!t[e]}))},[]),l=(0,e.useCallback)((e,t)=>{n(n=>{const i=e.split(".");let s=n;for(let e=0;e<i.length-1;e++)s[i[e]]||(s[i[e]]={}),s=s[i[e]];return s[i[i.length-1]]=t,a({},n)})},[]),c=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=n.split(".").reduce((e,t)=>null===e||void 0===e?void 0:e[t],t)||"",o="w-full px-3 py-2 text-sm border border-slate-300 rounded bg-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500";return"checkbox"===i?(0,Qr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Qr.jsx)("input",{type:"checkbox",id:n,checked:r||!1,onChange:e=>l(n,e.target.checked),className:"w-4 h-4 rounded border-slate-300"}),(0,Qr.jsxs)("label",{htmlFor:n,className:"text-sm font-medium text-slate-900",children:[e,s&&(0,Qr.jsx)("span",{className:"text-red-600",children:"*"})]})]}):"textarea"===i?(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("label",{className:"block text-sm font-medium text-slate-900 mb-1",children:[e,s&&(0,Qr.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,Qr.jsx)("textarea",{value:r,onChange:e=>l(n,e.target.value),className:"".concat(o," resize-none h-24")})]}):(0,Qr.jsxs)("div",{children:[(0,Qr.jsxs)("label",{className:"block text-sm font-medium text-slate-900 mb-1",children:[e,s&&(0,Qr.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,Qr.jsx)("input",{type:i,value:r,onChange:e=>l(n,e.target.value),className:o})]})},u=(e,t,n,s,a)=>{const l=i[e],c=r[e];return(0,Qr.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden mb-4",children:[(0,Qr.jsxs)("button",{onClick:()=>o(e),className:"w-full px-4 py-3 flex items-center justify-between bg-slate-50 hover:bg-slate-100 transition",children:[(0,Qr.jsxs)("div",{className:"flex items-center gap-3 flex-1 text-left",children:[(0,Qr.jsx)("div",{className:"flex-shrink-0",children:l?(0,Qr.jsx)(uA,{className:"w-5 h-5 text-slate-600"}):(0,Qr.jsx)(dA,{className:"w-5 h-5 text-slate-600"})}),(0,Qr.jsxs)("div",{className:"flex-1",children:[(0,Qr.jsxs)("h3",{className:"text-sm font-bold text-slate-900",children:[e,". ",t]}),(0,Qr.jsx)("p",{className:"text-xs text-slate-600 mt-0.5",children:n})]}),s&&(0,Qr.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Obrigat\xf3rio"})]}),(null===c||void 0===c?void 0:c.completed)&&(0,Qr.jsx)(hA,{className:"w-5 h-5 text-green-600 flex-shrink-0 ml-2"}),(null===c||void 0===c?void 0:c.warnings)&&c.warnings.length>0&&(0,Qr.jsx)(pA,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 ml-2"})]}),l&&(0,Qr.jsx)("div",{className:"px-4 py-4 border-t border-slate-200 bg-white",children:a})]},e)};return(0,Qr.jsxs)("div",{className:"w-full max-w-5xl mx-auto p-4 bg-slate-100 min-h-screen",children:[(0,Qr.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6 border-l-4 border-blue-600",children:[(0,Qr.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Presta\xe7\xe3o de Contas"}),(0,Qr.jsx)("p",{className:"text-slate-600",children:"Preencha todos os campos obrigat\xf3rios marcados com *"})]}),(0,Qr.jsxs)("div",{className:"space-y-4",children:[u(1,"Descritor","Identifica\xe7\xe3o geral da presta\xe7\xe3o de contas (exerc\xedcio, \xf3rg\xe3o, tipo de ajuste, per\xedodo, etc.)",!0,(0,Qr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[c("Exerc\xedcio","descritor.exercicio","text",!0),c("\xd3rg\xe3o","descritor.orgao","text",!0),c("Tipo de Ajuste","descritor.tipoAjuste","text",!0),c("Per\xedodo","descritor.periodo","text",!0)]})),u(2,"C\xf3digo do Ajuste","C\xf3digo identificador do conv\xeanio/ajuste conforme AUDESP",!0,(0,Qr.jsx)("div",{className:"grid grid-cols-1 gap-4",children:c("C\xf3digo","codigoAjuste","text",!0)})),u(3,"Retifica\xe7\xe3o","Indica se a presta\xe7\xe3o \xe9 original (false) ou retificadora (true)",!1,(0,Qr.jsx)("div",{className:"grid grid-cols-1 gap-4",children:c("Retificadora","retificacao","checkbox",!1)})),u(4,"Rela\xe7\xe3o de Empregados","Lista de empregados vinculados \xe0 execu\xe7\xe3o do conv\xeanio",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de empregados"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Empregado"})]})),u(5,"Rela\xe7\xe3o de Bens","Bens adquiridos com recursos do conv\xeanio (m\xf3veis e im\xf3veis)",!1,(0,Qr.jsxs)("div",{className:"space-y-6",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Bens M\xf3veis"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Bem M\xf3vel"})]}),(0,Qr.jsxs)("div",{className:"border-t border-slate-200 pt-6",children:[(0,Qr.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Bens Im\xf3veis"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Bem Im\xf3vel"})]})]})),u(6,"Contratos","Contratos firmados para execu\xe7\xe3o do objeto",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de contratos"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Contrato"})]})),u(7,"Documentos Fiscais","Notas fiscais, faturas e documentos equivalentes",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de documentos"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Documento Fiscal"})]})),u(8,"Pagamentos","Pagamentos efetuados no \xe2mbito do conv\xeanio",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de pagamentos"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Pagamento"})]})),u(9,"Disponibilidades","Saldos financeiros, aplica\xe7\xf5es e conta banc\xe1ria do conv\xeanio",!1,(0,Qr.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[c("Saldo Banc\xe1rio","disponibilidades.saldoBancario","number"),c("Aplica\xe7\xf5es","disponibilidades.aplicacoes","number"),c("Conta Banc\xe1ria","disponibilidades.contaBancaria","text")]})),u(10,"Receitas","Receitas do conv\xeanio (repasses, rendimentos, contrapartidas)",!1,(0,Qr.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[c("Repasses","receitas.repasses","number"),c("Rendimentos","receitas.rendimentos","number"),c("Contrapartidas","receitas.contrapartidas","number")]})),u(11,"Ajustes de Saldo","Ajustes cont\xe1beis de saldo (diferen\xe7as, corre\xe7\xf5es, concilia\xe7\xf5es)",!1,(0,Qr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[c("Diferen\xe7as","ajustesSaldo.diferencas","number"),c("Corre\xe7\xf5es","ajustesSaldo.correcoes","number"),c("Concilia\xe7\xf5es","ajustesSaldo.conciliacoes","textarea")]})),u(12,"Servidores Cedidos","Servidores p\xfablicos cedidos para execu\xe7\xe3o do conv\xeanio",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de servidores"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Servidor"})]})),u(13,"Descontos","Descontos aplicados (reten\xe7\xf5es, encargos, abatimentos)",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de descontos"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Desconto"})]})),u(14,"Devolu\xe7\xf5es","Valores devolvidos ao concedente",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de devolu\xe7\xf5es"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Devolu\xe7\xe3o"})]})),u(15,"Glosas","Despesas glosadas (n\xe3o reconhecidas)",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de glosas"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Glosa"})]})),u(16,"Empenhos","Empenhos relacionados ao conv\xeanio",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de empenhos"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Empenho"})]})),u(17,"Repasses","Repasses financeiros realizados pelo concedente",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de repasses"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Repasse"})]})),u(18,"Relat\xf3rio de Atividades","Relat\xf3rio de execu\xe7\xe3o f\xedsica das atividades",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Resumo Executivo","relatorioAtividades.resumoExecutivo","textarea"),c("Resultados F\xedsicos","relatorioAtividades.resultadosFisicos","textarea"),c("Impactos","relatorioAtividades.impactos","textarea")]})),u(19,"Dados Gerais Entidade Benefici\xe1ria","Dados cadastrais da entidade benefici\xe1ria",!1,(0,Qr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[c("Raz\xe3o Social","dadosGeraiseEntidadeBeneficiaria.razaoSocial","text"),c("CNPJ","dadosGeraiseEntidadeBeneficiaria.cnpj","text"),c("Endere\xe7o","dadosGeraiseEntidadeBeneficiaria.endereco","text"),c("Respons\xe1vel","dadosGeraiseEntidadeBeneficiaria.responsavel","text")]})),u(20,"Respons\xe1veis e Membros \xd3rg\xe3o Concedente","Respons\xe1veis e membros do \xf3rg\xe3o concedente",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Nomes","responsaveisMembrosOrgaoConcedente.nomes","textarea"),c("Assinantes","responsaveisMembrosOrgaoConcedente.assinantes","textarea"),c("Data","responsaveisMembrosOrgaoConcedente.data","date")]})),u(21,"Declara\xe7\xf5es","Declara\xe7\xf5es formais exigidas pelo TCE/AUDESP",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Declara\xe7\xe3o de Completude","declaracoes.declaracaoCompletude","checkbox"),c("Declara\xe7\xe3o de Legalidade","declaracoes.declaracaoLegalidade","checkbox"),c("Declara\xe7\xe3o de Regularidade","declaracoes.declaracaoRegularidade","checkbox"),c("Observa\xe7\xf5es","declaracoes.observacoes","textarea")]})),u(22,"Relat\xf3rio Governamental de An\xe1lise da Execu\xe7\xe3o","Relat\xf3rio governamental de an\xe1lise da execu\xe7\xe3o (preenchido pelo \xf3rg\xe3o concedente)",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("An\xe1lise Financeira","relatorioGovernamentalAnaliseExecucao.analiseFinanceira","textarea"),c("An\xe1lise Operacional","relatorioGovernamentalAnaliseExecucao.analiseOperacional","textarea"),c("Recomenda\xe7\xf5es","relatorioGovernamentalAnaliseExecucao.recomendacoes","textarea")]})),u(23,"Demonstra\xe7\xf5es Cont\xe1beis","Demonstrativos cont\xe1beis da execu\xe7\xe3o financeira",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Balan\xe7o Patrimonial","demonstracoesContabeis.balancePatrimonial","textarea"),c("Demonstra\xe7\xe3o de Resultado","demonstracoesContabeis.demonstracaoResultado","textarea"),c("Fluxo de Caixa","demonstracoesContabeis.fluxoCaixa","textarea")]})),u(24,"Publica\xe7\xf5es, Parecer e Ata","Publica\xe7\xf5es oficiais, atas e pareceres",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[(0,Qr.jsx)("p",{className:"text-sm text-slate-600",children:"Funcionalidade de array - adi\xe7\xe3o din\xe2mica de publica\xe7\xf5es"}),(0,Qr.jsx)("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Adicionar Publica\xe7\xe3o"})]})),u(25,"Presta\xe7\xe3o de Contas Entidade Benefici\xe1ria","Consolida\xe7\xe3o da presta\xe7\xe3o apresentada pela entidade",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Consolida\xe7\xe3o","prestacaoContasEntidadeBeneficiaria.consolidacao","textarea"),c("Observa\xe7\xf5es","prestacaoContasEntidadeBeneficiaria.observacoes","textarea")]})),u(26,"Parecer Conclusivo","Parecer conclusivo do \xf3rg\xe3o concedente",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Parecer","parecerConclusivo.parecer","textarea"),c("Conclus\xe3o","parecerConclusivo.conclusao","textarea"),c("Data","parecerConclusivo.data","date")]})),u(27,"Transpar\xeancia","Informa\xe7\xf5es de transpar\xeancia p\xfablica (links, portais)",!1,(0,Qr.jsxs)("div",{className:"space-y-4",children:[c("Links","transparencia.links","textarea"),c("Portais","transparencia.portais","textarea"),c("Data de Publica\xe7\xe3o","transparencia.dataPublicacao","date")]}))]}),(0,Qr.jsxs)("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 mt-8 px-4 py-4 flex gap-4 rounded-lg shadow-lg",children:[(0,Qr.jsx)("button",{className:"flex-1 px-4 py-3 text-sm bg-slate-300 text-slate-900 rounded hover:bg-slate-400 transition font-medium",children:"Cancelar"}),(0,Qr.jsx)("button",{className:"flex-1 px-4 py-3 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition font-medium",children:"Enviar Presta\xe7\xe3o de Contas"})]}),(0,Qr.jsx)("div",{className:"mt-8 p-4 bg-slate-800 text-slate-100 rounded-lg font-mono text-xs overflow-auto max-h-64",children:(0,Qr.jsx)("pre",{children:JSON.stringify(t,null,2)})})]})},mA=t=>{var n;let{activeSection:i,setActiveSection:s,formData:r,updateField:o,updateItem:a,addItem:l,removeItem:c,handleExtraction:u,handleDownload:d,onTransmit:h,isLoading:p=!1,sectionStatus:f={}}=t;const[m,g]=(0,e.useState)("form"),[v,y]=(0,e.useState)(!0),b=(0,e.useMemo)(()=>[{id:"identificacao",label:"Identifica\xe7\xe3o do Conv\xeanio"},{id:"prefeito-secretario",label:"Prefeito e Secret\xe1rio"},{id:"entidades-convenio",label:"Entidades do Conv\xeanio"},{id:"documentos-convenio",label:"Documentos do Conv\xeanio"},{id:"demonstracoes",label:"Demonstra\xe7\xf5es Cont\xe1beis"},{id:"resultado-exercicio",label:"Resultado do Exerc\xedcio"},{id:"analise-resultado",label:"An\xe1lise do Resultado"},{id:"responsavel-prestacao",label:"Respons\xe1vel da Presta\xe7\xe3o"}],[]),w=(0,e.useMemo)(()=>{const e=b.filter(e=>{var t;return null===(t=f[e.id])||void 0===t?void 0:t.isValid}).length;return Math.round(e/b.length*100)},[b,f]),_=(0,e.useMemo)(()=>{let e=0;const t=n=>{n&&"object"===typeof n&&Object.values(n).forEach(n=>{n&&"object"===typeof n&&!Array.isArray(n)?t(n):n&&""!==n&&e++})};return t(r),e},[r]);return(0,Qr.jsxs)("div",{className:"h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex flex-col overflow-hidden",children:[(0,Qr.jsx)("header",{className:"bg-white border-b border-slate-200 shadow-sm",children:(0,Qr.jsxs)("div",{className:"px-6 py-4",children:[(0,Qr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Presta\xe7\xe3o de Contas Anual"}),(0,Qr.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["Sistema de Transmiss\xe3o para Audesp - Progresso: ",w,"% completo"]})]}),(0,Qr.jsx)("button",{onClick:h,disabled:p||w<100,className:"px-8 py-3 rounded-lg font-semibold transition-all ".concat(p?"bg-slate-400 text-white cursor-not-allowed":w<100?"bg-slate-300 text-slate-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-xl"),children:p?"Enviando...":"Enviar para Audesp"})]}),(0,Qr.jsxs)("div",{className:"mt-4",children:[(0,Qr.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Qr.jsx)("span",{className:"text-xs font-medium text-slate-600",children:"Progresso do Formul\xe1rio"}),(0,Qr.jsxs)("span",{className:"text-xs font-bold text-slate-900",children:[w,"%"]})]}),(0,Qr.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2 overflow-hidden",children:(0,Qr.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-full transition-all duration-300",style:{width:"".concat(w,"%")}})})]})]})}),(0,Qr.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,Qr.jsx)("aside",{className:"bg-white border-r border-slate-200 transition-all duration-300 overflow-hidden flex flex-col ".concat(v?"w-72":"w-0"),children:(0,Qr.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,Qr.jsxs)("div",{className:"p-4 border-b border-slate-200",children:[(0,Qr.jsx)("h2",{className:"text-xs font-bold text-slate-900 uppercase tracking-wider mb-4",children:"Se\xe7\xf5es do Formul\xe1rio"}),(0,Qr.jsx)("div",{className:"space-y-1",children:b.map(e=>{const t=f[e.id],n=i===e.id,r=null===t||void 0===t?void 0:t.isValid,o=null===t||void 0===t?void 0:t.hasErrors;return(0,Qr.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left px-4 py-3 rounded-lg transition-all text-sm font-medium flex items-center justify-between ".concat(n?"bg-blue-50 text-blue-700 border border-blue-200":"text-slate-700 hover:bg-slate-50"),children:[(0,Qr.jsxs)("span",{className:"flex items-center gap-3 flex-1",children:[(0,Qr.jsx)("span",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0 transition-colors ".concat(r?"bg-green-500":o?"bg-red-500":"bg-slate-300")}),(0,Qr.jsx)("span",{className:"truncate",children:e.label})]}),n&&(0,Qr.jsx)("span",{className:"text-blue-600 text-lg ml-2",children:"\u2192"})]},e.id)})})]}),(0,Qr.jsxs)("div",{className:"p-4 border-b border-slate-200",children:[(0,Qr.jsx)("h2",{className:"text-xs font-bold text-slate-900 uppercase tracking-wider mb-4",children:"Visualiza\xe7\xf5es"}),(0,Qr.jsx)("div",{className:"space-y-2",children:[{id:"form",label:"Formul\xe1rio",icon:"\ud83d\udccb"},{id:"pdf",label:"Importar PDF",icon:"\ud83d\udcc4"},{id:"json",label:"Estrutura JSON",icon:"{}"}].map(e=>(0,Qr.jsxs)("button",{onClick:()=>g(e.id),className:"w-full px-4 py-3 rounded-lg font-medium text-sm transition-all flex items-center gap-2 ".concat(m===e.id?"bg-blue-600 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[(0,Qr.jsx)("span",{children:e.icon}),e.label]},e.id))})]}),(0,Qr.jsxs)("div",{className:"p-4",children:[(0,Qr.jsx)("h2",{className:"text-xs font-bold text-slate-900 uppercase tracking-wider mb-4",children:"A\xe7\xf5es R\xe1pidas"}),(0,Qr.jsxs)("div",{className:"space-y-2",children:[(0,Qr.jsx)("button",{onClick:d,className:"w-full px-4 py-2 bg-slate-100 text-slate-700 rounded-lg text-sm font-medium hover:bg-slate-200 transition-colors",children:"Baixar JSON"}),(0,Qr.jsx)("button",{onClick:u,className:"w-full px-4 py-2 bg-slate-100 text-slate-700 rounded-lg text-sm font-medium hover:bg-slate-200 transition-colors",children:"Extrair Dados"})]})]}),(0,Qr.jsx)("div",{className:"p-4 bg-slate-50 border-t border-slate-200",children:(0,Qr.jsxs)("div",{className:"space-y-3",children:[(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("p",{className:"text-xs text-slate-600 font-medium",children:"Campos Preenchidos"}),(0,Qr.jsx)("p",{className:"text-lg font-bold text-slate-900",children:_})]}),(0,Qr.jsxs)("div",{children:[(0,Qr.jsx)("p",{className:"text-xs text-slate-600 font-medium",children:"Se\xe7\xf5es V\xe1lidas"}),(0,Qr.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[b.filter(e=>{var t;return null===(t=f[e.id])||void 0===t?void 0:t.isValid}).length,"/",b.length]})]})]})})]})}),(0,Qr.jsxs)("main",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[(0,Qr.jsxs)("div",{className:"bg-white border-b border-slate-200 px-6 py-3 flex items-center justify-between",children:[(0,Qr.jsx)("button",{onClick:()=>y(!v),className:"px-3 py-2 rounded-lg bg-slate-100 text-slate-700 hover:bg-slate-200 transition-colors font-medium text-sm",title:v?"Fechar painel":"Abrir painel",children:v?"\u2190 Fechar Painel":"Abrir Painel \u2192"}),(0,Qr.jsxs)("div",{className:"text-sm font-semibold text-slate-700",children:["form"===m&&(0,Qr.jsx)("span",{children:(null===(n=b.find(e=>e.id===i))||void 0===n?void 0:n.label)||"Formul\xe1rio"}),"pdf"===m&&(0,Qr.jsx)("span",{children:"Importar Dados de PDF com OCR"}),"json"===m&&(0,Qr.jsx)("span",{children:"Visualizador de Estrutura JSON"})]}),(0,Qr.jsx)("div",{className:"text-xs text-slate-500",children:(new Date).toLocaleString("pt-BR")})]}),(0,Qr.jsxs)("div",{className:"flex-1 overflow-hidden",children:["form"===m&&(0,Qr.jsx)("div",{className:"h-full overflow-y-auto bg-slate-50",children:(0,Qr.jsx)("div",{className:"max-w-full",children:(0,Qr.jsx)(fA,{})})}),"pdf"===m&&(0,Qr.jsx)("div",{className:"h-full bg-white",children:(0,Qr.jsx)(rA,{onOCRComplete:e=>{console.log("OCR completado:",e)},onPDFLoaded:()=>{console.log("PDF carregado")}})}),"json"===m&&(0,Qr.jsx)("div",{className:"h-full bg-white",children:(0,Qr.jsx)(oA,{data:r})})]})]})]}),(0,Qr.jsx)("footer",{className:"bg-white border-t border-slate-200 px-6 py-3",children:(0,Qr.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[(0,Qr.jsx)("div",{children:"Audesp - Sistema de Presta\xe7\xe3o de Contas Eletr\xf4nica"}),(0,Qr.jsxs)("div",{className:"flex gap-4",children:[(0,Qr.jsx)("span",{children:"Vers\xe3o 2.2"}),(0,Qr.jsx)("span",{children:"Status: Pronto"})]})]})})]})},gA=()=>{const[t,n]=(0,e.useState)("dashboard"),[i,s]=(0,e.useState)(l),[r,o]=(0,e.useState)(!1),[c,u]=(0,e.useState)(!1),[d,f]=(0,e.useState)(null),[v,b]=(0,e.useState)(null),[x,E]=(0,e.useState)("idle"),[S,A]=(0,e.useState)(!1),[C,k]=(0,e.useState)(!1),[I,N]=(0,e.useState)(null),[P,M]=(0,e.useState)([]),R=(0,e.useMemo)(()=>T(i),[i]),[O,D]=(0,e.useState)(!1),[F,L]=(0,e.useState)(null),[j,U]=(0,e.useState)(""),[B,W]=(0,e.useState)("piloto"),[H,V]=(0,e.useState)("form"),q=(0,e.useRef)(F);(0,e.useEffect)(()=>{q.current=F},[F]),(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&r&&(o(!1),setTransmissionLog([]),setTransmissionErrors([]))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r]),(0,e.useEffect)(()=>{try{if(function(){if(!p())return!1;const e=sessionStorage.getItem(h);return!e||Date.now()<parseInt(e,10)}()){D(!0),L(p());const t=localStorage.getItem("audesp_draft");if(t)try{s(JSON.parse(t))}catch(e){}}else{if("undefined"!==typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||window.location.hostname.includes("10.0"))||localStorage.getItem("audesp_demo_mode")){D(!0),L("demo-token-dev"),W("piloto"),U("00000000000"),localStorage.setItem("audesp_demo_mode","true");const e=localStorage.getItem("audesp_draft");if(e)try{s(JSON.parse(e))}catch(t){}}else G()}}catch(n){console.error("Auth initialization error:",n),D(!0),L("demo-token-recovery"),W("piloto"),U("00000000000")}},[]);const z=function(e){f({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"}),setTimeout(()=>f(null),5e3)},G=()=>{sessionStorage.clear(),L(null),D(!1),U(""),W("piloto"),V("form")},J=(e,t,i)=>{sessionStorage.setItem("audesp_token",e),sessionStorage.setItem("audesp_expire",String(Date.now()+288e5)),L(e),W(t),U(i),D(!0),n("dashboard"),V("form"),z("Login no ambiente ".concat(t," realizado com sucesso!"),"success");const r=localStorage.getItem("audesp_draft");if(r)try{s(JSON.parse(r))}catch(o){}},K=e=>{z(e,"error")},Y=()=>{A(!0)};return O?(console.log("[App] Renderizando com isLoggedIn:",O,"activeSection:",t),(0,Qr.jsxs)("div",{className:"h-screen flex flex-col bg-slate-50 overflow-hidden",children:[(0,Qr.jsx)(mA,{activeSection:t,setActiveSection:n,formData:i,updateField:(e,t)=>{"string"===typeof e?s(n=>{const i=JSON.parse(JSON.stringify(n)),s=e.split(".");let r=i;for(let e=0;e<s.length-1;e++)r=r[s[e]]=r[s[e]]||{};return r[s[s.length-1]]=t,i}):console.error("CRITICAL: updateField received invalid path. Ignoring.",e,t)},updateItem:(e,t,n,i)=>{"string"===typeof e?s(s=>{const r=JSON.parse(JSON.stringify(s)),o=e.split(".");let a=r;for(let e=0;e<o.length;e++)a=a[o[e]];if(Array.isArray(a)&&a[t]){const e=n.split(".");let s=a[t];for(let t=0;t<e.length-1;t++)s=s[e[t]]=s[e[t]]||{};s[e[e.length-1]]=i}return r}):console.error("CRITICAL: updateItem received invalid path.",e)},addItem:(e,t)=>{"string"===typeof e?s(n=>{const i=JSON.parse(JSON.stringify(n)),s=e.split(".");let r=i;for(let e=0;e<s.length-1;e++)r=r[s[e]]=r[s[e]]||{};const o=s[s.length-1];return Array.isArray(r[o])||(r[o]=[]),r[o].push(t),i}):console.error("CRITICAL: addItem received invalid path.",e)},removeItem:(e,t)=>{"string"===typeof e&&s(n=>{const i=JSON.parse(JSON.stringify(n)),s=e.split(".");let r=i;for(let e=0;e<s.length-1;e++)r=r[s[e]];const o=s[s.length-1];return Array.isArray(r[o])&&r[o].splice(t,1),i})},handleExtraction:()=>{},handleDownload:()=>{try{((e,t)=>{const n=JSON.stringify(e,null,2),i=new Blob([n],{type:"application/json"}),s=URL.createObjectURL(i),r="prestacao_".concat(e.descritor.entidade,"_").concat(e.descritor.mes,"_").concat(e.descritor.ano,".json"),o=document.createElement("a");o.href=s,o.download=t||r,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)})(i),z("Arquivo JSON baixado com sucesso!","success")}catch(e){z("Erro ao gerar arquivo.","error")}},onTransmit:Y,isLoading:"processing"===x,sectionStatus:R}),d&&(0,Qr.jsx)("div",{className:"fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-xl border-l-4 ".concat("error"===d.type?"bg-white border-red-500 text-red-700":"success"===d.type?"bg-white border-green-500 text-green-700":"bg-white border-blue-500 text-blue-700"),children:(0,Qr.jsx)("p",{className:"font-semibold",children:d.message})}),c&&(0,Qr.jsx)(eo,{onDataMerge:e=>{s(t=>{const n=a({},t);return e.relacao_empregados&&(n.relacao_empregados=[...t.relacao_empregados||[],...e.relacao_empregados]),e.contratos&&(n.contratos=[...t.contratos||[],...e.contratos]),e.documentos_fiscais&&(n.documentos_fiscais=[...t.documentos_fiscais||[],...e.documentos_fiscais]),e.pagamentos&&(n.pagamentos=[...t.pagamentos||[],...e.pagamentos]),e.empenhos&&(n.empenhos=[...t.empenhos||[],...e.empenhos]),e.descritor&&e.descritor.ano&&(n.descritor=a(a({},t.descritor),e.descritor)),n}),u(!1),z("Dados importados e mesclados com sucesso!","success")},onCancel:()=>u(!1)}),S&&(0,Qr.jsx)(so,{isOpen:S,onConfirm:(e,t)=>{A(!1),U(e),o(!0),E("processing"),setTransmissionLog(["\u23f3 Iniciando processo de transmiss\xe3o...","\ud83d\udc64 Usu\xe1rio: ".concat(e).concat(t?" / ".concat(t):""),"Aguarde..."]),setTransmissionErrors([]),b(null),setTimeout(async()=>{try{var e,t,n;console.log("[Transmit] Starting transmission process");const l=sessionStorage.getItem("audesp_token"),c=sessionStorage.getItem("audesp_expire");console.log("[Transmit] Token sources:",{sessionStorageToken:(null===l||void 0===l?void 0:l.substring(0,20))+"...",sessionStorageExpire:c,authTokenRef:(null===(e=q.current)||void 0===e?void 0:e.substring(0,20))+"...",authTokenState:(null===F||void 0===F?void 0:F.substring(0,20))+"...",authCpf:j});let u=sessionStorage.getItem("audesp_token")||F||q.current;if(!u){const e="\u274c Sess\xe3o expirada. Fa\xe7a login novamente.";return setTransmissionLog([e]),E("error"),setTransmissionErrors([{field:"Autentica\xe7\xe3o",message:"Token n\xe3o dispon\xedvel"}]),void console.error("[Transmit]",e,{sessionStorage:!!l,authToken:!!F,authRef:!!q.current})}const d=sessionStorage.getItem("audesp_expire");if(d&&Date.now()>parseInt(d)){const e="\u274c Token expirado. Fa\xe7a login novamente.";return setTransmissionLog([e]),E("error"),setTransmissionErrors([{field:"Autentica\xe7\xe3o",message:"Token expirado"}]),void console.error("[Transmit]",e,{now:Date.now(),expireTime:parseInt(d),diff:parseInt(d)-Date.now()})}u.startsWith("Bearer ")&&(u=u.substring(7),console.log("[Transmit] Removed Bearer prefix from token")),console.log("[Transmit] Token validated and ready:",{hasToken:!!u,tokenLength:null===(t=u)||void 0===t?void 0:t.length,tokenPrefix:null===(n=u)||void 0===n?void 0:n.substring(0,20),cpf:j,expiresIn:d?Math.ceil((parseInt(d)-Date.now())/1e3)+"s":"unknown"}),setTransmissionLog(e=>[...e,"\ud83d\udccb Validando estrutura de dados (schema)..."]);const h=function(e){const t=T(e),n=[];return Object.values(t).forEach(e=>{"invalid"===e.status&&e.errors.forEach(t=>n.push("[Se\xe7\xe3o ".concat(e.id,"] ").concat(t)))}),[].forEach(e=>n.push("[Consist\xeancia] ".concat(e))),n}(i);console.log("[Transmit] Validation errors:",h.length),setTransmissionLog(e=>[...e,"\ud83d\udd17 Verificando consist\xeancia cont\xe1bil (cross-check)..."]);const p=[];if(console.log("[Transmit] Consistency errors:",p.length),h.length>0||p.length>0){E("error");const e=[...h.map((e,t)=>{const n=e.match(/Campo: (.+?)\s*(?:\||$)/);return{field:n?n[1]:"Erro ".concat(t+1),message:e}}),...p.map((e,t)=>{const n=e.match(/Campo: (.+?)\s*(?:\||$)/);return{field:n?n[1]:"Consist\xeancia ".concat(t+1),message:e}})];return setTransmissionErrors(e),setTransmissionLog(["\u274c ERRO DE VALIDA\xc7\xc3O LOCAL:","\ud83d\udcca ".concat(h.length," erro(s) de valida\xe7\xe3o encontrado(s)"),"\ud83d\udd17 ".concat(p.length," erro(s) de consist\xeancia encontrado(s)"),"","CAMPOS COM PROBLEMAS:",...e.map(e=>"  \u26a0\ufe0f  ".concat(e.field))]),void console.log("[Transmit] Validation failed, stopping transmission")}let f;setTransmissionLog(e=>[...e,"\u2705 Valida\xe7\xe3o local OK!","\ud83c\udf10 Enviando para Audesp Piloto..."]),console.log("[Transmit] All validations passed, sending to Audesp");try{f=await async function(e,t,n){const i=t.descritor.tipo_documento,s=_[i];if(!s)throw new Error("Tipo de documento n\xe3o mapeado: ".concat(i));console.log("[Transmission] Validando permiss\xf5es para: ".concat(i));const r=await y.validateTransmissionPermission(i,e,n);if(!r.hasPermission){const e=r.reason||"Permiss\xe3o negada";throw console.error("[Transmission] Falha na valida\xe7\xe3o de permiss\xe3o:",e),g.logTransmission(i,null,"PERMISSION_DENIED",e),new Error("\u274c Valida\xe7\xe3o de Permiss\xe3o Falhou:\n".concat(e))}const o="".concat(w).concat(s);console.log("[Transmission] \u2713 Permiss\xf5es validadas. Enviando para: ".concat(o)),console.log("[Transmission] ========== TOKEN E CPF INFO =========="),console.log("[Transmission] CPF: ".concat(n," (type: ").concat(typeof n,", length: ").concat(n?n.length:0,")")),console.log("[Transmission] CPF Detalhado:",{value:n,type:typeof n,length:n?n.length:0,isEmail:!!n&&n.includes("@"),isCpf:!!n&&/^\d{11}$/.test(n.replace(/\D/g,"")),isValid:!!n&&/^\d{11}$/.test(n.replace(/\D/g,""))&&!n.includes("@")}),console.log("[Transmission] Token:",{hasToken:!!e,tokenLength:e.length,tokenPrefix:e.substring(0,30),startsWithBearer:e.startsWith("Bearer ")}),console.log("[Transmission] =============================================");const l=t,c=new FormData,u=JSON.stringify(l);if(c.append("documentoJSON",u),console.log("[Transmission] JSON Payload Structure:",{descritor:l.descritor,hasCodigo:!!l.codigo_ajuste,hasRetificacao:"retificacao"in l,totalFields:Object.keys(l).length,jsonSize:u.length+" bytes"}),!l.descritor)throw new Error("\u274c Campo obrigat\xf3rio faltando: descritor");"codigo_ajuste"in l||console.warn("\u26a0\ufe0f Campo pode ser obrigat\xf3rio: codigo_ajuste"),"retificacao"in l||console.warn("\u26a0\ufe0f Campo pode ser obrigat\xf3rio: retificacao");try{var d,h,p,f,v,b,x;const t=new AbortController,s=setTimeout(()=>t.abort(),3e4),r={method:"POST",headers:a({Authorization:e.startsWith("Bearer ")?e:"Bearer ".concat(e),Accept:"application/json",Origin:"https://audesp-piloto.tce.sp.gov.br",Referer:"https://audesp-piloto.tce.sp.gov.br/","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"},n&&{"X-User-CPF":n}),body:c,signal:t.signal},l=r.headers;let u;console.log("[Transmission] \ud83d\udd10 Authorization Header:",{raw:l.Authorization,prefix:null===(d=l.Authorization)||void 0===d?void 0:d.substring(0,10),hasBearer:null===(h=l.Authorization)||void 0===h?void 0:h.startsWith("Bearer "),tokenLength:null===(p=l.Authorization)||void 0===p?void 0:p.replace("Bearer ","").length,tokenHash:(null===(f=l.Authorization)||void 0===f?void 0:f.substring(0,40))+"..."}),console.log("[Transmission] Request headers:",{Authorization:(null===(v=l.Authorization)||void 0===v?void 0:v.substring(0,40))+"...",Accept:"application/json",Origin:l.Origin,Referer:l.Referer,"User-Agent":(null===(b=l["User-Agent"])||void 0===b?void 0:b.substring(0,50))+"...","X-User-CPF":n||"n\xe3o informado","Content-Type":"multipart/form-data (auto)"}),console.log("[Transmission] Endpoint: ".concat(o)),console.log("[Transmission] Method: POST"),console.log("[Transmission] Environment: ".concat("production")),console.log("[Transmission] Is Localhost: ".concat(o.includes("proxy"))),console.log("[Transmission] Full Request URL: ".concat(o)),console.log("[Transmission] \ud83d\udd11 CPF SENDO ENVIADO: ".concat(n||"N\xc3O INFORMADO")),console.log("[Transmission] Header X-User-CPF: ".concat(n||"vazio")),console.log("[Transmission] CPF V\xe1lido (11 d\xedgitos): ".concat(n&&/^\d{11}$/.test(n.replace(/\D/g,""))?"SIM \u2705":"N\xc3O \u274c")),console.log("[Transmission] Form data fields:",{hasDocumentoJSON:c.has("documentoJSON"),documentoJSONSize:(null===(x=c.get("documentoJSON"))||void 0===x?void 0:x.toString().length)+" bytes"});try{u=await fetch(o,r)}finally{clearTimeout(s)}const y=await u.text();let w;console.log("[Transmission] \u2705 Response Status: ".concat(u.status)),console.log("[Transmission] Response Headers:",{"content-type":u.headers.get("content-type"),"access-control-allow-origin":u.headers.get("access-control-allow-origin")}),console.log("[Transmission] Response Body (first 500 chars):",y.substring(0,500));try{w=JSON.parse(y)}catch(T){throw new Error("Erro n\xe3o-JSON do servidor (".concat(u.status,"): ").concat(y.substring(0,100)))}if(!u.ok){const t=JSON.stringify(w,null,2),s="TRANS-".concat(u.status,"-").concat(Date.now().toString().slice(-6));if(401===u.status){const i="[Transmission] 401 Unauthorized - Diagnosticando:\n1. Token v\xe1lido: ".concat(e?"SIM (length: "+e.length+")":"N\xc3O","\n2. Token formato: ").concat(e.startsWith("Bearer ")?"Com Bearer prefix":"Sem prefix (ser\xe1 adicionado)","\n3. Token primeiros 30 chars: ").concat(e.substring(0,30),"...\n4. CPF informado: ").concat(n||"N\xc3O","\n5. Endpoint: ").concat(o,"\n6. Response: ").concat(t,"\n\n\ud83d\udd0d DIAGN\xd3STICO DO ERRO 401:\nEste erro significa que a credencial foi rejeitada pela API Audesp.\nPoss\xedveis causas:\n1. O CPF ").concat(n||"(n\xe3o informado)",' n\xe3o tem permiss\xe3o para transmitir (verifique com Audesp)\n2. O token foi revogado ou expirou (refa\xe7a login)\n3. A API Audesp est\xe1 rejeitando requisi\xe7\xf5es de sua IP/localidade\n4. O endpoint pode estar desativado no ambiente piloto\n\nPR\xd3XIMOS PASSOS:\n1. Verifique se o seu CPF tem permiss\xe3o para "Presta\xe7\xe3o de Contas de Conv\xeanio"\n2. Fa\xe7a logout e login novamente para renovar o token\n3. Contate o suporte Audesp: suporte@audesp.tce.sp.gov.br\n4. Mencione o c\xf3digo de erro: ').concat(s);console.error(i);const r="\u274c Erro de Autentica\xe7\xe3o (401):\n".concat(w.message||"Credencial n\xe3o reconhecida pela API Audesp",'\n\n\u26a0\ufe0f Verifique:\n\u2022 Suas credenciais est\xe3o corretas?\n\u2022 Seu CPF tem permiss\xe3o para transmitir?\n\u2022 Voc\xea est\xe1 no ambiente correto (Piloto/Produ\xe7\xe3o)?\n\n\ud83d\udca1 SOLU\xc7\xc3O:\n\u2022 Clique em "Fazer Login Novamente" para obter um novo token\n\u2022 Use as credenciais de um CPF autorizado pela Audesp\n\u2022 Se o erro persistir, contate o suporte\n\nC\xf3digo: ').concat(s);throw new Error(r)}if(403===u.status){const r="[Transmission] 403 Forbidden - Diagnosticando:\n1. Token v\xe1lido: ".concat(e?"SIM (length: "+e.length+")":"N\xc3O","\n2. CPF informado: ").concat(n||"N\xc3O","\n3. Tipo de Documento: ").concat(i,"\n4. Endpoint: ").concat(o,"\n5. Response: ").concat(t,"\n\n\ud83d\udd0d DIAGN\xd3STICO DO ERRO 403:\nEste erro significa que o usu\xe1rio N\xc3O TEM PERMISS\xc3O para realizar esta opera\xe7\xe3o.\nPoss\xedveis causas:\n1. O CPF ").concat(n||"(n\xe3o informado)",' n\xe3o tem permiss\xe3o espec\xedfica para transmitir "').concat(i,'"\n2. O perfil de acesso no Audesp n\xe3o inclui esta funcionalidade\n3. O acesso foi revogado ou suspenso temporariamente\n4. Ambiente Piloto vs Produ\xe7\xe3o pode ter permiss\xf5es diferentes\n5. CPF n\xe3o foi validado/certificado pela institui\xe7\xe3o respons\xe1vel\n\nPR\xd3XIMOS PASSOS:\n1. \u2713 Verifique com o administrador se seu CPF est\xe1 autorizado para transmitir\n2. \u2713 Tente com outro CPF que voc\xea sabe que tem permiss\xe3o\n3. \u2713 Fa\xe7a logout e login novamente (\xe0s vezes resolve)\n4. \u2713 Contate o suporte Audesp: suporte@audesp.tce.sp.gov.br\n5. \u2713 Mencione: CPF: ').concat(n||"n\xe3o informado",", Tipo Doc: ").concat(i,", C\xf3digo: ").concat(s);console.error(r);const a="\u274c Acesso Negado (403):\n".concat(w.message||"Voc\xea n\xe3o possui permiss\xe3o para transmitir este documento",'\n\n\u26a0\ufe0f Verifique com o Administrador:\n\u2022 Seu CPF est\xe1 autorizado para transmitir?\n\u2022 Seu perfil no Audesp inclui esta opera\xe7\xe3o?\n\u2022 Suas permiss\xf5es foram revogadas?\n\n\ud83d\udca1 PR\xd3XIMAS A\xc7\xd5ES:\n\u2022 Tente fazer login com outro CPF autorizado\n\u2022 Se correto, clique "Fazer Login Novamente"\n\u2022 Contate: suporte@audesp.tce.sp.gov.br\n\u2022 Compartilhe o c\xf3digo: ').concat(s,"\n\nTipo de Documento: ").concat(i);throw new Error(a)}throw new Error(t)}return w.protocolo&&(m({protocolo:w.protocolo,dataHora:w.dataHora,status:w.status,tipoDocumento:w.tipoDocumento}),g.logTransmission(i,w.protocolo,"SUCCESS")),w}catch(k){var E,S,A,C;console.error("[Transmission Error]",k),g.logTransmission(i,null,"FAILED",k.message);let t="";const n=o.includes("/proxy-"),s=o.includes("https://");throw t="AbortError"===k.name?"\u274c TIMEOUT (30s): Servidor n\xe3o respondeu em tempo h\xe1bil\n\u2022 Verifique se https://audesp-piloto.tce.sp.gov.br est\xe1 online\n\u2022 Tente novamente em alguns segundos":null!==(E=k.message)&&void 0!==E&&E.includes("Failed to fetch")?"\u274c ERRO DE CONEX\xc3O (CORS/Network) ".concat(n?"(via proxy - localhost)":s?"(CORS/direct HTTPS)":"(unknown URL)",":\n\u2022 Servidor pode estar indispon\xedvel\n\u2022 Verificar se dom\xednio est\xe1 acess\xedvel: https://audesp-piloto.tce.sp.gov.br\n\u2022 Pode ser bloqueio de CORS do navegador\n\u2022 Tente em produ\xe7\xe3o (n\xe3o localhost)"):null!==(S=k.message)&&void 0!==S&&S.includes("NetworkError")?"\u274c ERRO DE REDE:\n\u2022 Verifique sua conex\xe3o de internet\n\u2022 Tente novamente em alguns segundos\n\u2022 Se persistir, contate o administrador da rede":null!==(A=k.message)&&void 0!==A&&A.includes("TypeError")?"\u274c ERRO DE TIPO/CONFIGURA\xc7\xc3O:\n\u2022 Problema na constru\xe7\xe3o da requisi\xe7\xe3o\n\u2022 Verifique token e formato de dados":"\u274c ERRO DESCONHECIDO: ".concat(k.message),console.error("[Transmission Diagnostic]\n".concat(t)),console.error("[Transmission Debug Info]",{url:o,isProxyURL:n,isDirectURL:s,method:"POST",tokenPrefix:(null===e||void 0===e?void 0:e.substring(0,10))+"...",windowHostname:"undefined"!==typeof window?window.location.hostname:"N/A",environment:"production",errorName:k.name,errorMessage:k.message,errorStack:null===(C=k.stack)||void 0===C?void 0:C.split("\n").slice(0,3).join("\n")}),new Error(t)}}(u,i,j),console.log("[Transmit] Response received:",f)}catch(s){E("error");const e=s.message||String(s);let t={status:0,message:e};try{const n=e.match(/\{[\s\S]*\}/);n&&(t=JSON.parse(n[0]))}catch(r){console.debug("[Transmit] Could not parse error JSON:",r)}console.log("[Transmit] Parsed error object:",t),N(t);const n=ro.diagnoseError(t);return console.log("[Transmit] Generated diagnostics:",n),M(n),k(!0),setTransmissionLog(t=>[...t,"\u274c ERRO NA TRANSMISS\xc3O:",e,"","\ud83d\udca1 SUGEST\xd5ES:","  \u2022 Clique em '\ud83d\udcc4 Ver JSON com Erros' para an\xe1lise detalhada","  \u2022 Verifique sua conex\xe3o com a internet","  \u2022 Tente novamente em alguns segundos","  \u2022 Se o erro persistir, contate o administrador"]),setTransmissionErrors([{field:"Transmiss\xe3o",message:e}]),void console.error("[Transmit] Transmission failed:",s)}if(console.log("[Transmit] Processing response, status:",f.status),"Rejeitado"===f.status){E("error");const e=f.erros||[];setTransmissionErrors(e.map(e=>({field:e.campo||e.field||"Desconhecido",message:e.mensagem||e.message||JSON.stringify(e)}))),setTransmissionLog(t=>[...t,"","\u274c DOCUMENTO REJEITADO PELO AUDESP","\ud83d\udcc4 Protocolo: ".concat(f.protocolo),"","\ud83d\udd34 MOTIVOS DA REJEI\xc7\xc3O:",...e.map(e=>"  \u2022 ".concat(e.campo||e.field,": ").concat(e.mensagem||e.message))])}else"Armazenado"===f.status?(E("success"),setTransmissionLog(e=>[...e,"","\u26a0\ufe0f  ALERTA: Documento Armazenado com Ressalvas.","\ud83d\udcc4 Protocolo: ".concat(f.protocolo)])):(E("success"),setTransmissionLog(e=>[...e,"\u2705 SUCESSO: Documento Recebido.","Protocolo: ".concat(f.protocolo)]));b(f),o(!1)}catch(l){E("error");let e=l.message;try{const t=JSON.parse(e);e=JSON.stringify(t,null,2)}catch(c){}setTransmissionLog(t=>[...t,"\u274c ERRO T\xc9CNICO NA TRANSMISS\xc3O:",e]),(e.includes("401")||e.includes("Unauthorized"))&&setTimeout(()=>G(),3e3)}},500)},onCancel:()=>{A(!1)},currentCpf:j}),v&&(0,Qr.jsx)(io,{result:v,onClose:()=>b(null)}),C&&(0,Qr.jsx)(ao,{error:I||{},jsonData:i,diagnostics:P,onDismiss:()=>{k(!1),N(null)},onRetry:()=>{k(!1),Y()},onAutoFix:e=>{s(e),k(!1)}})]})):(0,Qr.jsx)("div",{className:"flex items-center justify-center h-screen bg-slate-100",children:(0,Qr.jsx)(fo,{onLoginSuccess:J,onError:K})})},vA=document.getElementById("root");if(!vA)throw new Error("Could not find root element to mount to");t.createRoot(vA).render((0,Qr.jsx)(e.StrictMode,{children:(0,Qr.jsx)(gA,{})}))})()})();
//# sourceMappingURL=main.8f124b4f.js.map